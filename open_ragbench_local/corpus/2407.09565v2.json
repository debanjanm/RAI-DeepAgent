{"title": "A Short Note on Event-Study Synthetic Difference-in-Differences\n  Estimators", "sections": [{"section_id": 0, "text": "#### Abstract\n\nI propose an event study extension of Synthetic Difference-in-Differences (SDID) estimators. I show that, in simple and staggered adoption designs, estimators from Arkhangelsky et al. (2021) can be disaggregated into dynamic treatment effect estimators, comparing the lagged outcome differentials of treated and synthetic controls to their pre-treatment average. Estimators presented in this note can be computed using the sdid_event Stata package ${ }^{1}$.\n\n\nAdapting SDID to event study analysis. In what follows, I use the notation from Clarke et al. (2023) to present the estimation procedure for event-study Synthetic Difference-inDifferences (SDID) estimators. In a setting with $N$ units observed over $T$ periods, $N_{t r}<N$ units receive treatment $D$ starting from period $a$, where $1<a \\leq T$. The treatment $D$ is binary, i.e. $D \\in\\{0,1\\}$, and it affects some outcome of interest $Y$. The outcome and the treatment are observed for all $(i, t)$ cells, meaning that the data has a balanced panel structure.\n\nHenceforth, values of $a$ are referred to as cohorts or adoption periods. The values of $a$ are collected in $A$, i.e. the adoption date vector. For the sake of generality, we assume that $|A|>1$, meaning that groups start receiving the treatment at different periods. The case with no differential timing can be simply retrieved by considering one cohort at a time. Time periods are indexed by $t \\in\\{1, \\ldots, T\\}$, while units are indexed by $i \\in\\{1, \\ldots N\\}$. Without loss of generality, the first $N_{c o}=N-N_{t r}$ units are the never-treated group. As for the treated units, let $I^{a}$ be the subset of $\\left\\{N_{c o}+1, \\ldots, N\\right\\}$ containing the indices of units in cohort $a$. Lastly, we denote with $N_{t r}^{a}$ and $T_{t r}^{a}$ the number of units in cohort $a$ and the number of periods from the the onset of the treatment in the same cohort to end of the panel, respectively. These two cohort-specific quantities can be aggregated into $T_{\\text {post }}$ from Clarke et al. (2023), i.e. the total number of post treatment periods of all the units in every cohort. Namely,\n\n$$\nT_{\\text {post }}=\\sum_{a \\in A} N_{t r}^{a} T_{t r}^{a}\n$$\n\nis the sum of the products of $N_{t r}^{a}$ and $T_{t r}^{a}$ across all $a \\in A$.\nDisaggregating $\\hat{\\tau}_{d}^{\\text {sdid }}$. The cohort-specific SDID estimator from Arkhangelsky et al. (2021) can be rearranged as follows:\n\n$$\n\\hat{\\tau}_{d}^{\\text {sdid }}=\\frac{1}{T_{t r}^{a}} \\sum_{t=a}^{T}\\left(\\frac{1}{N_{t r}^{a}} \\sum_{i \\in I^{a}} Y_{i, t}-\\sum_{i=1}^{N_{c o}} \\omega_{i} Y_{i, t}\\right)-\\sum_{t=1}^{a-1}\\left(\\frac{1}{N_{t r}^{a}} \\sum_{i \\in I^{a}} \\lambda_{i} Y_{i, t}-\\sum_{i=1}^{N_{c o}} \\omega_{i} \\lambda_{i} Y_{i, t}\\right)\n$$\n\n[^0]\n[^0]:    *Northwestern University, Kellogg School of Management. diego.ciccia@kellogg.northwestern.edu.\n    ${ }^{1}$ The package is hosted on Github.\n\nwhere $\\lambda_{t}$ and $\\omega_{i}$ are the optimal weights chosen to best approximate the pre-treatment outcome evolution of treated and (synthetic) control units. $\\tau_{a}^{\\text {adid }}$ compares the average outcome difference of treated in cohort $a$ and never-treated before and after the onset of the treatment. In doing so, $\\tau_{a}^{\\text {adid }}$ encompasses all the post-treatment periods. As a result, it is possible to estimate the treatment effect $\\ell$ periods after the adoption of the treatment, with $\\ell \\in\\left\\{1, \\ldots, T_{\\text {post }}^{\\alpha}\\right\\}$, via a simple disaggregation of $\\tau_{a}^{\\text {adid }}$ into the following event-study estimators:\n\n$$\n\\hat{\\tau}_{a, \\ell}^{\\text {adid }}=\\frac{1}{N_{t r}^{a}} \\sum_{i \\in I^{a}} Y_{i, a-1+\\ell}-\\sum_{i=1}^{N_{t r}} \\omega_{i} Y_{i, a-1+\\ell}-\\sum_{i=1}^{a-1}\\left(\\frac{1}{N_{t r}^{a}} \\sum_{i \\in I^{a}} \\lambda_{t} Y_{i, t}-\\sum_{i=1}^{N_{t r}} \\omega_{i} \\lambda_{t} Y_{i, t}\\right)\n$$\n\nThis estimator is very similar to those proposed by Borusyak et al. (2024), Liu et al. (2024) and Gardner (2022), when the design is a canonical DiD (de Chaisemartin and D'Haultfoeuille, 2023). The only difference lies in the fact that the outcomes are weighted via unit-time specific weights. Notice that by construction\n\n$$\n\\hat{\\tau}_{a}^{\\text {adid }}=\\frac{1}{T_{t r}^{a}} \\sum_{\\ell=1}^{T_{t r}^{a}} \\hat{\\tau}_{a, \\ell}^{\\text {adid }}\n$$\n\nthat is, $\\hat{\\tau}_{a}^{\\text {adid }}$ is the sample average of the cohort-specific dynamic estimators $\\hat{\\tau}_{a, \\ell}^{\\text {adid }}$.\nAggregating $\\hat{\\tau}_{a, \\ell}^{\\text {adid }}$ estimators into event-study estimates. Let $A_{\\ell}$ be the subset of cohorts in $A$ such that $a-1+\\ell \\leq T$, i.e. such that their $\\ell$-th dynamic effect can be computed, and let\n\n$$\nN_{t r}^{\\ell}=\\sum_{a \\in A_{\\ell}} N_{t r}^{a}\n$$\n\ndenote the number of units in cohorts where the $\\ell$-th dynamic effect can be estimated. We can use this notation to aggregate the cohort-specific dynamic effects into a single estimator. Let\n\n$$\n\\hat{\\tau}_{\\ell}^{\\text {adid }}=\\sum_{a \\in A_{\\ell}} \\frac{N_{t r}^{a}}{N_{t r}^{\\ell}} \\hat{\\tau}_{a, \\ell}^{\\text {adid }}\n$$\n\ndenote the weighted sum of the cohort-specific treatment effects $\\ell$ periods after the onset of the treatment, with weights corresponding to the relative number of groups participating into each cohort. This estimator aggregates the cohort-specific treatment effects, upweighting more representative cohorts in terms of units included.\n\nAs in Equation 4, $\\hat{\\tau}_{\\ell}^{\\text {adid }}$ can also be retrieved via disaggregation of another estimator from Clarke et al. (2023). Let $T_{t r}=\\max _{a \\in A} T_{t r}^{a}$ be the maximum number of post-treatment periods across all cohorts. Equivalently, $T_{t r}$ can also be defined as the number of post-treatment periods of the earliest treated cohort. Then, one can show that\n\n$$\n\\widehat{A T T}=\\frac{1}{T_{\\text {post }}} \\sum_{\\ell=1}^{T_{t r}} N_{t r}^{\\ell} \\hat{\\tau}_{\\ell}^{\\text {adid }}\n$$\n\nthat is, the $\\widehat{A T T}$ estimator from Clarke et al. (2023) is a weighted average of the event study estimators $\\hat{\\tau}_{\\ell}^{\\text {adid }}$, with weights proportional to the number of units for which the $\\ell$-th effect can be computed.\n\nMapping with estimates from sdid_event. Estimators presented in this note can be computed using the sdid_event Stata package. The baseline output table of sdid_event reports the estimates of the ATT from sdid and $\\hat{\\tau}_{\\ell}^{s d i d}$ for $\\ell \\in\\left\\{1, \\ldots, T_{t r}\\right\\}$. If the command is run with the disag option, the output also includes a table with the cohort-specific treatment effects. Namely, the program returns the estimates of $\\hat{\\tau}_{a}^{s d i d}$ and $\\hat{\\tau}_{a, \\ell}^{s d i d}$, whereas the former can also be retrieved from the e (tau) matrix in sdid.\n\nProof of Equation 7. Let $T_{\\text {post }}^{a}$ denote the total number of post-treatment periods across all units in cohort $a$.\n\n$$\n\\begin{aligned}\n\\widehat{A T T} & =\\sum_{a \\in A} \\frac{T_{\\text {post }}^{a}}{T_{\\text {post }}^{a}} \\hat{\\tau}_{a}^{s d i d} \\\\\n& =\\frac{1}{T_{\\text {post }}} \\sum_{a \\in A} N_{t r}^{a} T_{t r}^{a} \\hat{\\tau}_{a}^{s d i d} \\\\\n& =\\frac{1}{T_{\\text {post }}} \\sum_{a \\in A} \\sum_{\\ell=1}^{T_{t r}^{a}} N_{t r}^{a} \\hat{\\tau}_{a, \\ell}^{s d i d} \\\\\n& =\\frac{1}{T_{\\text {post }}} \\sum_{\\ell=1}^{T_{t r}} \\sum_{a \\in A_{\\ell}} N_{t r}^{a} \\hat{\\tau}_{a, \\ell}^{s d i d} \\\\\n& =\\frac{1}{T_{\\text {post }}} \\sum_{\\ell=1}^{T_{t r}} N_{t r}^{\\ell} \\hat{\\tau}_{\\ell}^{s d i d}\n\\end{aligned}\n$$\n\nwhere the first equality comes from the definition of $\\widehat{A T T}$ in Clarke et al. (2023), the second equality from the definition of $T_{\\text {post }}^{a}$, the third equality from Equation 4, the fourth equality from the fact that the sets $\\left\\{(a, \\ell): a \\in A, 1 \\leq \\ell \\leq T_{t r}^{a}\\right\\}$ and $\\left\\{(a, \\ell): 1 \\leq \\ell \\leq T_{t r}, a \\in A_{\\ell}\\right\\}$ are equal and the fifth equality from the definition of $\\hat{\\tau}_{\\ell}^{s d i d}$.", "tables": {}, "images": {}}, {"section_id": 1, "text": "# References \n\nDmitry Arkhangelsky, Susan Athey, David Hirshberg, Guido Imbens, and Stefan Wager. Synthetic difference-in-differences. American Economic Review, 2021.\n\nKirill Borusyak, Xavier Jaravel, and Jann Spiess. Revisiting event-study designs: robust and efficient estimation. Review of Economic Studies, 2024.\n\nDamian Clarke, Daniel Pailanir, Susan Athey, and Guido Imbens. Synthetic difference in differences estimation. arXiv preprint, 2023.\n\nCl\u00e9ment de Chaisemartin and Xavier D'Haultfoeuille. Difference-in-differences for simple and complex natural experiments. Working textbook under contract with Princeton University Press, 2023.\n\nJohn Gardner. Two-stage differences in differences. arXiv preprint, 2022.\nLicheng Liu, Ye Wang, and Yiqing Xu. A practical guide to counterfactual estimators for causal inference with time-series cross-sectional data. American Journal of Political Science, 2024.", "tables": {}, "images": {}}], "id": "2407.09565v2", "authors": ["Diego Ciccia"], "categories": ["econ.EM"], "abstract": "I propose an event study extension of Synthetic Difference-in-Differences\n(SDID) estimators. I show that, in simple and staggered adoption designs,\nestimators from Arkhangelsky et al. (2021) can be disaggregated into dynamic\ntreatment effect estimators, comparing the lagged outcome differentials of\ntreated and synthetic controls to their pre-treatment average. Estimators\npresented in this note can be computed using the sdid_event Stata package.", "updated": "2024-11-01T16:23:12Z", "published": "2024-07-05T16:38:07Z"}