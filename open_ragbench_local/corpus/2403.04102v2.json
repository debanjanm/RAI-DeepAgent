{"title": "Integral Varadhan formula for non-linear heat flow", "sections": [{"section_id": 0, "text": "#### Abstract\n\nWe prove the integral Varadhan short-time formula for non-linear heat flow on measured Finsler manifolds. To the best of the authors' knowledge, this is the first result establishing a Varadhan-type formula for non-linear semigroups. We do not assume the reversibility of the metric, thus the distance function can be asymmetric. In this generality, we reveal that the probabilistic interpretation is well-suited for our formula; the probability that a particle starting from a set $A$ can be found in another set $B$ describes the distance from $A$ to $B$. One side of the estimates (the upper bound of the probability) is also established in the nonsmooth setting of infinitesimally strictly convex metric measure spaces.", "tables": {}, "images": {}}, {"section_id": 1, "text": "## 1. INTRODUCTION\n\nAim. The main aim of this article is to draw more attention to (geometric) analysis of non-linear heat flow. The linear theory had been developed intensively and extensively in connection with two powerful theories: Dirichlet forms related to probability theory and the $\\Gamma$-calculus \u00e0 la Bakry-\u00c9mery related to differential geometry as well as geometric analysis. A non-linear analogue to the $\\Gamma$-calculus has been investigated on Finsler manifolds (of Ricci curvature bounded below in an appropriate way) by the first author and Sturm [28, 29, 30, 31, 33]. Then it is natural to expect a more general theory of non-linear heat semigroups as a non-linear counterpart to the theory of Dirichlet forms, however, there is surprisingly no result in such a direction. In this article, to motivate further studies of non-linear heat semigroups, we establish the integral Varadhan short-time formula for non-linear heat flow on Finsler manifolds.\n\nBackground. On a complete Riemannian manifold $(\\mathrm{M}, g)$ with the Riemannian distance d, let $p_{t}(x, y)$ be the heat kernel density, i.e., the minimal fundamental solution to the heat equation $\\partial_{t} u=\\frac{1}{2} \\Delta u$. From the probabilistic viewpoint, $p_{t}(x, y)$ is the density function of the transition probability of the Brownian motion in M. The Varadhan short-time formula [36] states that the short-time behaviour of $p_{t}(x, y)$ is governed by $\\mathrm{d}(x, y)$ in the following way:\n\n$$\n\\lim _{t \\downarrow 0} t \\log p_{t}(x, y)=-\\frac{1}{2} \\mathrm{~d}(x, y)^{2}\n$$\n\nThe formula (1.1), linking geometry, analysis, and probability, has been studied in various settings including complete connected Riemannian manifolds [36], Lipschitz manifolds [26],\n\n[^0]\n[^0]:    Date: April 16, 2025.\n    The first author is supported in part by JSPS Grant-in-Aid for Scientific Research (KAKENHI) 19H01786, 22H04942. The second author gratefully acknowledges funding by the Alexander von Humboldt Stiftung as well as the Theoretical Sciences Visiting Program (TSVP) at the Okinawa Institute of Science and Technology Graduate University in Japan.\n\ndegenerate diffusions on Euclidean spaces [10], sub-Riemannian manifolds [7, 8, 9, 23, 24], and metric measure spaces satisfying the quasi Riemannian curvature-dimension condition [13].\n\nFor spaces not admitting the heat kernel density $p_{t}(x, y)$, the formula (1.1) has been generalised as\n\n$$\n\\lim _{t \\downarrow 0} t \\log \\mathrm{P}_{t}(A, B)=-\\frac{1}{2} \\overline{\\mathrm{~d}}_{m}(A, B)^{2}\n$$\n\nfor $A, B \\subset \\mathrm{M}$ with $0<\\mathrm{m}(A), \\mathrm{m}(B)<\\infty$, where m is the reference measure on M ,\n\n$$\n\\mathrm{P}_{t}(A, B):=\\int_{A} \\mathrm{~T}_{t} \\mathbf{1}_{B} \\mathrm{dm}\n$$\n\nwith the $L^{2}$-heat semigroup $\\left(\\mathrm{T}_{t}\\right)_{t \\geq 0}$, and $\\overline{\\mathrm{d}}_{m}(A, B)$ is a suitably defined distance-like function. In the case of linear heat semigroups, (1.2) has been established in a general setting of local Dirichlet spaces [6, 20, 21], where $\\overline{\\mathrm{d}}_{m}(A, B)$ is induced by a local Dirichlet form. If a local Dirichlet space admits a distance function in the domain of the Dirichlet form in a compatible way in the sense of the Rademacher-type property and the Sobolev-to-Lipschitz property, the set function $\\overline{\\mathrm{d}}_{m}(A, B)$ is indeed identified with the distance between $A$ and $B$; see [11] for details. We refer the readers to the following articles for particular spaces: the Wiener space and path/loop groups [1, 2, 15, 16, 21], the configuration space [12, 39] and the Wasserstein space [38].\n\nMain results. We shall generalise (1.2) to non-linear heat flow $\\left(\\mathrm{T}_{t}\\right)_{t \\geq 0}$ on a Finsler manifold $(\\mathrm{M}, F)$ equipped with a measure m . We do not assume the reversibility of $F$ (i.e., $F(-v) \\neq F(v)$ is allowed), thereby the distance function d can be asymmetric. In this case, $\\overline{\\mathrm{d}}_{m}(A, B)$ is defined as\n\n$$\n\\overline{\\mathrm{d}}_{m}(A, B):=\\sup _{f \\in \\mathbb{L}}\\left\\{\\underset{x \\in A}{\\operatorname{ess} \\inf } f(x)-\\underset{y \\in B}{\\operatorname{ess} \\sup } f(y)\\right\\}\n$$\n\nfor measurable sets $A, B \\subset \\mathrm{M}$ with $0<\\mathrm{m}(A), \\mathrm{m}(B)<\\infty$, where\n\n$$\n\\mathbb{L}:=\\left\\{f \\in H_{\\mathrm{loc}}^{1}(\\mathrm{M}) \\cap L^{\\infty}(\\mathrm{M}): F^{*}(-\\mathbf{d} f) \\leq 1 \\text { a.e. }\\right\\}\n$$\n\nWe remark that $\\overline{\\mathrm{d}}_{m}(A, B)<\\infty$. The condition $F^{*}(-\\mathbf{d} f) \\leq 1$ roughly means that $-f$ is 1-Lipschitz, and one can regard that $\\overline{\\mathrm{d}}_{m}(A, B)$ represents the distance from $A$ to $B$. We refer to Subsection 2.1 for precise definitions and notations in Finsler geometry. We also set\n\n$$\n\\mathrm{d}(A, B):=\\inf _{x \\in A, y \\in B} \\mathrm{~d}(x, y)\n$$\n\nDue to Lemma 3.4 proven later, for open sets $A, B \\subset \\mathrm{M}$, we have\n\n$$\n\\overline{\\mathrm{d}}_{m}(A, B)=\\mathrm{d}(A, B)\n$$\n\nTheorem 1.1. Let $(\\mathrm{M}, F)$ be a complete $C^{\\infty}$-Finsler manifold equipped with a $C^{\\infty}$-measure m on M with $\\mathrm{m}(\\mathrm{M})<\\infty$. Assume that the uniform convexity and smoothness constants are finite. Then, for any measurable sets $A, B \\subset \\mathrm{M}$ with $0<\\mathrm{m}(A), \\mathrm{m}(B)<\\infty$, we have\n\n$$\n\\lim _{t \\downarrow 0} t \\log \\mathrm{P}_{t}(A, B)=-\\frac{1}{2} \\overline{\\mathrm{~d}}_{m}(A, B)^{2}\n$$\n\nIn particular, for any open sets $A, B \\subset \\mathrm{M}$, we have\n\n$$\n\\lim _{t \\downarrow 0} t \\log \\mathrm{P}_{t}(A, B)=-\\frac{1}{2} \\mathrm{~d}(A, B)^{2}\n$$\n\nTo the best of our knowledge, Theorem 1.1 is the first result establishing the integral Varadhan formula for non-linear semigroups. It is unclear whether the pointwise Varadhan estimate (1.1) can be properly formulated in our setting, since there is no concept of heat kernel density $p_{t}(x, y)$ for non-linear heat semigroups. The assumption $\\mathrm{m}(\\mathrm{M})<\\infty$ is used only for the lower estimate of (1.5). Though this assumption does not seem essential, we were not able to drop it due to the technicality of the linearised heat semigroup; see Subsection 5.6 for more details. The finiteness of the uniform convexity and smoothness constants is imposed also for a technical reason of constructing a linearised heat semigroup (see Lemma 5.7), and is satisfied by, e.g., compact Finsler manifolds and Randers spaces $(\\mathrm{M}, F), F(v)=\\sqrt{g(v, v)}+\\beta(v)$, such that $g$ is a Riemannian metric and $\\beta$ is a one-form on M with $|\\beta|_{g} \\leq c<1$ for some $c<1$.\n\nThe asymmetry of the distance function d reveals the probabilistic nature of our Varadhan formula, which is not apparent in the symmetric setting. From the analytic (PDE) point of view, the semigroup $\\mathrm{T}_{t} \\mathbf{1}_{B}$ in $\\mathrm{P}_{t}(A, B)=\\int_{A} \\mathrm{~T}_{t} \\mathbf{1}_{B} \\mathrm{dm}$ could be regarded as describing the heat propagation from $B$, thereby the appearance of the distance $\\mathrm{d}(A, B)$ from $A$ to $B$ may be counter-intuitive. From the probabilistic viewpoint (which is a dual perspective to the PDE one), however, $\\mathrm{d}(A, B)$ is natural since $\\mathrm{T}_{t} \\mathbf{1}_{B}(x)$ represents the probability that a Brownian motion starting from $x$ lives in $B$ at time $t$ (in the Riemannian setting, to be precise; the existence of the Brownian motion is unknown in the Finsler case).\n\nThe above observation should be compared with the fact that heat flow is regarded as the gradient flow of the relative entropy in the $L^{2}$-Wasserstein space with respect to the reverse Finsler structure $\\bar{F}(v)=F(-v)$ (see Remark 2.2). Since $\\mathrm{d}(A, B)$ coincides with the distance from $B$ to $A$ with respect to $\\bar{F}$, the analytic point of view seems consistent with $\\bar{F}$.\n\nThe upper estimate in Theorem 1.1 is more flexible than the lower estimate, and can be generalised to the nonsmooth setting as follows, thanks to differential calculus developed in $[5,18]$. We remark that reversible Finsler manifolds (satisfying $F(-v)=F(v)$ ) also fall into this framework.\n\nTheorem 1.2. Let $(\\mathrm{X}, \\mathrm{d}, \\mathrm{m})$ be an infinitesimally strictly convex metric measure space. Then, for any measurable sets $A, B \\subset \\mathrm{X}$ with $0<\\mathrm{m}(A), \\mathrm{m}(B)<\\infty$, we have\n\n$$\n\\limsup _{t \\downarrow 0} t \\log \\mathrm{P}_{t}(A, B) \\leq-\\frac{1}{2} \\mathrm{~d}(A, B)^{2}\n$$\n\nNote that sets $A, B \\subset \\mathrm{X}$ in Theorem 1.2 need not be open. If, in addition to the infinitesimal strict convexity, the Sobolev space $W^{1,2}(\\mathrm{X}, \\mathrm{d}, \\mathrm{m})$ (that is not necessarily a Hilbert space in this generality) is reflexive, then, for $A, B \\subset \\mathrm{X}$ with $0<\\mathrm{m}(A), \\mathrm{m}(B)<\\infty$,\n\n$$\n\\limsup _{t \\downarrow 0} t \\log \\mathrm{P}_{t}(A, B) \\leq-\\frac{1}{2} \\mathrm{~d}_{\\mathrm{m}}(A, B)^{2}\n$$\n\nwhere $\\mathrm{d}_{\\mathrm{m}}(A, B)$ is defined in Subsection 4.2. If, furthermore, $(\\mathrm{X}, \\mathrm{d}, \\mathrm{m})$ possesses the local Sobolev-to-Lipschitz property (see Subsection 4.2), then we have $\\mathrm{d}_{\\mathrm{m}}(A, B)=\\mathrm{d}(A, B)$ for open sets $A, B \\subset \\mathrm{X}$.\n\nOn the one hand, both the infinitesimal strict convexity and the reflexivity of the Sobolev space hold, e.g., for RCD spaces. On the other hand, Theorem 1.2 (more precisely, Proposition 4.1) can be applied to some spaces without infinitesimal strict convexity by approximation; see Remark 4.4, where we discuss the space $\\left(\\mathbb{R}^{n},\\|\\cdot\\|_{p}, \\mathfrak{m}\\right)$ with the $\\ell_{p}$ norm $\\|\\cdot\\|_{p}$ for $1 \\leq p \\leq \\infty$ and the Lebesgue measure $\\mathfrak{m}$.\n\nCompared to the existing literature, there are two difficulties that need to be addressed: one arises from the fact that the energy form is not bilinear, due to the lack of the Leibniz rule for the gradient operator; another difficulty arises due to the lack of symmetry: $\\int_{\\mathrm{M}} u_{1} \\Delta u_{2} \\mathrm{~d} \\mathfrak{m} \\neq \\int_{\\mathrm{M}} u_{2} \\Delta u_{1} \\mathrm{~d} \\mathfrak{m}$, which is relevant to the proof of the lower bound of (1.5). To overcome especially the latter point, we employ a linearisation technique for the heat semigroup in the Finsler case. This approach is, however, not applicable to the non-smooth setting in Theorem 1.2 as we do not know if the linearised semigroup exists in metric measure spaces.\n\nThe structure of the paper. After reviewing the basics of Finsler geometry in Section 2, we study the behaviour of the function $\\overline{\\mathrm{d}}_{m}(A, B)$ in Section 3. Then, we prove the upper bound estimate in Theorem 1.1 as well as Theorem 1.2 in Section 4, and Section 5 is devoted to the proof of the lower bound estimate in Theorem 1.1.", "tables": {}, "images": {}}, {"section_id": 2, "text": "# ACKNOWLEDGEMENT \n\nWe are grateful to Karl-Theodor Sturm for his suggestion regarding Theorem 1.2, which helped us improve the assumption. We also thank Davide Barilari for pointing out a couple of references concerning sub-Riemannian manifolds. Lastly, we thank the anonymous referees for carefully reading the manuscript and providing us with constructive suggestions.", "tables": {}, "images": {}}, {"section_id": 3, "text": "## 2. Preliminaries\n\nWe first review the basics of Finsler geometry, and then introduce truncation functions as in [21] playing an essential role in the lower estimate in Section 5.\n2.1. Finsler manifolds. We refer the readers to [30] for a concise description of the following contents, and also to $[17,32,33]$ for the behaviour of heat flow on Finsler manifolds.\n\nLet M be a connected $C^{\\infty}$-manifold without boundary of dimension $n \\geq 2$. Given local coordinates $\\left(x^{i}\\right)_{i=1}^{n}$ on an open set $U \\subset \\mathrm{M}$, we will denote by $\\left(x^{i}, v^{j}\\right)_{i, j=1}^{n}$ the fibre-wise linear coordinates of the tangent bundle $T U$ given by\n\n$$\nv=\\left.\\sum_{j=1}^{n} v^{i} \\frac{\\partial}{\\partial x^{j}}\\right|_{x} \\in T_{x} \\mathrm{M}, \\quad x \\in U\n$$\n\nWe say that a nonnegative function $F: T \\mathrm{M} \\rightarrow[0, \\infty)$ is a $C^{\\infty}$-Finsler structure on M if the following three conditions hold:\n(1) (Regularity) $F$ is $C^{\\infty}$ on $T \\mathrm{M} \\backslash\\{0\\}$;\n(2) (Positive 1-homogeneity) $F(c v)=c F(v)$ for every $v \\in T \\mathrm{M}$ and $c \\geq 0$;\n(3) (Strong convexity) For every $v \\in T \\mathrm{M} \\backslash\\{0\\}$, the following $n \\times n$ matrix is positivedefinite:\n\n$$\n\\left(g_{i j}(v)\\right)_{i, j=1}^{n}:=\\left(\\frac{1}{2} \\frac{\\partial^{2}\\left[F^{2}\\right]}{\\partial v^{i} \\partial v^{j}}(v)\\right)_{i, j=1}^{n}\n$$\n\nWe call a pair $(\\mathrm{M}, F)$ a $C^{\\infty}$-Finsler manifold. We stress that the 1-homogeneity is imposed only in the positive direction, thereby $F(-v) \\neq F(v)$ is allowed. If $F(v)=F(-v)$ for all $v \\in T \\mathrm{M}$, then we say that $(\\mathrm{M}, F)$ is reversible. The matrix $\\left(g_{i j}(v)\\right)$ in (2.1) provides an inner product $g_{v}$ of $T_{x} \\mathrm{M}$ by\n\n$$\ng_{v}\\left(\\sum_{i=1}^{n} a_{i} \\frac{\\partial}{\\partial x^{i}}, \\sum_{j=1}^{n} b_{j} \\frac{\\partial}{\\partial x^{j}}\\right):=\\sum_{i, j=1}^{n} a_{i} b_{j} g_{i j}(v)\n$$\n\nWe will also make use of their counterparts in the dual space $T_{x}^{*} \\mathrm{M}$ :\n\n$$\n\\begin{aligned}\n& F^{*}(\\alpha):=\\sup _{v \\in T_{x} \\mathrm{M}, F(v)=1} \\alpha(v) \\quad \\text { for } \\alpha \\in T_{x}^{*} \\mathrm{M} \\\\\n& g_{i j}^{*}(\\alpha):=\\frac{1}{2} \\frac{\\partial^{2}\\left[\\left(F^{*}\\right)^{2}\\right]}{\\partial \\alpha_{i} \\partial \\alpha_{j}}(\\alpha) \\quad \\text { for } \\alpha=\\sum_{i=1}^{n} \\alpha_{i} \\mathrm{~d} x^{i} \\in T_{x}^{*} \\mathrm{M} \\backslash\\{0\\} \\\\\n& g_{\\alpha}^{*}\\left(\\sum_{i=1}^{n} a_{i} \\mathrm{~d} x^{i}, \\sum_{j=1}^{n} b_{j} \\mathrm{~d} x^{j}\\right):=\\sum_{i, j=1}^{n} a_{i} b_{j} g_{i j}^{*}(\\alpha) \\quad \\text { on } T_{x}^{*} \\mathrm{M}\n\\end{aligned}\n$$\n\nWe remark that, though $\\alpha(v) \\leq F^{*}(\\alpha) F(v)$ holds by definition, $\\alpha(v) \\geq-F^{*}(\\alpha) F(v)$ does not hold in general due to the irreversibility of $F$ (for example, one cannot replace the LHS of (4.4) with its absolute value).\n\nFor $x, y \\in \\mathrm{M}$, we define\n\n$$\n\\mathrm{d}(x, y):=\\inf _{\\eta} \\int_{0}^{1} F(\\dot{\\eta}(t)) \\mathrm{d} t\n$$\n\nwhere the infimum is taken over all piecewise $C^{1}$-curves $\\eta:[0,1] \\rightarrow \\mathrm{M}$ with $\\eta(0)=x$ and $\\eta(1)=y$. Then d provides an asymmetric distance function on M , namely the triangle inequality\n\n$$\n\\mathrm{d}(x, z) \\leq \\mathrm{d}(x, y)+\\mathrm{d}(y, z) \\quad \\text { for all } x, y, z \\in \\mathrm{M}\n$$\n\nholds but $\\mathrm{d}(y, x)$ may be different from $\\mathrm{d}(x, y)$. Note that d is symmetric if and only if $F$ is reversible. We define the reversibility constant of $(\\mathrm{M}, F)$ as\n\n$$\n\\Lambda_{F}:=\\sup _{v \\in T \\mathrm{M} \\backslash\\{0\\}} \\frac{F(v)}{F(-v)}=\\sup _{x, y \\in \\mathrm{M}, x \\neq y} \\frac{\\mathrm{~d}(x, y)}{\\mathrm{d}(y, x)}\n$$\n\nObserve that $\\Lambda_{F} \\in[1, \\infty]$ in general, and $\\Lambda_{F}=1$ holds only in the reversible case.\nWe say that $(\\mathrm{M}, F)$ is forward complete if any closed, forward bounded set $A \\subset \\mathrm{M}$ (i.e., $\\sup _{y \\in A} \\mathrm{~d}(x, y)<\\infty$ for some or, equivalently, any $x \\in \\mathrm{M}$ ) is compact. The backward completeness is defined as the forward completeness of $(\\mathrm{M}, \\bar{F})$, where $\\bar{F}$ is the reverse Finsler structure given by $\\bar{F}(v):=F(-v)$. If $\\Lambda_{F}<\\infty$, then the forward and backward completenesses are mutually equivalent and we may simply call it the completeness.\n\nUniform convexity and smoothness. We define the uniform convexity and smoothness constants of $(\\mathrm{M}, F)$ as\n\n$$\n\\mathrm{C}_{F}:=\\sup _{x \\in \\mathrm{M}} \\sup _{v, w \\in T_{x} \\mathrm{M} \\backslash\\{0\\}} \\frac{F(w)^{2}}{g_{v}(w, w)}, \\quad \\mathrm{S}_{F}:=\\sup _{x \\in \\mathrm{M}} \\sup _{v, w \\in T_{x} \\mathrm{M} \\backslash\\{0\\}} \\frac{g_{v}(w, w)}{F(w)^{2}}\n$$\n\nrespectively. Since $g_{v}$ comes from the Hessian of $F^{2}, \\mathrm{C}_{F}$ (resp. $\\mathrm{S}_{F}$ ) actually measures the convexity (resp. concavity) of $F^{2}$ in tangent spaces. We have $\\mathrm{C}_{F}, \\mathrm{~S}_{F} \\in[1, \\infty]$ in general, and $\\mathrm{C}_{F}=1$ or $\\mathrm{S}_{F}=1$ holds only in Riemannian manifolds (see [30, Proposition 1.6]). On\n\na compact Finsler manifold, $\\mathrm{C}_{F}$ and $\\mathrm{S}_{F}$ are finite thanks to the smoothness and the strong convexity of $F$. We also remark that their dual expressions are given by\n\n$$\n\\mathrm{C}_{F}=\\sup _{x \\in \\mathrm{M}} \\sup _{\\alpha, \\beta \\in T_{x}^{*} \\mathrm{M} \\backslash\\{0\\}} \\frac{g_{\\alpha}^{*}(\\beta, \\beta)}{F^{*}(\\beta)^{2}}, \\quad \\mathrm{~S}_{F}=\\sup _{x \\in \\mathrm{M}} \\sup _{\\alpha, \\beta \\in T_{x}^{*} \\mathrm{M} \\backslash\\{0\\}} \\frac{F^{*}(\\beta)^{2}}{g_{\\alpha}^{*}(\\beta, \\beta)}\n$$\n\nWe refer to [27], [30, \u00a78.3.2] for more discussions on $\\mathrm{C}_{F}$ and $\\mathrm{S}_{F}$. The reversibility constant $\\Lambda_{F}$ in (2.3) can be bounded by $\\mathrm{C}_{F}$ and $\\mathrm{S}_{F}$ as (see [30, Lemma 8.18])\n\n$$\n\\Lambda_{F} \\leq \\min \\left\\{\\sqrt{\\mathrm{C}_{F}}, \\sqrt{\\mathrm{~S}_{F}}\\right\\}\n$$\n\nGradient vectors. For a differentiable function $f: \\mathrm{M} \\rightarrow \\mathbb{R}$, its gradient vector at $x \\in \\mathrm{M}$ is defined to be the Legendre transform of the derivative of $f$ :\n\n$$\n\\nabla f(x):=\\mathcal{L}^{*}(\\mathrm{~d} f(x)) \\in T_{x} \\mathrm{M}\n$$\n\nHere the Legendre transform $\\mathcal{L}^{*}: T_{x}^{*} \\mathrm{M} \\rightarrow T_{x} \\mathrm{M}$ maps $\\alpha \\in T_{x}^{*} \\mathrm{M}$ to the unique element $v \\in T_{x} \\mathrm{M}$ such that $F(v)=F^{*}(\\alpha)$ and $\\alpha(v)=F^{*}(\\alpha)^{2}$. We remark that $\\left(g_{i j}\\left(\\mathcal{L}^{*}(\\alpha)\\right)\\right)$ is the inverse matrix of $\\left(g_{i j}^{*}(\\alpha)\\right)$, provided $\\alpha \\neq 0$. In local coordinates, we can write down\n\n$$\n\\nabla f(x)=\\left.\\sum_{i, j=1}^{n} g_{i j}^{*}(\\mathrm{~d} f(x)) \\frac{\\partial f}{\\partial x^{j}}(x) \\frac{\\partial}{\\partial x^{i}}\\right|_{x}\n$$\n\n(when $\\mathbf{d} f(x) \\neq 0$; while $\\nabla f(x)=0$ if $\\mathbf{d} f(x)=0$ ). We say that $f$ is 1-Lipschitz if\n\n$$\nf(y)-f(x) \\leq \\mathrm{d}(x, y) \\quad \\text { for all } x, y \\in \\mathrm{M}\n$$\n\nwhich is equivalent to $F(\\nabla f) \\leq 1$ when $f$ is differentiable. For example, given $x_{0} \\in \\mathrm{M}$, the functions $x \\mapsto \\mathrm{~d}\\left(x_{0}, x\\right)$ and $x \\mapsto-\\mathrm{d}\\left(x, x_{0}\\right)$ are 1-Lipschitz by the triangle inequality.\n\nRemark 2.1 (Non-linearity of $\\nabla$ ). As the differential d stems only from the differentiable structure of M , it is a linear operator and enjoys the chain and Leibniz rules. However, the Legendre transform $\\mathcal{L}^{*}$ is non-linear $\\left(\\mathcal{L}^{*}(\\alpha+\\beta) \\neq \\mathcal{L}^{*}(\\alpha)+\\mathcal{L}^{*}(\\beta)\\right.$ ) and irreversible $\\left(\\mathcal{L}^{*}(-\\alpha) \\neq \\mathcal{L}^{*}(\\alpha)\\right)$. Therefore, the gradient operator $\\nabla$ does not satisfy the Leibniz rule, and the chain rule holds only for non-decreasing functions:\n\n$$\n\\nabla(\\varphi \\circ f)=\\mathcal{L}^{*}\\left(\\varphi^{\\prime} \\circ f \\cdot \\mathbf{d} f\\right)=\\varphi^{\\prime} \\circ f \\cdot \\nabla f \\quad \\text { if } \\varphi^{\\prime} \\geq 0\n$$\n\nwhile we have $\\nabla(\\varphi \\circ f)=-\\varphi^{\\prime} \\circ f \\cdot \\nabla(-f)$ if $\\varphi^{\\prime} \\leq 0$. In the reversible case, the chain rule holds regardless of the sign of $\\varphi^{\\prime}$.\n\nHeat semigroup. Now, we fix a positive $C^{\\infty}$-measure m on M (in the sense that, in each local chart, $\\mathrm{m}=\\rho \\mathrm{d} x^{1} \\cdots \\mathrm{~d} x^{n}$ for a positive $C^{\\infty}$-function $\\rho$ ). Then the divergence of a differentiable vector field $V$ on M with respect to m is defined in local coordinates as\n\n$$\n\\operatorname{div}_{\\mathrm{m}} V:=\\sum_{i=1}^{n}\\left(\\frac{\\partial V^{i}}{\\partial x^{i}}+V^{i} \\frac{\\partial \\psi}{\\partial x^{i}}\\right)\n$$\n\nwhere $V=\\sum_{i=1}^{n} V^{i}\\left(\\partial / \\partial x^{i}\\right)$ and we wrote $\\mathrm{m}=e^{\\psi} \\mathrm{d} x^{1} \\cdots \\mathrm{~d} x^{n}$ in the coordinates. It can be generalised to measurable vector fields $V$ in the distributional sense (against $C^{\\infty}$-functions of compact support) as\n\n$$\n\\int_{\\mathrm{M}} \\varphi \\operatorname{div}_{\\mathrm{m}} V \\mathrm{dm}=-\\int_{\\mathrm{M}} \\mathbf{d} \\varphi(V) \\mathrm{dm} \\quad \\text { for all } \\varphi \\in C_{c}^{\\infty}(\\mathrm{M})\n$$\n\nThen we define the distributional Laplacian $\\Delta:=\\operatorname{div}_{\\mathrm{m}} \\circ \\nabla$, i.e.,\n\n$$\n\\int_{\\mathrm{M}} \\varphi \\Delta u \\mathrm{dm}:=-\\int_{\\mathrm{M}} \\mathbf{d} \\varphi(\\nabla u) \\mathrm{dm} \\quad \\text { for all } \\varphi \\in C_{c}^{\\infty}(\\mathrm{M})\n$$\n\nThis Laplacian is again non-linear by the non-linearity of $\\nabla$. Moreover,\n\n$$\n\\int_{\\mathrm{M}} u_{1} \\Delta u_{2} \\mathrm{dm} \\neq \\int_{\\mathrm{M}} u_{2} \\Delta u_{1} \\mathrm{dm}\n$$\n\nin general (in other words, $\\mathbf{d} u_{1}\\left(\\nabla u_{2}\\right) \\neq \\mathbf{d} u_{2}\\left(\\nabla u_{1}\\right)$ ).\nDefine the energy functional $\\mathcal{E}$ on $H_{\\text {loc }}^{1}(\\mathrm{M})$ as\n\n$$\n\\mathcal{E}(u):=\\frac{1}{2} \\int_{\\mathrm{M}} F(\\nabla u)^{2} \\mathrm{dm}=\\frac{1}{2} \\int_{\\mathrm{M}} F^{*}(\\mathbf{d} u)^{2} \\mathrm{dm}\n$$\n\n( $H_{\\text {loc }}^{1}(\\mathrm{M})$ is defined solely by the differentiable structure of M via local charts). The Sobolev space $H^{1}(\\mathrm{M})$ is defined as the set of functions $u \\in L^{2}(\\mathrm{M}) \\cap H_{\\text {loc }}^{1}(\\mathrm{M})$ such that $\\mathcal{E}(u)+$ $\\mathcal{E}(-u)<\\infty$. Denote by $H_{0}^{1}(\\mathrm{M})$ the closure of $C_{c}^{\\infty}(\\mathrm{M})$ with respect to the norm\n\n$$\n\\|u\\|_{H^{1}}:=\\sqrt{\\|u\\|_{L^{2}}^{2}+\\mathcal{E}(u)+\\mathcal{E}(-u)}\n$$\n\nNote that $\\left(H^{1}(\\mathrm{M}),\\|\\cdot\\|_{H^{1}}\\right)$ is not a Hilbert space but a reflexive Banach space. If $\\Lambda_{F}<\\infty$ and $(\\mathrm{M}, F)$ is complete, then we have $H_{0}^{1}(\\mathrm{M})=H^{1}(\\mathrm{M})$ (see [30, Lemma 11.4]).\n\nThe $L^{2}$-heat semigroup $u_{t}=\\mathrm{T}_{t} f$ is defined as the solution to the Cauchy problem:\n\n$$\n\\partial_{t} u_{t}=\\frac{1}{2} \\Delta u_{t}, \\quad u_{0}=f\n$$\n\nOne can construct $\\left(u_{t}\\right)_{t \\geq 0}$ as gradient flow of the energy $\\mathcal{E}$ in $L^{2}(\\mathrm{M})$, provided $\\Lambda_{F}<\\infty$. Precisely, we first construct $\\mathrm{T}_{t} f$ for $f \\in H_{0}^{1}(\\mathrm{M})$ and then extend it to a contraction semigroup acting on $L^{2}(\\mathrm{M})$ (see, e.g., [4], [30, \u00a713.2]). Thanks to the regularizing effect as in [4, Theorem 4.0.4], [5, (4.26)], we have $\\mathrm{T}_{t} L^{2}(\\mathrm{M}) \\subset H_{0}^{1}(\\mathrm{M})$ for $t>0$. We stress that the heat semigroup $\\left(\\mathrm{T}_{t}\\right)_{t \\geq 0}$ is non-linear. Indeed, $\\mathrm{T}_{t}\\left(f_{1}+f_{2}\\right)=\\mathrm{T}_{t} f_{1}+\\mathrm{T}_{t} f_{2}$ does not hold, and $\\mathrm{T}_{t}(c f)=c \\mathrm{~T}_{t} f$ holds only when $c \\geq 0$ due to the irreversibility. Moreover, $\\mathrm{T}_{t} f$ is not smooth at points where $\\mathbf{d}\\left[\\mathrm{T}_{t} f\\right]$ vanishes.\n\nRemark 2.2. Besides the above interpretation of heat flow as gradient flow of the energy, one can also regard heat flow as gradient flow of the relative entropy in the $L^{2}$-Wasserstein space. Precisely, in the Finsler case, we need to consider the Wasserstein space for the reverse Finsler structure $\\bar{F}(v)=F(-v)$ (we refer to [32,34] for details). This fact could be compared with the appearance of $\\mathrm{d}(A, B)$, rather than $\\mathrm{d}(B, A)$, in our results.\n\nLinearised heat semigroups. In the last step of the lower estimate in Section 5, we will employ a linearisation of the heat semigroup to overcome a difficulty due to the asymmetry (2.6). See (5.10) in Lemma 5.7 below for the precise equation, here we recall a related result from $[30, \\S 13.5]$.\n\nLet $\\left(u_{t}\\right)_{t \\geq 0}$ be a solution to the heat equation, and take a measurable one-parameter family $\\left(V_{t}\\right)_{t \\geq 0}$ of nowhere vanishing vector fields such that $V_{t}(x)=\\nabla u_{t}(x)$ for all $x$ with $\\mathbf{d} u_{t}(x) \\neq 0$. Given $f \\in H_{0}^{1}(\\mathrm{M})$, there exists a (weak) solution $\\left(f_{t}\\right)_{t \\geq 0} \\subset H_{0}^{1}(\\mathrm{M})$ to the linearised heat equation\n\n$$\n\\partial_{t} f_{t}=\\frac{1}{2} \\Delta^{\\nabla u_{t}} f_{t}, \\quad f_{0}=f\n$$\n\nwhere $\\Delta^{\\nabla u_{t}}:=\\operatorname{div}_{\\mathfrak{m}} \\circ \\nabla^{\\nabla u_{t}}$ is the linearised Laplacian defined with\n\n$$\n\\nabla^{\\nabla u_{t}} h:=\\sum_{i, j=1}^{n} g_{i j}^{*}\\left(\\left(\\mathcal{L}^{*}\\right)^{-1}\\left(V_{t}\\right)\\right) \\frac{\\partial h}{\\partial x^{j}} \\frac{\\partial}{\\partial x^{i}}\n$$\n\nNote that we suppressed the dependence on the choice of $V_{t}$ for simplicity. We also remark that $\\Delta^{\\nabla u_{t}} u_{t}=\\Delta u_{t}$. Linearised heat semigroups play an essential role in geometric analysis on Finsler manifolds, including gradient estimates [33] as well as functional and geometric inequalities $[29,31]$.\n2.2. Truncation functions. We shall introduce some useful functions as in [21, \u00a72.1]. Let $\\zeta:[0, \\infty) \\rightarrow[0, \\infty)$ be a bounded concave $C^{3}$-function satisfying:\n(1) $\\zeta(t)=t$ for $t \\in[0,1]$ and $0<\\zeta^{\\prime}(t) \\leq 1$ for all $t \\geq 0$;\n(2) There is a positive constant $C$ such that $0 \\leq-\\zeta^{\\prime \\prime}(t) \\leq C \\zeta^{\\prime}(t)$ for all $t \\geq 0$.\n\nFor instance, any $C^{\\infty}$-function $\\zeta$ such that $\\zeta(0)=0$ and $\\zeta^{\\prime}$ is non-increasing with\n\n$$\n\\zeta^{\\prime}(t)= \\begin{cases}1 & 0 \\leq t \\leq 1 \\\\ e^{-t} & t \\geq 2\\end{cases}\n$$\n\nsatisfies the required properties. By these conditions, the monotone limit $\\lim _{t \\rightarrow \\infty} \\zeta(t)=L$ exists. Define $\\phi^{K}(t):=K \\zeta(t / K)$ for $K>0$. For notational simplicity, we do not write $K$ explicitly when no confusion could occur. We also set\n\n$$\n\\Phi(t):=\\int_{0}^{t} \\phi^{\\prime}(s)^{2} \\mathrm{~d} s, \\quad \\Psi(t):=t \\phi^{\\prime}(t)^{2}\n$$\n\nThen we immediately have the following estimates:\n\n$$\n\\begin{aligned}\n& 0<\\phi^{\\prime}(t) \\leq 1, \\quad 0 \\leq-\\phi^{\\prime \\prime}(t) \\leq \\frac{C}{K} \\phi^{\\prime}(t), \\quad \\Phi(t)=\\Psi(t)=t \\text { on }[0, K] \\\\\n& 0 \\leq \\Psi(t) \\leq \\Phi(t) \\leq \\int_{0}^{t} \\phi^{\\prime}(s) \\mathrm{d} s=\\phi(t) \\leq K L\n\\end{aligned}\n$$", "tables": {}, "images": {}}, {"section_id": 4, "text": "# 3. Maximal Functions \n\nIn this section, we assume $\\Lambda_{F}<\\infty$ and the completeness of $(\\mathrm{M}, F)$. To begin the proof of Theorem 1.1, fix $x_{0} \\in \\mathrm{M}$ and let $\\left(B_{r_{k}}\\left(x_{0}\\right)\\right)_{k \\in \\mathbb{N}}$ and $\\left(\\chi_{k}\\right)_{k \\in \\mathbb{N}}$ be sequences of open forward balls (i.e., $B_{r}(x):=\\{y \\in \\mathrm{M}: \\mathrm{d}(x, y)<r\\}$ ) and functions such that $\\lim _{k \\rightarrow \\infty} r_{k}=\\infty$, $0 \\leq \\chi_{k} \\leq 1, \\chi_{k} \\equiv 1$ on $B_{r_{k}}\\left(x_{0}\\right), \\chi_{k} \\equiv 0$ on $\\mathrm{M} \\backslash B_{r_{k+1}}\\left(x_{0}\\right)$, and $-\\chi_{k}$ is 1-Lipschitz. Note that, in particular, $\\chi_{k}$ is compactly supported. Throughout this article, for simplicity, we omit an arbitrarily fixed centre $x_{0}$ and write $B_{k}:=B_{r_{k}}\\left(x_{0}\\right)$.\n\nWe next introduce a distance-like function $\\mathrm{d}_{B}$ for a measurable set $B \\subset \\mathrm{M}$. We will always assume $0<\\mathrm{m}(A), \\mathrm{m}(B)<\\infty$. For $R \\geq 0$, define\n\n$$\n\\mathbb{L}_{B, R}:=\\{f \\in \\mathbb{L}: f=0 \\text { a.e. on } B \\text { and } 0 \\leq f \\leq R \\text { a.e. }\\}\n$$\n\nRecall the definitions (1.3), (1.4) of $\\mathrm{d}_{\\mathrm{m}}(A, B)$ and $\\mathbb{L}$ given in the introduction. We also set\n\n$$\n\\mathrm{d}_{\\mathrm{m}}(A, B):=\\underset{x \\in A}{\\operatorname{ess} \\inf } \\inf _{y \\in B} \\mathrm{~d}(x, y)\n$$\n\nProposition 3.1. For any measurable set $B \\subset \\mathrm{M}$, there exists a unique $[0, \\infty]$-valued measurable function $\\overline{\\mathrm{d}}_{B}$ such that, for every $R>0$, the function $\\overline{\\mathrm{d}}_{B} \\wedge R$ is the maximal element of $\\mathbb{L}_{B, R}$. Precisely, $\\overline{\\mathrm{d}}_{B} \\wedge R \\in \\mathbb{L}_{B, R}$ and $f \\leq \\overline{\\mathrm{~d}}_{B} \\wedge R$ holds a.e. for any $f \\in \\mathbb{L}_{B, R}$. Furthermore, for any measurable set $A \\subset \\mathrm{M}$, we have\n\n$$\n\\overline{\\mathrm{d}}_{m}(A, B)=\\underset{x \\in A}{\\operatorname{ess} \\inf } \\overline{\\mathrm{~d}}_{B}(x)\n$$\n\nProof. We can follow the lines of [6, Proposition 3.11] by replacing $E_{k}, \\mathbb{D}, \\mathbb{D}_{A, M}$ and $\\mathbb{D}_{0}$ there by $B_{k}, H_{0}^{1}(\\mathrm{M})=H^{1}(\\mathrm{M}), \\mathbb{L}_{B, R}$ and $\\mathbb{L}$.\n\nRemark 3.2. The requirement $F^{*}(-\\mathbf{d} f) \\leq 1$ in (1.4) means that $\\overline{\\mathrm{d}}_{B}$ is regarded as the distance \"to\" the set $B$ rather than the distance \"from\" $B$. We need to distinguish them in the present situation where the distance function $\\mathbf{d}$ is asymmetric.\n\nSet $\\mathrm{d}_{B}(x):=\\inf _{y \\in B} \\mathrm{~d}(x, y)$ for $x \\in \\mathrm{M}$. Note that $-\\mathrm{d}_{B}$ is 1-Lipschitz by the triangle inequality, and $F^{*}\\left(-\\mathbf{d d}_{B}\\right) \\leq 1$ a.e. We compare $\\mathrm{d}_{B}$ with $\\overline{\\mathrm{d}}_{B}$ obtained in Proposition 3.1.\n\nLemma 3.3. For any measurable set $B \\subset \\mathrm{M}$, we have $\\mathrm{d}_{B} \\leq \\overline{\\mathrm{~d}}_{B}$ a.e. In particular, for any measurable sets $A, B \\subset \\mathrm{M}$, we have\n\n$$\n\\mathrm{d}_{\\mathrm{m}}(A, B) \\leq \\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)\n$$\n\nProof. Since $\\mathrm{d}_{B} \\wedge R \\in \\mathbb{L}_{B, R}$ for every $R>0$, we have $\\mathrm{d}_{B} \\wedge R \\leq \\overline{\\mathrm{d}}_{B} \\wedge R$ by the maximality of $\\overline{\\mathrm{d}}_{B} \\wedge R$ in $\\mathbb{L}_{B, R}$. Letting $R \\rightarrow \\infty$, we obtain $\\mathrm{d}_{B} \\leq \\overline{\\mathrm{~d}}_{B}$ a.e. The latter assertion then follows from the definition of $\\mathrm{d}_{\\mathrm{m}}(A, B)$ and Proposition 3.1 as\n\n$$\n\\mathrm{d}_{\\mathrm{m}}(A, B)=\\underset{x \\in A}{\\operatorname{ess} \\inf } \\mathrm{~d}_{B}(x) \\leq \\underset{x \\in A}{\\operatorname{ess} \\inf } \\overline{\\mathrm{~d}}_{B}(x)=\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)\n$$\n\nFor open sets, these distance-like functions actually coincide with the usual distance $\\mathrm{d}(A, B)=\\inf _{x \\in A, y \\in B} \\mathrm{~d}(x, y)=\\inf _{x \\in A} \\mathrm{~d}_{B}(x)$.\n\nLemma 3.4. For any open set $B \\subset \\mathrm{M}$, we have $\\overline{\\mathrm{d}}_{B}=\\mathrm{d}_{B}$ a.e. In particular, for any open sets $A, B \\subset \\mathrm{M}$, we have\n\n$$\n\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)=\\mathrm{d}_{\\mathrm{m}}(A, B)=\\mathrm{d}(A, B)\n$$\n\nProof. Since $\\overline{\\mathrm{d}}_{B} \\wedge R \\in \\mathbb{L}_{B, R}$ and $B$ is open, from the proposition below, its continuous version $f$ satisfies $f \\equiv 0$ on $B$, and $-f$ is 1-Lipschitz. Hence, for all $y \\in B$ and a.e. $x \\in \\mathrm{M}$, we have\n\n$$\n\\overline{\\mathrm{d}}_{B}(x) \\wedge R=f(x)=f(x)-f(y) \\leq \\mathrm{d}(x, y)\n$$\n\nLetting $R \\rightarrow \\infty$ and taking the infimum in $y \\in B$, we conclude $\\overline{\\mathrm{d}}_{B} \\leq \\mathrm{d}_{B}$ a.e. Combining this with Lemma 3.3, we deduce the former assertion. Then $\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)=\\mathrm{d}_{\\mathrm{m}}(A, B)$ follows from the definition of $\\mathrm{d}_{\\mathrm{m}}(A, B)$ and Proposition 3.1, while $\\mathrm{d}_{\\mathrm{m}}(A, B)=\\mathrm{d}(A, B)$ is immediate since $A$ is open and $\\mathrm{d}_{B}$ is continuous.\n\nThough the next proposition (called the local Sobolev-to-Lipschitz property) should be a known fact, we give a short proof for completeness.\n\nProposition 3.5. For any $f \\in \\mathbb{L}$, there exists a bounded 1-Lipschitz function $-\\tilde{f}$ such that $\\tilde{f}=f$ a.e.\n\nProof. By multiplying with a smooth cut-off function in each local chart, one can reduce the existence of a (locally) Lipschitz function $\\tilde{f}$ such that $\\tilde{f}=f$ a.e. to the Euclidean case. The Euclidean case can be seen, e.g., in [14, Theorem 4.5]. Then $F^{*}(-\\mathbf{d} \\tilde{f})=F^{*}(-\\mathbf{d} f) \\leq 1$ a.e. yields that $-\\tilde{f}$ is 1-Lipschitz.", "tables": {}, "images": {}}, {"section_id": 5, "text": "# 4. UPPER ESTIMATE \n\nFor measurable sets $A, B \\subset \\mathrm{M}$, recall that we define\n\n$$\n\\mathrm{P}_{t}(A, B):=\\int_{A} \\mathrm{~T}_{t} \\mathbf{1}_{B} \\mathrm{dm}\n$$\n\nIn this section, we establish the upper estimate of (1.5). Our proof is essentially along the lines of [6, Theorem 4.1] or [21, Theorem 2.8], where the former is a generalisation of the latter to admit infinite total mass. The upper estimate is less demanding than the lower estimate. In fact, after establishing the upper estimate in the Finsler setting, we will see that it also holds true in metric measure spaces under mild assumptions in Subsection 4.2.\n4.1. Finsler case. Let $(\\mathrm{M}, F, \\mathrm{~m})$ be a complete measured Finsler manifold such that $\\Lambda_{F}<$ $\\infty$ equipped with a measure $m$.\n\nProposition 4.1. For any measurable sets $A, B \\subset \\mathrm{M}$ with $0<\\mathrm{m}(A), \\mathrm{m}(B)<\\infty$ and $t>0$, we have\n\n$$\n\\mathrm{P}_{t}(A, B) \\leq \\sqrt{\\mathrm{m}(A)} \\sqrt{\\mathrm{m}(B)} \\exp \\left(-\\frac{\\tilde{\\mathrm{d}}_{\\mathrm{m}}(A, B)^{2}}{2 t}\\right)\n$$\n\nIn particular,\n\n$$\n\\limsup _{t \\downarrow 0} t \\log \\mathrm{P}_{t}(A, B) \\leq-\\frac{\\tilde{\\mathrm{d}}_{\\mathrm{m}}(A, B)^{2}}{2}\n$$\n\nProof. Given $R>0$, take $f \\in \\mathbb{L}_{B, R}$ and set $f_{k}:=f \\chi_{k} \\in H_{0}^{1}(\\mathrm{M})$ for $k \\in \\mathbb{N}$, with $\\chi_{k}$ chosen in Section 3. We also set $u_{t}:=\\mathrm{T}_{t} \\mathbf{1}_{B} \\in H_{0}^{1}(\\mathrm{M})$ and $u_{t, k}:=u_{t} \\chi_{k} \\in H_{0}^{1}(\\mathrm{M})$. Note that $0 \\leq u_{t} \\leq 1$ a.e. (see, e.g., [30, Lemma 13.13]). For $\\alpha \\geq 0$ (chosen later), we consider the function\n\n$$\n\\xi(t):=\\int_{\\mathrm{M}}\\left(e^{\\alpha f} u_{t}\\right)^{2} \\mathrm{dm}\n$$\n\nBy the heat equation and the integration by parts, we have\n\n$$\n\\begin{aligned}\n\\xi^{\\prime}(t) & =\\int_{\\mathrm{M}} e^{2 \\alpha f} u_{t} \\Delta u_{t} \\mathrm{dm}=\\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} e^{2 \\alpha f_{k}} u_{t, k} \\Delta u_{t} \\mathrm{dm} \\\\\n& =-\\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} \\mathbf{d}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)\\left(\\nabla u_{t}\\right) \\mathrm{dm}\n\\end{aligned}\n$$\n\nLet us now see that\n\n$$\n\\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} \\mathbf{d}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)\\left(\\nabla u_{t}\\right) \\mathrm{dm}=\\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} \\mathbf{d}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)\\left(\\nabla u_{t, k}\\right) \\mathrm{dm}\n$$\n\nNote first that\n\n$$\n\\left|\\int_{\\mathrm{M}} \\mathbf{d}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)\\left(\\nabla u_{t}\\right) \\mathrm{dm}-\\int_{\\mathrm{M}} \\mathbf{d}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)\\left(\\nabla u_{t, k}\\right) \\mathrm{dm}\\right|\n$$\n\n$$\n\\begin{aligned}\n& \\leq \\Lambda_{F} \\int_{\\mathrm{M}} F^{*}\\left(\\mathbf{d}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)\\right) F\\left(\\nabla u_{t}-\\nabla u_{t, k}\\right) \\mathrm{dm} \\\\\n& \\leq \\Lambda_{F} \\sqrt{2 \\mathcal{E}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)} \\cdot\\left\\|F\\left(\\nabla u_{t}-\\nabla u_{t, k}\\right)\\right\\|_{L^{2}}\n\\end{aligned}\n$$\n\nWe find from $u_{t} \\in H_{0}^{1}(\\mathrm{M})$,\n\n$$\nF^{*}\\left(-\\mathbf{d} f_{k}\\right) \\leq F^{*}\\left(-f \\mathbf{d} \\chi_{k}\\right)+F^{*}\\left(-\\chi_{k} \\mathbf{d} f\\right) \\leq R+1 \\quad \\text { a.e. }\n$$\n\nand $\\Lambda_{F}<\\infty$ that $\\mathcal{E}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)$ is bounded above uniformly in $k$. Moreover, since $\\mathbf{d} u_{t}=$ $\\mathbf{d} u_{t, k}$ on $B_{k}$, we observe\n\n$$\n\\begin{aligned}\n\\left\\|F\\left(\\nabla u_{t}-\\nabla u_{t, k}\\right)\\right\\|_{L^{2}}^{2} & \\leq \\int_{\\mathrm{M} \\backslash B_{k}}\\left(F\\left(\\nabla u_{t}\\right)+\\Lambda_{F} F\\left(\\nabla u_{t, k}\\right)\\right)^{2} \\mathrm{dm} \\\\\n& \\leq \\int_{\\mathrm{M} \\backslash B_{k}}\\left(F\\left(\\nabla u_{t}\\right)+\\Lambda_{F}\\left(u_{t} F^{*}\\left(\\mathbf{d} \\chi_{k}\\right)+\\chi_{k} F^{*}\\left(\\mathbf{d} u_{t}\\right)\\right)\\right)^{2} \\mathrm{dm} \\\\\n& \\leq \\int_{\\mathrm{M} \\backslash B_{k}}\\left(\\Lambda_{F}^{2} u_{t}+\\left(\\Lambda_{F}+1\\right) F\\left(\\nabla u_{t}\\right)\\right)^{2} \\mathrm{dm} \\xrightarrow{k \\rightarrow \\infty} 0\n\\end{aligned}\n$$\n\nTherefore, (4.2) has been shown and the RHS of (4.1) can be expanded as\n\n$$\n\\begin{aligned}\n& -\\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} \\mathbf{d}\\left(e^{2 \\alpha f_{k}} u_{t, k}\\right)\\left(\\nabla u_{t, k}\\right) \\mathrm{dm} \\\\\n& =-\\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} e^{2 \\alpha f_{k}}\\left(\\mathbf{d} u_{t, k}\\left(\\nabla u_{t, k}\\right)+2 \\alpha u_{t, k} \\mathbf{d} f_{k}\\left(\\nabla u_{t, k}\\right)\\right) \\mathrm{dm}\n\\end{aligned}\n$$\n\nOn $B_{k}$, it follows from $\\chi_{k} \\equiv 1$ and $f \\in \\mathbb{L}_{B, R}$ that $F^{*}\\left(-\\mathbf{d} f_{k}\\right)=F^{*}(-\\mathbf{d} f) \\leq 1$, thereby,\n\n$$\n-\\mathbf{d} f_{k}\\left(\\nabla u_{t, k}\\right) \\leq F^{*}\\left(-\\mathbf{d} f_{k}\\right) F\\left(\\nabla u_{t, k}\\right) \\leq F\\left(\\nabla u_{t, k}\\right)\n$$\n\nCombining (4.1)-(4.4), we obtain\n\n$$\n\\begin{aligned}\n\\xi^{\\prime}(t) & =-\\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} e^{2 \\alpha f_{k}}\\left(\\mathbf{d} u_{t, k}\\left(\\nabla u_{t, k}\\right)+2 \\alpha u_{t, k} \\mathbf{d} f_{k}\\left(\\nabla u_{t, k}\\right)\\right) \\mathrm{dm} \\\\\n& \\leq-\\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} e^{2 \\alpha f_{k}}\\left(F\\left(\\nabla u_{t, k}\\right)^{2}-2 \\alpha u_{t, k} F\\left(\\nabla u_{t, k}\\right)\\right) \\mathrm{dm} \\\\\n& \\leq \\lim _{k \\rightarrow \\infty} \\int_{\\mathrm{M}} e^{2 \\alpha f_{k}}\\left(\\alpha u_{t, k}\\right)^{2} \\mathrm{dm} \\\\\n& =\\alpha^{2} \\int_{\\mathrm{M}} e^{2 \\alpha f} u_{t}^{2} \\mathrm{dm}=\\alpha^{2} \\xi(t)\n\\end{aligned}\n$$\n\nwhich yields\n\n$$\n\\xi(t) \\leq \\xi(0) e^{\\alpha^{2} t}\n$$\n\nNow, we take $f=\\overline{\\mathrm{d}}_{B} \\wedge \\overline{\\mathrm{~d}}_{\\mathrm{m}}(A, B) \\in \\mathbb{L}_{B, \\overline{\\mathrm{~d}}_{\\mathrm{m}}(A, B)}$. Since $\\overline{\\mathrm{d}}_{B}=0$ a.e. on $B$ and $\\overline{\\mathrm{d}}_{B} \\geq$ $\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)$ a.e. on $A$ by Proposition 3.1, we have\n\n$$\n\\begin{aligned}\n\\mathrm{P}_{t}(A, B) & =\\int_{\\mathrm{M}} u_{t} \\mathbf{1}_{A} \\mathrm{dm} \\leq\\left\\|e^{\\alpha f} u_{t}\\right\\|_{L^{2}}\\left\\|e^{-\\alpha f} \\mathbf{1}_{A}\\right\\|_{L^{2}} \\leq \\sqrt{\\xi(0)} e^{\\alpha^{2} t / 2} \\sqrt{\\mathrm{~m}(A)} e^{-\\alpha \\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)} \\\\\n& =\\sqrt{\\mathrm{m}(A)} \\sqrt{\\mathrm{m}(B)} \\exp \\left(\\frac{\\alpha^{2} t}{2}-\\alpha \\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)\\right)\n\\end{aligned}\n$$\n\nChoosing the optimal value $\\alpha=\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B) / t$, we conclude\n\n$$\n\\mathrm{P}_{t}(A, B) \\leq \\sqrt{\\mathrm{m}(A)} \\sqrt{\\mathrm{m}(B)} \\exp \\left(-\\frac{\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)^{2}}{2 t}\\right)\n$$\n\nSet $\\Phi_{t}:=\\Phi\\left(-t \\log \\mathrm{~T}_{t} \\mathbf{1}_{B}\\right)$ for $t>0$ and $\\Phi$ as in Subsection 2.2. Since $\\Phi$ is bounded, for any finite measure $\\nu$ mutually absolutely continuous with $\\mathrm{m},\\left(\\Phi_{t}\\right)_{t>0}$ is uniformly bounded and hence weakly relatively compact in $L^{2}(\\nu)$. The following corollary will play a role in the lower estimate.\n\nCorollary 4.2. For any measurable set $B \\subset \\mathrm{M}$ with $0<\\mathrm{m}(B)<\\infty$ and any weak $L^{2}(\\nu)$-limit $\\Phi_{0}$ of $\\left(\\Phi_{t}\\right)_{t>0}$ as $t \\rightarrow 0$, we have\n\n$$\n\\Phi_{0} \\geq \\Phi\\left(\\frac{\\mathrm{d}_{B}^{2}}{2}\\right) \\quad \\text { a.e. }\n$$\n\nProof. We can follow the lines of [21, Lemma 2.9] thanks to Propositions 3.1, 4.1.\n4.2. Nonsmooth case. In this subsection, we briefly explain that the upper estimate (Proposition 4.1) can be generalised to the nonsmooth setting of metric measure spaces by utilising the differential calculus developed in $[5,18]$.\n\nSetting. Let ( $\\mathrm{X}, \\mathrm{d}$ ) be a complete separable metric space (with a usual symmetric distance function), and m be a fully supported Borel measure on X such that $\\mathrm{m}(B)<\\infty$ for every bounded m-measurable set $B \\subset \\mathrm{X}$. A Borel probability measure $\\pi$ on the set $C([0,1], \\mathrm{X})$ of continuous curves $\\gamma:[0,1] \\rightarrow \\mathrm{X}$ is called a test plan if there is a constant $C>0$ such that $\\left(e_{t}\\right)_{\\#} \\pi \\leq C \\mathrm{~m}$ for all $t \\in[0,1]$ and\n\n$$\n\\int_{C([0,1], \\mathrm{X})} \\int_{0}^{1}\\left|\\dot{\\gamma}_{t}\\right|^{2} \\mathrm{~d} t \\pi(\\mathrm{~d} \\gamma)<\\infty\n$$\n\nwhere $e_{t}(\\gamma):=\\gamma_{t}$ is the evaluation map, $\\left(e_{t}\\right)_{\\#} \\pi$ denotes the push-forward of $\\pi$ by $e_{t}$, and $\\left|\\dot{\\gamma}_{t}\\right|:=\\lim _{s \\rightarrow t} \\mathrm{~d}\\left(\\gamma_{s}, \\gamma_{t}\\right) /|s-t|$ is the metric speed.\n\nThe Sobolev class $S^{2}(\\mathrm{X})$ consists of measurable functions $f$ such that there is a nonnegative function $g \\in L^{2}(\\mathrm{X})$ satisfying\n\n$$\n\\int_{C([0,1], \\mathrm{X})}\\left|f\\left(\\gamma_{1}\\right)-f\\left(\\gamma_{0}\\right)\\right| \\pi(\\mathrm{d} \\gamma) \\leq \\int_{C([0,1], \\mathrm{X})} \\int_{0}^{1} g\\left(\\gamma_{t}\\right)\\left|\\dot{\\gamma}_{t}\\right| \\mathrm{d} t \\pi(\\mathrm{~d} \\gamma)\n$$\n\nfor all test plans $\\pi$. The minimal function $g$ is called the minimal weak upper gradient and denoted by $|\\mathrm{D} f|$. We define the Sobolev space $W^{1,2}(\\mathrm{X}):=S^{2}(\\mathrm{X}) \\cap L^{2}(\\mathrm{X})$ equipped with the norm\n\n$$\n\\|f\\|_{W^{1,2}}:=\\sqrt{\\|f\\|_{L^{2}}^{2}+\\||\\mathrm{D} f|\\|_{L^{2}}^{2}}\n$$\n\n(Denoting the Sobolev space by $W^{1,2}(\\mathrm{X})$ follows the notation in $[5,18]$, while in the Finsler setting we use $H^{1}(\\mathrm{M}), H_{0}^{1}(\\mathrm{M})$ as in [30].) We remark that $W^{1,2}(\\mathrm{X})$ is not necessarily separable, reflexive, nor a Hilbert space in this generality (see [3], [18, Theorem 2.1.5]).\n\nHeat semigroup. The Cheeger energy $\\mathrm{Ch}: L^{2}(\\mathrm{X}) \\rightarrow[0, \\infty]$ is defined as\n\n$$\n\\operatorname{Ch}(f):=\\frac{1}{2} \\int_{\\mathrm{X}}|\\mathrm{D} f|^{2} \\mathrm{dm}\n$$\n\nfor $f \\in W^{1,2}(\\mathrm{X})$, and $\\operatorname{Ch}(f):=\\infty$ otherwise. Note that Ch is convex, lower semi-continuous and the domain $W^{1,2}(\\mathrm{X})$ is dense in $L^{2}(\\mathrm{X})$. For $f \\in W^{1,2}(\\mathrm{X})$ such that the sub-differential $\\partial^{-} \\operatorname{Ch}(f) \\subset L^{2}(\\mathrm{X})$ is nonempty, $\\Delta f \\in L^{2}(\\mathrm{X})$ is defined as $\\Delta f:=-h$, where $h$ is the element of minimal $L^{2}$-norm in $\\partial^{-} \\operatorname{Ch}(f)$. Note that this Laplacian is not necessarily linear.\n\nThanks to the theory of gradient flows for convex functions on Hilbert spaces (we refer to [4]), we have the heat semigroup $\\left(\\mathrm{T}_{t}\\right)_{t \\geq 0}$ of continuous operators from $L^{2}(\\mathrm{X})$ to itself such that, for every $f \\in L^{2}(\\mathrm{X}), t \\mapsto \\mathrm{~T}_{t} f \\in L^{2}(\\mathrm{X})$ is continuous on $[0, \\infty)$, absolutely continuous on $(0, \\infty)$ and\n\n$$\n\\frac{\\mathrm{d}}{\\mathrm{~d} t} \\mathrm{~T}_{t} f=\\frac{1}{2} \\Delta \\mathrm{~T}_{t} f \\quad \\text { a.e. } t>0\n$$\n\nDifferentials and gradients. According to [18, Definition 2.2.1], there exists a dual pair of Banach spaces called the tangent module and the cotangent module:\n\n$$\n\\left(L^{2}(T \\mathrm{X}),\\|\\cdot\\|_{L^{2}(T \\mathrm{X})}\\right), \\quad\\left(L^{2}\\left(T^{*} \\mathrm{X}\\right),\\|\\cdot\\|_{L^{2}\\left(T^{*} \\mathrm{X}\\right)}\\right)\n$$\n\nThese spaces are endowed with maps $|\\cdot|: L^{2}(T \\mathrm{X}) \\rightarrow L^{2}(\\mathrm{X}),|\\cdot|_{*}: L^{2}\\left(T^{*} \\mathrm{X}\\right) \\rightarrow L^{2}(\\mathrm{X})$ such that\n\n$$\n\\||v|\\|_{L^{2}}=\\|v\\|_{L^{2}(T \\mathrm{X})} \\text { for } v \\in L^{2}(T \\mathrm{X}), \\quad\\left\\|\\left.|\\omega|_{*}\\right|_{L^{2}}=\\|\\omega\\|_{L^{2}\\left(T^{*} \\mathrm{X}\\right)} \\text { for } \\omega \\in L^{2}\\left(T^{*} \\mathrm{X}\\right)\\right.\n$$\n\nThere exist a linear operator $\\mathbf{d}: S^{2}(\\mathrm{X}) \\rightarrow L^{2}\\left(T^{*} \\mathrm{X}\\right)$ and a (not necessarily linear) multivalued operator $\\operatorname{Grad}: S^{2}(\\mathrm{X}) \\rightarrow L^{2}(T \\mathrm{X})$ satisfying\n\n$$\n\\mathbf{d} f(v)=|v|^{2}=|\\mathbf{d} f|_{*}^{2}=|\\mathrm{D} f|^{2} \\quad \\text { for } v \\in \\operatorname{Grad} f, f \\in S^{2}(\\mathrm{X})\n$$\n\nWe say that $(\\mathrm{X}, \\mathrm{d}, \\mathrm{m})$ is infinitesimally strictly convex if $\\operatorname{Grad}(f)$ consists of exactly one element, which is denoted by $\\nabla f$ (see, e.g., [18, Definition 2.3.9]). In this case, we have\n\n$$\n\\operatorname{Ch}(f)=\\frac{1}{2} \\int_{\\mathrm{X}} \\mathbf{d} f(\\nabla f) \\mathrm{dm}, \\quad f \\in W^{1,2}(\\mathrm{X})\n$$\n\nThe differential operator $\\mathbf{d}$ enjoys the locality as well as the Leibniz and chain rules in an appropriate sense. On the other hand, the gradient operator $\\nabla$ satisfies the locality and the chain rule, whereas the Leibniz rule does not hold.\n\nUpper estimate. Define $W_{\\mathrm{loc}}^{1,2}(\\mathrm{X})$ as the set of functions $f$ admitting $\\left(f_{k}\\right)_{k \\in \\mathbb{N}} \\subset W^{1,2}(\\mathrm{X})$ such that $f=f_{k}$ on $B_{k}$ (with $B_{k}$ as in Section 3; $W_{\\text {loc }}^{1,2}(\\mathrm{X})$ does not depend on the choice of $\\left.B_{k}\\right)$. Then we define $\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)$ as in (1.3) with\n\n$$\n\\mathbb{L}:=\\left\\{f \\in W_{\\mathrm{loc}}^{1,2}(\\mathrm{X}) \\cap L^{\\infty}(\\mathrm{X}):|\\mathrm{D} f| \\leq 1 \\text { a.e. }\\right\\}\n$$\n\nand the local Sobolev-to-Lipschitz property means the property described in Proposition 3.5: for any $f \\in \\mathbb{L}$, there exists a bounded 1-Lipschitz function $\\tilde{f}$ such that $f=\\tilde{f}$ m-a.e.\n\nNow, Theorem 1.2 is proved in the same way as Proposition 4.1 with $\\overline{\\mathrm{d}}_{B}$ and $\\overline{\\mathrm{d}}_{m}(A, B)$ replaced by $\\mathrm{d}_{B}$ and $\\mathrm{d}(A, B)$, respectively, to obtain the upper bound\n\n$$\n\\mathrm{P}_{t}(A, B) \\leq \\sqrt{\\mathrm{m}(A)} \\sqrt{\\mathrm{m}(B)} \\exp \\left(-\\frac{\\mathrm{d}(A, B)^{2}}{2 t}\\right)\n$$\n\nThe infinitesimal strict convexity is used to have the integration by parts formula in the third equality in (4.1) in the generality of metric measure spaces. We remark that $W^{1,2}(\\mathrm{X})$ is not necessarily a Hilbert space, therefore, the reflexivity is not automatic. If $W^{1,2}(\\mathrm{X})$ is reflexive, then the proof of Proposition 3.1 works verbatim to construct $\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)$ based on $\\mathbb{L}$ defined above in metric measure spaces, and we have\n\n$$\n\\mathrm{P}_{t}(A, B) \\leq \\sqrt{\\mathrm{m}(A)} \\sqrt{\\mathrm{m}(B)} \\exp \\left(-\\frac{\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)^{2}}{2 t}\\right)\n$$\n\nIf, furthermore, the local Sobolev-to-Lipschitz property holds, the same proof of Lemma 3.4 applies to obtain $\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)=\\mathrm{d}(A, B)$ for any open sets $A, B \\subset \\mathrm{X}$.\n\nConcerning the lower estimate in the next section, our argument is applicable up to Subsection 5.3, whereas the use of a linearised heat semigroup in Lemma 5.7 prevents us from applying the same proof to the non-smooth case.\n\nRemark 4.3. The nonsmooth calculus in this subsection is not yet generalised to the asymmetric setting. We refer to [22] for a related study of the curvature-dimension condition in asymmetric metric measure spaces.\n\nRemark 4.4 (The case without the infinitesimal strict convexity). The upper bound (4.5) can be extended to some spaces without the infinitesimal strict convexity by using the stability under a perturbation of metric measure spaces. For instance, take $\\mathrm{X}=\\mathbb{R}^{n}, \\mathrm{~m}$ as the Lebesgue measure, and $\\mathrm{d}_{\\varepsilon}(x, y)^{2}:=\\|x-y\\|_{p}^{2}+\\varepsilon\\|x-y\\|_{2}^{2}$, where $\\|x\\|_{p}^{p}:=\\sum_{i=1}^{n}\\left|x_{i}\\right|^{p}$ when $1 \\leq p<\\infty$, and $\\|x\\|_{\\infty}:=\\max _{1 \\leq i \\leq n}\\left|x_{i}\\right|$. As $\\left(\\mathbb{R}^{n}, \\mathrm{~d}_{\\varepsilon}\\right)$ is a normed space for every $\\varepsilon>0$, the metric measure space $\\mathrm{X}_{\\varepsilon}:=\\left(\\mathbb{R}^{n}, \\mathrm{~d}_{\\varepsilon}, \\mathrm{m}\\right)$ is a $\\operatorname{CD}(0, n)$ space for every $\\varepsilon>0$ (see Theorem in [37, p. 908]). Furthermore, $\\left(\\mathbb{R}^{n}, \\mathrm{~d}_{\\varepsilon}\\right)$ is infinitesimally strictly convex for every $\\varepsilon>0$. It is easy to see that $\\mathrm{X}_{\\varepsilon}$ converges to $\\mathrm{X}=\\left(\\mathbb{R}^{n}, \\mathrm{~d}, \\mathrm{~m}\\right)$ as $\\varepsilon \\rightarrow 0$ in the sense of the pointed measured Gromov-Hausdorff convergence, where d is induced from $\\|\\cdot\\|_{p}$. Thus, by $[19,(1.5)]$, the corresponding heat semigroup $\\mathrm{T}_{t}^{\\varepsilon} f$ converges to $\\mathrm{T}_{t} f$ strongly in $L^{2}\\left(\\mathbb{R}^{n}, \\mathrm{~m}\\right)$ for every $f \\in L^{2}\\left(\\mathbb{R}^{n}, \\mathrm{~m}\\right)$ and $t>0$. Noting that\n\n$$\n\\lim _{\\varepsilon \\rightarrow 0} \\mathrm{~d}_{\\varepsilon}(A, B)=\\inf _{\\varepsilon>0} \\inf _{x \\in A, y \\in B} \\sqrt{\\|x-y\\|_{p}^{2}+\\varepsilon\\|x-y\\|_{2}^{2}}=\\mathrm{d}(A, B)\n$$\n\nwe obtain\n\n$$\n\\begin{aligned}\n\\mathrm{P}_{t}(A, B) & =\\int_{\\mathbb{R}^{n}} \\mathbf{1}_{A} \\cdot \\mathrm{~T}_{t} \\mathbf{1}_{B} \\mathrm{dm}=\\lim _{\\varepsilon \\rightarrow 0} \\int_{\\mathbb{R}^{n}} \\mathbf{1}_{A} \\cdot \\mathrm{~T}_{t}^{\\varepsilon} \\mathbf{1}_{B} \\mathrm{dm} \\\\\n& \\leq \\lim _{\\varepsilon \\rightarrow 0} \\sqrt{\\mathrm{~m}(A)} \\sqrt{\\mathrm{m}(B)} \\exp \\left(-\\frac{\\mathrm{d}_{\\varepsilon}(A, B)^{2}}{2 t}\\right) \\\\\n& =\\sqrt{\\mathrm{m}(A)} \\sqrt{\\mathrm{m}(B)} \\exp \\left(-\\frac{\\mathrm{d}(A, B)^{2}}{2 t}\\right)\n\\end{aligned}\n$$\n\nThis proves the upper bound in Theorem 1.2 for $\\left(\\mathbb{R}^{n}, \\mathrm{~d}, \\mathrm{~m}\\right)(1 \\leq p \\leq \\infty)$, although the infinitesimal strict convexity fails for $p=1, \\infty$. For general metric measure spaces, however, it is open whether we can remove the infinitesimal strict convexity in Theorem 1.2.", "tables": {}, "images": {}}, {"section_id": 6, "text": "# 5. LOWER ESTIMATE \n\nThis last section is devoted to the lower estimate of (1.5):\n\n$$\n\\liminf _{t, B} t \\log \\mathrm{P}_{t}(A, B) \\geq-\\frac{\\overline{\\mathrm{d}}_{\\mathrm{m}}(A, B)^{2}}{2}\n$$\n\nfor measurable sets $A, B \\subset \\mathrm{M}$ with $0<\\mathrm{m}(A), \\mathrm{m}(B)<\\infty$. Let $(\\mathrm{M}, F, \\mathrm{~m})$ be a complete Finsler manifold with $\\Lambda_{F}<\\infty$ with a measure m . We will need the additional assumptions $\\mathrm{C}_{F}, \\mathrm{~S}_{F}<\\infty$ and $\\mathrm{m}(\\mathrm{M})<\\infty$ only in a later step in Subsections 5.4, 5.5.\n\n5.1. Outline of the proof. Let us first remark that it is sufficient to show (5.1) in the case of $\\mathrm{P}_{t}(A, B)<1$. This is seen by replacing m with cm for $c>0$ such that $\\mathrm{cm}(A)<1$. Indeed, $(\\mathrm{M}, F, \\mathrm{~cm})$ has the same heat flow as $(\\mathrm{M}, F, \\mathrm{~m})$, thereby $\\mathrm{P}_{t}^{c m}(A, B)=c \\mathrm{P}_{t}^{m}(A, B)$, and clearly $\\ddot{\\mathrm{d}}_{c m}(A, B)=\\ddot{\\mathrm{d}}_{m}(A, B)$. Thus, we have $\\mathrm{P}_{t}^{c m}(A, B) \\leq c \\mathrm{~m}(A)<1$, and (5.1) for cm implies that for m .\n\nGiven $\\varepsilon>0$, we set\n\n$$\nD_{\\varepsilon}:=\\left\\{x \\in A: \\ddot{\\mathrm{d}}_{B}(x) \\leq \\ddot{\\mathrm{d}}_{m}(A, B)+\\varepsilon\\right\\}\n$$\n\nand observe $\\mathrm{m}\\left(D_{\\varepsilon}\\right)>0$ by Proposition 3.1. Then, recalling $\\Phi_{t}=\\Phi\\left(-t \\log \\mathrm{~T}_{t} \\mathbf{1}_{B}\\right)$ and noting $\\log \\mathrm{P}_{t}(A, B)<0$, we have\n\n$$\n\\begin{aligned}\n\\limsup _{t \\downarrow 0} \\Phi\\left(-t \\log \\mathrm{P}_{t}(A, B)\\right) & \\leq \\limsup _{t \\downarrow 0} \\Phi\\left(-t \\log \\mathrm{P}_{t}\\left(D_{\\varepsilon}, B\\right)\\right) \\\\\n& =\\limsup _{t \\downarrow 0} \\Phi\\left(-t \\log \\left[\\frac{1}{\\mathrm{~m}\\left(D_{\\varepsilon}\\right)} \\int_{D_{\\varepsilon}} \\mathrm{T}_{t} \\mathbf{1}_{B} \\mathrm{dm}\\right]\\right) \\\\\n& \\leq \\limsup _{t \\downarrow 0} \\frac{1}{\\mathrm{~m}\\left(D_{\\varepsilon}\\right)} \\int_{D_{\\varepsilon}} \\Phi\\left(-t \\log \\mathrm{~T}_{t} \\mathbf{1}_{B}\\right) \\mathrm{dm} \\\\\n& =\\limsup _{t \\downarrow 0} \\frac{1}{\\mathrm{~m}\\left(D_{\\varepsilon}\\right)} \\int_{D_{\\varepsilon}} \\Phi_{t} \\mathrm{dm}\n\\end{aligned}\n$$\n\nwhere the latter inequality is derived from Jensen's inequality since the function $s \\mapsto$ $\\Phi(-t \\log s)$ is convex on $[0,1]$ for sufficiently small $t>0$ (see [21, Lemma 2.1]). Now, suppose that the following inequality holds:\n\n$$\n\\limsup _{t \\downarrow 0} \\int_{D_{\\varepsilon}} \\Phi_{t} \\mathrm{dm} \\leq \\int_{D_{\\varepsilon}} \\Phi\\left(\\frac{\\ddot{\\mathrm{d}}_{B}^{2}}{2}\\right) \\mathrm{dm}\n$$\n\nThen, we can continue the estimation in (5.2) as, with the help of (2.9) to see $\\Phi(t) \\leq t$,\n\n$$\n\\leq \\frac{1}{\\mathrm{~m}\\left(D_{\\varepsilon}\\right)} \\int_{D_{\\varepsilon}} \\Phi\\left(\\frac{\\ddot{\\mathrm{d}}_{B}^{2}}{2}\\right) \\mathrm{dm} \\leq \\frac{1}{\\mathrm{~m}\\left(D_{\\varepsilon}\\right)} \\int_{D_{\\varepsilon}} \\frac{\\ddot{\\mathrm{d}}_{B}^{2}}{2} \\mathrm{dm} \\leq \\frac{\\left(\\ddot{\\mathrm{d}}_{\\mathrm{m}}(A, B)+\\varepsilon\\right)^{2}}{2}\n$$\n\nSince $\\varepsilon>0$ was arbitrary, $\\Phi$ is non-decreasing and $\\Phi(t)=\\Phi^{K}(t) \\rightarrow t$ as $K \\rightarrow \\infty$, we conclude (5.1).\n\nThe purpose of the rest of the section is to show (5.3), which completes the proof of (5.1). In fact, at the end of the section, we will prove that equality holds (see (5.11)).\n5.2. Uniform bounds. For $\\delta \\in(0,1)$ and $t>0$, we put\n\n$$\nu_{t}^{\\delta}:=-t \\log \\left((1-\\delta) \\mathrm{T}_{t} \\mathbf{1}_{B}+\\delta\\right), \\quad e_{t}^{\\delta}:=-t \\log \\delta\n$$\n\nNote that $u_{t}^{\\delta} \\geq 0$ since $0 \\leq \\mathrm{T}_{t} \\mathbf{1}_{B} \\leq 1$. In addition, for $\\phi, \\Phi$ and $\\Psi$ in Subsection 2.2, we will abbreviate as $\\phi_{t}^{\\delta}:=\\phi\\left(u_{t}^{\\delta}\\right), \\Phi_{t}^{\\delta}:=\\Phi\\left(u_{t}^{\\delta}\\right)$ and $\\Psi_{t}^{\\delta}:=\\Psi\\left(u_{t}^{\\delta}\\right)$.\n\nWe will denote by $(\\cdot, \\cdot)_{L^{2}}$ both the $L^{2}$-inner product and the paring between a one-form and a vector field with respect to m . We also introduce the following notation: For a nonnegative function $\\rho$, define\n\n$$\n\\mathcal{E}_{\\rho}(f):=\\frac{1}{2} \\int_{\\mathrm{M}} F^{*}(\\mathrm{~d} f)^{2} \\rho \\mathrm{dm}, \\quad\\left(f_{1}, f_{2}\\right)_{L^{2}(\\rho)}:=\\int_{\\mathrm{M}} f_{1} f_{2} \\rho \\mathrm{dm}\n$$\n\nLemma 5.1. For any $t>0$, we have $u_{t}^{\\delta}-e_{t}^{\\delta} \\in H_{0}^{1}(\\mathrm{M})$ and, for every bounded nonnegative function $\\rho \\in H_{0}^{1}(\\mathrm{M}) \\cap L^{1}(\\mathrm{M})$,\n\n$$\n\\partial_{t}\\left(\\rho, \\Phi_{t}^{\\delta}\\right)_{L^{2}}=\\frac{1}{t}\\left(\\rho, \\Psi_{t}^{\\delta}\\right)_{L^{2}}+\\frac{1}{2}\\left(\\mathbf{d}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\rho\\right), \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}}-\\frac{1}{t} \\mathcal{E}_{\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\rho}\\left(-u_{t}^{\\delta}\\right)\n$$\n\nProof. We put $f:=(1-\\delta) \\mathbf{1}_{B}$ for brevity. Observe that $u_{t}^{\\delta}-e_{t}^{\\delta}=\\vartheta\\left(\\mathrm{T}_{t} f\\right)$, where $\\vartheta(s):=$ $-t \\log ((s+\\delta) / \\delta)$ is a Lipschitz function on $[0, \\infty)$ with $\\vartheta(0)=0$. Thus, since $\\mathrm{T}_{t} f \\in H_{0}^{1}(\\mathrm{M})$, we have $u_{t}^{\\delta}-e_{t}^{\\delta} \\in H_{0}^{1}(\\mathrm{M})$. We deduce from the chain rule for $\\mathbf{d}$ that\n\n$$\n\\mathbf{d} u_{t}^{\\delta}=-\\frac{t}{\\mathrm{~T}_{t} f+\\delta} \\mathbf{d} \\mathrm{T}_{t} f, \\quad \\nabla\\left(-u_{t}^{\\delta}\\right)=\\frac{t}{\\mathrm{~T}_{t} f+\\delta} \\nabla \\mathrm{T}_{t} f\n$$\n\nWe remark that, to derive the latter equation, we needed $t /\\left(\\mathrm{T}_{t} f+\\delta\\right)>0$ because of the irreversibility of $F$. Combining this with the Leibniz rule for $\\mathbf{d}$, we have\n\n$$\n\\begin{aligned}\n\\left(\\mathbf{d}\\left[\\frac{\\rho}{\\mathrm{~T}_{t} f+\\delta}\\right], \\nabla \\mathrm{T}_{t} f\\right)_{L^{2}} & =\\left(\\frac{\\mathbf{d} \\rho}{\\mathrm{~T}_{t} f+\\delta}, \\nabla \\mathrm{T}_{t} f\\right)_{L^{2}}-\\left(\\frac{\\mathbf{d} \\mathrm{~T}_{t} f}{\\left(\\mathrm{~T}_{t} f+\\delta\\right)^{2}}, \\nabla \\mathrm{~T}_{t} f\\right)_{L^{2}(\\rho)} \\\\\n& =\\frac{1}{t}\\left(\\mathbf{d} \\rho, \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}}+\\frac{1}{t^{2}}\\left(\\mathbf{d} u_{t}^{\\delta}, \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}(\\rho)}\n\\end{aligned}\n$$\n\nHence, we obtain\n\n$$\n\\begin{aligned}\n\\left(\\rho, \\partial_{t} u_{t}^{\\delta}\\right)_{L^{2}} & =\\frac{1}{t}\\left(\\rho, u_{t}^{\\delta}\\right)_{L^{2}}-\\frac{t}{2}\\left(\\rho, \\frac{\\Delta \\mathrm{~T}_{t} f}{\\mathrm{~T}_{t} f+\\delta}\\right)_{L^{2}} \\\\\n& =\\frac{1}{t}\\left(\\rho, u_{t}^{\\delta}\\right)_{L^{2}}+\\frac{t}{2}\\left(\\mathbf{d}\\left[\\frac{\\rho}{\\mathrm{~T}_{t} f+\\delta}\\right], \\nabla \\mathrm{T}_{t} f\\right)_{L^{2}} \\\\\n& =\\frac{1}{t}\\left(\\rho, u_{t}^{\\delta}\\right)_{L^{2}}+\\frac{1}{2}\\left(\\mathbf{d} \\rho, \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}}-\\frac{1}{t} \\mathcal{E}_{\\rho}\\left(-u_{t}^{\\delta}\\right)\n\\end{aligned}\n$$\n\nSince $\\partial_{t}\\left(\\rho, \\Phi_{t}^{\\delta}\\right)_{L^{2}}=\\left(\\rho, \\partial_{t} \\Phi_{t}^{\\delta}\\right)_{L^{2}}=\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\rho, \\partial_{t} u_{t}^{\\delta}\\right)_{L^{2}}$, replacing $\\rho$ with $\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\rho$ in the above calculation completes the proof.\n\nFor a function $f:(0, \\infty) \\times \\mathrm{M} \\rightarrow \\mathbb{R}$ (such as $\\left.(t, x) \\mapsto \\phi_{t}^{\\delta}(x)\\right)$, we will denote its time average by\n\n$$\n\\bar{f}_{t}(x):=\\frac{1}{t} \\int_{0}^{t} f_{s}(x) \\mathrm{d} s\n$$\n\nwhere $f_{s}(x):=f(s, x)$. The next lemma is a standard fact of the $\\left(H_{0}^{1}(\\mathrm{M})\\right.$-valued $)$ Bochner integral (cf. [21, Lemma 2.5]).\n\nLemma 5.2. Let $f:(0, T] \\times \\mathrm{M} \\rightarrow \\mathbb{R}$ be a bounded jointly measurable function such that $f_{t} \\in H_{0}^{1}(\\mathrm{M})$ for all $t \\in(0, T]$ and $\\int_{0}^{T}\\left\\|f_{t}\\right\\|_{H^{1}}^{2} \\mathrm{~d} t<\\infty$. Then, we have $\\bar{f}_{T} \\in H_{0}^{1}(\\mathrm{M})$ and\n\n$$\n\\mathcal{E}_{\\rho}\\left(\\bar{f}_{T}\\right) \\leq \\frac{1}{T} \\int_{0}^{T} \\mathcal{E}_{\\rho}\\left(f_{t}\\right) \\mathrm{d} t\n$$\n\nfor any bounded nonnegative function $\\rho \\in L_{\\mathrm{loc}}^{1}(\\mathrm{M})$.\nProof. By hypothesis, $t \\mapsto f_{t} \\in H_{0}^{1}(\\mathrm{M})$ is Bochner integrable and we have $\\bar{f}_{T} \\in H_{0}^{1}(\\mathrm{M})$. Then, the claimed inequality is a consequence of the linearity of $\\mathbf{d}$ and Jensen's inequality for the convex function $\\left(F^{*}\\right)^{2}$ :\n\n$$\n2 \\mathcal{E}_{\\rho}\\left(\\bar{f}_{T}\\right)=\\int_{\\mathrm{M}} F^{*}\\left(\\frac{1}{T} \\int_{0}^{T} \\mathbf{d} f_{t} \\mathrm{~d} t\\right)^{2} \\rho \\mathrm{dm} \\leq \\frac{1}{T} \\int_{\\mathrm{M}} \\int_{0}^{T} F^{*}\\left(\\mathbf{d} f_{t}\\right)^{2} \\rho \\mathrm{~d} t \\mathrm{dm}\n$$\n\n$$\n=\\frac{2}{T} \\int_{0}^{T} \\mathcal{E}_{\\rho}\\left(f_{t}\\right) \\mathrm{d} t\n$$\n\nThe next proposition is the goal of this subsection.\nProposition 5.3. For sufficiently small $T_{0}>0$, the families $\\left\\{\\phi_{t}^{\\delta} \\chi_{k}\\right\\}_{0<t<T_{0}, 0<\\delta<1}$ and $\\left\\{\\Phi_{t}^{\\delta} \\chi_{k}\\right\\}_{0<t<T_{0}, 0<\\delta<1}$ are bounded in $H_{0}^{1}(\\mathrm{M})$ for every $k \\in \\mathbb{N}$.\n\nProof. Since $\\phi$ and $\\Phi$ are bounded, it is straightforward that both families are bounded in $L^{2}(\\mathrm{M})$. Thus, we discuss only the bound for the energy. Put\n\n$$\nU_{t}^{\\delta}:=2 \\mathcal{E}\\left(-\\phi_{t}^{\\delta} \\chi_{k}\\right), \\quad a:=\\Lambda_{F}^{2} \\cdot \\mathrm{~m}\\left(B_{k+1}\\right)\n$$\n\nfor $\\Lambda_{F}$ in (2.3). Then, by (2.9) and the choice of $\\chi_{k}$ as in Section 3, we have\n\n$$\n\\begin{aligned}\nU_{t}^{\\delta} & \\leq\\left\\|F^{*}\\left(-\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right) \\chi_{k} \\mathbf{d} u_{t}^{\\delta}\\right)+F^{*}\\left(-\\phi_{t}^{\\delta} \\mathbf{d} \\chi_{k}\\right)\\right\\|_{L^{2}}^{2} \\\\\n& =\\left\\|\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right) \\chi_{k} F^{*}\\left(-\\mathbf{d} u_{t}^{\\delta}\\right)+\\phi_{t}^{\\delta} F^{*}\\left(-\\mathbf{d} \\chi_{k}\\right)\\right\\|_{L^{2}}^{2} \\\\\n& \\leq 4 \\mathcal{E}_{\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\chi_{k}^{2}}\\left(-u_{t}^{\\delta}\\right)+2(K L)^{2} \\mathrm{~m}\\left(B_{k+1}\\right)\n\\end{aligned}\n$$\n\nLetting $\\rho=\\chi_{k}^{2}$ in Lemma 5.1, we find\n\n$$\n\\begin{aligned}\nV_{t}^{\\delta} & :=2 \\mathcal{E}_{\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\chi_{k}^{2}}\\left(-u_{t}^{\\delta}\\right) \\\\\n& =-2 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+2\\left(\\Psi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+t\\left(\\mathbf{d}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\chi_{k}^{2}\\right), \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}}\n\\end{aligned}\n$$\n\nNote that, in the RHS, $\\left(\\Psi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}} \\leq K L \\mathrm{~m}\\left(B_{k+1}\\right)$ by (2.9) and the choice of $\\chi_{k}$. For the third term, we deduce from the Leibniz rule for $\\mathbf{d}$ and (2.9) that\n\n$$\n\\begin{aligned}\n& \\left(\\mathbf{d}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\chi_{k}^{2}\\right), \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}} \\\\\n& =2\\left(\\mathbf{d} \\chi_{k}, \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\chi_{k}\\right)}+2\\left(\\phi^{\\prime \\prime}\\left(u_{t}^{\\delta}\\right) \\mathbf{d} u_{t}^{\\delta}, \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right) \\chi_{k}^{2}\\right)} \\\\\n& \\leq 2\\left(F^{*}\\left(\\mathbf{d} \\chi_{k}\\right), F\\left(\\nabla\\left(-u_{t}^{\\delta}\\right)\\right)\\right)_{L^{2}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\chi_{k}\\right)}+\\frac{4 C}{K} \\mathcal{E}_{\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\chi_{k}^{2}}\\left(-u_{t}^{\\delta}\\right)\n\\end{aligned}\n$$\n\nSince $\\mathbf{d}\\left(\\phi_{t}^{\\delta} \\chi_{k}\\right)=\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right) \\chi_{k} \\mathbf{d} u_{t}^{\\delta}+\\phi_{t}^{\\delta} \\mathbf{d} \\chi_{k}$ by the chain rule for $\\mathbf{d}$, we also have\n\n$$\n\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right) \\chi_{k} F\\left(\\nabla\\left(-u_{t}^{\\delta}\\right)\\right) \\leq F\\left(\\nabla\\left(-\\phi_{t}^{\\delta} \\chi_{k}\\right)\\right)+\\phi_{t}^{\\delta} F\\left(\\nabla \\chi_{k}\\right)\n$$\n\nCombining these inequalities with $2 \\mathcal{E}\\left(\\chi_{k}\\right) \\leq 2 \\Lambda_{F}^{2} \\mathcal{E}\\left(-\\chi_{k}\\right) \\leq a$ yields that\n\n$$\n\\begin{aligned}\nV_{t}^{\\delta} & \\leq-2 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+2 K L a+\\frac{2 C t}{K} V_{t}^{\\delta} \\\\\n& +2 t\\left(F^{*}\\left(\\mathbf{d} \\chi_{k}\\right), F\\left(\\nabla\\left(-\\phi_{t}^{\\delta} \\chi_{k}\\right)\\right)\\right)_{L^{2}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)\\right)}+2 t\\left(F^{*}\\left(\\mathbf{d} \\chi_{k}\\right), F\\left(\\nabla \\chi_{k}\\right)\\right)_{L^{2}\\left(\\phi_{t}^{\\delta} \\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)\\right)} \\\\\n& \\leq-2 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+2 K L a+\\frac{2 C t}{K} V_{t}^{\\delta}+4 t \\sqrt{\\mathcal{E}\\left(\\chi_{k}\\right) \\mathcal{E}\\left(-\\phi_{t}^{\\delta} \\chi_{k}\\right)}+4 K L t \\mathcal{E}\\left(\\chi_{k}\\right) \\\\\n& \\leq-2 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+2 K L a+\\frac{2 C t}{K} V_{t}^{\\delta}+2 t \\sqrt{a U_{t}^{\\delta}}+2 K L a t\n\\end{aligned}\n$$\n\nHence, we obtain\n\n$$\n\\left(1-\\frac{2 C t}{K}\\right) V_{t}^{\\delta} \\leq-2 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+\\frac{U_{t}^{\\delta}}{8}+8 a t^{2}+2 K L a(t+1)\n$$\n\nNow, put $T_{0}:=K /(4 C)$ and observe that $V_{t}^{\\delta} / 2 \\leq(1-(2 C t) / K) V_{t}^{\\delta}$ for $t \\in\\left(0, T_{0}\\right]$. Thus, for $t \\in\\left(0, T_{0}\\right]$, we find from (5.4) and (5.5) that\n\n$$\n\\begin{aligned}\nU_{t}^{\\delta} & \\leq 2 V_{t}^{\\delta}+2 K^{2} L^{2} a \\\\\n& \\leq-8 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+\\frac{U_{t}^{\\delta}}{2}+32 a T_{0}^{2}+8 K L a\\left(T_{0}+1\\right)+2 K^{2} L^{2} a\n\\end{aligned}\n$$\n\nThis implies\n\n$$\nU_{t}^{\\delta} \\leq-16 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+c\n$$\n\nwhere $c$ is a constant independent of $t \\in\\left(0, T_{0}\\right]$ and $\\delta \\in(0,1)$. Hence, for $0<\\varepsilon<t \\leq T_{0}$,\n\n$$\n\\begin{aligned}\n\\int_{\\varepsilon}^{t} 2 \\mathcal{E}\\left(-\\phi_{s}^{\\delta} \\chi_{k}\\right) \\mathrm{d} s & =\\int_{\\varepsilon}^{t} U_{s}^{\\delta} \\mathrm{d} s \\leq-16 \\int_{\\varepsilon}^{t} s \\partial_{s}\\left(\\Phi_{s}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}} \\mathrm{~d} s+c(t-\\varepsilon) \\\\\n& =-16\\left[s\\left(\\Phi_{s}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}\\right]_{\\varepsilon}^{t}+16 \\int_{\\varepsilon}^{t}\\left(\\Phi_{s}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}} \\mathrm{~d} s+c(t-\\varepsilon)\n\\end{aligned}\n$$\n\nLetting $\\varepsilon \\rightarrow 0$ yields, since $0 \\leq \\Phi \\leq K L$,\n\n$$\n\\int_{0}^{t} 2 \\mathcal{E}\\left(-\\phi_{s}^{\\delta} \\chi_{k}\\right) \\mathrm{d} s \\leq 16 K L a t+c t\n$$\n\nTherefore, we conclude\n\n$$\n2 \\mathcal{E}\\left(-\\bar{\\phi}_{t}^{\\delta} \\chi_{k}\\right) \\leq \\frac{1}{t} \\int_{0}^{t} 2 \\mathcal{E}\\left(-\\phi_{s}^{\\delta} \\chi_{k}\\right) \\mathrm{d} s \\leq 16 K L a+c\n$$\n\nwhere the first inequality follows from Lemma 5.2. This completes the proof of the boundedness of $\\left\\{\\bar{\\phi}_{t}^{\\delta} \\chi_{k}\\right\\}_{0<t<T_{0}, 0<\\delta<1}$ in $H_{0}^{1}(\\mathrm{M})$.\n\nBy a similar calculation to (5.4), we find\n\n$$\n2 \\mathcal{E}\\left(-\\Phi_{t}^{\\delta} \\chi_{k}\\right) \\leq\\left\\|\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\chi_{k} F^{*}\\left(-\\mathbf{d} u_{t}^{\\delta}\\right)+\\Phi_{t}^{\\delta} F^{*}\\left(-\\mathbf{d} \\chi_{k}\\right)\\right\\|_{L^{2}}^{2} \\leq 2 V_{t}^{\\delta}+2(K L)^{2} a\n$$\n\nThus, we deduce from (5.6) that, for $t \\in\\left(0, T_{0}\\right]$,\n\n$$\n2 \\mathcal{E}\\left(-\\Phi_{t}^{\\delta} \\chi_{k}\\right) \\leq-8 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+\\frac{U_{t}^{\\delta}}{2}+\\frac{c}{2} \\leq-16 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\chi_{k}^{2}\\right)_{L^{2}}+c\n$$\n\nwhich yields\n\n$$\n\\int_{0}^{t} 2 \\mathcal{E}\\left(-\\Phi_{s}^{\\delta} \\chi_{k}\\right) \\mathrm{d} s \\leq 16 K L a t+c t\n$$\n\nand the boundedness of $\\left\\{\\bar{\\Phi}_{t}^{\\delta} \\chi_{k}\\right\\}_{0<t<T_{0}, 0<\\delta<1}$ in $H_{0}^{1}(\\mathrm{M})$ by the same reasoning as above.\n5.3. Limit functions. Thanks to Proposition 5.3 and the reflexivity of $H_{0}^{1}(\\mathrm{M})=H^{1}(\\mathrm{M})$, up to extracting a (non-relabelled) subsequence, we have\n\n$$\n\\bar{\\phi}_{t}^{\\delta} \\chi_{k} \\xrightarrow{\\delta \\rightarrow 0, t \\rightarrow 0} \\exists \\bar{\\phi}_{k}, \\quad \\text { weakly in } H_{0}^{1}(\\mathrm{M})\n$$\n\nSince $\\bar{\\phi}_{k}=\\bar{\\phi}_{l}$ on $B_{k}$ for $k \\leq l$, there exists a bounded nonnegative function $\\bar{\\phi}_{0} \\in H_{\\mathrm{loc}}^{1}(\\mathrm{M})$ such that $\\bar{\\phi}_{0}=\\bar{\\phi}_{k}$ on $B_{k}$ for every $k \\in \\mathbb{N}$. By the boundedness of $\\Phi$ and $\\Psi$, we may take a further (non-relabelled) subsequence such that, by passing $\\delta \\rightarrow 0$ and then $t \\rightarrow 0$,\n\n$$\n\\Phi_{t}^{\\delta} \\xrightarrow{\\delta \\rightarrow 0, t \\rightarrow 0} \\exists \\Phi_{0}, \\quad \\bar{\\Phi}_{t}^{\\delta} \\xrightarrow{\\delta \\rightarrow 0, t \\rightarrow 0} \\exists \\bar{\\Phi}_{0}, \\quad \\bar{\\Psi}_{t}^{\\delta} \\xrightarrow{\\delta \\rightarrow 0, t \\rightarrow 0} \\exists \\bar{\\Psi}_{0}\n$$\n\nfor some nonnegative functions $\\Phi_{0}, \\bar{\\Phi}_{0}, \\bar{\\Psi}_{0} \\in L^{\\infty}(\\mathrm{M})$, both in the weak $L^{2}(\\nu)$ sense for any finite measure $\\nu$ mutually absolutely continuous with $m$ and in the weak-star $L^{\\infty}(m)$ sense.\n\nThen the goal of this subsection is to prove the next proposition.\n\nProposition 5.4. We have\n\n$$\n\\bar{\\Phi}_{0}=\\Phi\\left(\\frac{\\overline{\\mathrm{d}}_{B}^{2}}{2}\\right) \\quad \\text { a.e. }\n$$\n\nIn particular, $\\bar{\\Phi}_{0}$ is uniquely determined and is the weak limit of $\\bar{\\Phi}_{t}$ as $t \\rightarrow 0$.\nRecall Proposition 3.1 for $\\overline{\\mathrm{d}}_{B}$. To this end, we first observe the following.\nLemma 5.5. We have\n\n$$\n\\bar{\\Phi}_{0} \\leq \\bar{\\phi}_{0} \\leq \\frac{\\overline{\\mathrm{d}}_{B}^{2}}{2} \\quad \\text { a.e. }\n$$\n\nProof. We will use the same symbols as in Proposition 5.3. The former inequality $\\bar{\\Phi}_{0} \\leq \\bar{\\phi}_{0}$ follows from $\\Phi \\leq \\phi$. To show the latter inequality, take a bounded nonnegative function $\\rho \\in H_{0}^{1}(\\mathrm{M})$ with $\\operatorname{supp} \\rho \\subset B_{k}$. Then, it follows from $\\chi_{k} \\equiv 1$ on $B_{k}$ and Lemma 5.1 that\n\n$$\n\\begin{aligned}\n2 \\mathcal{E}_{\\rho}\\left(-\\phi_{t}^{\\delta} \\chi_{k}\\right) & =2 \\mathcal{E}_{\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\rho}\\left(-u_{t}^{\\delta}\\right) \\\\\n& =-2 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\rho\\right)_{L^{2}}+t\\left(\\mathbf{d}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\rho\\right), \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}}+2\\left(\\Psi_{t}^{\\delta}, \\rho\\right)_{L^{2}}\n\\end{aligned}\n$$\n\nBy the Leibniz rule for $\\mathbf{d}$ and (2.9), the second term can be bounded as\n\n$$\n\\begin{aligned}\n& \\left(\\mathbf{d}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\rho\\right), \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}} \\\\\n& =\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\mathbf{d} \\rho, \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}}+2\\left(\\phi^{\\prime \\prime}\\left(u_{t}^{\\delta}\\right) \\mathbf{d} u_{t}^{\\delta}, \\nabla\\left(-u_{t}^{\\delta}\\right)\\right)_{L^{2}\\left(\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right) \\rho\\right)} \\\\\n& \\leq\\left(\\mathbf{d} \\rho, \\nabla\\left(-\\Phi_{t}^{\\delta}\\right)\\right)_{L^{2}}+\\frac{4 C}{K} \\mathcal{E}_{\\phi^{\\prime}\\left(u_{t}^{\\delta}\\right)^{2} \\rho}\\left(-u_{t}^{\\delta}\\right) \\\\\n& =\\left(\\mathbf{d} \\rho, \\nabla\\left(-\\Phi_{t}^{\\delta} \\chi_{k}\\right)\\right)_{L^{2}}+\\frac{4 C}{K} \\mathcal{E}_{\\rho}\\left(-\\phi_{t}^{\\delta}\\right)\n\\end{aligned}\n$$\n\nCombining this with the above calculation and observing $\\mathcal{E}_{\\rho}\\left(-\\phi_{t}^{\\delta}\\right)=\\mathcal{E}_{\\rho}\\left(-\\phi_{t}^{\\delta} \\chi_{k}\\right)$, we find\n\n$$\n2\\left(1-\\frac{2 C t}{K}\\right) \\mathcal{E}_{\\rho}\\left(-\\phi_{t}^{\\delta} \\chi_{k}\\right) \\leq-2 t \\partial_{t}\\left(\\Phi_{t}^{\\delta}, \\rho\\right)_{L^{2}}+t\\left(\\mathbf{d} \\rho, \\nabla\\left(-\\Phi_{t}^{\\delta} \\chi_{k}\\right)\\right)_{L^{2}}+2\\left(\\Psi_{t}^{\\delta}, \\rho\\right)_{L^{2}}\n$$\n\nThis implies, with the help of Fubini's theorem,\n\n$$\n\\begin{aligned}\n& 2\\left(1-\\frac{2 C T}{K}\\right) \\frac{1}{T} \\int_{0}^{T} \\mathcal{E}_{\\rho}\\left(-\\phi_{t}^{\\delta} \\chi_{k}\\right) \\mathrm{d} t \\\\\n& \\leq-\\frac{2}{T}\\left[t\\left(\\Phi_{t}^{\\delta}, \\rho\\right)_{L^{2}}\\right]_{0}^{T}+\\frac{2}{T} \\int_{0}^{T}\\left(\\Phi_{t}^{\\delta}, \\rho\\right)_{L^{2}} \\mathrm{~d} t+\\frac{1}{T} \\int_{0}^{T} t\\left(\\mathbf{d} \\rho, \\nabla\\left(-\\Phi_{t}^{\\delta} \\chi_{k}\\right)\\right)_{L^{2}} \\mathrm{~d} t+2\\left(\\bar{\\Psi}_{T}^{\\delta}, \\rho\\right)_{L^{2}} \\\\\n& =-2\\left(\\Phi_{T}^{\\delta}, \\rho\\right)_{L^{2}}+2\\left(\\bar{\\Phi}_{T}^{\\delta}, \\rho\\right)_{L^{2}}+\\frac{1}{T} \\int_{0}^{T} t\\left(\\mathbf{d} \\rho, \\nabla\\left(-\\Phi_{t}^{\\delta} \\chi_{k}\\right)\\right)_{L^{2}} \\mathrm{~d} t+2\\left(\\bar{\\Psi}_{T}^{\\delta}, \\rho\\right)_{L^{2}}\n\\end{aligned}\n$$\n\nUsing the integration by parts, we can estimate the third term of the RHS as\n\n$$\n\\begin{aligned}\n& \\frac{1}{T} \\int_{0}^{T} t\\left(\\mathbf{d} \\rho, \\nabla\\left(-\\Phi_{t}^{\\delta} \\chi_{k}\\right)\\right)_{L^{2}} \\mathrm{~d} t \\\\\n& =\\frac{1}{T}\\left[t \\int_{0}^{t}\\left(\\mathbf{d} \\rho, \\nabla\\left(-\\Phi_{s}^{\\delta} \\chi_{k}\\right)\\right)_{L^{2}} \\mathrm{~d} s\\right]_{t=0}^{t=T}-\\frac{1}{T} \\int_{0}^{T} \\int_{0}^{t}\\left(\\mathbf{d} \\rho, \\nabla\\left(-\\Phi_{s}^{\\delta} \\chi_{k}\\right)\\right)_{L^{2}} \\mathrm{~d} s \\mathrm{~d} t \\\\\n& \\leq \\int_{0}^{T} 2 \\sqrt{\\mathcal{E}(\\rho) \\mathcal{E}\\left(-\\Phi_{s}^{\\delta} \\chi_{k}\\right)} \\mathrm{d} s+\\frac{1}{T} \\int_{0}^{T} \\int_{0}^{t} 2 \\sqrt{\\mathcal{E}(-\\rho) \\mathcal{E}\\left(-\\Phi_{s}^{\\delta} \\chi_{k}\\right)} \\mathrm{d} s \\mathrm{~d} t \\\\\n& \\xrightarrow{\\delta \\rightarrow 0, T \\rightarrow 0} 0\n\\end{aligned}\n$$\n\nwhere the convergence in the last line follows from the boundedness (5.7).\nBy the lower semi-continuity of $\\mathcal{E}_{\\rho}$, taking the limit of (5.8) as $\\delta \\rightarrow 0, T \\rightarrow 0$ along the subsequence taken in the beginning of Subsection 5.3 yields\n\n$$\n2 \\mathcal{E}_{\\rho}\\left(-\\bar{\\phi}_{0}\\right) \\leq\\left(-2 \\Phi_{0}+2 \\bar{\\Phi}_{0}+2 \\bar{\\Psi}_{0}, \\rho\\right)_{L^{2}} \\leq\\left(4 \\bar{\\phi}_{0}, \\rho\\right)_{L^{2}}\n$$\n\nwhere we used $\\rho \\geq 0$ and $0 \\leq \\Psi \\leq \\Phi \\leq \\phi$ in (2.9) in the latter inequality. This implies that, for any $\\varepsilon>0$,\n\n$$\n2 \\mathcal{E}_{\\rho}\\left(-\\sqrt{\\bar{\\phi}_{0}+\\varepsilon}\\right)=\\frac{1}{2} \\mathcal{E}_{\\rho /\\left(\\bar{\\phi}_{0}+\\varepsilon\\right)}\\left(-\\bar{\\phi}_{0}\\right) \\leq\\left(\\bar{\\phi}_{0}, \\frac{\\rho}{\\bar{\\phi}_{0}+\\varepsilon}\\right)_{L^{2}} \\leq\\|\\rho\\|_{L^{1}}\n$$\n\nLetting $\\varepsilon \\rightarrow 0$ and noting that $\\rho$ was arbitrary, we find that $f_{0}:=\\sqrt{\\bar{\\phi}_{0}} \\in H_{\\mathrm{loc}}^{1}(\\mathrm{M})$ with $F^{*}\\left(-\\mathbf{d} f_{0}\\right) \\leq 1$ a.e. Moreover, a similar proof to $[6$, Lemma 4.4] shows that $\\bar{\\phi}_{0}=0$ a.e. on $B$. Thus, we have $f_{0} \\in \\mathbb{L}_{B, \\sqrt{R L}}$, and then it follows from Proposition 3.1 that\n\n$$\n\\bar{\\phi}_{0} \\leq \\overline{\\mathrm{d}}_{B}^{2} \\quad \\text { a.e. }\n$$\n\nFinally, one can improve $\\bar{\\phi}_{0} \\leq \\overline{\\mathrm{d}}_{B}^{2}$ to $\\bar{\\phi}_{0} \\leq \\overline{\\mathrm{d}}_{B}^{2} / 2$ by the same argument as in [6, Lemma 4.5] (see also [21, Lemma 2.12]) thanks to Proposition 4.1.\n\nWe can also show a partial converse inequality as follows.\nLemma 5.6. We have\n\n$$\n\\bar{\\Phi}_{0} \\geq \\Phi\\left(\\frac{\\overline{\\mathrm{d}}_{B}^{2}}{2}\\right) \\quad \\text { a.e. }\n$$\n\nProof. We can follow the same lines as in [21, Lemma 2.13] by using Corollary 4.2.\nNow, we are ready to prove Proposition 5.4.\nProof of Proposition 5.4. Thanks to Lemmas 5.5, 5.6, we can apply the argument in [21, Lemma 2.14] by replacing $m$ with an equivalent finite measure $\\nu$.\n5.4. Tauberian argument. By a Tauberian argument, we shall get rid of the time average from Proposition 5.4. Here we need additional assumptions to make use of linearised heat semigroups. Note that, for the linearised gradient operator as in (2.8), we have\n\n$$\n\\mathbf{d} h(\\nabla f)=\\sum_{i, j=1}^{n} g_{i j}^{*}(\\mathbf{d} f) \\frac{\\partial f}{\\partial x^{j}} \\frac{\\partial h}{\\partial x^{i}}=\\mathbf{d} f\\left(\\nabla^{\\nabla f} h\\right)\n$$\n\nRecall also that we set $u_{t}=\\mathrm{T}_{t} \\mathbf{1}_{B}$ and $\\Phi_{t}=\\Phi\\left(-t \\log \\mathrm{~T}_{t} \\mathbf{1}_{B}\\right)$ in Section 4.\nLemma 5.7. Assume $\\mathbb{C}_{F}, \\mathbb{S}_{F}<\\infty$ and $\\mathrm{m}(\\mathrm{M})<\\infty$. Then, for every $\\tau>0$ and measurable set $D \\subset \\mathrm{M}$ with $\\mathrm{m}(D)>0$, we have\n\n$$\n\\lim _{t \\downarrow 0}\\left(\\Phi_{t}, h_{\\tau-t}^{\\tau, \\sigma}\\right)_{L^{2}}=\\left(\\bar{\\Phi}_{0}, h_{\\tau}^{\\tau, \\sigma}\\right)_{L^{2}}\n$$\n\nwhere $\\left(h_{t}^{\\tau, \\sigma}\\right)_{t \\in[0, \\tau]}$ is the solution to the linearised heat equation\n\n$$\n\\partial_{t} h_{t}^{\\tau, \\sigma}=\\frac{1}{2} \\Delta^{\\nabla u_{\\tau-t}} h_{t}^{\\tau, \\sigma}, \\quad h_{0}^{\\tau, \\sigma}=\\mathrm{T}_{\\sigma} \\mathbf{1}_{D}\n$$\n\nRemark 5.8. In (5.10), to be precise, we choose a measurable one-parameter family $\\left(V_{t}\\right)_{t \\geq 0}$ of nowhere vanishing vector fields with $V_{t}(x)=\\nabla u_{t}(x)$ when $\\mathbf{d} u_{t}(x) \\neq 0$, and replace $\\nabla u_{\\tau-t}$ with $V_{\\tau-t}$. The unique existence of a solution $\\left(h_{t}^{\\tau, \\sigma}\\right)_{t \\in[0, \\tau]}$ is guaranteed in the same manner as that for (2.7) (see [30, Proposition 13.20]) by virtue of the hypothesis $\\mathrm{C}_{F}, \\mathrm{~S}_{F}<\\infty$. We remark that $t \\mapsto h_{t}^{\\tau, \\sigma}$ is $L^{2}$-continuous on $[0, \\tau]$, and $\\int_{\\mathbf{M}} h_{t}^{\\tau, \\sigma} \\mathrm{d} \\mathrm{m}=\\mathrm{m}(D)$ holds for all $t$ (since constant functions belong to $L^{2}(\\mathrm{M})$ ).\n\nWe also remark that choosing $\\mathrm{T}_{\\sigma} \\mathbf{1}_{D}$ as the initial point is unessential; we may take any nonnegative function in $H_{0}^{1}(\\mathrm{M})$ converging to $\\mathbf{1}_{D}$ (see the very last step in Subsection 5.5).\n\nProof. We follow the argument in [21, Lemma 2.15] (see also [6, Lemma 4.6]), however, a modification is needed because of the asymmetry (2.6).\n\nSince $\\tau, \\sigma>0$ are fixed, we will denote $h_{t}^{\\tau, \\sigma}$ by $h_{t}$ for brevity. For $t \\in(0, \\tau)$, put $H(t):=\\left(\\Phi_{t}, h_{\\tau-t}\\right)_{L^{2}}$. For applying the Tauberian-type theorem in [35, Lemma 3.11] which implies the claim $\\lim _{t \\downarrow 0} H(t)=\\left(\\bar{\\Phi}_{0}, h_{\\tau}\\right)_{L^{2}}$, it suffices to see the following:\n(a) $T^{-1} \\int_{0}^{T} H(t) \\mathrm{d} t \\rightarrow\\left(\\bar{\\Phi}_{0}, h_{\\tau}\\right)_{L^{2}}$ as $T \\rightarrow 0$;\n(b) There exist $M, t_{0}>0$ such that $H(t)-H(s) \\leq M(t-s) / s$ for all $0<s<t \\leq t_{0}$.\n\nThe condition (a) follows from\n\n$$\n\\begin{aligned}\n\\left|\\frac{1}{T} \\int_{0}^{T} H(t) \\mathrm{d} t-\\left(h_{\\tau}, \\bar{\\Phi}_{0}\\right)_{L^{2}}\\right| & \\leq \\frac{1}{T} \\int_{0}^{T}\\left|H(t)-\\left(h_{\\tau}, \\Phi_{t}\\right)_{L^{2}}\\right| \\mathrm{d} t+\\left|\\left(h_{\\tau}, \\bar{\\Phi}_{T}-\\bar{\\Phi}_{0}\\right)_{L^{2}}\\right| \\\\\n& \\leq \\frac{K L}{T} \\int_{0}^{T}\\left\\|h_{\\tau-t}-h_{\\tau}\\right\\|_{L^{1}} \\mathrm{~d} t+\\left|\\left(h_{\\tau}, \\bar{\\Phi}_{T}-\\bar{\\Phi}_{0}\\right)_{L^{2}}\\right| \\\\\n& \\xrightarrow{T \\rightarrow 0} 0\n\\end{aligned}\n$$\n\nTo see (b), we observe from Lemma 5.1 and (5.10) that\n\n$$\n\\begin{aligned}\n{\\left[\\left(h_{\\tau-r}, \\Phi_{r}^{\\delta}\\right)_{L^{2}}\\right]_{r=s}^{r=t}=} & \\int_{s}^{t}\\left(h_{\\tau-r}, \\partial_{r} \\Phi_{r}^{\\delta}\\right)_{L^{2}} \\mathrm{~d} r+\\int_{s}^{t}\\left(\\partial_{r} h_{\\tau-r}, \\Phi_{r}^{\\delta}\\right)_{L^{2}} \\mathrm{~d} r \\\\\n= & \\int_{s}^{t} \\frac{1}{r}\\left(h_{\\tau-r}, \\Psi_{r}^{\\delta}\\right)_{L^{2}} \\mathrm{~d} r+\\int_{s}^{t} \\frac{1}{2}\\left(\\mathbf{d}\\left(\\phi^{\\prime}\\left(u_{r}^{\\delta}\\right)^{2} h_{\\tau-r}\\right), \\nabla\\left(-u_{r}^{\\delta}\\right)\\right)_{L^{2}} \\mathrm{~d} r \\\\\n& -\\int_{s}^{t} \\frac{1}{r} \\mathcal{E}_{\\phi^{\\prime}\\left(u_{r}^{\\delta}\\right)^{2} h_{\\tau-r}}\\left(-u_{r}^{\\delta}\\right) \\mathrm{d} r-\\int_{s}^{t} \\frac{1}{2}\\left(\\Delta^{\\nabla u_{r}} h_{\\tau-r}, \\Phi_{r}^{\\delta}\\right)_{L^{2}} \\mathrm{~d} r \\\\\n= & : I_{1}+I_{2}-I_{3}-I_{4}\n\\end{aligned}\n$$\n\nNote first that $I_{1}$ can be estimated as\n\n$$\nI_{1} \\leq \\int_{s}^{t} \\frac{1}{r} K L \\mathrm{~m}(D) \\mathrm{d} r \\leq K L \\mathrm{~m}(D) \\frac{t-s}{s}\n$$\n\nNext, since\n\n$$\n\\mathbf{d} \\Phi_{r}^{\\delta}=\\phi^{\\prime}\\left(u_{r}^{\\delta}\\right)^{2} \\mathbf{d} u_{r}^{\\delta}=-\\phi^{\\prime}\\left(u_{r}^{\\delta}\\right)^{2} \\frac{t(1-\\delta)}{(1-\\delta) u_{r}+\\delta} \\cdot \\mathbf{d} u_{r}\n$$\n\nimplies $g_{i j}^{*}\\left(\\mathbf{d} u_{r}\\right)=g_{i j}^{*}\\left(-\\mathbf{d} \\Phi_{r}^{\\delta}\\right)$, we deduce from (5.9) that\n\n$$\n\\begin{aligned}\n2 I_{4} & =\\int_{s}^{t}\\left(\\mathbf{d}\\left(-\\Phi_{r}^{\\delta}\\right), \\nabla^{\\nabla u_{r}} h_{\\tau-r}\\right)_{L^{2}} \\mathrm{~d} r=\\int_{s}^{t}\\left(\\mathbf{d} h_{\\tau-r}, \\nabla\\left(-\\Phi_{r}^{\\delta}\\right)\\right)_{L^{2}} \\mathrm{~d} r \\\\\n& =\\int_{s}^{t}\\left(\\mathbf{d} h_{\\tau-r}, \\nabla\\left(-u_{r}^{\\delta}\\right)\\right)_{L^{2}\\left(\\phi^{\\prime}\\left(u_{r}^{\\delta}\\right)^{2}\\right)} \\mathrm{d} r\n\\end{aligned}\n$$\n\n(we remark that the integrands in the above calculation vanish on the set $\\left\\{\\mathbf{d} u_{r}=0\\right\\}$ ). Then, using the Leibniz rule for $\\mathbf{d}$ and (2.9), we find\n\n$$\n\\begin{aligned}\nI_{2} & =\\int_{s}^{t} \\frac{1}{2}\\left(\\mathbf{d} h_{\\tau-r}, \\nabla\\left(-u_{r}^{\\delta}\\right)\\right)_{L^{2}\\left(\\phi^{\\prime}\\left(u_{r}^{\\delta}\\right)^{2}\\right)} \\mathrm{d} r+\\int_{s}^{t}\\left(\\phi^{\\prime \\prime}\\left(u_{r}^{\\delta}\\right) \\mathbf{d} u_{r}^{\\delta}, \\nabla\\left(-u_{r}^{\\delta}\\right)\\right)_{L^{2}\\left(\\phi^{\\prime}\\left(u_{r}^{\\delta}\\right) h_{\\tau-r}\\right)} \\mathrm{d} r \\\\\n& \\leq I_{4}+\\frac{2 C}{K} \\int_{s}^{t} \\mathcal{E}_{\\phi^{\\prime}\\left(u_{r}^{\\delta}\\right)^{2} h_{\\tau-r}}\\left(-u_{r}^{\\delta}\\right) \\mathrm{d} r\n\\end{aligned}\n$$\n\nSetting $t \\leq t_{0}:=K /(2 C)$, we have $I_{2} \\leq I_{4}+I_{3}$. Therefore, we obtain\n\n$$\n\\left[\\left(h_{\\tau-r}, \\Phi_{r}^{\\delta}\\right)_{L^{2}}\\right]_{r=s}^{r=t} \\leq I_{1} \\leq K L \\mathfrak{m}(D) \\frac{t-s}{s} \\quad \\text { for all } 0<s<t \\leq t_{0}\n$$\n\nLetting $\\delta \\rightarrow 0$ completes the proof.\n5.5. Proof of (5.3). We are now in a position to prove (5.3). We shall in fact show that\n\n$$\n\\lim _{t \\downarrow 0} \\int_{D} \\Phi_{t} \\mathrm{dm}=\\int_{D} \\Phi\\left(\\frac{\\overline{\\mathrm{~d}}_{B}^{2}}{2}\\right) \\mathrm{dm}\n$$\n\nfor every measurable set $D \\subset \\mathrm{M}$ with $\\mathrm{m}(D)>0$, namely $\\Phi\\left(\\overline{\\mathrm{d}}_{B}^{2} / 2\\right)$ is the weak $L^{2}$-limit of $\\Phi_{t}$. For $\\sigma>0$ and $\\tau>t>0$, we decompose as\n\n$$\n\\int_{D} \\Phi_{t} \\mathrm{dm}=\\left(\\Phi_{t}, h_{\\tau-t}^{\\tau, \\sigma}\\right)_{L^{2}}+\\left(\\Phi_{t}, \\mathbf{1}_{D}-h_{\\tau-t}^{\\tau, \\sigma}\\right)_{L^{2}}\n$$\n\nTaking the limit as $t \\rightarrow 0$, we find from Lemma 5.7, Proposition 5.4 and $0 \\leq \\Phi \\leq K L$ that\n\n$$\n\\left|\\lim _{t \\downarrow 0} \\int_{D} \\Phi_{t} \\mathrm{dm}-\\left(\\Phi\\left(\\frac{\\overline{\\mathrm{d}}_{B}^{2}}{2}\\right), h_{\\tau}^{\\tau, \\sigma}\\right)_{L^{2}}\\right| \\leq K L\\left\\|\\mathbf{1}_{D}-h_{\\tau}^{\\tau, \\sigma}\\right\\|_{L^{1}}\n$$\n\nWe next consider the limit as $\\tau \\rightarrow 0$. Put $w_{t}:=\\mathrm{T}_{t} \\mathbf{1}_{D}$ and observe that, for $t \\in(0, \\tau)$,\n\n$$\n\\begin{aligned}\n& \\frac{\\mathrm{d}}{\\mathrm{~d} t}\\left[\\left\\|w_{\\sigma+t}-h_{t}^{\\tau, \\sigma}\\right\\|_{L^{2}}^{2}\\right] \\\\\n& =\\int_{\\mathrm{M}}\\left(w_{\\sigma+t}-h_{t}^{\\tau, \\sigma}\\right)\\left(\\Delta w_{\\sigma+t}-\\Delta^{\\nabla u_{\\tau-t}} h_{t}^{\\tau, \\sigma}\\right) \\mathrm{dm} \\\\\n& =-\\int_{\\mathrm{M}} \\mathbf{d}\\left(w_{\\sigma+t}-h_{t}^{\\tau, \\sigma}\\right)\\left(\\nabla w_{\\sigma+t}-\\nabla^{\\nabla u_{\\tau-t}} h_{t}^{\\tau, \\sigma}\\right) \\mathrm{dm} \\\\\n& =-2 \\mathcal{E}\\left(w_{\\sigma+t}\\right)-2 \\mathcal{E}^{\\nabla u_{\\tau-t}}\\left(h_{t}^{\\tau, \\sigma}\\right)+\\int_{\\mathrm{M}}\\left\\{\\mathbf{d} h_{t}^{\\tau, \\sigma}\\left(\\nabla w_{\\sigma+t}\\right)+\\mathbf{d} w_{\\sigma+t}\\left(\\nabla^{\\nabla u_{\\tau-t}} h_{t}^{\\tau, \\sigma}\\right)\\right\\} \\mathrm{dm} \\\\\n& \\leq-2 \\mathcal{E}\\left(w_{\\sigma+t}\\right)-2 \\mathcal{E}^{\\nabla u_{\\tau-t}}\\left(h_{t}^{\\tau, \\sigma}\\right)+\\int_{\\mathrm{M}} F^{*}\\left(\\mathbf{d} w_{\\sigma+t}\\right)\\left\\{F^{*}\\left(\\mathbf{d} h_{t}^{\\tau, \\sigma}\\right)+F\\left(\\nabla^{\\nabla u_{\\tau-t}} h_{t}^{\\tau, \\sigma}\\right)\\right\\} \\mathrm{dm}\n\\end{aligned}\n$$\n\nwhere we defined (recall (2.2) for $g_{\\mathrm{d} u}^{*}$ )\n\n$$\n\\mathcal{E}^{\\nabla u}(h):=\\frac{1}{2} \\int_{\\mathrm{M}} g_{\\mathbf{d} u}^{*}(\\mathbf{d} h, \\mathbf{d} h) \\mathrm{dm}=\\frac{1}{2} \\int_{\\mathrm{M}} \\mathbf{d} h\\left(\\nabla^{\\nabla u} h\\right) \\mathrm{dm}\n$$\n\nNow, it follows from (2.5) that\n\n$$\nF^{*}\\left(\\mathbf{d} h_{t}^{\\tau, \\sigma}\\right)^{2} \\leq \\mathrm{S}_{F} \\cdot g_{\\mathbf{d} u_{\\tau-t}}^{*}\\left(\\mathbf{d} h_{t}^{\\tau, \\sigma}, \\mathbf{d} h_{t}^{\\tau, \\sigma}\\right)\n$$\n\nand similarly, by (2.4),\n\n$$\nF\\left(\\nabla^{\\nabla u_{\\tau-t}} h_{t}^{\\tau, \\sigma}\\right)^{2} \\leq \\mathrm{C}_{F} \\cdot g \\nabla u_{\\tau-t}\\left(\\nabla^{\\nabla u_{\\tau-t}} h_{t}^{\\tau, \\sigma}, \\nabla^{\\nabla u_{\\tau-t}} h_{t}^{\\tau, \\sigma}\\right)=\\mathrm{C}_{F} \\cdot g_{\\mathbf{d} u_{\\tau-t}}^{*}\\left(\\mathbf{d} h_{t}^{\\tau, \\sigma}, \\mathbf{d} h_{t}^{\\tau, \\sigma}\\right)\n$$\n\nTherefore,\n\n$$\n\\frac{\\mathrm{d}}{\\mathrm{~d} t}\\left[\\left\\|w_{\\sigma+t}-h_{t}^{\\tau, \\sigma}\\right\\|_{L^{2}}^{2}\\right]\n$$\n\n$$\n\\begin{aligned}\n\\leq & -2 \\mathcal{E}\\left(w_{\\sigma+t}\\right)-2 \\mathcal{E}^{\\nabla u_{\\tau-t}}\\left(h_{t}^{\\tau, \\sigma}\\right) \\\\\n& +\\int_{\\mathrm{M}}\\left(\\sqrt{\\mathrm{~S}_{F}}+\\sqrt{\\mathrm{C}_{F}}\\right) F^{*}\\left(\\mathbf{d} w_{\\sigma+t}\\right) \\cdot \\sqrt{g_{\\mathbf{d} u_{\\tau-t}}^{*}\\left(\\mathbf{d} h_{t}^{\\tau, \\sigma}, \\mathbf{d} h_{t}^{\\tau, \\sigma}\\right)} \\mathrm{dm} \\\\\n\\leq & -2 \\mathcal{E}\\left(w_{\\sigma+t}\\right)-2 \\mathcal{E}^{\\nabla u_{\\tau-t}}\\left(h_{t}^{\\tau, \\sigma}\\right) \\\\\n& +\\int_{\\mathrm{M}}\\left\\{\\frac{1}{4}\\left(\\sqrt{\\mathrm{~S}_{F}}+\\sqrt{\\mathrm{C}_{F}}\\right)^{2} F^{*}\\left(\\mathbf{d} w_{\\sigma+t}\\right)^{2}+g_{\\mathbf{d} u_{\\tau-t}}^{*}\\left(\\mathbf{d} h_{t}^{\\tau, \\sigma}, \\mathbf{d} h_{t}^{\\tau, \\sigma}\\right)\\right\\} \\mathrm{dm} \\\\\n= & \\left(\\frac{\\left(\\sqrt{\\mathrm{~S}_{F}}+\\sqrt{\\mathrm{C}_{F}}\\right)^{2}}{2}-2\\right) \\mathcal{E}\\left(w_{\\sigma+t}\\right)\n\\end{aligned}\n$$\n\nSince $h_{0}^{\\tau, \\sigma}=w_{\\sigma}$, integrating the above inequality in $t \\in(0, \\tau)$ yields\n\n$$\n\\left\\|w_{\\sigma+\\tau}-h_{\\tau}^{\\tau, \\sigma}\\right\\|_{L^{2}}^{2} \\leq\\left(\\frac{\\left(\\sqrt{\\mathrm{~S}_{F}}+\\sqrt{\\mathrm{C}_{F}}\\right)^{2}}{2}-2\\right) \\int_{0}^{\\tau} \\mathcal{E}\\left(w_{\\sigma+t}\\right) \\mathrm{d} t\n$$\n\nPlugging\n\n$$\n\\frac{\\mathrm{d}}{\\mathrm{~d} t}\\left[\\left\\|w_{\\sigma+t}\\right\\|_{L^{2}}^{2}\\right]=\\int_{\\mathrm{M}} w_{\\sigma+t} \\Delta w_{\\sigma+t} \\mathrm{dm}=-2 \\mathcal{E}\\left(w_{\\sigma+t}\\right)\n$$\n\ninto the RHS, we obtain\n\n$$\n\\left\\|w_{\\sigma+\\tau}-h_{\\tau}^{\\tau, \\sigma}\\right\\|_{L^{2}}^{2} \\leq\\left(\\frac{\\left(\\sqrt{\\mathrm{~S}_{F}}+\\sqrt{\\mathrm{C}_{F}}\\right)^{2}}{4}-1\\right)\\left(\\left\\|w_{\\sigma}\\right\\|_{L^{2}}^{2}-\\left\\|w_{\\sigma+\\tau}\\right\\|_{L^{2}}^{2}\\right)\n$$\n\nHence, $h_{\\tau}^{\\tau, \\sigma} \\rightarrow w_{\\sigma}$ in $L^{2}$ as $\\tau \\rightarrow 0$, and then (5.12) shows\n\n$$\n\\left|\\lim _{t \\downarrow 0} \\int_{D} \\Phi_{t} \\mathrm{dm}-\\left(\\Phi\\left(\\frac{\\overline{\\mathrm{d}}_{B}^{2}}{2}\\right), w_{\\sigma}\\right)_{L^{2}}\\right| \\leq K L\\left\\|\\mathbf{1}_{D}-w_{\\sigma}\\right\\|_{L^{1}}\n$$\n\nFinally, as $\\sigma \\rightarrow 0$, we have $\\left\\|\\mathbf{1}_{D}-w_{\\sigma}\\right\\|_{L^{1}} \\rightarrow 0$ since $w_{\\sigma} \\rightarrow \\mathbf{1}_{D}$ in $L^{2}$ and $\\mathrm{m}(\\mathrm{M})<\\infty$. This completes the proof of (5.11) and hence the lower estimate (5.1).\n5.6. Further problems. We conclude with some further problems.\n\nFirst of all, in Theorem 1.1, we used the assumption $\\mathrm{m}(\\mathrm{M})<\\infty$ only for deducing the $L^{1}$-convergence from the $L^{2}$-convergence. We expect that a finer analysis of (non-linear and linearised) heat semigroups could remove it. Such an analysis will be helpful also for the further study of geometric analysis on noncompact Finsler manifolds, where some results are known only under seemingly artificial assumptions; we refer to [31] for gradient estimates and an isoperimetric inequality, and to [25] for a rigidity problem of the spectral gap.\n\nIn the non-smooth setting in Theorem 1.2, the lower bound estimate is an intriguing open problem. The main issue is whether we can avoid using a linearised heat semigroup in Lemma 5.7.", "tables": {}, "images": {}}, {"section_id": 7, "text": "# REFERENCES \n\n[1] Aida, S. and Kawabi, H. Short time asymptotics of a certain infinite dimensional diffusion process. In Decreusefond, L., \u00d8ksendal, B. K., and \u00dcst\u00fcnel, A. S., editors, Stochastic Analysis and Related Topics VII - Proceedings of the Seventh Silivri Workshop, volume 48 of Progress in Probability, pages 77-124. Birkh\u00e4user, 2001.\n[2] Aida, S. and Zhang, T. S. On the small time asymptotics of diffusion processes on path groups. Potential Anal., 16:67-78, 2002.\n\n[3] Ambrosio, L., Colombo, M., and Di Marino, S. Sobolev spaces in metric measure spaces: reflexivity and lower semicontinuity of slope. Adv. Stud. Pure Math., 67:1-58, 2015.\n[4] Ambrosio, L., Gigli, N., and Savar\u00e9, G. Gradient flows in metric spaces and in the space of probability measures. Lectures in Mathematics - ETH Z\u00fcrich. Birkh\u00e4user, $2^{\\text {nd }}$ edition, 2008.\n[5] Ambrosio, L., Gigli, N., and Savar\u00e9, G. Calculus and heat flow in metric measure spaces and applications to spaces with Ricci bounds from below. Invent. Math., 395:289-391, 2014.\n[6] Ariyoshi, T. and Hino, M. Small-time asymptotic estimates in local Dirichlet spaces. Electron. J. Probab., 10:1236-1259, 2005.\n[7] Bailleul, I. and Norris, J. Diffusion in small time in incomplete sub-Riemannian manifolds. Anal. PDE, 15:63-84, 2022.\n[8] Ben Arous, G. D\u00e9veloppement asymptotique du noyau de la chaleur hypoelliptique hors du cut-locus . Ann. Sci. Ecole Norm. Sup., 21 (4):307-331, 1988.\n[9] Ben Arous, G. and L\u00e9andre, R. D\u00e9croissance exponentielle du noyau de la chaleur sur la diagonale. II . Probab. Theory Related Fields, 90:377-402, 1991.\n[10] Carlen, E. A., Kusuoka, S., and Stroock, D. W. Upper bounds for symmetric Markov transition functions. Ann. I. H. Poincar\u00e9 B, 23(S2):245-287, 1987.\n[11] Dello Schiavo, L. and Suzuki, K. Rademacher-type theorems and Sobolev-toLipschitz properties for strongly local Dirichlet spaces. J. Funct. Anal., 281(11):Paper No. 109234, 2021.\n[12] Dello Schiavo, L. and Suzuki, K. Configuration spaces over singular spaces II - Curvature. arXiv:2205.01379, 2022.\n[13] Dello Schiavo, L. and Suzuki, K. Sobolev-to-Lipschitz property on QCD-spaces and applications. Math. Ann., 384:1815-1832, 2022.\n[14] Evans, C. L. and Gariepy, F. R. Measure theory and fine properties of functions. Textbook in Mathematics, CRC Press, 2015.\n[15] Fang, S. On the Ornstein-Uhlenbeck process. Stoch. Stoch. Rep., 46:141-159, 1994.\n[16] Fang, S. and Zhang, T. S. On the small time behavior of Ornstein-Uhlenbeck processes with unbounded linear drifts. Probab. Theory Relat. Fields, 114:487-504, 1999.\n[17] Ge, Y. and Shen, Z. Eigenvalues and eigenfunctions of metric measure manifolds. Proc. London Math. Soc. (3), 82:725-746, 2001.\n[18] Gigli, N. Nonsmooth differential geometry - An approach tailored for spaces with Ricci curvature bounded from below. Mem. Am. Math. Soc., 251(1196), 2018.\n[19] Gigli, N., Mondino, A., and Savar\u00e9, G. Convergence of pointed non-compact metric measure spaces and stability of Ricci curvature bounds and heat flows. Proc. London Math. Soc., 111(3):1071-1129, 2015.\n[20] Hino, M. and Matsuura, K. An integrated version of Varadhan's asymptotics for lower-order perturbations of strong local Dirichlet forms. Potent. Anal., 48:257-300, 2018.\n[21] Hino, M. and Ram\u00edrez, J. A. Small-time Gaussian behavior of symmetric diffusion semigroups. Ann. Probab., 31(3):1254-1295, 2003.\n\n[22] Krist\u00e1ly, A. and Zhao, W. On the geometry of irreversible metric-measure spaces: Convergence, stability and analytic aspects. J. Math. Pures Appl. (9), 158:216-292, 2022.\n[23] R. L\u00e9andre. Majoration en temps petit de la densit\u00e9 d'une diffusion d\u00e9g\u00e9n\u00e9r\u00e9e. Probab. Theory Relat. Fields, 74(2):289-294, 1987.\n[24] R. L\u00e9andre. Minoration en temps petit de la densit\u00e9 d'une diffusion d\u00e9g\u00e9n\u00e9r\u00e9e. J. Funct. Anal., 74(2):399-414, 1987.\n[25] Mai, C. H. A rigidity result of spectral gap on Finsler manifolds and its application. Tohoku Math. J. (2), 76:561-575, 2024.\n[26] Norris, J. R. Heat kernel asymptotics and the distance function in Lipschitz Riemannian manifolds. Acta Math., 179:79-103, 1997.\n[27] Ohta, S. Uniform convexity and smoothness, and their applications in Finsler geometry. Math. Ann., 343:669-699, 2009.\n[28] Ohta, S. Nonlinear geometric analysis on Finsler manifolds. Eur. J. Math, 3:916-952, 2017.\n[29] Ohta, S. Some functional inequalities on non-reversible Finsler manifolds. Proc. Indian Acad. Sci. Math. Sci., 127:833-855, 2017.\n[30] Ohta, S. Comparison Finsler geometry. Springer Monographs in Mathematics, 2021.\n[31] Ohta, S. A semigroup approach to Finsler geometry: Bakry-Ledoux's isoperimetric inequality. Comm. Anal. Geom., 30:2347-2387, 2022.\n[32] Ohta, S. and Sturm, K.-T. Heat flow on Finsler manifolds. Comm. Pure Appl. Math., $62: 1386-1433,2009$.\n[33] Ohta, S. and Sturm, K.-T. Bochner-Weitzenb\u00f6ck formula and Li-Yau estimates on Finsler manifolds. Adv. Math., 252:429-448, 2014.\n[34] Ohta, S. and Zhao, W. Gradient flows in asymmetric metric spaces and applications. Ann. Sc. Norm. Super. Pisa Cl. Sci. (to appear), arXiv:2206.07591, 2022.\n[35] Ram\u00edrez, J. Short time asymptotics in Dirichlet spaces. Comm. Pure Appl. Math., $54(3): 259-293,2001$.\n[36] Varadhan, S. R. S. On the behavior of the fundamental solution of the heat equation with variable coefficients. Comm. Pure Appl. Math., 20(2):431-455, 1967.\n[37] Villani, C. Optimal transport, old and new, volume 338 of Grundlehren der mathematischen Wissenschaften. Springer-Verlag, 2009.\n[38] von Renesse, M.-K. and Sturm, K.-T. Entropic measure and Wasserstein diffusion. Ann. Probab., 37(3):1114-1191, 2009.\n[39] Zhang, T. S. On the small time large deviations of diffusion processes on configuration spaces. Stoch. Proc. Appl., 91(2):239-254, 2001.\n\nDepartment of Mathematics, Osaka University, Osaka 560-0043, Japan, and RIKEN CenTER FOR ADVANCED Intelligence Project (AIP), 1-4-1 Nihonbashi, Tokyo 103-0027, Japan\nEmail address: s.ohta@math.sci.osaka-u.ac.jp\nDepartment of Mathematical Science, Durham University, DH13LE, Durham, United Kingdom/Theoretical Sciences Visiting Program, Okinawa Institute of Science and Technology Graduate University, Onna, 904-0495, Japan\n\nEmail address: kohei.suzuki@durham.ac.uk", "tables": {}, "images": {}}], "id": "2403.04102v2", "authors": ["Shin-ichi Ohta", "Kohei Suzuki"], "categories": ["math.PR", "math.FA", "math.MG"], "abstract": "We prove the integral Varadhan short-time formula for non-linear heat flow on\nmeasured Finsler manifolds. To the best of the authors' knowledge, this is the\nfirst result establishing a Varadhan-type formula for non-linear semigroups. We\ndo not assume the reversibility of the metric, and the distance function can be\nasymmetric. In this generality, we reveal that the probabilistic interpretation\nis well-suited for our formula; the probability that a particle starting from a\nset $A$ can be found in another set $B$ describes the distance from $A$ to $B$.\nOne side of the estimates (the upper bound of the probability) is also\nestablished in the nonsmooth setting of infinitesimally strictly convex metric\nmeasure spaces satisfying the local Sobolev-to-Lipschitz property.", "updated": "2025-04-14T23:52:23Z", "published": "2024-03-06T23:11:03Z"}