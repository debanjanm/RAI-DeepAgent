{
  "title": "Definable convolution and idempotent Keisler measures III. Generic\n  stability, generic transitivity, and revised Newelski's conjecture",
  "sections": [
    {
      "section_id": 0,
      "text": "#### Abstract\n\nWe study idempotent measures and the structure of the convolution semigroups of measures over definable groups.\n\nWe isolate the property of generic transitivity and demonstrate that it is sufficient (and necessary) to develop stable group theory localizing on a generically stable type, including invariant stratified ranks and connected components. We establish generic transitivity of generically stable idempotent types in important new cases, including abelian groups in arbitrary theories and arbitrary groups in rosy theories, and characterize them as generics of connected type-definable subgroups.\n\nUsing tools from Keisler's randomization theory, we generalize some of these results from types to generically stable Keisler measures, and classify idempotent generically stable measures in abelian groups as (unique) translation-invariant measures on type-definable fsg subgroups. This provides a partial definable counterpart to the classical work of Rudin, Cohen and Pym for locally compact topological groups.\n\nFinally, we provide an explicit construction of a minimal left ideal in the convolution semigroup of measures for an arbitrary countable NIP group, from a minimal left ideal in the corresponding semigroup on types and a canonical measure constructed on its ideal subgroup. In order to achieve it, we in particular prove the revised Ellis group conjecture of Newelski for countable NIP groups.",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 1,
      "text": "## CONTENTS\n\n1. Introduction ..... 2\n2. Idempotent generically stable types ..... 9\n2.1. Generically stable types ..... 9\n2.2. Setting ..... 10\n2.3. Generically stable groups ..... 11\n2.4. Idempotent generically stable types and generic transitivity: main conjecture ..... 11\n2.5. Abelian groups ..... 14\n2.6. Inp-minimal groups ..... 15\n2.7. Stable theories ..... 16\n2.8. Stable types in arbitrary theories ..... 17\n2.9. Simple theories ..... 19\n2.10. Rosy theories ..... 19\n\n2.11. Generic transitivity of $p$ and stratified rank localized on $p$ 20\n2.12. Stabilizer of a generically transitive type is an intersection of definable groups 24\n2.13. Chain conditions for type-definable groups on a generically stable type 26\n3. Idempotent generically stable measures 30\n3.1. Overview 30\n3.2. Setting and notation 31\n3.3. Fim measures 31\n3.4. Fim measures over \"random\" parameters 34\n3.5. Definable pushforwards of Keisler measures 39\n3.6. Fim and fsg groups 41\n3.7. Idempotent fim measures and generic transitivity 44\n3.8. Idempotent fim measures in abelian groups 47\n3.9. Support transitivity of idempotent measures 49\n3.10. Idempotent measures in stable theories, revisited 50\n4. Topological dynamics of $\\mathfrak{M}_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ and $S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ in NIP groups 52\n4.1. Preliminaries from topological dynamics 53\n4.2. Minimal left ideal of $\\mathfrak{M}_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ 56\n5. Revised Newelski's conjecture for countable NIP groups 59\n6. Acknowledgements 68\nReferences 68",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 2,
      "text": "# 1. InTRODUCTION \n\nWe study idempotent measures and the structure of the convolution semigroups on measures in definable groups, as well as some related questions about topological dynamics of definable actions (continuing [CG22; CG23]).\n\nWe first recall the classical setting. If $G$ is a locally compact group and $\\mathcal{M}(G)$ is the space of regular Borel probability measures on $G$, one extends group multiplication on $G$ to convolution $*$ on $\\mathcal{M}(G)$ : if $\\mu, \\nu \\in \\mathcal{M}(G)$ and $B$ is a Borel subset of $G$, then\n\n$$\n(\\mu * \\nu)(B)=\\int_{G} \\int_{G} \\mathbf{1}_{B}(x \\cdot y) d \\mu(x) d \\mu(y)\n$$\n\nA measure $\\mu$ is idempotent if $\\mu * \\mu=\\mu$. A classical line of work established a correspondence between compact subgroups of $G$ and idempotent measures in $\\mathcal{M}(G)$, in progressively broader contexts [KI40; Wen54; Coh60; Rud59; Gli59] culminating in the following:\nFact 1.1. [Pym62, Theorem A.4.1] Let $G$ be a locally compact group and $\\mu \\in \\mathcal{M}(G)$. Then the following are equivalent:\n(1) $\\mu$ is idempotent.\n(2) The support $\\operatorname{supp}(\\mu)$ of $\\mu$ is a compact subgroup of $G$ and $\\left.\\mu\\right|_{\\operatorname{supp}(\\mu)}$ is the normalized Haar measure on $\\operatorname{supp}(\\mu)$.\n\nWe are interested in a counterpart of this phenomenon in the definable category. In the same way as e.g. algebraic or Lie groups are important in algebraic or differential geometry, the understanding of groups definable in a given first-order structure (or in certain classes of first-order structures) is important for model theory and its applications. The class of stable groups is at the core of model theory, and the corresponding theory was developed in the 1970s-1980s borrowing many ideas from the study of algebraic groups over algebraically closed fields (with corresponding notions of connected components, stabilizers, generics, etc., see [Poi01]). More recently, many of the ideas of stable group theory were extended to the class of NIP groups, which contains both stable groups and groups definable in o-minimal structures or over the $p$-adics. This led to multiple applications, e.g. a resolution of Pillay's conjecture for compact o-minimal groups [HPP08] or Hrushovski's work on approximate subgroups [Hru12], and brought to light the importance of the study of invariant measures on definable subsets of the group (see e.g. [Che18] for a short survey), as well as the methods of topological dynamics (introduced into the picture starting with Newelski [New09]). In particular, deep connections with tame dynamical systems as studied by Glasner, Megrelishvili and others (see e.g. [Gla07; Gla18]) have emerged, and play an important role in the current paper.\n\nMore precisely, we now let $G$ be a group definable in some structure $M$ (i.e. both the underlying set and multiplication are definable by formulas with parameters in $M$ ), it comes equipped with a collection of definable subsets of cartesian powers of $G$ closed under Boolean combinations, projection and Cartesian products (but does not carry topology or any additional structure a priori). We let $\\mathcal{U}$ be a \"non-standard\" elementary extension of $M$, and we let $G(\\mathcal{U})$ denote the group obtained by evaluating in $\\mathcal{U}$ the formulas used to define $G$ in $M$ (which in the case of an algebraic group corresponds to working in the universal domain, in the sense of Weil). So e.g. if we start with $M=(\\mathbb{R},+, \\times)$ the field of reals, and $G(M)$ its additive group, then $G(\\mathcal{U})$ is the additive group of a large real closed field extending $\\mathbb{R}$ which now contains infinitesimals - i.e., it satisfies a saturation condition: every small finitely consistent family of definable sets has non-empty intersection. It is classical in topological dynamics to consider the action of a discrete group $G$ on the compact space $\\beta G$ of ultrafilters on $G$, or more precisely ultrafilters on the Boolean algebra of all subsets of $G$. In the definable setting, given a definable group $G(M)$, we let $S_{G}(M)$ denote the space of ultrafilters on the Boolean algebra of definable subsets of $G(M)$, hence the space $S_{G}(M)$ (called the space of types of $G(M)$ ) is a \"tame\" analogue of the Stone-\u010cech compactification of the discrete group $G$. Then $G(M)$ acts on $S_{G}(M)$ by homeomorphisms, and the same construction applies to $G(\\mathcal{U})$ giving the space $S_{G}(\\mathcal{U})$ of ultrafilters on the definable subsets of $G(\\mathcal{U})$. Similarly, we let $\\mathfrak{M}_{G}(M)$ denote the space of finitely additive probability measures on the Boolean algebra of definable subsets of $G(M)$ (and $\\mathfrak{M}_{G}(\\mathcal{U})$ for $G(\\mathcal{U})$ ), it is\n\naffinely homeomorphic to the space of all regular $\\sigma$-additive Borel probability measures on $S_{G}(M)$ (respectively on $S_{G}(\\mathcal{U})$ ), with weak*-topology. The set $G(M)$ embeds into $S_{G}(\\mathcal{U})$ as realized types, and we let $S_{G, M}(\\mathcal{U})$ denote its closure (model theoretically, this corresponds to the set of global types in $S_{G}(\\mathcal{U})$ that are finitely satisfiable in $G(M)$ ). Similarly, we let $\\mathfrak{M}_{G, M}(\\mathcal{U})$ denote the closed convex hull of $G(M)$ in $\\mathfrak{M}_{G}(\\mathcal{U})$ (this is the set of global Keisler measures on $G(\\mathcal{U})$ finitely satisfiable in $G(M)$, equivalently the set of measures supported on $S_{G, M}(\\mathcal{U})$ - see [CG22, Proposition 2.11]). Similarly to the classical case, in many situations (including the ones discussed in the introduction) we have a well-defined convolution operation $*$ on $\\mathfrak{M}_{G, M}(\\mathcal{U})$ (see Definition 3.32 and the discussion around it).\n\nIn this context, generalizing a classical fact about idempotent types in stable groups [New91], we have the following definable counterpart of Fact 1.1 for stable groups:\n\nFact 1.2. [CG22, Theorem 5.8] Let $G$ be a (type-)definable group in a stable structure $M$ and $\\mu \\in \\mathfrak{M}_{G, M}(\\mathcal{U})$ a measure. Then $\\mu$ is idempotent if and only if $\\mu$ is the unique left-invariant (and the unique right-invariant) measure on a type-definable subgroup of $G(\\mathcal{U})$ (namely, the left-/right-stabilizer of $\\mu$ ).\n\nThis suggests a remarkable analogy between the topological and definable settings, even though Fact 1.2 is proved using rather different methods.\n\nIn the first part of the paper (Sections 2 and 3), we study generalizations of Fact 1.2 beyond the limited context of stable groups (we note that this correspondence fails in general NIP groups without an appropriate tameness assumption on the idempotent measure [CG23, Example 4.5]). An important class of groups arising in the work on Pillay's conjectures is that of groups with finitely satisfiable generics, or $f s g$ groups in short [HPP08]. It contains stable groups, as well as (definably) compact groups in o-minimal structures, and provides a natural counterpart to the role that compact groups play in Fact 1.2. By a well-known characterization in the NIP context (see e.g. [Sim15, Proposition 8.33]), these are precisely the groups that admit a (unique) translation-invariant measure $\\mu$ on their definable subsets which is moreover generically stable: a sufficiently long random sample of elements from the group uniformly approximates the measure of all sets in a definable family of subsets with high probability (i.e. $\\mu$ is a frequency interpretation measure, or fim measure, satisfying a uniform version of the weak law of large numbers - this notion is motivated by Vapnik-Chervonenkis theory, and serves as a correct generalization of generic stability for measures outside of NIP, by analogy with generically stable types in the sense of [PT11]); see Section 3.3). An analog of Fact 1.2 would thus amount to demonstrating that such subgroups are the only source of idempotent generically stable measures (see Problem 3.41).\n\nFirst, in Section 2 we focus on the case of idempotent types in $S_{G, M}(\\mathcal{U})$ (i.e. $\\{0,1\\}$-measures, equivalently ultrafilters on the Boolean algebra of definable subsets of $G$ ). After reviewing some preliminaries on generically\n\nstable types (Sections 2.1 and 2.4), we revise the case of groups in stable structures (Section 2.7), and then resolve the question in several important cases:\n\nTheorem 1.3. Assume $p \\in S_{G}(\\mathcal{U})$ is generically stable and idempotent, and one of the following holds:\n(1) $p$ is stable and $M$ is arbitrary (Proposition 2.29, see Section 2.8);\n(2) $G$ is abelian and $M$ is arbitrary (Proposition 2.18, see Section 2.5);\n(3) $G$ is arbitrary and $M$ is inp-minimal (Proposition 2.23, see Section 2.6);\n(4) $G$ is arbitrary and $M$ is rosy (so e.g. if $M$ has a simple theory; Proposition 2.35, see Sections 2.10 and 2.9).\nThen $p$ is the unique left-/right-invariant type on a type-definable subgroup of $G(\\mathcal{U})$ (namely, the left-/right-stabilizer of $p$ ).\n\nThe proof proceeds by establishing the crucial property of generic transitivity (see Section 2.4) for idempotent generically stable types in these cases, namely that if $\\left(a_{1}, a_{2}\\right) \\models p \\otimes p$, then $\\left(a_{1} \\cdot a_{2}, a_{1}\\right) \\models p \\otimes p$ (using local weight arguments in case (2), and the appropriate version of the theory of stratified ranks in the other cases). The question whether every generically stable idempotent type is generically transitive remains open, even for NIP groups (see Problem 2.15 and discussion in Section 2.4).\n\nWe further investigate generic transitivity, and demonstrate that it is a sufficient and necessary condition for developing some crucial results of stable group theory localizing on a generically stable type (some other elements of stable group theory for generically stable types were considered in [Wan22]). Sometimes we use a slightly stronger technical assumption that $p^{(n)}$ is generically stable for all $n$, which always holds in NIP structures. In Section 2.11, working in an arbitrary theory, we define an analog of the stratified rank in stable theories restricting to subsets of $G(\\mathcal{U})$ defined using parameters from a Morley sequence in a generically stable type $p$, demonstrate finiteness of this rank (Lemma 2.39) and show that this rank is left invariant (under multiplication by realizations of $p$ ) if and only if $p$ is generically transitive (Proposition 2.41). A fundamental theorem of Hrushovski [Hru90] demonstrates that in a stable theory, every type definable group (i.e. an intersection of definable sets that happens to be a group) is in fact an intersection of definable groups. The main result of Section 2.12 is an analog for generically transitive types:\n\nTheorem 1.4 (Proposition 2.44). If $G$ is type-definable and $p \\in S_{G}(\\mathcal{U})$ is generically stable, idempotent and generically transitive, then its stabilizer is an intersection of $M$-definable groups.\n\nFinally, in Section 2.13 we establish a chain condition for groups typedefinable using parameters from a Morley sequence of a generically stable type $p$, implying that there is a smallest group of this form - and it is equal\n\nto the stabilizer of $p$ when $p$ is generically transitive (see Lemma 2.46 and Proposition 2.50 for the precise statement).\n\nIn Section 3, we generalize some of these results from types (i.e. $\\{0,1\\}$ measures) to general measures, in arbitrary structures. Our main result is a definable counterpart of Fact 1.1 for arbitrary abelian group:\n\nTheorem 1.5. (Theorem 3.45) Let $G$ be an abelian group and $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ a generically stable measure. Then $\\mu$ is idempotent if and only if $\\mu$ is the unique left-invariant (and the unique right-invariant) measure on a typedefinable subgroup of $G(\\mathcal{U})$ (namely, its stabilizer).\n\nGroups as in Theorem 1.5, i.e. supporting an invariant generically stable measure, are called fim groups (see Section 3.6), and in the NIP case correspond precisely to fsg groups (but this is potentially a stronger condition in general). Our proof of Theorem 1.5 relies on several ingredients of independent interest. First, we develop some theory of fim groups, generalizing from fsg groups in NIP structures (Section 3.6). Then, in Section 3.4, we provide a characterization of generically stable measures of independent interest extending [CGH23a], demonstrating that the usual property - any Morley sequence determines the measure of arbitrary formulas by averaging along it - holds even when the parameters of these formulas are allowed to be \"random\". More precisely:\n\nTheorem 1.6 (Theorem 3.13). Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ be fim, $\\nu \\in \\mathfrak{M}_{y}(\\mathcal{U})$ arbitrary, $\\varphi(x, y, z)$ a formula, $b \\in \\mathcal{U}^{z}$, and let $\\mathbf{x}=\\left(x_{i}\\right)_{i \\in \\omega}$. Suppose that $\\lambda \\in \\mathfrak{M}_{\\mathbf{x} y}(\\mathcal{U})$ is arbitrary such that $\\left.\\lambda\\right|_{\\mathbf{x}, M}=\\mu^{(\\omega)}$ and $\\left.\\lambda\\right|_{y}=\\nu$. Then\n\n$$\n\\lim _{i \\rightarrow \\infty} \\lambda\\left(\\varphi\\left(x_{i}, y, b\\right)\\right)=\\mu \\otimes \\nu(\\varphi(x, y, b))\n$$\n\nMoreover for every $\\varepsilon>0$ there exists $n=n(\\mu, \\varphi, \\varepsilon) \\in \\mathbb{N}$ so that for any $\\nu, \\lambda, b$ as above, we have $\\lambda\\left(\\varphi\\left(x_{i}, y, b\\right)\\right) \\approx^{\\varepsilon} \\mu \\otimes \\nu(\\varphi(x, y, b))$ for all but $n$ many $i \\in \\omega$.\n\nThis is new even in the NIP case, and relies on the use of Keisler randomization theory. Namely, we use the correspondence between measures in $G(\\mathcal{U})$ and types in its randomization, viewed as a structure in continuous logic, that was introduced in [BY09] (and studied further in [CGH23a]). It allows us to imitate in Section 3.8 the bounded local weight argument from Section 2.5 in a purely measure theoretic context, using an adapted version of generic transitivity (see Section 3.7) and arguments with pushforwards.\n\nProblem 2.15 on whether every generically stable idempotent type is generically transitive generalizes to measures (see Problem 3.41). In Section 3.9 , we distinguish a weaker property of a measure than being generically transitive, which we call support transitivity. It leads to a weaker conjecture saying that every generically stable idempotent measure is support transitive (see Problem 3.48). While this conjecture is open, it trivially holds for idempotent types, and so one can expect that if the techniques used for types in Sections 2.7-2.10 could be adapted to measures, they would\n\nrather not prove the main conjecture that every generically stable idempotent measure is generically transitive, but reduce it to the above weakening. The idea is to pass to the randomization of the structure in question, and if this randomization happens to have a well-behaved stratified rank, then apply a continuous logic version of the arguments from Sections 2.7-2.10. In Section 3.10, we illustrate how it works for stable theories (recall that stability is preserved under randomization).\n\nIn Section 4, instead of considering an individual (idempotent) measure, we study the structure of the (left-continuous compact Hausdorff) semigroup $\\left(\\mathfrak{M}_{G, M}(\\mathcal{U}), *\\right)$ of measures on a definable NIP group under convolution, through the lens of Ellis theory. It was demonstrated in [CG23, Theorem 5.1] that the ideal (or Ellis) subgroup of any minimal left ideal is always trivial, and that when $G$ is definably amenable (i.e. admits a leftinvariant finitely additive probability measure on its definable subsets), then any minimal left ideal itself is trivial, but has infinitely many extreme points when $G$ is not definably amenable. In the general, non-definably amenable case, a description of a minimal left ideal in $\\left(\\mathfrak{M}_{G, M}(\\mathcal{U}), *\\right)$ was obtained under some additional strong assumptions (see [CG23, Theorem 6.11] and discussion at the end of Section 4.2). Here we obtain a description of a minimal left ideal of $\\left(\\mathfrak{M}_{G, M}(\\mathcal{U}), *\\right)$ for an arbitrary countable NIP group:\n\nTheorem 1.7 (Corollary 5.18). Assume that $G$ is group definable in a countable NIP structure $M$, and let $\\mathcal{M}$ be a minimal left ideal in $\\left(S_{G, M}(\\mathcal{U}), *\\right)$ and $u \\in \\mathcal{M}$ an idempotent. Then the ideal group $u \\mathcal{M}$ carries a canonical invariant Keisler measure $\\mu_{u \\mathcal{M}}$ (see Proposition 4.15 for the definition), and $\\mathfrak{M}(\\mathcal{M}) * \\mu_{u \\mathcal{M}}$ is a minimal left ideal of $\\left(\\mathfrak{M}_{G, M}(\\mathcal{U}), *\\right)$, where $\\mathfrak{M}(\\mathcal{M})$ denotes the space of all measures supported on $\\mathcal{M}$, and $\\mu_{u \\mathcal{M}}$ is an idempotent in $\\mathfrak{M}(\\mathcal{M}) * \\mu_{u \\mathcal{M}}$.\n\nTheorem 1.7 is deduced using a combination of two results of independent interest that we now discuss.\n\nAn important general fact from topological dynamics is that the ideal group $u \\mathcal{M}$ of the Ellis semigroup of any flow is always a compact $T_{1}$ (not necessarily Hausdorff) semi-topological group (i.e. multiplication is separately continuous) with respect to a canonical topology, the so called $\\tau$-topology (which is weaker than the induced topology from the Ellis semigroup). This topology was defined by Ellis and has played an essential role in the most important structural results in abstract topological dynamics, starting from the Furstenberg structure theorem for minimal distal flows (e.g. see [Aus88]) and ending with a recent theorem of Glasner on the structure of tame, metrizable, minimal flows [Gla18]. In model theory, the $\\tau$-topology on the ideal groups played a key role in applications to the quotients of definable groups by their model-theoretic connected components ([KP17]) and to Lascar strong types and quotients by arbitrary bounded invariant equivalence relations [KPR18; KR20]. It also partly motivated the work of Hrushovski on definability patterns structures with spectacular applications to additive\n\ncombinatorics [Hru19; Hru20]. In [KP23], the $\\tau$-topology was used to give a shorter and simpler proof of the main result of [Hru20]. As the key result of Section 4 we demonstrate the following:\n\nTheorem 1.8. (Lemma 4.14) Assume that $G$ is group definable in an arbitrary NIP structure $M$, and that the $\\tau$-topology on the ideal group $u \\mathcal{M}$ of the $G(M)$-flow $S_{G, M}(\\mathcal{U})$ is Hausdorff. Then for any clopen subset $C$ of $S_{G}(\\mathcal{U})$, the subset $C \\cap u \\mathcal{M}$ of $u \\mathcal{M}$ is constructible, and so Borel, in the $\\tau$-topology.\n\nIt follows that when the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff, the ideal group $u \\mathcal{M}$ is a compact topological group (Corollary 4.9), so we have the unique (normalized) Haar measure $h_{u \\mathcal{M}}$ on Borel subsets, and by Theorem 1.8 it induces the aforementioned Keisler measure $\\mu_{u \\mathcal{M}} \\in \\mathfrak{M}_{G}(\\mathcal{U})$ via $\\mu_{u \\mathcal{M}}(\\varphi(x)):=$ $h_{u \\mathcal{M}}([\\varphi(x)] \\cap u \\mathcal{M})$ (Proposition 4.15). This reduces the question to understanding when the $\\tau$-topology is Hausdorff - which is precisely the revised version of Newelski's conjecture (see [KP23, Conjecture 5.3]).\n\nThe Ellis group conjecture of Newelski [New09] is an important prediction in the study of NIP groups connecting a canonical model-theoretic quotient of a definable group $G(M)$ and a dynamical invariant of its natural action on $S_{G, M}(\\mathcal{U})$. Let $G$ be a group definable in a structure $M$, and let $u \\mathcal{M}$ be the ideal (Ellis) group of the $G(M)$-flow $\\left(G(M), S_{G, M}(\\mathcal{U})\\right)$. We let $G_{M}^{00}$ be the smallest type-definable over $M$ subgroup of $G(\\mathcal{U})$ of bounded index. The Ellis group conjecture of Newelski says that the group epimorphism $\\theta: u \\mathcal{M} \\rightarrow G(\\mathcal{U}) / G_{M}^{00}$ given by $\\theta(p):=a / G_{M}^{00}$, for a type $p \\in u \\mathcal{M}$ and $a$ a realization of $p$, is an isomorphism under suitable tameness assumptions on the ambient theory. This conjecture was established for definably amenable groups definable in $o$-minimal structures in [CPS14], and for definably amenable groups in arbitrary NIP structures in [CS18]. On the other hand, it was refuted for $\\mathrm{SL}_{2}(\\mathbb{R})$ in [GPP15]. Newelski's epimorphism $\\theta$ was refined in [KP17] to a sequence of epimorphisms\n\n$$\nu \\mathcal{M} \\rightarrow u \\mathcal{M} / H(u \\mathcal{M}) \\rightarrow G(\\mathcal{U}) / G_{M}^{000} \\rightarrow G(\\mathcal{U}) / G_{M}^{00}\n$$\n\nwhere $G_{M}^{000}$ is the smallest bounded index subgroup of $G(\\mathcal{U})$ invariant under the action of $\\operatorname{Aut}(\\mathcal{U} / M)$, and $H(u \\mathcal{M})$ is the subgroup of $u \\mathcal{M}$ given by the intersection of the $\\tau$-closures of all $\\tau$-neighborhoods of $u$. With this refinement, Newelski's conjecture fails when $G_{M}^{000} \\neq G_{M}^{00}$, in which case also $u \\mathcal{M} / H(u \\mathcal{M}) \\rightarrow G(\\mathcal{U}) / G_{M}^{000}$ is not an isomorphism. The first such example, the universal cover $\\widehat{\\mathrm{SL}_{2}(\\mathbb{R})}$ of $\\mathrm{SL}_{2}(\\mathbb{R})$, was found in [CP12], and further examples were given in [GK15]. On the other hand, no examples of NIP groups with non-trivial $H(u \\mathcal{M})$ (equivalently, with $u \\mathcal{M}$ not Hausdorff in the $\\tau$-topology) were known. This motivated the following weakening of Newelski's conjecture:\n\nConjecture 1.9. [KP23, Conjecture 5.3] If $M$ is NIP, then the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff.\n\nIt clearly holds whenever $u \\mathcal{M}$ is finite. It is also known to hold for definably amenable groups in NIP theories, as the full Newelski's conjecture holds in this context. Besides those two general situations, it was confirmed only for $\\mathrm{SL}_{2}(\\mathbb{R})$ (we refer to [KP23, Section 5] for a proof and a more detailed discussion).\n\nIn Section 5 we establish the revised Newelski's conjecture for countable NIP groups:\n\nTheorem 1.10 (Theorem 5.17). The revised Newelski's conjecture holds when $G$ is a definable group in a countable NIP structure.\n\nThis relies on the fundamental theorem of Glasner describing the structure of minimal tame metrizable flows [Gla18] and a presentation of the $G(M)$ flow $S_{G, M}(\\mathcal{U})$ as the inverse limit of all $S_{G, \\Delta}(M)$ (the Stone space of the $G(M)$-algebra generated by the finite set $\\Delta$ ), where $\\Delta$ ranges over all finite collections of externally definable subsets of $G(M)$.",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 3,
      "text": "# 2. Idempotent Generically Stable Types \n\nThroughout this section, we let $T$ be a complete theory, $M \\models T$, and $\\mathcal{U} \\succ M$ a monster model.\n2.1. Generically stable types. We will need some basic facts about generically stable types. As usual, given a global type $p \\in S_{x}(\\mathcal{U})$ (automorphism)invariant over a small set $A \\subseteq \\mathcal{U}$ and $\\mathcal{U}^{\\prime} \\succ \\mathcal{U}$ a bigger monster model with respect to $\\mathcal{U}$, we let $\\left.p\\right|_{\\mathcal{U}^{\\prime}}$ be the unique extension of $p$ to a type in $S_{x}\\left(\\mathcal{U}^{\\prime}\\right)$ which is invariant over $A$. Given another $A$-invariant type $q \\in S_{p}(\\mathcal{U})$, we define the $A$-invariant type $p \\otimes q \\in S_{x_{p}}(\\mathcal{U})$ via $p \\otimes q:=\\operatorname{tp}(a b / \\mathcal{U})$ for some/any $a, b$ in $\\mathcal{U}^{\\prime}$ such that $b \\models q$ and $a \\models p \\mid_{\\mathcal{U} b}$. Given an arbitrary linear order $(I,<)$, a sequence $\\bar{a}=\\left(a_{i}: i \\in I\\right)$ in $\\mathcal{U}$ is a Morley sequence in $p$ over $A$ if $a_{i} \\models p \\mid A a_{<i}$ for all $i \\in I$. Then the sequence $\\bar{a}$ is indiscernible over $A$, and for any other Morley sequence $\\bar{a}^{\\prime}=\\left(a_{i}^{\\prime}: i \\in I\\right)$ in $p$ over $A$ we have $\\operatorname{tp}(\\bar{a} / A)=\\operatorname{tp}\\left(\\bar{a}^{\\prime} / A\\right)$. We can then define a global $A$-invariant type $p^{(I)}\\left(\\left(x_{i}: i \\in I\\right)\\right) \\in S_{\\bar{x}}(\\mathcal{U})$ as\n$\\bigcup\\left\\{\\operatorname{tp}(\\bar{a} / B): A \\subseteq B \\subseteq \\mathcal{U}\\right.$ small, $\\left.\\bar{a}=\\left(a_{i}: i \\in I\\right)\\right.$ a Morley sequence in $p$ over $\\left.B\\right\\}$.\nEquivalently, $p^{(I)}=\\operatorname{tp}(\\bar{a} / \\mathcal{U})$ for $\\bar{a}=\\left(a_{i}: i \\in I\\right)$ a Morley sequence in $p_{\\mathcal{U}^{\\prime}}$ over $\\mathcal{U}$, where $\\mathcal{U}^{\\prime} \\succ \\mathcal{U}$ be a monster model with respect to $\\mathcal{U}$ and $p_{\\mathcal{U}^{\\prime}}$ is the unique extension of $p$ to a type in $S_{x}\\left(\\mathcal{U}^{\\prime}\\right)$ which is invariant over $A$. For any $k \\in \\omega$ (viewed as an ordinal) we have $p^{(k)}\\left(x_{1}, \\ldots, x_{k}\\right)=p\\left(x_{k}\\right) \\otimes \\ldots \\otimes p\\left(x_{1}\\right)$.\n\nWe do not assume NIP unless explicitly stated, and use the standard definition from [PT11]: a global type $p \\in S_{x}(\\mathcal{U})$ is generically stable if it is $A$-invariant for some small $A \\subset \\mathcal{U}$, and for any ordinal $\\alpha$ (or just for $\\alpha=\\omega+\\omega),\\left(a_{i}: i \\in \\alpha\\right)$ a Morley sequence in $p$ over $A$ and formula $\\varphi(x) \\in \\mathcal{L}(\\mathcal{U})$, the set $\\left\\{i \\in \\alpha:=\\varphi\\left(a_{i}\\right)\\right\\}$ is either finite or co-finite.\n\nIn the following fact, items (1)-(4) can be found in [Cas11, Section 9], (5) in [GOU13, Theorem 2.4], (6) is an immediate consequence of stationarity in (2), and (7) is [PT11, Proposition 2.1]. We let $\\perp$ denote forking independence. We will freely use some of the basic properties of forking in arbitrary theories, e.g. extension and left transitivity, see [CK12, Section 2] for a reference.\n\nFact 2.1. Let $p \\in S_{x}(\\mathcal{U})$ be a generically stable type, invariant over a small subset $A \\subseteq \\mathcal{U}$. Then the following hold.\n(1) Every realization of $\\left.p^{(\\omega)}\\right|_{A}$ is a totally indiscernible sequence over $A$.\n(2) The type $p$ is the unique global non-forking extension of $\\left.p\\right|_{A}$.\n(3) For any $a\\models p \\mid A$ and $b$ in $\\mathcal{U}$ such that $\\operatorname{tp}(b / A)$ does not fork over $A$, we have $a \\perp_{A} b \\Longleftrightarrow b \\perp_{A} a$ (this holds for any $b$ when $A$ is an extension base, e.g. when $A \\prec \\mathcal{U}$ ).\n(4) In particular, if $a, b \\models p \\mid A$, then $a \\perp_{A} b \\Longleftrightarrow(a, b) \\models p^{(2)} \\mid A \\Longleftrightarrow$ $(b, a) \\models p^{(2)} \\mid A$.\n(5) If $A$ is an extension base, $\\left(a_{i}\\right)_{i<\\omega} \\models p^{(\\omega)} \\mid A$ and $\\varphi\\left(x, a_{0}\\right)$ (where $\\varphi(x, y) \\in \\mathcal{L}(A))$ forks/divides over $A$, then $\\left\\{\\varphi\\left(x, a_{i}\\right): i<\\omega\\right\\}$ is inconsistent.\n(6) Let $a \\models p \\mid A$ and let $b, c$ be arbitrary small tuples in $\\mathcal{U}$. If $a \\perp_{A} b$ and $a \\perp_{A b} c$, then $a \\perp_{A} b c$;\n(7) $p$ is definable over $A$.\n\nRemark 2.2. By Fact 2.1(1), for a global generically stable type $p$ invariant over $A$, we will also be using (without mentioning) an equivalent definition of a Morley sequence with the reversed order. That is, given a linear order $(I,<)$, we might say that $\\left(a_{i}: i \\in I^{*}\\right)$ is a Morley sequence in $p$ over $A$ if $a_{i} \\models p \\mid A a_{<i}$ for all $i \\in I$, where $I^{*}$ is $I$ with the reversed ordering. So e.g. we will refer to $\\left(a_{k}, a_{k-1}, \\ldots, a_{1}\\right)$ with $a_{i} \\models p \\mid A a_{1} \\ldots a_{i-1}$ as a Morley sequence in $p$ over $A$, and write $\\left(a_{k}, \\ldots, a_{1}\\right) \\models p^{(k)}$. We will frequently use this without further mention.\n\nFact 2.3. [DK12, Proposition 1.2] Let $p \\in S_{x}(\\mathcal{U})$ be a generically stable type, invariant over a small set of parameters $A \\subseteq \\mathcal{U}$. Suppose that $\\mathcal{U} \\prec \\mathcal{U}^{\\prime}$, $a$ is an element of $\\mathcal{U}^{\\prime}$ such that $a \\models p$, and $b \\in \\operatorname{dcl}(a, A)$. Then $\\operatorname{tp}(b / \\mathcal{U})$ is generically stable over $A$.\n2.2. Setting. Let $G=G(x)$ be an $\\emptyset$-type-definable group (in the sort of $\\mathcal{U}$ corresponding to the tuple of variables $x$ ) and $\\bar{G}:=G(\\mathcal{U})$. By $\\cdot$ we mean an $\\emptyset$-definable function (from $\\left(\\mathcal{U}^{x}\\right)^{2}$ to $\\mathcal{U}^{x}$ ) whose restriction to $G$ is the group operation on $G$. Similarly, by ${ }^{-1}$ we mean an $\\emptyset$-definable function (from $\\mathcal{U}^{x}$ to $\\mathcal{U}^{x}$ ) whose restriction to $G$ is the inverse in $G$. By compactness, we can fix a formula $\\varphi_{0}(x) \\in \\mathcal{L}$ implied by the partial type $G(x)$ such that: $\\cdot$ is defined and associative on $\\varphi_{0}(\\mathcal{U}) ; a \\cdot e=a=e \\cdot a$ and $a \\cdot a^{-1}=a^{-1} \\cdot a=e$ for all $a \\in \\varphi_{0}(\\mathcal{U})$; if $b_{1} \\neq b_{2}$ then $a \\cdot b_{1} \\neq a \\cdot b_{2}, b_{1} \\cdot a \\neq b_{2} \\cdot a$ for all $a, b_{1}, b_{2} \\in \\varphi_{0}(\\mathcal{U})$ (but $\\varphi_{0}(\\mathcal{U})$ is not necessarily closed under $\\cdot$ ). As usual, for\n\n$A \\subseteq \\mathcal{U}, S_{G}(A)$ denotes the set of types $p \\in S(A)$ concentrated on $G$, i.e. such that $p(x) \\vdash G(x)$.\n\nGiven $p, q \\in S_{G}(\\mathcal{U})$ global $M$-invariant types $(M \\prec \\mathcal{U})$, we define $p * q \\in$ $S_{G}(\\mathcal{U})$ via $p * q(\\varphi(x)):=p_{x} \\otimes q_{y}(\\varphi(x \\cdot y))$ for all $\\varphi(x) \\in \\mathcal{L}(U)$. Together with this operation, the set of all global $M$-invariant types in $S_{G}(\\mathcal{U})$ forms a left-continuous semigroup. We say that an invariant type $p \\in S_{G}(\\mathcal{U})$ is idempotent if $p * p=p$.",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 4,
      "text": "# 2.3. Generically stable groups. \n\nDefinition 2.4. [PT11, Definition 2.1] A type-definable group $G(x)$ is generically stable if there is a generically stable $p \\in S_{G}(\\mathcal{U})$ which is left $G(\\mathcal{U})$ invariant (we might use \" $G(\\mathcal{U})$-invariant\" and \" $G$-invariant\" interchangeably when talking about global types).\n\nFact 2.5. [PT11, Lemma 2.1] Suppose that $G$ is a generically stable typedefinable group in an arbitrary theory, witnessed by a generically stable type $p \\in S_{G}(\\mathcal{U})$. Then we have:\n(1) $p$ is the unique left $G(\\mathcal{U})$-invariant and also the unique right $G(\\mathcal{U})$ invariant type;\n(2) $p=p^{-1}$ (where $p^{-1}:=\\operatorname{tp}\\left(g^{-1} / \\mathcal{U}\\right)$ for some/any $g \\models p$ in a bigger monster model $\\left.\\mathcal{U}^{\\prime} \\succ \\mathcal{U}\\right)$.\n\nBy Fact 2.4 and its symmetric version, we get:\nCorollary 2.6. A type-definable group $G(x)$ is generically stable if and only if there is a generically stable $p \\in S_{G}(\\mathcal{U})$ which is right $G(\\mathcal{U})$-invariant.",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 5,
      "text": "### 2.4. Idempotent generically stable types and generic transitivity: main conjecture. Let $p \\in S_{G}(\\mathcal{U})$ be a generically stable type over $M$. The following is standard:\n\nProposition 2.7. The left stabilizer $\\operatorname{Stab}(p)$ of $p$ is an intersection of relatively $M$-definable subgroups of $\\bar{G}$; in particular, it is $M$-type-definable.\n\nProof. By compactness, we can find a formula $\\varphi_{1}(x) \\in \\mathcal{L}$ implied by $G(x)$ such that $\\varphi_{1}(\\bar{G}) \\cdot \\bar{G} \\subseteq \\varphi_{0}(\\bar{G})$.\n\nSince $p$ is generically stable over $M$, it is definable over $M$ (by Fact 2.1(7)). For any formula $\\varphi(x, y) \\in \\mathcal{L}$ which implies $\\varphi_{1}(x)$ (and $y$ is an arbitrary tuple of variables) let\n\n$$\nd_{p} \\varphi:=\\left\\{(h, a) \\in \\varphi_{0}(\\mathcal{U}) \\times \\mathcal{U}^{g}: \\varphi(h \\cdot x, a) \\in p\\right\\}\n$$\n\nBy the definability of $p$ over $M, d_{p} \\varphi$ is definable over $M$. Then\n\n$$\n\\operatorname{Stab}_{\\varphi}(p):=\\left\\{g \\in \\bar{G}: g \\cdot d_{p} \\varphi=d_{p} \\varphi\\right\\}\n$$\n\nwhere $g \\cdot(h, a):=\\left(h \\cdot g^{-1}, a\\right)$, is an $M$-relatively definable subgroup of $\\bar{G}$ (the fact that it is a subgroup of $G$ follows from the observation that it is the stabilizer of the set $d_{p} \\varphi$ under the left action of $G$ on $\\varphi_{0}(\\mathcal{U}) \\cdot \\bar{G} \\times \\mathcal{U}^{g}$ given by $g \\cdot(h, a):=\\left(h \\cdot g^{-1}, a\\right)$, which uses the choice of $\\varphi_{0}(x)$ ). By the\n\nchoice of $\\varphi_{1}(x)$, we get that $\\operatorname{Stab}(p)=\\bigcap_{\\varphi(x, y) \\in \\mathcal{L}, \\varphi(x, y) \\vdash \\varphi_{1}(x)} \\operatorname{Stab}_{\\varphi}(p)$ is an intersection of relatively $M$-definable subgroups of $G$.\n\nExample 2.8. Let $G^{\\prime}$ be an arbitrary type-definable subgroup of $G$ which is generically stable, witnessed by a generically stable left or right $G^{\\prime}$-invariant type $p \\in S_{G^{\\prime}}(\\mathcal{U})$. Then $p$ is obviously idempotent.\n\nOur central question in the case of types is whether this is the only source of generically stable idempotent types:\nDefinition 2.9. For the rest of the section, we let $H_{\\ell}:=\\operatorname{Stab}_{\\ell}(p)$ and $H_{\\mathrm{r}}:=\\operatorname{Stab}_{\\mathrm{r}}(p)$ be the left and the right stabilizer of $p$, respectively.\n\nProblem 2.10. Assume that $p$ is generically stable and idempotent, and let $H=H_{\\ell}$ or $H=H_{\\mathrm{r}}$. Is it true that $p \\in S_{H}(\\mathcal{U})$ and the group $H$ is generically stable (Definition 2.4)?\n\nWe will note now that the second part follows from the first, and that the left and the right versions of the problem are equivalent.\nRemark 2.11. Assume $p$ is generically stable and $p \\in S_{H}(\\mathcal{U})$, where $H=$ $H_{\\ell}$ or $H=H_{\\mathrm{r}}$. Then:\n(1) $H$ is a generically stable group, witnessed by $p$ (hence $p$ is both the unique left-invariant and the unique right-invariant type of $H$, by Fact 2.5);\n(2) $H$ is the smallest among all type-definable subgroups $H^{\\prime}$ of $G$ with $p \\in S_{H^{\\prime}}(\\mathcal{U})$;\n(3) $H$ is both the left and the right stabilizer of $p$ in $G$.\n\nProof. We will do the case of $H=H_{\\ell}$. The proof for $H=H_{\\mathrm{r}}$ is symmetric.\n(1) As then $p$ is a left $H$-invariant generically stable type in $S_{H}(\\mathcal{U})$.\n(2) $H$ is type-definable by Proposition 2.7. For any type-definable $H^{\\prime} \\leq$ $G(\\mathcal{U})$ with $p(x) \\vdash H^{\\prime}(x)$, the group $H^{\\prime \\prime}:=H \\cap H^{\\prime}$ is type-definable with $p(x) \\vdash H^{\\prime \\prime}(x)$ and $H^{\\prime \\prime} \\leq H$. If the index is $\\geq 2$, we have some $g \\in H$ with $H^{\\prime \\prime} \\cap g \\cdot H^{\\prime \\prime}=\\emptyset$, and $p(x) \\vdash H^{\\prime \\prime}(x),(g \\cdot p)(x) \\vdash\\left(g \\cdot H^{\\prime \\prime}\\right)(x)$, so $p \\neq g \\cdot p-$ a contradiction. So $H^{\\prime \\prime}=H$, and $H \\subseteq H^{\\prime}$.\n(3) $H_{r}$ is type-definable by a symmetric argument as in Proposition 2.7. By (1), $p$ is right $H$-invariant, so we have $H \\subseteq H_{r}$, and so $p \\in S_{H_{r}}(\\mathcal{U})$. By the right version of (2) (which is obtained by a symmetric argument as in (2)), we conclude that $H=H_{r}$.\n\nBy Remark 2.11, we see that $p \\in S_{H_{f}}(\\mathcal{U})$ if and only if $p \\in S_{H_{r}}(\\mathcal{U})$, so the left and the right versions of Problem 2.10 are indeed equivalent.\n\nLet $p \\in S_{G}(\\mathcal{U})$ be a generically stable type. Let $\\mathcal{U}^{\\prime} \\succ \\mathcal{U}$ be a monster model with respect to $\\mathcal{U}$ and $p^{\\prime}:=\\left.p\\right|_{\\mathcal{U}^{\\prime}}$ (the unique extension of $p$ to a type in $S_{G}\\left(\\mathcal{U}^{\\prime}\\right)$ which is invariant over $M$ ). Then still $p^{\\prime}$ is definable over $M$ and $H\\left(\\mathcal{U}^{\\prime}\\right)=\\operatorname{Stab}\\left(p^{\\prime}\\right)$. Pick an arbitrary $a \\in p\\left(\\mathcal{U}^{\\prime}\\right)$.\n\nLet $p \\in S_{G}(\\mathcal{U})$ be a generically stable type, and let $\\mathcal{U}^{\\prime} \\succ \\mathcal{U}$ be a monster model with respect to $\\mathcal{U}$ and $p^{\\prime}:=\\left.p\\right|_{\\mathcal{U}^{\\prime}}$ (the unique extension of $p$ to a type\n\nin $S_{G}\\left(\\mathcal{U}^{\\prime}\\right)$ which is invariant over $M$ ). Then still $p^{\\prime}$ is definable over $M$ and $H_{\\ell}\\left(\\mathcal{U}^{\\prime}\\right)=\\operatorname{Stab}_{\\ell}\\left(p^{\\prime}\\right), H_{\\mathrm{r}}\\left(\\mathcal{U}^{\\prime}\\right)=\\operatorname{Stab}_{\\mathrm{r}}\\left(p^{\\prime}\\right)$. Pick an arbitrary $a \\in p\\left(\\mathcal{U}^{\\prime}\\right)$.\nRemark 2.12. The following conditions are equivalent for a generically stable type $p$ :\n(1) $p \\in S_{H_{\\ell}}(\\mathcal{U})$;\n(2) $a \\in \\operatorname{Stab}_{\\ell}\\left(p^{\\prime}\\right)$;\n(3) for any (equivalently, some) $\\left(a_{0}, a_{1}\\right) \\models p^{(2)},\\left(a_{0} \\cdot a_{1}, a_{0}\\right) \\models p^{(2)}$;\n(4) $p \\in S_{H_{\\ell}}(\\mathcal{U})$;\n(5) $a \\in \\operatorname{Stab}_{\\mathrm{r}}\\left(p^{\\prime}\\right)$;\n(6) for any (equivalently, some) $\\left(a_{0}, a_{1}\\right) \\models p^{(2)},\\left(a_{1} \\cdot a_{0}, a_{0}\\right) \\models p^{(2)}$.\n\nProof. (1) $\\Rightarrow$ (2). This is because $a \\in p\\left(\\mathcal{U}^{\\prime}\\right) \\subseteq H_{\\ell}\\left(\\mathcal{U}^{\\prime}\\right)=\\operatorname{Stab}_{\\ell}\\left(p^{\\prime}\\right)$, where the inclusion follows by (1).\n$(2) \\Rightarrow(3)$. Pick $b \\models p^{\\prime}$. Then $(a, b) \\models p^{(2)}$ and $a \\cdot b \\models p^{\\prime}$ by (2). So $(a \\cdot b, a) \\models p^{(2)}$.\n(3) $\\Rightarrow$ (1). Suppose (1) fails. Then $a \\notin H_{\\ell}\\left(\\mathcal{U}^{\\prime}\\right)=\\operatorname{Stab}_{\\ell}\\left(p^{\\prime}\\right)$. So for any $b \\models p^{\\prime}$ we have that $a \\cdot b$ does not realize $p^{\\prime}$. Using Fact 2.1, this implies that $a \\cdot b$ does not realize $\\left.p\\right|_{\\mathcal{U} a}$, because otherwise, since $a \\cdot b \\perp_{\\mathcal{U} a} \\mathcal{U}^{\\prime}$ (which follows from $b \\perp_{\\mathcal{U} a} \\mathcal{U}^{\\prime}$ and left transitivity of forking), $\\operatorname{tp}\\left(a \\cdot b / \\mathcal{U}^{\\prime}\\right)$ is the unique non-forking extension of $\\left.p\\right|_{\\mathcal{U} a}$ which is exactly $p^{\\prime}$, a contradiction. Thus, $(a \\cdot b, a)$ does not realize $p^{(2)}$ which contradicts (3).\n$(4) \\Rightarrow(5) \\Rightarrow(6) \\Rightarrow(4)$ are obtained by symmetric arguments to the above ones.\n$(1) \\Leftrightarrow(4)$ follows from Remark 2.11.\nDefinition 2.13. We will say that a generically stable type $p \\in S_{G}(\\mathcal{U})$ is generically transitive if it satisfies any of the equivalent conditions in Remark 2.12 .\n\nRemark 2.14. We have chosen this terminology to highlight the connection of condition (3) in Remark 2.12(3) and the generic transitivity assumption in Hrushovski's group chunk theorem (see e.g. [Bay18, Section 5.1]).\n\nIn view of Remark 2.12, our main Problem 2.10 is equivalent to the following:\nProblem 2.15. Assume that $p$ is generically stable and idempotent. Is it then generically transitive?\n\nIn the following sections, we will provide a positive solution under some additional assumptions on the group. We will also see that elements of stable group theory (stratified rank, connected components, etc.) can be developed in an arbitrary theory localizing on a generically stable type $p$, if and only said type $p$ is generically transitive.\n\nWe conclude this section with a couple of additional observations.\nLemma 2.16. If $p \\in S_{G}(\\mathcal{U})$ is generically stable over $M$ and idempotent, then the type $p^{-1}:=\\operatorname{tp}\\left(a^{-1} / \\mathcal{U}\\right)$ for some/any $a \\models p$ is also generically stable over $M$ and idempotent.\n\nProof. Assume the hypothesis. Then $p^{-1}$ is generically stable over $M$ by Fact 2.3. It follows that $p^{-1} * p^{-1}$ is definable over $M$ (see e.g. [CG22, Proposition 3.15]). Since $p^{-1}$ is the unique extension of $\\left.p^{-1}\\right|_{M}$ definable over $M$, it suffices to show that $\\left.\\left(p^{-1} * p^{-1}\\right)\\right|_{M}=\\left.p^{-1}\\right|_{M}$. Let $b_{1} \\models p^{-1} \\|_{M}$ and $b_{2} \\models p^{-1} \\mid M b_{1}$. Clearly $b_{1}^{-1} \\models p \\|_{M}$ and $b_{2}^{-1} \\models p \\mid M b_{1}$ and so $\\left(b_{2}^{-1}, b_{1}^{-1}\\right) \\models$ $\\left.p^{(2)}\\right|_{M}$. Since $p$ is idempotent, we conclude that $b_{1}^{-1} \\cdot b_{2}^{-1} \\models p \\|_{M}$ and in particular $\\left(b_{2} \\cdot b_{1}\\right) \\models p^{-1} \\|_{M}$. For any $\\varphi(x) \\in \\mathcal{L}_{x}(M)$ we have\n\n$$\n\\begin{aligned}\n& \\varphi(x) \\in p^{-1} * p^{-1} \\Longrightarrow \\varphi(x \\cdot y) \\in p_{x}^{-1} \\otimes p_{y}^{-1} \\Longrightarrow \\varphi\\left(x \\cdot b_{1}\\right) \\in p_{x}^{-1} \\\\\n& \\Longrightarrow \\models \\varphi\\left(b_{2} \\cdot b_{1}\\right) \\Longrightarrow \\varphi(x) \\in \\operatorname{tp}\\left(b_{2} \\cdot b_{1} / M\\right) \\Longrightarrow \\varphi(x) \\in p^{-1} \\|_{M}\n\\end{aligned}\n$$\n\nhence $\\left.\\left(p^{-1} * p^{-1}\\right)\\right|_{M}=\\left.p^{-1}\\right|_{M}$.\nRemark 2.17. If $p$ is generically transitive, then $p=p^{-1}$.\nIndeed, by Remarks 2.12 and 2.11 it follows that if $p$ is generically transitive, then $p \\in S_{H_{\\ell}}(\\mathcal{U})$ witnesses that $H_{\\ell}$ is generically stable, hence $p=p^{-1}$ by Fact 2.5 .\n2.5. Abelian groups. In this section we give a positive answer to Problem 2.10 in the case of abelian groups (in arbitrary theories):\n\nProposition 2.18. Assume that $G$ is an abelian group and $p \\in S_{G}(\\mathcal{U})$ is a generically stable idempotent type. Then $p$ is generically transitive.\n\nProof. Let $M \\prec \\mathcal{U}$ be any small model such that $p$ is $M$-invariant. Let $\\left(a_{1}, a_{0}\\right) \\models p^{(2)} \\|_{M}$ be given, and assume towards contradiction that $\\left(a_{1} \\cdot\\right.$ $\\left.a_{0}, a_{0}\\right) \\not \\models p^{(2)} \\|_{M}$, then $a_{1} \\cdot a_{0} \\not \\subset_{M} a_{0}$ by Fact 2.1(4). Let $\\varphi(x, y) \\in \\mathcal{L}(M)$ be such that $\\models \\varphi\\left(a_{1} \\cdot a_{0}, a_{0}\\right)$ and $\\varphi\\left(x, a_{0}\\right)$ forks over $M$. We extend $\\left(a_{1}, a_{0}\\right)$ to a Morley sequence $\\left(a_{i}\\right)_{i<\\omega} \\models p^{(\\omega)} \\|_{M}$. For each $k<\\omega$, let $b_{k}:=a_{k-1} \\cdot a_{k-2}$. $\\ldots \\cdot a_{0}$. Then we have:\n(1) $\\left(a_{k-1}, \\ldots, a_{1}\\right) \\models p^{(k-1)} \\|_{a_{0} M}$, hence by idempotence of $p$ we have $a_{k-1} \\cdot \\ldots \\cdot a_{1} \\models p \\|_{a_{0} M}$, and so $\\left(a_{k-1} \\cdot \\ldots \\cdot a_{1}, a_{0}\\right) \\models p^{(2)} \\|_{M}$, and $b_{k}=\\left(a_{k-1} \\cdot \\ldots \\cdot a_{1}\\right) \\cdot a_{0}$, so $\\left(b_{k}, a_{0}\\right) \\equiv_{M}\\left(a_{1} \\cdot a_{0}, a_{0}\\right)$, in particular $\\models \\varphi\\left(b_{k}, a_{0}\\right) ;$\n(2) for any permutation $\\sigma$ of $\\{0,1, \\ldots, k-1\\}$, we have $\\left(a_{\\sigma(0)}, \\ldots, a_{\\sigma(k-1)}\\right) \\models$ $\\left.p^{(k)}\\right|_{M}($ by Fact $2.1(1))$;\n(3) in particular, for every $i<k$ we have\n\n$$\n\\left(a_{k-1}, a_{k-2}, \\ldots, a_{0}\\right) \\equiv_{M}\\left(a_{k-1}, \\ldots, a_{i+1}, a_{i-1}, \\ldots, a_{0}, a_{i}\\right)\n$$\n\n(4) and $b_{k}=a_{k-1} \\cdot \\ldots \\cdot a_{i+1} \\cdot a_{i-1} \\cdot \\ldots \\cdot a_{0} \\cdot a_{i}$ (as $\\mathcal{G}$ is abelian);\n(5) hence $\\left(b_{k}, a_{0}\\right) \\equiv_{M}\\left(b_{k}, a_{i}\\right)$ for every $i<k$.\n\nThus, by (1) and (5), for every $k<\\omega$ we have $b_{k} \\models\\left\\{\\varphi\\left(x, a_{i}\\right): i<k\\right\\}$, and by compactness the set $\\left\\{\\varphi\\left(x, a_{i}\\right): i<\\omega\\right\\}$ is consistent. But this contradicts the choice of $\\varphi$ by Fact 2.1(5). Hence $\\left(a_{1} \\cdot a_{0}, a_{0}\\right) \\models p^{(2)} \\|_{M}$, and since $M$ was an arbitrary small model (over which $p$ is invariant), we conclude the proof.\n\nRemark 2.19. It was pointed out to us by Martin Hils that this argument is related to [HRK19, Lemma 5.1], which is used there to find idempotent types in abelian groups of finite $p$-weight.\n\nRemark 2.20. In the case of an arbitrary group, the proof of Proposition 2.18 gives the following:\n\n- If $p \\in S_{G}(\\mathcal{U})$ is invariant and idempotent, then for any $\\left(a_{2}, a_{1}, a_{0}\\right) \\models$ $p^{(3)}$ we have $\\left(a_{2} \\cdot a_{1} \\cdot a_{0}, a_{1}\\right) \\models p^{(2)}$.\nIndeed, this time we assume towards a contradiction that $a_{2} \\cdot a_{1} \\cdot a_{0} \\not \\underline{I}_{M} a_{1}$. We extend $\\left(a_{2}, a_{1}, a_{0}\\right)$ to a Morley sequence $\\left(a_{i}: i \\in \\omega\\right)$ in $p$ over $M$. Let $k \\in \\omega$ be arbitrary, and let $b_{k}:=a_{k} \\cdot \\ldots \\cdot a_{0}$. Then we get $\\left(b_{k}, a_{i}\\right) \\equiv_{M}$ $\\left(a_{2} \\cdot a_{1} \\cdot a_{0}, a_{1}\\right)$ for all $2 \\leq i \\leq k-1$, which gives a contradiction as in the proof of Proposition 2.18. To see this, note that since $p$ is idempotent, $a_{0}^{\\prime}:=a_{i-1} \\cdot \\ldots \\cdot a_{0}\\left|=p\\right|_{M}, a_{i}\\left|=p\\right|_{M a_{0}^{\\prime}}$, and $a_{2}^{\\prime}:=a_{k} \\cdot \\ldots \\cdot a_{i+1}\\left|=p\\right|_{M a_{0}^{\\prime} a_{i}}$. Hence $\\left(a_{2}^{\\prime}, a_{i}, a_{0}^{\\prime}\\right) \\models p^{[3]}{ }_{M}$, and so $\\left(b_{k}, a_{i}\\right) \\equiv_{M}\\left(a_{2} \\cdot a_{1} \\cdot a_{0}, a_{1}\\right)$.\n\nRemark 2.21. Note that in Remark 2.20 we only assumed that the idempotent type $p$ is invariant. However, the assumption of generic stability is necessary in Proposition 2.18. Indeed, let $M:=(\\mathbb{R},+,<), G(M):=(\\mathbb{R},+)$, and let $p_{0^{+}} \\in S_{G}(\\mathcal{U})$ be the unique global definable (over $\\mathbb{R}$ ) type extending $\\{x<a: a \\in \\mathcal{U}, a>0\\} \\cup\\{x>a: a \\in \\mathcal{U}, a \\leq 0\\}$. Then $p_{0^{+}}$is idempotent (see [CG23, Example 4.5(1)]). But if $\\left(a_{1}, a_{0}\\right) \\models p_{0^{+}} \\otimes p_{0^{+}}$we have $0<a_{1}<a_{0}<\\mathcal{U}$, hence $a_{1}+a_{0}>a_{0}$, so $\\left(a_{1}+a_{0}, a_{0}\\right) \\not \\models p_{0^{+}} \\otimes p_{0^{+}}$.\n2.6. Inp-minimal groups. A similar argument with (local) weight applies to arbitrary inp-minimal groups. Recall that a type-definable group $G$ is inp-minimal if $\\operatorname{bdn}(G(x)) \\leq 1$ (we refer to [Adl07] and [Che14, Section 2] for the definition and basic properties of burden). In particular, every dpminimal group is inp-minimal. Note that there exist dp-minimal groups which are not virtually abelian [Sim03]. Answering [CPS14, Problem 5.9], it was recently proved in [Sto23] and [Wag24] that all dp-minimal groups are virtually nilpotent.\n\nWe will use the following fact:\nFact 2.22. [GOU13, Theorem 2.9] Let $p(x) \\in S(M)$ be generically stable over a small set $A$ and $\\left(a_{i}: i<\\kappa\\right) \\models p^{(\\kappa)}\\left.\\right|_{A}$ for some cardinal $\\kappa$. Let $b \\in \\mathcal{U}^{y}$ be such that $b \\not \\underline{I}_{A} a_{i}$ for all $i<\\kappa$. Then $\\operatorname{bdn}(\\operatorname{tp}(b / A)) \\geq \\kappa$.\n\nProposition 2.23. Assume that $G$ is an arbitrary type-definable group which is inp-minimal. If $p \\in S_{G}(\\mathcal{U})$ is idempotent and generically stable, then $p$ is generically transitive.\n\nProof. Assume that $G$ is inp-minimal and $p \\in S_{G}(\\mathcal{U})$ is a generically stable idempotent type. Let $\\mathcal{U}^{\\prime} \\succ \\mathcal{U}$ be a monster model with respect to $\\mathcal{U}$ and $p^{\\prime}:=\\left.p\\right|_{\\mathcal{U}^{\\prime}}$ (the unique extension of $p$ to a type in $S_{G}\\left(\\mathcal{U}^{\\prime}\\right)$ which is invariant over $M$ ). Then $p^{\\prime} \\in S_{G}\\left(\\mathcal{U}^{\\prime}\\right)$ is idempotent and generically stable over $\\mathcal{U}$.\n\nLet $\\left(a_{1}, a_{0}\\right) \\models p^{(2)}=\\left(p^{\\prime}\\right)^{(2)} \\mid \\mathcal{U}$. Let $b:=a_{1} \\cdot a_{0} \\in G\\left(\\mathcal{U}^{\\prime}\\right)$, by assumption $\\operatorname{bdn}(\\operatorname{tp}(b / \\mathcal{U})) \\leq \\operatorname{bdn}(G(x)) \\leq 1$. As $a_{1} \\perp_{\\mathcal{U}} a_{0}$, by Fact 2.22 we must have at least one of the following (by idempotence and Fact 2.1(4)):\n(1) $b \\perp_{\\mathcal{U}} a_{0}$, hence $\\left(a_{1} \\cdot a_{0}, a_{0}\\right) \\models p^{(2)}$;\n(2) or $b \\perp_{\\mathcal{U}} a_{1}$, hence $\\left(a_{1} \\cdot a_{0}, a_{1}\\right) \\models p^{(2)}$.\n\nIn both cases we obtain that $p$ is generically transitive (see Remark 2.12).\n\nRemark 2.24. Fact 2.22 also holds when $p$ a generically simple type in an $\\mathrm{NTP}_{2}$ theory and $A$ is an extension base (this follows from [Che14, Section 6] and [Sim20, Section 3.1]).\n2.7. Stable theories. In this section we provide a proof that all idempotent types in stable groups are generically transitive. This was known from [New91] (see also e.g. [BMPW16, Lemme 1.2] and references there), and recently generalized from idempotent types to idempotent Keisler measures in stable theories in [CG22] (see the discussion in Section 3.10). We provide two detailed proofs since in the following sections we will extend them to the case when $p$ is a stable type in an arbitrary theory, and also to the case of a generically stable type $p$ in a simple or even rosy theory.\n\nThe proof uses local stratified ranks:\nDefinition 2.25. Let $G(x)$ be an $\\emptyset$-type-definable group and $\\varphi_{0}(x) \\in \\mathcal{L}$ as in Section 2.2. To a formula $\\varphi(x, y) \\in \\mathcal{L}$ (with $y$ an arbitrary tuple of variables) we associate a formula $\\varphi^{\\prime}(x, y):=\\varphi(x, y) \\wedge \\varphi_{0}(x)$. For $g \\in \\bar{G}$, put $\\varphi_{g}(x, y):=g \\cdot \\varphi^{\\prime}(x, y):=(\\exists z)\\left(\\varphi^{\\prime}(z, y) \\wedge x=g \\cdot z\\right)$. Finally, let $\\Delta_{\\varphi}:=$ $\\left\\{\\varphi_{g}(x, y): g \\in \\bar{G}\\right\\}$. We consider the usual notion of $\\Delta_{\\varphi}$-rank denoted by $R_{\\Delta_{\\varphi}}$ and $\\Delta_{\\varphi}$-multiplicity denoted by $\\mathrm{Mlt}_{\\Delta_{\\varphi}}$.\n\nThe proofs of all items except (3) in the following fact are standard arguments as for usual $\\Delta$-ranks (see e.g. [Pil96, Chapter 1]). The proof of (3) uses the choice of $\\varphi_{0}(x)$ and is left as an exercise.\n\nFact 2.26. Assume $T$ is stable. Then we have:\n(1) $R_{\\Delta_{\\varphi}}(x=x)<\\omega$;\n(2) $R_{\\Delta_{\\varphi}}\\left(\\psi_{1}(x) \\vee \\psi_{2}(x)\\right)=\\max \\left(R_{\\Delta_{\\varphi}}\\left(\\psi_{1}\\right), R_{\\Delta_{\\varphi}}\\left(\\psi_{2}\\right)\\right)$;\n(3) $R_{\\Delta_{\\varphi}}$ is invariant under left translations by the elements of $\\bar{G}$;\n(4) For any $A \\subseteq B \\subset \\mathcal{U}$ and $q \\in S_{G}(B)$ we have that $q$ does not fork over $A$ if and only if $R_{\\Delta_{\\varphi}}(q)=R_{\\Delta_{\\varphi}}\\left(\\left.q\\right|_{A}\\right)$ for every $\\varphi \\in \\mathcal{L}$;\n(5) $\\mathrm{Mlt}_{\\Delta_{\\varphi}}(q)=1$ for any complete type $q \\in S_{G}(N)$ over a model $N \\prec \\mathcal{U}$.\n\nRemark 2.27. Note that (5) follows from (4) and stationary of types over models in stable theories, but for $\\aleph_{0}$-saturated $N$ it can also be shown easily directly, without using forking.\n\nIn the proof below, the role of $\\mathcal{U}$ is played by $\\mathcal{U}^{\\prime}$.\n\nProposition 2.28. If $T$ is stable and $p \\in S_{G}(\\mathcal{U})$ is idempotent, then $p$ is generically transitive.\n\nProof. By stability, $p$ is generically stable over some small $M \\prec \\mathcal{U}$. Let $a \\models p$ in $\\mathcal{U}^{\\prime}$. By Remark 2.12, it suffices to show that $a \\in \\operatorname{Stab}_{\\ell}\\left(p^{\\prime}\\right)$, where $p^{\\prime}=\\left.p\\right|_{\\mathcal{U}^{\\prime}}$\n\nMethod 1 (without using forking). Suppose for a contradiction that $a \\cdot p^{\\prime} \\neq p^{\\prime}$, witnessed by a formula $\\varphi(x, b) \\in \\mathcal{L}\\left(\\mathcal{U}^{\\prime}\\right)$. Since $p$ is a generically stable idempotent and $a \\in p\\left(\\mathcal{U}^{\\prime}\\right)$, we get $a \\cdot p^{\\prime} \\mid \\mathcal{U}=p$. On the other hand, since $p^{\\prime}$ is invariant over $M$ and the ranks are invariant under automorphisms, a formula $\\psi(x) \\in p^{\\prime}$ with $R_{\\Delta_{\\varphi(x, y)}}(\\psi)=R_{\\Delta_{\\varphi(x, y)}}\\left(p^{\\prime}\\right)$ and $\\operatorname{Mlt}_{\\Delta_{\\varphi(x, y)}}(\\psi)=1$ can be mapped by an automorphism over $M$ to a formula $\\psi^{\\prime}(x) \\in p^{\\prime} \\mid \\mathcal{U}=p$ with $R_{\\Delta_{\\varphi(x, y)}}\\left(\\psi^{\\prime}\\right)=R_{\\Delta_{\\varphi(x, y)}}(\\psi)$ and $\\operatorname{Mlt}_{\\Delta_{\\varphi(x, y)}}\\left(\\psi^{\\prime}\\right)=1$. By Fact 2.26(3), we also have $R_{\\Delta_{\\varphi(x, y)}}\\left(a \\cdot p^{\\prime}\\right)=R_{\\Delta_{\\varphi(x, y)}}\\left(p^{\\prime}\\right)$. Summarizing, $p \\subseteq p^{\\prime} \\cap a \\cdot p^{\\prime}$, $R_{\\Delta_{\\varphi(x, y)}}(p)=R_{\\Delta_{\\varphi(x, y)}}\\left(p^{\\prime}\\right)=R_{\\Delta_{\\varphi(x, y)}}\\left(a \\cdot p^{\\prime}\\right)$ and $\\operatorname{Mlt}_{\\Delta_{\\varphi(x, y)}}(p)=1$. Hence, $\\left.p^{\\prime}\\right|_{\\varphi(x, y)}=\\left.a \\cdot p^{\\prime}\\right|_{\\varphi(x, y)}$, a contradiction.\n\nMethod 2 (using forking). Since $p^{\\prime}$ does not fork over $\\mathcal{U}$, by Fact 2.26(4), we get $R_{\\Delta_{\\varphi}}\\left(p^{\\prime}\\right)=R_{\\Delta_{\\varphi}}(p)$ for every $\\varphi(x, y) \\in \\mathcal{L}$. By Fact 2.26(3), we also have $R_{\\Delta_{\\varphi}}\\left(a \\cdot p^{\\prime}\\right)=R_{\\Delta_{\\varphi}}\\left(p^{\\prime}\\right)$. Thus, $R_{\\Delta_{\\varphi}}\\left(a \\cdot p^{\\prime}\\right)=R_{\\Delta_{\\varphi}}(p)$. On the other hand, since $p$ is a generically stable idempotent and $a \\in p\\left(\\mathcal{U}^{\\prime}\\right)$, we have $p \\subseteq a \\cdot p^{\\prime}$. We conclude, using Fact 2.26(4), that $a \\cdot p^{\\prime}$ does not fork over $\\mathcal{U}$, and so it is the unique non-forking extension of $p$ which is equal to $p^{\\prime}$.\n2.8. Stable types in arbitrary theories. Method 1 from the proof of Proposition 2.28 extends to the case when $p \\in S_{G}(\\mathcal{U})$ is stable over $M$, that is $p$ is $M$-invariant and $\\left.p\\right|_{M}$ is stable (in a not necessarily stable theory). Recall that $\\left.p(x)\\right|_{M}$ is stable if there are no sequences $\\left(a_{i}\\right)_{i<\\omega}$ in $\\mathcal{U}^{x}$ and $\\left(b_{i}\\right)_{i<\\omega}$ in $\\mathcal{U}^{y}$ such that $a_{i} \\models p \\mid M$ for all $i<\\omega$ and for some $\\varphi(x, y) \\in \\mathcal{L}$ we have $\\models \\varphi\\left(a_{i}, b_{j}\\right) \\Longleftrightarrow i<j$ for all $i, j<\\omega$. It follows from the definitions that if $p$ is stable over $M$, then it is generically stable over $M$.\n\nWe refer to e.g. [ACP14, Section 1] and [HO10, Section 2] for the basic properties of stable types. Method 1 applies when $p$ is stable over $M$ because in this case $R_{\\Delta_{\\varphi}}(p)<\\omega$, and we also have item (3) of Fact 2.26 (without any assumptions on $T$ ). Thus, Method 1 yields:\n\nProposition 2.29. If $p \\in S_{G}(\\mathcal{U})$ is idempotent and stable over some small $M \\prec \\mathcal{U}$, then $p$ is generically transitive.\n\nIn order to prove this proposition using Method 2 from the proof of Proposition 2.28, we have to be careful with item (4) of Fact 2.26. Modifying a standard proof of item (4) (see e.g. [Pil96, Lemma 3.4]) gives the following weaker variant:\n\nFact 2.30. Assume $p \\in S_{G}(\\mathcal{U})$ and $\\left.p\\right|_{M}$ is stable for a small model $M \\prec \\mathcal{U}$. Let $B$ be a set of realizations of $\\left.p\\right|_{M}$ and $A \\subseteq B$. Then for any $q \\in S_{G}(M B)$\n\nextending $\\left.p\\right|_{M}$ we have that $q$ does not fork over $M A$ if and only if $R_{\\Delta_{\\varphi}}(q)=$ $R_{\\Delta_{\\varphi}}\\left(\\left.q\\right|_{M A}\\right)$ for every $\\varphi \\in \\mathcal{L}$.\n\nWhile adapting the proof of [Pil96, Lemma 3.4] for Fact 2.30, the only essential difficulty is to show that if a formula $\\varphi(x, B)$ does not fork over $M A$ (where $\\varphi(x, y) \\in \\mathcal{L}(M A)$ ), then some positive Boolean combination of $M A$-conjugates of $\\varphi(x, B)$ is definable over $M A$. For that one needs to use the assumption that $B$ is a set of realizations of $\\left.p\\right|_{M}$ in order to have that $\\operatorname{tp}(B / M A)$ is stable, which allows to use symmetry of forking and $\\operatorname{acl}^{\\mathrm{eg}}(M A)$-definability of non-forking extensions of $\\operatorname{tp}(B / M A)$.\n\nThe following is a strengthening of the fact saying that $p$ is the unique non-forking extension of $\\left.p\\right|_{M}$ to a global type, and follows by one of the standard proofs:\n\nProposition 2.31. Assume that $p \\in S_{G}(\\mathcal{U})$ is generically stable, and $p^{\\prime}=$ $p \\mid \\mathcal{U}^{\\prime}$ (where $\\mathcal{U}^{\\prime} \\succ \\mathcal{U}$ is a monster model with respect to $\\mathcal{U}$ ). Let $q \\in S_{G}\\left(\\mathcal{U}^{\\prime}\\right)$ be an extension of $p$ such that $q \\mid \\mathcal{U}_{B}$ does not fork over $\\mathcal{U}$ for every small set $B$ of independent realizations of $p$. Then $q=p^{\\prime}$.\n\nMore generally, in the assumption, it is enough to consider only the sets $B$ of independent realizations of $p$ containing a fixed realization $a$ of $p$ in $\\mathcal{U}^{\\prime}$.\n\nProof. We will deduce the proposition from the following claim.\nClaim. If $a_{i}|=q|_{\\mathcal{U}, a_{<i}}$ for all $i<n$, then $\\left(a_{0}, \\ldots, a_{n-1}\\right)$ is a Morley sequence in $p$. In the more general version of the assumption, the same holds but assuming that $a_{0}=a$.\n\nProof. This is induction on $n$. The base step $n=0$ is trivial, as $\\left.q\\right|_{\\mathcal{U}}=p$ by assumption.\n\nInduction step. Consider any $a_{i}|=q|_{\\mathcal{U}, a_{<i}}$ in $\\mathcal{U}^{\\prime}$ for all $i \\leq n$. By induction hypothesis $a_{i}|=p|_{\\mathcal{U}, a_{<i}}$ for all $i<n$. The goal is to prove that $a_{n}|=p|_{\\mathcal{U}, a_{<n}}$, equivalently $\\left.q\\right|_{\\mathcal{U}, a_{<n}}=\\left.p\\right|_{\\mathcal{U}, a_{<n}}$.\n\nSuppose for a contradiction that $\\varphi\\left(x, a_{<n}\\right) \\in q \\mid \\mathcal{U}, a_{<n}$ but $\\neg \\varphi\\left(x, a_{<n}\\right) \\in$ $\\left.p\\right|_{\\mathcal{U}, a_{<n}}$. Extend $a_{<n}$ to a Morley sequence in $p$ by $b_{n}|=p|_{\\mathcal{U}, a_{<n}}, b_{n+1} \\models$ $\\left.p\\right|_{\\mathcal{U}, a_{<n}, b_{n}}, \\ldots$ Since $a_{<n} b_{\\geq n}$ is a Morley sequence in $p$, we get, by generic stability of $p$, that the formula $\\varphi\\left(x, a_{<n-1}, a_{n-1}\\right) \\wedge \\neg \\varphi\\left(x, a_{<n-1}, b_{m}\\right)$ divides over $\\mathcal{U}$ for every $m \\geq n$. As by assumption we know that $q \\mid \\mathcal{U}, a_{<n} . b_{\\geq n}$ does not fork over $\\mathcal{U}$, we conclude that $\\varphi\\left(x, a_{<n-1}, b_{m}\\right) \\in q(x)$ for all $m \\geq n$.\n\nPick any $c|=q|_{\\mathcal{U}, a_{<n}, b_{\\geq n}}$. By the above conclusion, $=\\varphi\\left(c, a_{<n-1}, b_{m}\\right)$ for all $m \\geq n$, so, by generic stability of $p, \\varphi\\left(c, a_{<n-1}, y\\right) \\in p^{\\prime}(y)$.\n\nOn the other hand, since $\\neg \\varphi\\left(x, a_{<n}\\right) \\in p \\mid \\mathcal{U}, a_{<n}$ and $b_{\\geq n}$ is Morley sequence in $p$ over $\\mathcal{U}, a_{<n}$, we get that $=\\neg \\varphi\\left(b_{i}, a_{<n}\\right)$ for all $i \\geq n$. Since $a_{<n} b_{\\geq m}$ is a Morley sequence in $p$, and as such it is totally indiscernible, we get that $=\\neg \\varphi\\left(a_{n-1}, a_{<n-1}, b_{i}\\right)$ for all $i \\geq n$. Therefore, $\\neg \\varphi\\left(a_{n-1}, a_{<n-1}, y\\right) \\in p^{\\prime}(y)$.\n\nSummarizing, the last two paragraphs yield $\\varphi\\left(c, a_{<n-1}, y\\right) \\wedge \\neg \\varphi\\left(a_{n-1}, a_{<n-1}, y\\right) \\in$ $p^{\\prime}(y)$. This contradicts the $\\mathcal{U}$-invariance of $p^{\\prime}$, because $c \\equiv_{\\mathcal{U}, a_{<n-1}} a_{n-1}$ as both these elements satisfy $q \\mid \\mathcal{U}, a_{<n-1}$.\n$\\square$ (claim)\n\nNow consider any $\\varphi(x, b) \\in q$. Pick $a_{i} \\models q \\mid \\mathcal{U}_{, a, b, a_{<i}}$ in $\\mathcal{U}^{\\prime}$ for all $0<i<\\omega$, and put $a_{0}:=a$. By the claim, $\\left(a_{i}\\right)_{i<\\omega}$ is a Morley sequence in $p$. Since $\\models \\varphi\\left(a_{i}, b\\right)$ for all $0<i<\\omega$, by generic stability of $p$, we get $\\varphi(x, b) \\in p^{\\prime}$. Thus, $q=p^{\\prime}$.\n\nNow, to prove Proposition 2.29 via Method 2, using Fact 2.30, we get that $R_{\\Delta_{\\varphi}}\\left(\\left.p^{\\prime}\\right|_{\\mathcal{U} B}\\right)=R_{\\Delta_{\\varphi}}(p)$ for every set $B$ of realizations of $p$ (where $\\left.p^{\\prime}:=p\\right|_{\\mathcal{U}^{\\prime}}$ ). This implies (by Fact $2.26(3)$ - which does not require any assumptions) that $R_{\\Delta_{\\varphi}}\\left(\\left(a \\cdot p^{\\prime}\\right) \\|_{U B}\\right)=R_{\\Delta_{\\varphi}}\\left(a \\cdot\\left(p^{\\prime}\\right|_{\\mathcal{U} B}\\right)\\right)=R_{\\Delta_{\\varphi}}(p)$ for every set $B$ of realizations of $p$ containing $a$. Since $p \\subseteq a \\cdot p^{\\prime}$ (by the idempotence of $p$ ), we conclude, using Fact 2.30 , that $\\left.\\left(a \\cdot p^{\\prime}\\right)\\right|_{\\mathcal{U} B}$ does not fork over $\\mathcal{U}$ for every set $B$ of realizations of $p$ containing $a$. Hence, $a \\cdot p^{\\prime}=p^{\\prime}$ by Proposition 2.31.\n2.9. Simple theories. Assume that $T$ is a simple theory, and as usual that $p \\in S_{G}(\\mathcal{U})$ is idempotent and generically stable over $M \\prec \\mathcal{U}$. Method 2 extends from stable to simple theories using stratified Shelah degrees in place of stratified local ranks. In simple theories, they are wrongly defined in Definition 4.1.4 of [Wag00] (as they are not left-invariant due to the lack of associativity outside $\\bar{G}$ ). A way to fix it is to use suitable $\\varphi(x, y)$ (as in Definition 2.25) or to apply Definition 4.3.5 of [Wag00] (in the special case of type-definable rather than hyper-definable groups). In any case, by [Wag00], stratified Shelah degrees satisfy items (1)-(4) of Fact 2.26, so Method 2 applies directly and yields the following generalization of Proposition 2.28:\n\nProposition 2.32. Let $T$ be simple, $G$ an $\\emptyset$-type-definable group, and $p \\in$ $S_{G}(\\mathcal{U})$ idempotent and generically stable. Then $p$ is generically transitive.\n2.10. Rosy theories. In the case of groups in rosy theories, again we can apply Method 2, using stratified local thorn ranks. They were defined and studied in [EKP08] (see [EKP08, Definition 1.13]) in the case of definable groups, and extend easily to type-definable groups (using $\\varphi_{0}$ as in Definition 2.25). By [EKP08], stratified local thorn ranks satisfy items (1)-(4) of Fact 2.26, with thorn forking in place forking in item (4). However, [GOU13, Theorem 3.4] tells us that if a type $q \\in S(B)$ is generically stable and $A \\subseteq B$, then $q$ forks over $A$ if and only if $q$ thorn forks over $A$. We have all the tools to prove the following generalization of Proposition 2.32 via Method 2 .\n\nBefore its statement, let us first recall local thorn ranks and define stratified local thorn ranks $\\mathrm{b}_{\\Phi, \\Theta, k}^{\\mathcal{G}}$ :\n\nDefinition 2.33. For a finite set $\\Phi$ of partitioned formulas with object variables $x$ and parameter variables $y$, a finite set of formulas $\\Theta$ in variables $y, z$, and natural number $k>0$, the $\\mathrm{b}_{\\Phi, \\Theta, k}$-rank is the unique function from the collection of all consistent formulas with parameters to $\\operatorname{Ord} \\cup\\{\\infty\\}$ satisfying: $\\mathrm{b}_{\\Phi, \\Theta, k}(\\psi) \\geq \\alpha+1$ if and only if there is $\\varphi \\in \\Phi$, some $\\theta(y, z) \\in \\Theta$ and parameter $c$ such that:\n(1) $\\mathrm{b}_{\\Phi, \\Theta, k}(\\psi(x) \\wedge \\varphi(x, a)) \\geq \\alpha$ for infinitely many $a \\models \\theta(y, c)$, and\n\n(2) $\\{\\varphi(x, a): a \\models \\theta(y, c)\\}$ is $k$-inconsistent.\n\nGiven a (partial) type $\\pi(x)$ closed under conjunction we define $\\mathrm{b}_{\\Phi, \\Theta, k}(\\pi(x))$ to be the minimum of $\\mathrm{b}_{\\Phi, \\Theta, k}(\\psi)$ for $\\psi \\in \\pi(x)$.\n\nDefinition 2.34. (1) For a formula $\\varphi(x, y) \\in \\mathcal{L}$, let $\\tilde{\\varphi}(x, t, y):=(\\exists z)(\\varphi(z, y) \\wedge$ $\\varphi_{0}(z) \\wedge x=t \\cdot z)$, where $\\varphi_{0}(x)$ is chosen in Section 2.2 .\n(2) For a finite set $\\Phi$ of formulas in variables $x, y$, put $\\tilde{\\Phi}:=\\{\\tilde{\\varphi}(x, t, y)$ : $\\varphi(x, y) \\in \\Phi\\}$. For a finite set of formulas $\\Theta$ in variables $y, z$, put $\\Theta^{*}\\left(t, y ; t^{\\prime}, z\\right):=\\left\\{\\theta(y, z) \\wedge t=t^{\\prime}: \\theta \\in \\Theta\\right\\}$.\n(3) The stratified $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}$-rank is defined as the unique function satisfying: $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}(\\psi) \\geq \\alpha+1$ if and only if there is a formula $\\varphi \\in \\Phi$, some $\\theta^{*}\\left(t, y ; t^{\\prime} z\\right) \\in \\Theta^{*}$ and parameters $g \\in G$ and $c$ anywhere such that:\n(a) $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}(\\psi(x) \\wedge \\tilde{\\varphi}(x, g, b)) \\geq n$ for infinitely many $(g, b) \\models \\theta^{*}(t, y ; g, c)$, and\n(b) $\\left\\{\\tilde{\\varphi}(x, g, b):(g, b) \\models \\theta^{*}(t, y ; g, c)\\right\\}$ is $k$-inconsistent.\n\nGiven a (partial) type $\\pi(x)$ closed under conjunction we define $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}(\\pi(x))$ to be the minimum of $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}(\\psi)$ for $\\psi \\in \\pi(x)$.\n\nProposition 2.35. If $T$ is rosy and $G$ is a type-definable group, then every generically stable idempotent type $p \\in S_{G}(\\mathcal{U})$ is generically transitive.\n\nProof. Assume $p$ is generically stable over $M \\prec \\mathcal{U}$ and let $a \\models p$ in $\\mathcal{U}^{\\prime} \\succ \\mathcal{U}$ and $p^{\\prime}=\\left.p\\right|_{\\mathcal{U}^{\\prime}}$. As usual, by Remark 2.12 it suffices to show that $a \\in$ $\\operatorname{Stab}_{\\ell}\\left(p^{\\prime}\\right)$. Since $p^{\\prime}$ does not fork over $\\mathcal{U}$, it does not $\\mathfrak{p}$-fork over $\\mathcal{U}$, so $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}\\left(p^{\\prime}\\right)=\\mathrm{b}_{\\Phi, \\Theta, k}^{G}(p)$ for every finite $\\Phi, \\Theta, k$. Since $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}\\left(a \\cdot p^{\\prime}\\right)=$ $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}\\left(p^{\\prime}\\right)$, we conclude that $\\mathrm{b}_{\\Phi, \\Theta, k}^{G}\\left(a \\cdot p^{\\prime}\\right)=\\mathrm{b}_{\\Phi, \\Theta, k}^{G}(p)$. On the other hand, since $p$ is a generically stable idempotent and $a \\in p\\left(\\mathcal{U}^{\\prime}\\right)$, we have $p \\subseteq a \\cdot p^{\\prime}$. Therefore, $a \\cdot p^{\\prime}$ does not $\\mathfrak{p}$-fork over $\\mathcal{U}$. In order to conclude that $a \\cdot p^{\\prime}$ does not fork over $\\mathcal{U}$ (and so coincides with $p^{\\prime}$, which finishes the proof), by virtue of [GOU13, Theorem 3.4], it remains to show the following:\nClaim. $a \\cdot p^{\\prime}$ is generically stable over $M, a$.\nThe claim follows from Fact 2.3 since $p^{\\prime}$ is generically stable over $M$ (and so over $M, a)$ and $a \\cdot p^{\\prime}$ is realized by $a \\cdot g \\in \\operatorname{dcl}(a, g)$ for $g \\models p^{\\prime}$.\n2.11. Generic transitivity of $p$ and stratified rank localized on $p$. As we saw in Sections 2.7-2.10, generic transitivity of an idempotent generically stable type $p \\in S_{G}(\\mathcal{U})$ can be established using a well-behaved stratified rank. In this section, working in an arbitrary theory, we define an analog of the stratified rank in stable theories (Definition 2.25) restricting to formulas with parameters from a Morley sequence in a generically stable type $p$ (aiming for it to satisfy the properties similar to Fact 2.26 needed to apply Method 1 or 2 from the proof of Proposition 2.28). For technical reasons, we will make a stronger assumption that $p^{(n)}$ is generically stable for all $n$. In NIP theories, or even in NTP $_{2}$ theories (by [CGH23a]), this follows from generic stability of $p$; but it is open in general if generic stability of $p$ implies\n\nthat $p^{(2)}$ is generically stable (a counterexample was suggested in [ACP14, Example 1.7], however it does not work - see [CGH23b, Section 8.1]). As the main result of this section, we will show that this rank is left invariant (under multiplication by elements from $p\\left(\\mathcal{U}^{\\prime}\\right)$ ) if and only if $p$ is generically transitive.\n\nThe following proposition will be used to show that our ranks are finite, but it may be of independent interest.\n\nProposition 2.36. Let $p \\in S(\\mathcal{U}), M \\prec \\mathcal{U}$ a small model, and assume that $p^{(n)}$ is generically stable over $M$ for every $n \\in \\mathbb{N}_{>0}$. Let $A \\subseteq \\mathcal{U}$ be finite and let $\\left(a_{i}\\right)_{i<\\omega} \\subseteq \\mathcal{U}$ be a Morley sequence in $p$ over $M$. Let $\\varphi(x, y) \\in \\mathcal{L}(\\mathcal{U})$ be any formula (possibly with parameters, and $x, y$ arbitrary tuples of variables). Then there are only countably many types in $S_{\\varphi}\\left(A\\left(a_{i}\\right)_{i<\\omega}\\right)$.\nProof. As there are only finitely many possibilities for substitutions of the elements of the finite set $A$ in place of some variables in $y$, without loss of generality we may assume that $A=\\emptyset$.\n\nDenote $n:=|y|$, say $y=\\left(y_{0}, \\ldots, y_{n-1}\\right)$ with $y_{j}$ corresponding to the free variables of $p$ for $j<n$. The next claim follows from generic stability of $p^{(n)}$.\nClaim. There exists $N^{\\varphi} \\in \\omega$ such that: for every $b \\in \\mathcal{U}^{x}$ there is a subset $S_{b}^{\\varphi} \\subseteq \\omega$ of cardinality $\\leq N^{\\varphi}$ and $\\varepsilon_{b}^{\\varphi} \\in\\{0,1\\}$ such that for every pairwise distinct $i_{0}, \\ldots, i_{n-1} \\in \\omega \\backslash S_{b}^{\\varphi}$ we have $\\models \\varphi\\left(b, a_{i_{0}}, \\ldots, a_{i_{n-1}}\\right)^{\\varepsilon_{b}^{\\varphi}}$.\nProof. By generic stability of $p^{(n)}$, there is $N_{\\varphi}$ such that for every Morley sequence $\\left(\\bar{c}_{i}\\right)_{i<2 N_{\\varphi}}$ in $p^{(n)}$ over $M$ and for every $b \\in \\mathcal{U}^{x}$, either for all but $N_{\\varphi}-1$ many $i$ 's we have $\\models \\varphi\\left(b, c_{i}\\right)$, or for all but $N_{\\varphi}-1$ many $i$ 's we have $\\models \\neg \\varphi\\left(b, c_{i}\\right)$. Put $N^{\\varphi}:=2 n N_{\\varphi}$, suppose that it does not satisfy the requirement in the claim, and choose a witness $b \\in \\mathcal{U}^{x}$ for that. Then, by recursion on $k$, we can find pairwise distinct numbers $i_{l}^{k}$ and $j_{l}^{k}$ for $l<n$ and $k<N_{\\varphi}$ so that $\\models \\varphi\\left(b, a_{i_{0}^{k}}, \\ldots, a_{i_{n-1}^{k}}\\right)$ and $\\models \\neg \\varphi\\left(b, a_{j_{0}^{k}}, \\ldots, a_{j_{n-1}^{k}}\\right)$ for all $k<N_{\\varphi}$. As\n\n$$\n\\left\\langle\\left(a_{i_{l}^{0}}\\right)_{l<n},\\left(a_{j_{l}^{0}}\\right)_{l<n}, \\ldots,\\left(a_{i_{l}^{N_{\\varphi}-1}}\\right)_{l<n},\\left(a_{j_{l}^{N_{\\varphi}-1}}\\right)_{l<n}\\right\\rangle\n$$\n\nis a Morley sequence in $p^{(n)}$ over $M$, the previous sentence contradicts the choice of $N_{\\varphi}$.\n$\\square$ (claim)\nBy the claim, varying $b \\in \\mathcal{U}^{x}$, we have only countably many possibilities for the finite set $S_{b}^{\\varphi} \\subset \\omega$ and two possibilities for $\\varepsilon_{b}^{\\varphi}$, so only countably many possibilities for $\\left(S_{b}^{\\varphi}, \\varepsilon_{b}^{\\varphi}\\right)$.\n\nFor $j<n$, let $\\varphi_{j}\\left(x, y_{j} ; y \\backslash\\left\\{y_{j}\\right\\}\\right):=\\varphi(x ; y)$. The proof of the proportion is by induction on $n(=|y|)$.\n\nBase step $(n=1)$. For any $b \\in \\mathcal{U}^{x}$, the type $\\operatorname{tp}_{\\varphi}\\left(b /\\left(a_{i}\\right)_{i<\\omega}\\right)$ is determined by the pair $\\left(S_{b}^{\\varphi}, \\varepsilon_{b}^{\\varphi}\\right)$ and the truth values of finitely many sentences $\\varphi\\left(b, a_{i}\\right)$ for $i \\in S_{b}^{\\varphi}$. So we get countably many possibilities for $\\operatorname{tp}\\left(b /\\left(a_{i}\\right)_{i<\\omega}\\right)$.\n\nInduction step $(n \\rightarrow n+1)$. By induction hypothesis $\\left|S_{\\varphi_{j}}\\left(\\left(a_{i}\\right)_{i<\\omega}\\right)\\right| \\leq \\aleph_{0}$, so\n\n$$\n\\left|S_{\\varphi\\left(x ; y_{0}, \\ldots, y_{j-1}, a_{i_{j}}, y_{j+1}, \\ldots, y_{n-1}\\right)}\\left(\\left(a_{i}\\right)_{i<\\omega}\\right)\\right| \\leq \\aleph_{0}\n$$\n\nfor any $j<n$ and $i_{j} \\in \\omega$. Since $\\operatorname{tp}_{\\varphi}\\left(b /\\left(a_{i}\\right)_{i<\\omega}\\right)$ is determined by the pair $\\left(S_{b}^{\\varphi}, \\varepsilon_{b}^{\\varphi}\\right)$ together with\n\n$$\n\\bigcup_{j<n} \\bigcup_{i_{j} \\in S_{b}^{\\varphi}} \\operatorname{tp}_{\\varphi\\left(x ; y_{0}, \\ldots, y_{j-1}, a_{i_{j}}, y_{j+1}, \\ldots, y_{n-1}\\right)}\\left(b /\\left(a_{i}\\right)_{i<\\omega}\\right)\n$$\n\nwe conclude that there are countably many types in $S_{\\varphi}\\left(\\left(A_{i}\\right)_{i<\\omega}\\right)$.\nNow let $G(x)$ be an $\\emptyset$-type-definable group and $p \\in S_{G}(\\mathcal{U})$ such that $p^{(n)}$ is generically stable over $M \\prec \\mathcal{U}$ for all $n \\in \\omega$. Let $\\mathcal{U}^{\\prime} \\succ \\mathcal{U}$ be a bigger monster model. We define a version of stratified local ranks, where the inconsistent types witnessing the increase in rank have to be defined over a Morley sequence in $p$.\n\nDefinition 2.37. (1) For a formula $\\varphi(x, y) \\in \\mathcal{L}$, let $\\tilde{\\varphi}(x, t, y):=(\\exists z)(\\varphi(z, y) \\wedge$ $\\varphi_{0}(z) \\wedge \\varphi_{0}(t) \\wedge x=t \\cdot z)$, where $\\varphi_{0}(x)$ is chosen in Section 2.2 .\n(2) Following Shelah's terminology (rather than Pillay's from [Pil96]), given $A \\subseteq \\mathcal{U}$, by a $\\tilde{\\varphi}(x, t, y)$-formula over $A$ we mean a formula of the form $\\tilde{\\varphi}(x, a, b)$ or $\\neg \\tilde{\\varphi}(x, a, b)$ for $a, b$ from $A$.\n(3) By a $\\tilde{\\varphi}(x, t, y)$-type over $A$ we mean a consistent collection of $\\tilde{\\varphi}(x, t, y)$ formulas over $A$. Two such types are explicitly contradictory if there is a $\\tilde{\\varphi}(x, t, y)$-formula contained in one of these types such that the negation of this formula is in the other type.\n\nDefinition 2.38. (1) We define a function $R_{p, \\varphi}$ from the collection of all partial types in $x$ over $\\mathcal{U}^{\\prime}$ to $\\operatorname{Ord} \\cup\\{\\infty\\}$ as a unique function satisfying: $R_{p, \\varphi}(\\pi(x)) \\geq \\alpha+1$ if and only if for every finite $\\pi_{0}(x) \\subseteq \\pi(x)$ and $n \\in \\omega$ there exist pairwise explicitly contradictory $\\tilde{\\varphi}(x, t, y)$ types $q_{0}(x), \\ldots, q_{n-1}(x)$ whose parameters altogether form a Morely sequence in $p$ over $M$ together with the parameters of $\\pi_{0}(x)$ and such that $R_{p, \\varphi}\\left(\\pi_{0}(x) \\cup q_{i}(x)\\right) \\geq \\alpha$ for all $i<n$.\n(2) If $R_{p, \\varphi}(\\pi(x))<\\infty$, then $\\operatorname{Mlt}_{p, \\varphi}(\\pi(x))$ is defined as the maximal number $n \\in \\omega$ such that for every finite $\\pi_{0}(x) \\subseteq \\pi(x)$ with $R_{p, \\varphi}\\left(\\pi_{0}(x)\\right)=$ $R_{p, \\varphi}(\\pi(x))$ there are pairwise explicitly contradictory $\\tilde{\\varphi}(x, t, y)$-types $q_{0}(x), \\ldots, q_{n-1}(x)$ whose parameters form a Morley sequence in $p$ over $M$ together with the parameters of $\\pi_{0}(x)$ and such that $R_{p, \\varphi}\\left(\\pi_{0}(x) \\cup\\right.$ $\\left.q_{i}(x)\\right)=R_{p, \\varphi}(\\pi(x))$ for all $i<n$.\n\nLemma 2.39. Assume that $p^{(n)}$ is generically stable for all $n \\in \\omega$. Then the ranks $R_{p, \\varphi}$ have the following properties.\n(1) $R_{p, \\varphi}(x=x)<\\omega$.\n(2) $R_{p, \\varphi}\\left(\\psi_{1}(x) \\vee \\psi_{2}(x)\\right)=\\max \\left\\{R_{p, \\varphi}\\left(\\psi_{1}(x)\\right), R_{p, \\varphi}\\left(\\psi_{2}(x)\\right)\\right\\}$.\n(3) $R_{p, \\varphi}$ is invariant under automorphisms of $\\mathcal{U}^{\\prime}$ fixing $M$ pointwise.\n\n(4) In the definition of $R_{p, \\varphi}$, one can use $\\pi(x)$ in place of the finite piece $\\pi_{0}(x)$.\n(5) $R_{p, \\varphi}(\\pi(x))=R_{p, \\varphi}\\left(\\pi(x) \\cup(\\exists z, t)\\left(G(t) \\wedge \\varphi_{0}(z) \\wedge x=t \\cdot z\\right)\\right)$.\n\nProof. (1) If not, then, by compactness, there is a tree $\\left(q_{\\eta}\\right)_{\\eta \\in 2^{<\\omega}}$, where each $q_{\\eta}$ is a $\\tilde{\\varphi}$-formula, branches are consistent, the sons of every node are pairwise explicitly contradictory, and the parameters of the types $q_{\\eta}$ form a Morley sequence in $p$ over $M$. So the number of complete $\\tilde{\\varphi}$-types over these parameters is $2^{R_{0}}$ which contradicts Proposition 2.36.\n(2) and (3) are straightforward from the definitions.\n(4) follows from (1) (namely, it is enough to consider only finite values $\\alpha \\in$ Ord of the rank), and compactness. One just gets that $R_{p, \\varphi}(\\pi(x)) \\geq n$ if and only if there is a tree $\\left(q_{\\eta}\\right)_{\\eta \\in n^{\\omega}}$ of $\\tilde{\\varphi}(x, t, y)$-types with suitable parameters and such that each branch is consistent with $\\pi(x)$ and the sons of every node are pairwise explicitly contradictory.\n(5) follows from the observation that each but at most one of the types $q_{0}, \\ldots, q_{n-1}$ in the definition of $R_{p, \\varphi}$ implies $(\\exists z, t)\\left(G(t) \\wedge \\varphi_{0}(z) \\wedge x=t\\right.$. $z)$.\n\nWe consider the left action of $G$ on partial types over $\\mathcal{U}^{\\prime}$ as follows:\nDefinition 2.40. For $g \\in G\\left(\\mathcal{U}^{\\prime}\\right)$ and a partial type $\\pi(x)$ over a set $A \\subseteq \\mathcal{U}^{\\prime}$, we define $g \\cdot \\pi(x)$ to be a partial type over $A, g$ defining the set $g \\cdot\\left(\\pi\\left(\\mathcal{U}^{\\prime}\\right) \\cap\\right.$ $\\left.\\left(G\\left(\\mathcal{U}^{\\prime}\\right) \\cdot \\varphi_{0}\\left(\\mathcal{U}^{\\prime}\\right)\\right)\\right)$.\n\nProposition 2.41. Suppose that $p$ is idempotent. Then generic transitivity of $p$ is equivalent to the invariance of the ranks $R_{p, \\varphi}$ under action on the left by elements of $p\\left(\\mathcal{U}^{\\prime}\\right)$.\n\nProof. $(\\Rightarrow)$ By Lemma 2.39(5), it suffices to show that for any $g \\in p\\left(\\mathcal{U}^{\\prime}\\right)$ and any partial type $\\pi(x)$ which implies $(\\exists y, z)\\left(G(y) \\wedge \\varphi_{0}(z) \\wedge x=y z\\right)$ we have $R_{p, \\varphi}(g \\cdot \\pi(x))=R_{p, \\varphi}(\\pi(x))$.\n\nBy generic transitivity of $p$ and Remark 2.12 we have $p \\in S_{H}(\\mathcal{U})$, where $H=\\operatorname{Stab}_{\\ell}(p)$. Then the type-definable group $H$ is generically stable witnessed by $p$, so $p=p^{-1}$ by Fact 2.5. Hence, $g^{-1} \\models p$. Thus, since $g^{-1} \\cdot(g \\cdot \\pi(x))$ is equivalent to $\\pi(x)$ (by the choice of $\\varphi_{0}(x)$ ), it is enough to show that $R_{p, \\varphi}(g \\cdot \\pi(x)) \\geq R_{p, \\varphi}(\\pi(x))$. For that, by induction on $\\alpha$, we will show that $R_{p, \\varphi}(\\pi(x)) \\geq \\alpha$ implies that $R_{p, \\varphi}(g \\cdot \\pi(x)) \\geq \\alpha$.\n\nThe base step is obvious. For the induction step, consider any $n \\in \\omega$ and pairwise explicitly contradictory $\\tilde{\\varphi}(x, t, y)$-types $q_{0}(x), \\ldots, q_{n-1}(x)$ whose parameters form a Morley sequence $\\left(c_{i}\\right)_{i}$ in $p$ over $M$ together with the parameters $A$ of $\\pi(x)$ and such that $R_{p, \\varphi}\\left(\\pi(x) \\cup q_{i}(x)\\right) \\geq \\alpha$ for all $i<n$. Without loss of generality we may assume that this Morley sequence is over $M, A, g$. By induction hypothesis, $R_{p, \\varphi}\\left(g \\cdot\\left(\\pi(x) \\cup q_{i}(x)\\right)\\right) \\geq \\alpha$ for all $i<n$. On the other hand, by the choice of $\\varphi_{0}(x)$ and $\\pi(x)$, for any $h \\in G\\left(\\mathcal{U}^{\\prime}\\right)$ and any $b$ in $\\mathcal{U}^{\\prime}$ we have $g \\cdot \\tilde{\\varphi}(x, h, b)$ is equivalent to $\\tilde{\\varphi}(x, g \\cdot h, b)$ and $g \\cdot\\left(\\pi(x) \\wedge \\neg \\tilde{\\varphi}(x, h, b)\\right)$ is equivalent to $g \\cdot \\pi(x) \\wedge \\neg \\tilde{\\varphi}(x, g \\cdot h, b)$. Thus,\n\n$R_{p, \\varphi}(g \\cdot \\pi(x) \\cup q_{i}^{\\prime}(x)) \\geq \\alpha$ for all $i<n$ for some pairwise explicitly contradictory $\\tilde{\\varphi}(x, t, y)$-types $q_{0}^{\\prime}(x), \\ldots, q_{n-1}^{\\prime}(x)$ whose parameters form a sequence $\\left(c_{i}^{\\prime}\\right)_{i}$, where for every $i, c_{i}^{\\prime}=c_{i}$ or $c_{i}^{\\prime}=g \\cdot c_{i}$. It remains to show that $\\left(c_{i}^{\\prime}\\right)_{i}$ is a Morley sequence in $p$ over $M, A, g$. So we need to show that $c_{i}^{\\prime} \\models p \\mid M, A, g,\\left(c_{j}^{\\prime}\\right)_{j \\neq i}$.\n\nIf $c_{i}^{\\prime}=c_{i}$, then this follows from the fact that $c_{i} \\models p \\mid M, A, g,\\left(c_{j}\\right)_{j \\neq i}$. Consider the case $c_{i}^{\\prime}=g \\cdot c_{i}$. Since $c_{i} \\models p \\mid M, A, g,\\left(c_{j}\\right)_{j \\neq i}$, we have $c_{i} \\perp_{M} M, A, g,\\left(c_{j}^{\\prime}\\right)_{j \\neq i}$ and so $g \\cdot c_{i} \\perp_{M, g} M, A, g,\\left(c_{j}^{\\prime}\\right)_{j \\neq i}$ by left transitivity. On the other hand, by generic transitivity of $p$ and Remark $2.12, g \\cdot c_{i} \\models p \\mid M, g$. Hence, $c_{i}^{\\prime}=g \\cdot c_{i} \\models$ $\\left.p\\right|_{M, A, g,\\left(c_{j}^{\\prime}\\right)_{j \\neq i}}$ (by Fact 2.1(2)).\n$(\\Leftarrow)$ We will apply Method 1 from the proof of Proposition 2.28, using Proposition 2.31.\n\nLet $a \\models p$ in $\\mathcal{U}^{\\prime}$, and suppose for a contradiction that $a \\cdot p^{\\prime} \\neq p^{\\prime}$. By Proposition 2.31, there is a formula $\\varphi(x, \\bar{a})$ with $\\bar{a}$ being a Morley sequence in $p$ (over $\\mathcal{U}$ ) such that $\\varphi(x, \\bar{a}) \\in p^{\\prime}$ but $\\neg \\varphi(x, \\bar{a}) \\in a \\cdot p^{\\prime}$. Then we follow the lines of Method 1, using $R_{p, \\varphi}$ in place of $R_{\\Delta_{\\varphi}}$ and left invariance of $R_{\\Delta_{p, \\varphi}}$ under $a$ (which follows by assumption) together with invariance under $\\operatorname{Aut}\\left(\\mathcal{U}^{\\prime} / M\\right)$. At the end, we get $p \\subseteq p^{\\prime} \\cap a \\cdot p^{\\prime}, R_{p, \\varphi}(p)=R_{p, \\varphi}\\left(p^{\\prime}\\right)=R_{p, \\varphi}\\left(a \\cdot p^{\\prime}\\right)$ and $\\operatorname{Mlt}_{p, \\varphi(x, \\bar{y})}(p)=1$, which contradicts the choice of $\\varphi(x, \\bar{a})$.\n\nProblem 2.42. Does the equivalence in Proposition 2.41 hold only assuming that $p$ is generically stable? (As opposed to $p^{(n)}$ is generically stable for all $n \\in \\omega$.)\n2.12. Stabilizer of a generically transitive type is an intersection of definable groups. As before, let $G$ be a type-definable group and let $p \\in S_{G}(\\mathcal{U})$ be a generically stable type over $M$. By Proposition 2.7, we know that $\\operatorname{Stab}_{\\ell}(p)$ is an intersection of relatively $M$-definable subgroups of $\\bar{G}$.\n\nQuestion 2.43. Assuming that $p$ is generically stable and idempotent, is $\\operatorname{Stab}_{\\ell}(p)$ an intersection of $M$-definable groups?\n\nThis question is open only in the case of type-definable $\\bar{G}$ (in the definable case, the answer is trivially positive by the above comment).\n\nProposition 2.44. If $G$ is type-definable and $p \\in S_{G}(\\mathcal{U})$ is generically stable, idempotent and generically transitive, then the answer to Question 2.43 is positive.\n\nProof. This proof is an elaboration on the proof of Hrushovski's theorem that a type-definable group in a stable theory is an intersection of definable groups [Hru90].\n\nChoose $\\varphi_{0}(x) \\in \\mathcal{L}$ as in Section 2.2, we will only use that $G(x) \\vdash \\varphi_{0}(x)$ and $\\cdot$ is defined and associative on $\\varphi_{0}(\\mathcal{U})$ and $a \\cdot e=a=e \\cdot a$ for all $a \\in \\varphi_{0}(\\mathcal{U})$.\n\nWe will prove that there exists an $M$-definable set $H=H_{\\varphi_{0}}$ such that $\\left.p\\right|_{M}(\\mathcal{U}) \\subseteq H \\subseteq \\varphi_{0}(\\mathcal{U})$ and $(H, \\cdot)$ is a group. Then $\\operatorname{Stab}_{\\ell}(p) \\leq H_{\\varphi_{0}}$ and\n\n$\\bigcap_{\\varphi_{0}} H_{\\varphi_{0}} \\leq \\bar{G}$, where $\\varphi_{0}$ ranges over the formulas chosen as above. Therefore, by Proposition 2.7 and compactness, $\\operatorname{Stab}_{\\ell}(p)$ is an intersection of $M$-definable groups (all with group operation given by $\\cdot$ ), so the proof will be finished.\n\nWe can clearly assume that the partial type $G(x)$ is closed under conjunction. For any $\\varphi(x) \\in G(x)$ put $\\delta_{\\varphi}(x, y):=\\varphi_{0}(x) \\wedge \\varphi_{0}(y) \\wedge \\varphi(y \\cdot x)$. Let $\\varepsilon_{\\varphi}(y)$ be the $\\delta_{\\varphi}(x ; y)$-definition of $p$; this is a formula over $M$, since $p$ is definable over $M$. Also, $\\varepsilon_{\\varphi}(y)$ implies $\\varphi_{0}(y)$.\n\nClaim 1. $G(x) \\equiv\\left\\{\\varepsilon_{\\varphi}(x): \\varphi(x) \\in G(x)\\right\\}$.\nProof. ( $\\vdash$ ) Consider any $\\mathcal{U} \\ni b \\models G(x)$, i.e. $b \\in \\bar{G}$. Take $a \\models p$. Then $b \\cdot a \\in G\\left(\\mathcal{U}^{\\prime}\\right)$. Hence, for any $\\varphi(x) \\in G(x)$ we have $\\models \\varphi_{0}(a) \\wedge \\varphi_{0}(b) \\wedge \\varphi(b \\cdot a)$, and so $b \\models \\varepsilon_{\\varphi}(x)$.\n$(\\dashv)$ ) Consider any $\\mathcal{U} \\ni b \\models\\left\\{\\varepsilon_{\\varphi}(x): \\varphi(x) \\in G(x)\\right\\}$. Take $a \\models p$. Then for every $\\varphi(x) \\in G(x)$ we have $\\models \\delta_{\\varphi}(a, b)$, so $b \\cdot a \\models \\varphi(x)$. Hence, $b \\cdot a \\in G\\left(\\mathcal{U}^{\\prime}\\right)$, so $b=(b \\cdot a) \\cdot a^{-1} \\in G\\left(\\mathcal{U}^{\\prime}\\right)$ (the equality holds, as $b \\models \\varphi_{0}(x)$ and $\\left.a \\in G\\left(\\mathcal{U}^{\\prime}\\right)\\right)$, whence $b \\models G(x)$.\n$\\square$ (claim)\nBy Claim 1, choose $\\varphi(x) \\in G(x)$ such that $a \\cdot b \\in \\varphi_{0}(\\mathcal{U})$ for all $a, b \\in \\varepsilon_{\\varphi}(\\mathcal{U})$.\nClaim 2. For every $b \\in \\varepsilon_{\\varphi}(\\mathcal{U})$ and $\\left.a \\in p\\right|_{M}(\\mathcal{U})$ we have $b \\cdot a \\in \\varepsilon_{\\varphi}(\\mathcal{U})$.\nProof. Consider any $a$ and $b$ as above. Take any $c \\in \\bar{G}$ realizing $\\left.p\\right|_{M, a, b}$. By generic transitivity and Remark $2.12, a \\cdot c \\models p_{\\mid M, a}$, and so $a \\cdot c \\perp_{M}$ $M, a$. On the other hand, by left transitivity, $a \\cdot c \\perp_{M, a} M, a, b$. Hence, $a \\cdot c \\perp_{M} M, a, b$ by transitivity of forking for generically stable types (Fact 2.1), and so $a \\cdot c \\models p_{\\mid M, b}$. Therefore, since $b \\in \\varepsilon_{\\varphi}(\\mathcal{U})$, we get $b \\cdot(a \\cdot c) \\models \\varphi(x)$. Since $a, b, c \\in \\varphi_{0}(\\mathcal{U})$, this means that $(b \\cdot a) \\cdot c \\models \\varphi(x)$. On the other hand, $c \\models p_{\\mid M, b \\cdot a}$. Moreover, since $b \\in \\varepsilon_{\\varphi}(\\mathcal{U})$ and $\\left.a \\in p\\right|_{M}(\\mathcal{U}) \\subseteq \\bar{G} \\subseteq \\varepsilon_{\\varphi}(\\mathcal{U})$ (the last inclusion holds by Claim 1), we have $b \\cdot a \\in \\varphi_{0}(\\mathcal{U})$. So we conclude that $b \\cdot a \\models \\varepsilon_{\\varphi}(x)$.\n$\\square$ (claim)\nPut $H_{0}:=\\varepsilon_{\\varphi}(\\mathcal{U})$ and $H_{1}:=\\left\\{a \\in H_{0}: b \\cdot a \\in H_{0}\\right.$ for all $\\left.b \\in H_{0}\\right\\}$. By Claim $2,\\left.p\\right|_{M}(\\mathcal{U}) \\subseteq H_{1}$, and clearly $e \\in H_{1}$. Both $H_{0}$ and $H_{1}$ are $M$ definable. Using the choice of $\\varphi_{0}(x)$ and the inclusions $H_{1} \\subseteq H_{0} \\subseteq \\varphi_{0}(\\mathcal{U})$, one easily checks that $H_{1}$ is closed under $\\cdot$. Finally, put $H=H_{\\varphi_{0}}:=\\left\\{a \\in\\right.$ $\\left.H_{1}: a \\cdot b=b \\cdot a=e\\right.$ for some $\\left.b \\in H_{1}\\right\\}$. It is clearly $M$-definable.\n\nBy generic transitivity of $p$ (and Remark 2.11), the type-definable group $\\operatorname{Stab}_{\\ell}(p)$ is generically stable witnessed by $p$ (Definition 2.4), so $p=p^{-1}$ by Fact 2.5. Therefore, as we have seen above that $\\left.p\\right|_{M}(\\mathcal{U}) \\subseteq H_{1}$, we get that $\\left.p\\right|_{M}(\\mathcal{U}) \\subseteq H$. Summarizing, $\\left.p\\right|_{M}(\\mathcal{U}) \\subseteq H \\subseteq H_{1} \\subseteq H_{0} \\subseteq \\varphi_{0}(\\mathcal{U})$.\n\nOne easily checks, using the choice of $\\varphi_{0}(x)$ and the inclusion $H_{1} \\subseteq \\varphi_{0}(x)$, that $H$ is closed under $\\cdot$. Since $H \\subseteq \\varphi_{0}(\\mathcal{U})$, we have that $\\cdot$ is associative on $H$ and $e \\in H$ is neutral in $H$. Also, for any $a \\in H$ there is $b \\in H_{1}$ with $a \\cdot b=b \\cdot a=e$ which implies that $b \\in H$. Hence, $(H, \\cdot)$ is a group.\n\nRemark 2.45. If we drop the assumption that $p$ is generically transitive, then the main difficulty in adaptation of the above proof is in Claim 2. Namely, by exactly the same method we only get \"For every $b \\in \\varepsilon_{\\varphi}(\\mathcal{U})$ and $a \\in p \\mid_{M, b}(\\mathcal{U})$ we have $b \\cdot a \\in \\varepsilon_{\\varphi}(\\mathcal{U})$ \".\n2.13. Chain conditions for type-definable groups on a generically stable type. One approach towards Problem 2.10 is to adapt Newelski's \"2-step generation\" theorem [New91, Theorem 2.3] that provides a positive answer for types in stable theories. One ingredient is the existence of a smallest type-definable group containing a given type in a stable theory. In this section we investigate this question (and corresponding chain conditions and connected components) for groups type-definable using parameters from a Morley sequence of a generically stable type.\n\nThe following is a generalization of [DK12, Lemma 2.1] to type-definable groups (combining it with [HP18, Lemma 2.1]).\n\nLemma 2.46. Let $G$ be an $\\emptyset$-type-definable group and $p(y) \\in S_{G}(\\mathcal{U})$ a global type generically stable over a small set $A \\subset \\mathcal{U}$.\n(1) Assume that $H(x, y, z)$ is a countable partial type over $A$, and let $\\kappa:=2^{2^{8} 0}$. Then for any linear order $I$, any tuple $c \\in \\mathcal{U}^{z}$ and any $\\bar{b}:=\\left(b_{i}: i \\in I\\right) \\models p^{[I]} \\mid_{A c}$, if $H\\left(\\mathcal{U}, b_{i}, c\\right) \\cap G(\\mathcal{U}) \\leq G(\\mathcal{U})$ for all $i \\in I$, then for any $J \\subseteq I$ with $|J|=\\kappa$ we have\n\n$$\n\\bigcap_{i \\in I} H\\left(\\mathcal{U}, b_{i}, c\\right) \\cap G(\\mathcal{U})=\\bigcap_{i \\in J} H\\left(\\mathcal{U}, b_{i}, c\\right) \\cap G(\\mathcal{U})\n$$\n\n(2) Assume that $p^{(n)}$ is generically stable over $A$ for all $n \\in \\omega$. Let $H(x ; \\bar{y}, z)$ with $\\bar{y}=\\left(y_{\\alpha}: \\alpha<\\omega\\right)$ be a countable partial type over A. Then $\\kappa:=2^{2^{8} 0}$ satisfies the following: for any linear order $I$, any tuple $c \\in \\mathcal{U}^{z}$ and any $\\bar{b}:=\\left(b_{i}: i \\in I\\right) \\models p^{[I]} \\mid_{A c}$, if $H\\left(\\mathcal{U}, \\bar{b}_{\\bar{i}}, c\\right) \\cap$ $G(\\mathcal{U}) \\leq G(\\mathcal{U})$, where $\\bar{b}_{\\bar{i}}=\\left(b_{i_{\\alpha}}: \\alpha<\\omega\\right)$, for all $\\bar{i}=\\left(i_{\\alpha}: \\alpha<\\omega\\right) \\in$ $I^{\\omega}$, then for any $J \\subseteq I$ with $|J|=\\kappa$ we have\n\n$$\n\\bigcap_{\\bar{i} \\in I^{\\omega}} H\\left(\\mathcal{U}, \\bar{b}_{\\bar{i}}, c\\right) \\cap G(\\mathcal{U})=\\bigcap_{\\bar{i} \\in J^{\\omega}} H\\left(\\mathcal{U}, \\bar{b}_{\\bar{i}}, c\\right) \\cap G(\\mathcal{U})\n$$\n\n(3) Assume that $p^{(n)}$ is generically stable over $A$ for all $n \\in \\omega$. Let $\\mathcal{F}$ be a family of subgroups of $G(\\mathcal{U})$ that is invariant under $A$ automorphisms and closed under (possibly infinite) intersections and supergroups (so for example could take $\\mathcal{F}$ to be all subgroups of $G(\\mathcal{U}))$.\n\nThen for any linear order $I$, any $\\bar{b}:=\\left(b_{i}: i \\in I\\right) \\models p^{[I]} \\mid A$ and any $J \\subseteq I,|J| \\geq \\kappa:=2^{2^{8} 0}$, the intersection of all subgroups of $G(\\mathcal{U})$ from $\\mathcal{F}$ type-definable with parameters from $A \\bar{b}$ is a subgroup of $G(\\mathcal{U})$ in $\\mathcal{F}$ relatively type-definable over $A\\left(b_{i}: i \\in J\\right)$.\n\nProof. (1) Without loss of generality we may clearly assume that $|I| \\geq \\kappa$; and extending $\\left(b_{i}: i \\in I\\right)$ to a longer Morley sequence if necessary, we may\n\nassume $|I|>\\kappa$. First we show that there exists some $J \\subseteq I,|J| \\leq \\kappa$ with $\\bigcap_{i \\in I} H\\left(\\mathcal{U}, b_{i}, c\\right) \\cap G(\\mathcal{U})=\\bigcap_{i \\in J} H\\left(\\mathcal{U}, b_{i}, c\\right) \\cap G(\\mathcal{U})$. Assume not, then by induction on $\\alpha<\\kappa^{+}$we can choose $g_{\\alpha} \\in G(\\mathcal{U})$ and pairwise distinct $i_{\\alpha} \\in I$ so that\n\n$$\ng_{\\alpha} \\in G(\\mathcal{U}) \\cap\\left(\\bigcap_{\\beta<\\alpha} H\\left(\\mathcal{U}, b_{i_{\\beta}}, c\\right)\\right) \\backslash H\\left(\\mathcal{U}, b_{i_{\\alpha}}, c\\right)\n$$\n\nLet $A_{0} \\subseteq A$ with $\\left|A_{0}\\right|=\\aleph_{0}$ contain the parameters of $H$, and let $\\mathcal{L}_{0}$ be a countable sublanguage of $\\mathcal{L}$ containing all of the formulas in $H$. By the choice of $\\kappa$, applying Erd\u0151s-Rado and passing to a subsequence of $\\left(g_{\\alpha}, b_{i_{\\alpha}}: \\alpha<\\kappa\\right)$ we may assume that the sequence $\\left(g_{\\alpha}, b_{i_{\\alpha}}: \\alpha<\\omega\\right)$ is \"2-indiscernible\" with respect to $\\mathcal{L}_{0}\\left(A_{0} c\\right)$, i.e. tuples $\\left(g_{\\alpha}, b_{i_{\\alpha}}, g_{\\beta}, b_{i_{\\beta}}\\right)$ have the same $\\mathcal{L}_{0}$-type over $A_{0} c$ for all $\\alpha<\\beta<\\omega$, and either $i_{\\alpha}<i_{\\beta}$ for all $\\alpha<\\beta<\\omega$, or $i_{\\alpha}>i_{\\beta}$ for all $\\alpha<\\beta<\\omega$. Assume we are in the former case (the latter case is similar).\n\nFirst assume that $g_{\\alpha} \\notin H\\left(\\mathcal{U}, b_{i_{\\beta}}, c\\right)$ for some $\\beta>\\alpha$ in $\\omega$, then $\\models \\neg \\varphi\\left(g_{\\alpha}, b_{i_{\\beta}}, c\\right)$ for some $\\varphi(x, y, z) \\in H(x, y, z)$. Hence, by 2-indiscernibility, we have $\\models$ $\\varphi\\left(g_{\\alpha}, b_{i_{\\beta}}, c\\right) \\Longleftrightarrow \\beta<\\alpha$ for all $\\alpha, \\beta \\in \\omega$. Taking $\\alpha \\in \\omega$ sufficiently large, this contradicts generic stability of $p$.\n\nOtherwise we have $g_{\\alpha} \\in H\\left(\\mathcal{U}, b_{i_{\\beta}}, c\\right) \\Longleftrightarrow \\alpha \\neq \\beta$, for all $\\alpha, \\beta \\in \\omega$. Note that for any $h_{1}, h_{2} \\in G(\\mathcal{U}) \\cap H\\left(\\mathcal{U}, b_{i_{0}}, c\\right)$, we have $h_{1} \\cdot g_{0} \\cdot h_{2} \\notin H\\left(\\mathcal{U}, b_{i_{0}}, c\\right)$ (as $\\left.g_{0} \\notin H\\left(\\mathcal{U}, b_{i_{0}}, c\\right)\\right)$. By compactness there is a formula $\\varphi(x, y, z) \\in H(x, y, z)$ (without loss of generality the partial type $H$ is closed under conjunctions) so that: for any $h_{1}, h_{2} \\in G(\\mathcal{U}) \\cap H\\left(\\mathcal{G}, b_{i_{0}}, c\\right), \\models \\neg \\varphi\\left(h_{1} \\cdot g_{0} \\cdot h_{2}, b_{i_{0}}, c\\right)$. By 1-indiscernibility we then have: for any $\\alpha<\\omega$, for any $h_{1}, h_{2} \\in G(\\mathcal{U}) \\cap$ $H\\left(\\mathcal{U}, b_{i_{\\alpha}}, c\\right), \\models \\neg \\varphi\\left(h_{1} \\cdot g_{\\alpha} \\cdot h_{2}, b_{i_{\\alpha}}, c\\right)$. Let now $K$ be any finite subset of $\\omega$, and let $g_{K}:=\\prod_{\\alpha \\in K} g_{i_{\\alpha}}$. As $g_{\\alpha} \\in H\\left(\\mathcal{U}, b_{i_{\\beta}}, c\\right) \\Longleftrightarrow \\alpha \\neq \\beta$, it follows that for all $\\alpha<\\omega, \\models \\varphi\\left(g_{K}, b_{i_{\\alpha}}, c\\right) \\Longleftrightarrow \\alpha \\notin K$. Taking $K$ sufficiently large, this again contradicts generic stability of $p$ (in fact, even \"generic NIP\" of $p$ ).\n\nWe have thus shown that there exists $J \\subseteq I,|J|=\\kappa$ with $G(\\mathcal{U}) \\cap$ $\\bigcap_{i \\in I} H\\left(\\mathcal{U}, b_{i}, c\\right)=G(\\mathcal{U}) \\cap \\bigcap_{i \\in J} H\\left(\\mathcal{U}, b_{i}, c\\right)$. Given an arbitrary $J^{\\prime} \\subseteq I,\\left|J^{\\prime}\\right|=$ $\\kappa$, there exists a permutation $\\sigma$ of $I$ sending $J$ to $J^{\\prime}$. As $\\bar{b}$ is totally indiscernible over $A c$ by generic stability of $p$, there exists $f \\in \\operatorname{Aut}_{\\mathcal{L}}(\\mathcal{U} / A c)$ with $f\\left(b_{i}\\right)=b_{\\sigma(i)}$ for all $i$. Applying $f$ we thus have:\n\n$$\n\\begin{aligned}\n& G(\\mathcal{U}) \\cap \\bigcap_{i \\in I} H\\left(\\mathcal{U}, b_{i}, c\\right)=G(\\mathcal{U}) \\cap \\bigcap_{i \\in I} H\\left(\\mathcal{U}, b_{\\sigma(i)}, c\\right) \\\\\n= & G(\\mathcal{U}) \\cap \\bigcap_{i \\in J} H\\left(\\mathcal{U}, b_{\\sigma(i)}, c\\right)=G(\\mathcal{U}) \\cap \\bigcap_{i \\in J^{\\prime}} H\\left(\\mathcal{U}, b_{i}, c\\right)\n\\end{aligned}\n$$\n\n(2) Let $J \\subseteq I,|J|=\\kappa$ be arbitrary. Fix any $\\bar{i}=\\left(i_{\\alpha}: \\alpha<\\omega\\right) \\in I^{\\omega}$. Let $\\bar{i}^{\\prime}:=\\left(i_{\\alpha}: \\alpha<\\omega, i_{\\alpha} \\notin J\\right), \\bar{i}^{\\prime \\prime}:=\\left(i_{\\alpha}: \\alpha<\\omega, i_{\\alpha} \\in J\\right)$, so that $\\bar{i}=\\bar{i}^{\\prime} \\bar{i}^{\\prime \\prime}$ and $\\bar{i}^{\\prime} \\cap \\bar{i}^{\\prime \\prime}=\\emptyset$. As $\\left|\\bar{i}^{\\prime \\prime}\\right| \\leq \\aleph_{0}$, we can choose tuples $\\bar{i}_{\\alpha} \\in I \\leq \\omega$ for $\\alpha<\\kappa$ so that: $\\bar{i}_{0}=\\bar{i}^{\\prime}, \\bar{i}_{\\alpha} \\in J \\leq \\omega$ for $\\alpha>0,\\left|\\bar{i}_{\\alpha}\\right|=\\left|\\bar{i}^{\\prime}\\right|, \\bar{i}_{\\alpha} \\cap \\bar{i}^{\\prime \\prime}=\\emptyset$ and $\\bar{i}_{\\alpha} \\cap \\bar{i}_{\\beta}=\\emptyset$ for all $\\alpha \\neq \\beta<\\kappa$. As $\\bar{b}\\left|\\left.=p^{(I)}\\right|_{A c}\\right.$ is totally indiscernible over $A c$, it\n\nfollows that $\\left(\\bar{b}_{\\bar{i}_{\\alpha}}: \\alpha<\\kappa\\right) \\models\\left(p^{\\left|\\bar{i}^{\\prime}\\right)}\\right)_{A c \\bar{b}_{\\bar{i}^{\\prime}}}^{\\kappa}$, hence applying (1) to the family $H^{\\prime}\\left(x ; \\bar{b}_{\\bar{i}_{\\alpha}} ; c \\bar{b}_{\\bar{i}^{\\prime}}\\right):=H\\left(x ; \\bar{b}_{\\bar{i}_{\\alpha}} \\bar{b}_{\\bar{i}^{\\prime}} ; c\\right), \\alpha<\\kappa$, and generically stable type $p^{(\\omega)}$ we conclude that\n\n$$\n\\begin{aligned}\n& G(\\mathcal{U}) \\cap \\bigcap_{\\bar{i} \\in J \\omega} H\\left(\\mathcal{U}, \\bar{b}_{\\bar{i}}, c\\right) \\subseteq G(\\mathcal{U}) \\cap \\bigcap_{\\alpha<\\kappa, \\alpha \\neq 0} H^{\\prime}\\left(\\mathcal{U} ; \\bar{b}_{\\bar{i}_{\\alpha}} ; c \\bar{b}_{\\bar{i}^{\\prime}}\\right) \\\\\n& \\quad \\subseteq G(\\mathcal{U}) \\cap H^{\\prime}\\left(\\mathcal{U} ; \\bar{b}_{\\bar{i}_{0}} ; c \\bar{b}_{\\bar{i}^{\\prime}}\\right)=G(\\mathcal{U}) \\cap H\\left(\\mathcal{U}, \\bar{b}_{\\bar{i}}, c\\right)\n\\end{aligned}\n$$\n\n(3) Let $H \\in \\mathcal{F}$ be type-defined by a partial type $\\pi(x)$ with parameters in $\\bar{b} A$ for some $\\bar{b} \\models p^{(I)} \\mid{ }_{A}$ with $I$ a small linear order. We can write $H=G(\\mathcal{U}) \\cap$ $\\bigcap_{\\alpha<\\gamma} H_{\\alpha}\\left(\\mathcal{U}, \\bar{b}_{\\alpha}\\right)$ for some ordinal $\\gamma$, with each $H_{\\alpha}\\left(x, \\bar{b}_{\\alpha}\\right) \\subseteq \\pi(x)$ a countable partial type relatively defining a subgroup of $G(\\mathcal{U})$, and $\\bar{b}_{\\alpha}$ a countable subsequence of $\\bar{b}$. In particular $G(\\mathcal{U}) \\cap H_{\\alpha}(\\mathcal{U}, \\bar{b}_{\\alpha}) \\in \\mathcal{F}$, as $\\mathcal{F}$ is closed under supergroups. Fix any $J \\subseteq I,|J|=\\kappa$. For any $\\alpha<\\gamma$, applying (2) we have $G(\\mathcal{U}) \\cap \\bigcap_{\\bar{j} \\in J \\omega} H_{\\alpha}\\left(\\mathcal{U}, \\bar{b}_{\\bar{i}}\\right) \\subseteq G(\\mathcal{U}) \\cap H_{\\alpha}\\left(\\mathcal{U}, \\bar{b}_{\\alpha}\\right)$. And by indiscernibility of $\\bar{b}$ over $A, A$-invariance of $\\mathcal{F}$ and closure under intersections, we have $G(\\mathcal{U}) \\cap$ $\\bigcap_{\\bar{j} \\in J \\omega} H_{\\alpha}\\left(\\mathcal{G}, \\bar{b}_{\\bar{i}}\\right) \\in \\mathcal{F}$. Hence $G(\\mathcal{U}) \\cap H \\supseteq G(\\mathcal{U}) \\cap \\bigcap_{\\alpha<\\gamma, \\bar{j} \\in J \\omega} H_{\\alpha}\\left(\\mathcal{U}, \\bar{b}_{\\bar{i}}\\right) \\in$ $\\mathcal{F}$.\n\nQuestion 2.47. Does Lemma 2.46(2) hold only assuming that $p$ is generically stable? The answer is positive for the analog for definable groups instead of type-definable groups ([DK12, Lemma 2.1]), but the proof there does not immediately seem to generalize to the type-definable case. We also expect that an analog of Lemma 2.46 holds for invariant instead of type-definable subgroups, but do not pursue it here.\nCorollary 2.48. Let $G$ be an $\\emptyset$-type-definable group and $p \\in S_{G}(\\mathcal{U})$ a global type so that $p^{(n)}$ is generically stable for all $n<\\omega$. Assume that $p$ is invariant over a small set $A \\subset \\mathcal{U}$, and consider the family\n$\\mathcal{H}_{p, A}:=\\left\\{H \\leq G(\\mathcal{U}): H\\right.$ is type-definable over $A \\bar{b}, \\bar{b} \\models p^{\\left.||\\bar{b}|\\right|_{A}, p \\vdash H(x)\\right\\}$.\nThen the group $G_{p, A}:=\\bigcap \\mathcal{H}_{p, A}$ is type-definable over $A$, and $\\left.p\\right|_{A} \\vdash G_{p, A}$.\nProof. Let $\\kappa$ be as in Lemma 2.46, and fix some $\\bar{b} \\models p^{(\\kappa)} \\mid{ }_{A}$. Assume we are given an arbitrary small linear order $I$ and arbitrary $\\bar{b}^{\\prime} \\models p^{(I)} \\mid A$, and let $H^{\\prime} \\leq G(\\mathcal{U})$ with $p \\vdash H^{\\prime}$ be type-definable over $\\bar{b}^{\\prime} A$. We can choose some $\\bar{b}^{\\prime \\prime} \\models p^{(\\kappa)} \\mid{ }_{A \\bar{b} \\bar{b}^{\\prime}}$. Let $\\mathcal{F}:=\\{H \\leq G(\\mathcal{U}): p \\vdash H(x)\\}$. Then the family $\\mathcal{F}$ is $\\operatorname{Aut}(\\mathcal{U} / A)$-invariant by $A$-invariance of $p$, and is closed under supergroups and intersections. Applying Lemma 2.46(3) with $\\mathcal{F}$ and the sequence $\\bar{b}^{\\prime}+$ $\\bar{b}^{\\prime \\prime} \\models p^{(I+\\kappa)} \\mid A$, we find some $H^{\\prime \\prime} \\in \\mathcal{F}$ type-definable over $\\bar{b}^{\\prime \\prime} A$ with $H^{\\prime \\prime} \\subseteq H^{\\prime}$. Applying Lemma 2.46(3) again to the sequence $\\bar{b}+\\left.\\bar{b}^{\\prime \\prime} \\models p^{(\\kappa+\\kappa)}\\right|_{A}$, we find some $H \\in \\mathcal{F}$ type-definable over $\\bar{b} A$ with $H \\subseteq H^{\\prime \\prime}$. This shows that the group $G_{p, A}:=\\bigcap \\mathcal{H}_{p, A}$ is type-definable, over $A \\bar{b}$. But it is also $\\operatorname{Aut}(\\mathcal{U} / A)$ invariant (since the family $\\mathcal{H}_{p, A}$ is $\\operatorname{Aut}(\\mathcal{U} / A)$-invariant by $A$-invariance of $p$ ). Hence $G_{p, A}$ is type-definable over $A$, and $p \\mid A \\vdash G_{p, A}(x)$.\n\nQuestion 2.49. (1) Does $G_{p, A}$ depend on $A$ ?\n(2) Is $G_{p, A}$ an intersection of definable groups?\n(3) Let $p \\in S_{G}(\\mathcal{U})$ be a generically stable type (idempotent and such that $p^{(n)}$ is generically stable for all $n \\in \\omega$, if it helps). Does there exist a smallest type-definable (over a small set of parameters anywhere in $\\mathcal{U})$ group $H$ with $p \\vdash H(x)$ ?\n\nAll of these questions have a positive answer assuming $p$ is idempotent and generically transitive:\n\nProposition 2.50. Assume that $p \\in S_{G}(\\mathcal{U})$ is generically stable, idempotent and generically transitive. Then $\\operatorname{Stab}_{\\ell}(p)$ is the smallest type-definable (with parameters anywhere in $\\mathcal{U})$ subgroup $H$ of $G$ so that $p \\vdash H$.\n\nMoreover, if $p^{(n)}$ is generically stable for all $n \\in \\omega$, then $\\operatorname{Stab}_{\\ell}(p)=$ $G_{p, A}$ for any small $A \\subseteq \\mathcal{U}$ so that $p$ is invariant over $A$, and $G_{p, A}$ is an intersection of definable groups.\n\nProof. The first part is by Remark 2.11. Moreover, let $A \\subseteq \\mathcal{U}$ be such that $p$ is invariant over $A$. As $\\operatorname{Stab}_{\\ell}(p)$ is type-definable over $A$ (by Proposition 2.7) and $p \\vdash \\operatorname{Stab}_{\\ell}(p)$, by the definition of $G_{p, A}$ we have $G_{p, A} \\subseteq \\operatorname{Stab}_{\\ell}(p)$, and $\\operatorname{Stab}_{\\ell}(p) \\subseteq G_{p, A}$ by minimality as $G_{p, A}$ is type-definable. Then $G_{p, A}$ is an intersection of definable groups by Proposition 2.44.\n\nWe note however that we cannot answer Question 2.49(3) positively by proving a chain condition for groups containing $p$ and (type-)definable with arbitrary parameters:\n\nExample 2.51. Let $\\mathcal{U}=(K, \\Gamma, k)$ be a monster model of the theory ACVF of algebraically closed fields, and let $G:=(K,+)$ be the additive group. For $b \\in K, \\beta \\in \\Gamma$ and $\\square \\in\\{\\geq,>\\}$, let $B_{\\square \\beta}(b):=\\{x \\in K: v(x-b) \\square \\beta\\}$ be the closed (respectively, open) ball of radius $\\beta$ with center $b$. Fix $\\alpha \\in \\Gamma$, given a ball $B_{\\square \\alpha}(a)$, by quantifier elimination in ACVF, density of $\\Gamma$, and the fact that for any two balls either one is contained in the other, or they are disjoint,\n\n$$\n\\left\\{x \\in B_{\\square \\alpha}(a)\\right\\} \\cup\\left\\{x \\notin B_{\\square \\beta}(b): b \\in K, \\beta \\in \\Gamma, B_{\\square \\beta}(b) \\subsetneq B_{\\square \\alpha}(a)\\right\\}\n$$\n\ndetermines a complete type $p_{\\square \\alpha, a}(x) \\in S_{G}(\\mathcal{U})$, called the generic type of $B_{\\square \\alpha}(a)$.\n\nNow let $B:=B_{\\geq \\alpha}(0)$ and $p:=p_{\\geq \\alpha, 0}$. As for any $a, b$ we have $a+B_{\\square \\beta}(b)=$ $B_{\\square \\beta}(a+b)$, hence for any $b \\in B$ we have $b+B=B$ and if $B^{\\prime} \\subsetneq B$, then $b+B^{\\prime} \\subseteq B$ for any ball $B^{\\prime}$. And if $b \\in K \\backslash B$ then $(b+B) \\cap B=\\emptyset$, so we have $\\operatorname{Stab}_{\\ell}(p)=B$, and $B \\leq G(\\mathcal{U})$. In particular $p \\vdash B$, and $p$ is left- $B$-invariant. Note that $p$ generically stable over any $a \\in K$ with $v(a)=\\alpha$ (as it is internal to the residue field, or can see directly that it commutes with itself). Hence $p$ is idempotent.\n\nNote that $\\left\\{B_{>\\beta}(0): \\beta \\in \\Gamma, \\beta<\\alpha\\right\\}$ is a large strictly descending chain of definable subgroups of $G(\\mathcal{U})$ with $p \\vdash B_{>\\beta}(0)$ for all $\\beta<\\alpha$. So we have\n\narbitrary long descending chains of definable subgroups of $G(\\mathcal{U})$ containing $p$ (but the smallest one $B$ is still definable).",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 6,
      "text": "# 3. Idempotent Generically Stable MEASURes\n### 3.1. Overview. The main aim of this section is to prove the following:\n\nTheorem. (Theorem 3.45) Let $G(x)$ be an abelian type-definable group, and assume that $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is fim (Definition 3.5) and idempotent. Then $\\mu$ is the unique left-invariant (and the unique right-invariant) measure on a type-definable subgroup of $G(\\mathcal{U})$ (namely, its stabilizer).\n\nRemark 3.1. In particular, if $T$ is NIP and $G$ is abelian, there is a one-to-one correspondence between generically stable idempotent measures and type-definable fsg subgroups of $G$.\nRemark 3.2. The assumption that $\\mu$ is fim cannot be relaxed.\nIndeed, consider $G:=S^{1} \\times \\mathbb{R}$ as a definable group in $(\\mathbb{R} ;+, \\times, 0,1)$, and let $G(\\mathcal{U})=\\mathcal{S}^{1} \\times \\mathcal{R}$ be a monster model. Let $\\lambda$ be the normalized Haar measure on $S^{1}$ and $p$ the type of the cut above 0 . Let $\\lambda^{\\prime}$ be the unique smooth extension of $\\lambda$ to the monster model, $p^{\\prime}$ the unique definable extension of $p$, and $\\mu:=\\lambda^{\\prime} \\times p^{\\prime}$. Then $\\mu$ is definable and idempotent. But $\\operatorname{Stab}(\\mu)=$ $\\left\\{(\\alpha, 0): \\alpha \\in \\mathcal{S}^{1}\\right\\}$, in particular $\\mu([\\operatorname{Stab}(\\mu)])=0$, so $\\mu$ cannot satisfy the conclusion of the theorem by Remark 3.39 (see also [CG23, Example 4.5]).\n\nThis section of the paper is organized as follows. We briefly recall the setting and some properties of Keisler measures in Section 3.2. In Section 3.3 we recall some basic facts and make some new observations involving fim measures - they provide a generalization of generically stable measures from NIP to arbitrary theories in the same way as generically stable types in the sense of [PT11] provide a generalization from NIP to arbitrary theories. In Section 3.4 we prove that the usual characterization of generic stability - any Morley sequence of a fim measure determines the measure of arbitrary formulas by averaging along it - holds even when the parameters of these formulas are themselves replaced by a measure, see Theorem 3.13. In Section 3.5 we collect some basic facts about definable pushforwards of Keisler measures. In Section 3.6 we develop some theory of fim groups (i.e. groups admitting a translation invariant fim measure) in arbitrary theories, simultaneously generalizing from fsg groups in NIP theories and generically stable groups in arbitrary theories (in particular, that this translation invariant measure is unique and bi-invariant, Proposition 3.33). In Section 3.7 we develop an appropriate analog of generic transitivity for fim measures, generalizing some of the results for generically stable types from Section 2.4. Finally, in Section 3.8, we put all of this together in order to prove the main theorem of the section, adapting the weight argument from Section 2.5 to a purely measure theoretic context.\n\nIn Section 3.9 we isolate a weaker property of support transitivity and connect it to the algebraic properties of the semigroup induced by $*$ on the\n\nsupport of an idempotent measure. In Section 3.10 we illustrate how the Keisler randomization can be used to reduce generic transitivity to support transitivity in stable groups, and discuss more general situations when the randomization may have an appropriate stratified rank.\n3.2. Setting and notation. We work in the same setting as in Section 2.2. For a partitioned formula $\\varphi(x, y), \\varphi^{*}(y, x)$ is the same formula but with the roles of the variables swapped. In the group setting, if $\\varphi(x, y) \\vdash$ $\\varphi_{0}(x) \\wedge \\varphi_{0}(y)$, then $\\varphi^{\\prime}(x, y):=\\varphi(x \\cdot y)$. Let $A \\subseteq \\mathcal{U}$. Then a Keisler measure (in variable $x$ over $A$ ) is a finitely additive probability measure on $\\mathcal{L}_{x}(A)$ (modulo logical equivalence). We denote the collection of Keisler measures (in variable $x$ over $A$ ) as $\\mathfrak{M}_{\\pi}(A)$. Given $\\mu \\in \\mathfrak{M}_{\\pi}(A)$, we let $S(\\mu)$ denote the support of $\\mu$, i.e. the (closed) set of all $p \\in S_{x}(A)$ such that $\\mu(\\varphi(x))>0$ for every $\\varphi(x) \\in p$. We refer the reader to [CG22; CG23] for basic definitions involving Keisler measures (e.g. Borel-definable, definable, support of a measure, etc). Given a partial type $\\pi(x)$ over $\\mathcal{U}$, we will consider the closed set $\\mathfrak{M}_{\\pi}(\\mathcal{U}):=\\left\\{\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U}): p \\in S(\\mu) \\Rightarrow p(x) \\vdash \\pi(x)\\right\\}$ of measures supported on $\\pi(x)$.\n\nWe will assume some familiarity with the basic theory of Keisler measures and their basic properties such as (automorphism-) invariance, (Borel-) definability, finite satisfiability, etc., and refer to e.g. [Sim15] or earlier papers in the series [CG22; CG23] for the details and references.\n3.3. Fim measures. Throughout this section we work in an arbitrary theory $T$, unless explicitly specified otherwise.\nDefinition 3.3. Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U}), \\nu \\in \\mathfrak{M}_{y}(\\mathcal{U})$ and suppose that $\\mu$ is Boreldefinable. Then we define the Morley product of $\\mu$ and $\\nu$, denoted $\\mu \\otimes \\nu$, as the unique measure in $\\mathfrak{M}_{x y}(\\mathcal{U})$ such that for any $\\varphi(x, y) \\in \\mathcal{L}_{x y}(\\mathcal{U})$, we have\n\n$$\n(\\mu \\otimes \\nu)(\\varphi(x, y))=\\int_{S_{y}(A)} F_{\\mu, A}^{\\varphi} d\\left(\\widehat{\\nu \\mid A}\\right)\n$$\n\nwhere:\n(1) $\\mu$ is $A$-invariant and $A$ contains all the parameters from $\\varphi$,\n(2) $F_{\\mu, A}^{\\varphi}: S_{y}(A) \\rightarrow[0,1]$ is defined by $F_{\\mu, A}^{\\varphi}(q)=\\mu(\\varphi(x, b))$ for some (equivalently, any) $b \\models q$ in $\\mathcal{U}$,\n(3) $\\widehat{\\nu \\mid A}$ is the unique regular Borel probability measure on $S_{x}(A)$ corresponding to the Keisler measure $\\left.\\nu\\right|_{A}$.\nSee e.g. [CG22, Section 3.1] for an explanation why this product is welldefined and its basic properties. We will often abuse the notation slightly and replace $\\left.\\widehat{\\nu}\\right|_{A}$ with either $\\left.\\nu\\right|_{A}$ or simply $\\nu$ when it is clear from the context, and sometimes write $F_{\\mu, A}^{\\varphi}$ as $F_{\\mu}^{\\varphi}$.\nDefinition 3.4. Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ and suppose that $\\mu$ is Borel-definable. Then we define $\\mu^{(1)}:=\\mu\\left(x_{1}\\right), \\mu^{(n+1)}\\left(x_{1}, \\ldots, x_{n+1}\\right):=\\mu\\left(x_{n+1}\\right) \\otimes \\mu^{(n)}\\left(x_{1}, \\ldots, x_{n}\\right)$, and $\\mu^{(\\omega)}=\\bigcup_{n<\\omega} \\mu^{(n)}\\left(x_{1}, \\ldots, x_{n}\\right)$. (In general, $\\otimes$ need not be commutative/associative on Borel definable measures in arbitrary theories.)\n\nDefinition 3.5. [HPS13] Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ and $M \\prec \\mathcal{U}$ a small model. A Borel-definable measure $\\mu$ is fim (a frequency interpretation measure) over $M$ if $\\mu$ is $M$-invariant and for any $\\mathcal{L}$-formula $\\varphi(x, y)$ there exists a sequence of formulas $\\left(\\theta_{n}\\left(x_{1}, \\ldots, x_{n}\\right)\\right)_{1 \\leq n<\\omega}$ in $\\mathcal{L}(M)$ such that:\n(1) for any $\\varepsilon>0$, there exists some $n_{\\varepsilon} \\in \\omega$ satisfying: for any $k \\geq n_{\\varepsilon}$, if $\\mathcal{U} \\models \\theta_{k}(\\bar{a})$ then\n\n$$\n\\sup _{b \\in \\mathcal{U}^{g}}|\\operatorname{Av}(\\bar{a})(\\varphi(x, b))-\\mu(\\varphi(x, b))|<\\varepsilon\n$$\n\n(2) $\\lim _{n \\rightarrow \\infty} \\mu^{(n)}\\left(\\theta_{n}(\\bar{x})\\right)=1$.\n\nWe say that $\\mu$ is fim if $\\mu$ is fim over some small $M \\prec \\mathcal{U}$.\nRemark 3.6. In NIP theories, fim is equivalent to each of the following two properties for measures: $d f s$ (definable and finitely satisfiable) and fam (finitely approximable [CS21]), recovering the usual notion of generic stability for Keisler measures [HPS13]. Outside of the NIP context, fim (properly) implies fam over a model, which in turn (properly) implies $d f s$ (see [CG20; CGH23b]).\n\nGeneralizing from generically stable measures in NIP, one has:\nFact 3.7. [CGH23b] If $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ is fim and $\\nu \\in \\mathfrak{M}_{y}(\\mathcal{U})$ is Borel definable, then $\\mu \\otimes \\nu=\\nu \\otimes \\mu$.\n\nDefinition 3.8. [CGH23a] Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ and $M \\prec \\mathcal{U}$ a small submodel such that $\\mu$ is $M$-invariant, and $\\mathbf{x}=\\left(x_{i}\\right)_{i<\\omega}$. We say that $\\mu$ is self-averaging over $M$ if for any measure $\\lambda \\in \\mathfrak{M}_{\\mathbf{x}}(\\mathcal{U})$ with $\\left.\\lambda\\right|_{M}=\\left.\\mu^{(\\omega)}\\right|_{M}$ and any formula $\\varphi(x) \\in \\mathcal{L}_{x}(\\mathcal{U})$ we have\n\n$$\n\\lim _{i \\rightarrow \\infty} \\lambda\\left(\\varphi\\left(x_{i}\\right)\\right)=\\mu(\\varphi(x))\n$$\n\nThe following generalizes a standard characterization of generically stable measures in NIP theories [HPS13] to fim measures in arbitrary theories (and demonstrates in particular that if $p \\in S_{x}(\\mathcal{U})$ is fim viewed as a Keisler measure, then it is generically stable in the sense of Section 2.1; indeed, $p$ is generically stable over $M$ if for every Morley sequence $\\left(a_{i}\\right)_{i<\\omega}$ in $p$ over $M$ we have $\\lim _{i \\rightarrow \\omega} \\operatorname{tp}\\left(a_{i} / \\mathcal{U}\\right)=p-$ and if $\\delta_{p}$ is self-averaging, this property holds, see [CG20, Proposition 3.2]):\n\nFact 3.9. [CGH23a, Theorem 2.7] If $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ and $\\mu$ is fim over $M$, then $\\mu$ is self-averaging over $M$.\n\nThe following would be a natural generalization of stationarity for generically stable types to measures:\n\nConjecture 3.10. Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ be fim over $M \\prec \\mathcal{U}$ and let $A$ be a small set with $M \\subseteq A \\subseteq \\mathcal{U}$. If $\\nu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ is $A$-invariant, Borel-definable, and $\\left.\\nu\\right|_{A}=\\left.\\mu\\right|_{A}$, then $\\mu=\\nu$.\n\nConjecture 3.10 is known to hold when $\\mu=p$ is a type and $T$ is an arbitrary theory (by Fact 2.1(2)) and when $\\mu$ is a measure but $T$ is NIP (by [HPS13, Proposition 3.3]). The following proposition is a special case of Conjecture 3.10 sufficient for our purposes here.\n\nProposition 3.11. Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ be fim over $M$ and $A \\supseteq M$. Suppose $\\nu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ is $A$-invariant and $\\left.\\nu\\right|_{A}=\\left.\\mu\\right|_{A}$. If either of the following holds:\n(1) $\\nu$ is definable,\n(2) or the measures $\\mu^{(n)}$ are fim for each $n \\geq 1$ and $\\nu$ is Borel-definable; then $\\mu=\\nu$.\n\nProof. The only difference between the two cases is the justification of equation $(b)$ below. Suppose that we are given some $\\nu$ with the described properties. Since $\\nu$ is $A$-invariant and (Borel-)definable, it follows that $\\nu$ is (Borel-)definable over $A$.\n\nClaim. We have that $\\left.\\nu^{(\\omega)}\\right|_{A}=\\left.\\mu^{(\\omega)}\\right|_{A}$ (in either of the two cases).\nProof. By assumption $\\left.\\nu^{(1)}\\right|_{A}=\\left.\\mu^{(1)}\\right|_{A}$. Assume that we have already established $\\left.\\nu^{(n)}\\right|_{A}=\\left.\\mu^{(n)}\\right|_{A}$ for some $n \\in \\omega$. Fix an arbitrary formula $\\theta\\left(x_{1}, \\ldots, x_{n+1}\\right) \\in$ $\\mathcal{L}_{x_{1}, \\ldots, x_{n+1}}(A)$ and $\\varepsilon>0$. Let $\\rho\\left(x_{n+1} ; x_{1}, \\ldots, x_{n}\\right):=\\theta\\left(x_{1}, \\ldots, x_{n+1}\\right)$. Since the measure $\\mu^{(n)}\\left(x_{1}, \\ldots, x_{n}\\right)$ is definable over $A$, there exist formulas $\\psi_{1}\\left(x_{n+1}, \\bar{a}\\right), \\ldots$, $\\psi_{m}\\left(x_{n+1}, \\bar{a}\\right) \\in \\mathcal{L}_{x_{n+1}}(A)$ and $r_{1}, \\ldots, r_{m} \\in[0,1]$ such that\n\n$$\n\\sup _{q \\in S_{x_{n+1}}(A)}\\left|F_{\\mu^{(n)}, A}^{\\rho^{*}}(q)-\\sum_{i=1}^{m} r_{i} \\mathbf{1}_{\\psi_{i}\\left(x_{n+1}, \\bar{a}\\right)}(q)\\right| \\leq \\varepsilon\n$$\n\nThen we have:\n\n$$\n\\begin{aligned}\n& \\nu^{(n+1)}\\left(\\theta\\left(x_{1}, \\ldots, x_{n+1}\\right)\\right)=\\left(\\nu_{x_{n+1}} \\otimes \\nu_{x_{1}, \\ldots, x_{n}}^{(n)}\\right)\\left(\\theta\\left(x_{1}, \\ldots, x_{n+1}\\right)\\right) \\\\\n= & \\int_{S_{x_{1}, \\ldots, x_{n}}(A)} F_{\\nu_{x_{n+1}}, A}^{\\rho} \\mathrm{d}\\left(\\left.\\nu^{(n)}\\right|_{A}\\right) \\stackrel{(a)}{=} \\int_{S_{x_{1}, \\ldots, x_{n}}(A)} F_{\\nu_{x_{n+1}}, A}^{\\rho} \\mathrm{d}\\left(\\left.\\mu^{(n)}\\right|_{A}\\right) \\\\\n& \\stackrel{(b)}{=} \\int_{S_{x_{n+1}}(A)} F_{\\mu^{(n)}, A}^{\\rho^{*}} \\mathrm{~d}\\left(\\left.\\nu\\right|_{A}\\right) \\stackrel{(c)}{\\approx} \\int_{S_{x_{n+1}}(A)} \\sum_{i=1}^{m} r_{i} \\mathbf{1}_{\\psi_{i}\\left(x_{n+1}, \\bar{a}\\right)} \\mathrm{d}\\left(\\left.\\nu\\right|_{A}\\right) \\\\\n& =\\sum_{i=1}^{m} r_{i} \\nu\\left(\\psi_{i}\\left(x_{n+1}, \\bar{a}\\right)\\right) \\stackrel{(d)}{=} \\sum_{i=1}^{m} r_{i} \\mu\\left(\\psi_{i}\\left(x_{n+1}, \\bar{a}\\right)\\right) \\\\\n= & \\int_{S_{x_{n+1}}(A)} \\sum_{i=1}^{m} r_{i} \\mathbf{1}_{\\psi_{i}\\left(x_{n+1}, \\bar{a}\\right)} \\mathrm{d}\\left(\\left.\\mu\\right|_{A}\\right) \\stackrel{(c)}{\\approx} \\int_{S_{x_{n+1}}(A)} F_{\\mu^{(n)}, A}^{\\rho^{*}} \\mathrm{~d}\\left(\\left.\\mu\\right|_{A}\\right) \\\\\n= & \\left(\\mu_{x_{1}, \\ldots, x_{n}}^{(n)} \\otimes \\mu_{x_{n+1}}\\right)\\left(\\theta\\left(x_{1}, \\ldots, x_{n+1}\\right)\\right) \\stackrel{(e)}{=}\\left(\\mu_{x_{n+1}} \\otimes \\mu_{x_{1}, \\ldots, x_{n}}^{(n)}\\right)\\left(\\theta\\left(x_{1}, \\ldots, x_{n+1}\\right)\\right) \\\\\n& \\quad=\\mu^{(n+1)}\\left(\\theta\\left(x_{1}, \\ldots, x_{n+1}\\right)\\right)\n\\end{aligned}\n$$\n\nwith the following justifications for the corresponding steps:\n(a) induction hypothesis;\n\n(b) in Case (1), $\\mu^{(n)}$ is fam over $A$ since $\\mu^{(n)}$ is fam over $M$ and $M \\subseteq A$ (and fim implies fam over a model), by [CG20, Proposition 2.10(b)], $\\nu$ is definable over $A$, and fam measures commute with definable measures [CGH23b, Proposition 5.17]; in Case (2), $\\mu^{(n)}$ is fim over $A, \\nu$ is Borel-definable over $A$, and fim measures commute with Borel-definable measures [CGH23b, Proposition 5.15];\n(c) by $(\\dagger)$;\n(d) by assumption;\n(e) $\\mu_{x_{n+1}}$ is fim, and fim measures commute with all Borel-definable measures [CGH23b, Proposition 5.15] (alternatively, fam measures commute with definable measures).\nAs $\\theta$ and $\\varepsilon$ were arbitrary, we conclude $\\left.\\nu^{(n+1)}\\right|_{A}=\\left.\\mu^{(n+1)}\\right|_{A}$. And then $\\left.\\nu^{(\\omega)}\\right|_{A}=\\bigcup_{n<\\omega} \\nu^{(n)}=\\bigcup_{n<\\omega} \\mu^{(n)}=\\left.\\mu^{(\\omega)}\\right|_{A}$.\nLet now $\\varphi(x) \\in \\mathcal{L}_{x}(\\mathcal{U})$ be arbitrary. Let $\\lambda(\\mathbf{x}):=\\nu^{(\\omega)}(\\mathbf{x})$, by the claim above we have $\\left.\\lambda\\right|_{A}=\\left.\\mu^{(\\omega)}\\right|_{A}$. Note that for every $i \\in \\omega, \\lambda\\left(\\varphi\\left(x_{i}\\right)\\right)=\\nu(\\varphi(x))$. As $\\mu$ is fim over $M$, it is self-averaging over $M$ by Fact 3.9 , hence $\\nu(\\varphi(x))=$ $\\lim _{i \\rightarrow \\infty} \\lambda\\left(\\varphi\\left(x_{i}\\right)\\right)=\\mu(\\varphi(x))$.\n\nRemark 3.12. Our proof of Proposition 3.11 does not apply to the general case of Conjecture 3.10 since it is open whether or not $\\mu$ being fim implies that $\\mu^{(n)}$ is fim for $n \\geq 2$ in an arbitrary theory, even when $\\mu=p$ is a generically stable type.\n3.4. Fim measures over \"random\" parameters. In this section we prove a generalization of Fact 3.9 of independent interest, demonstrating that any Morley sequence of a fim measure determines the measure of arbitrary formulas by averaging along it - even when the parameters of these formulas are allowed to be \"random\". More precisely:\n\nTheorem 3.13. Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ be fim over $M, \\nu \\in \\mathfrak{M}_{y}(\\mathcal{U}), \\varphi(x, y, z) \\in$ $\\mathcal{L}_{x y z}, b \\in \\mathcal{U}^{z}$, and $\\mathbf{x}=\\left(x_{i}\\right)_{i \\in \\omega}$. Suppose that $\\lambda \\in \\mathfrak{M}_{\\mathbf{x} y}(\\mathcal{U})$ is arbitrary such that $\\left.\\lambda\\right|_{\\mathbf{x}, M}=\\mu^{(\\omega)}$ and $\\left.\\lambda\\right|_{y}=\\nu$. Then\n\n$$\n\\lim _{i \\rightarrow \\infty} \\lambda\\left(\\varphi\\left(x_{i}, y, b\\right)\\right)=\\mu \\otimes \\nu(\\varphi(x, y, b))\n$$\n\nMoreover for every $\\varepsilon>0$ there exists $n=n(\\mu, \\varphi, \\varepsilon) \\in \\mathbb{N}$ so that for any $\\nu, \\lambda, b$ as above, we have $\\lambda\\left(\\varphi\\left(x_{i}, y, b\\right)\\right) \\approx^{\\varepsilon} \\mu \\otimes \\nu(\\varphi(x, y, b))$ for all but $n$ many $i \\in \\mathbb{N}$.\n\nRemark 3.14. Fact 3.9 corresponds to the special case when $\\nu(y)=q(y)$ is a type. We note that this result is central to the proof of our main theorem, and is new even for NIP theories.\n\nOur proof of Theorem 3.13 relies on the use of Keisler randomization in continuous logic, as introduced and studied in [BYK09]. We will follow the notation from [CGH23a, Section 3.2]. Let $T$ be a complete first order theory. We let $T^{R}$ denote the (continuous) first order theory of its Keisler\n\nrandomization (we refer to [BYK09, Section 2] for the details). Let $M$ be a model of $T$ and let $(\\Omega, \\mathcal{B}, \\mathbb{P})$ be a probability algebra. We consider the model $M^{(\\Omega, \\mathcal{B}, \\mathbb{P})}$ of $T^{R}$, which we usually denote as $M^{\\Omega}$ for brevity, defined as follows. We let\n\n$$\nM_{0}^{\\prime}:=\\left\\{f: \\Omega \\rightarrow M: f \\text { is } \\mathcal{B} \\text {-measurable, }|\\operatorname{im}(f)|<\\aleph_{0}\\right\\}\n$$\n\nequipped with the pseudo-metric $d(f, g):=\\mathbb{P}(\\{\\omega \\in \\Omega: f(\\omega) \\neq g(\\omega)\\})$. Then $M^{\\Omega}$ is constructed by taking the metric completion of $M_{0}^{\\prime}$ and then identifying random variables up to $\\mathbb{P}$-measure 0 . We let $M_{0}^{\\Omega}$ be the set of classes of elements of $M_{0}^{\\prime}$. By construction, $M_{0}^{\\Omega}$ is a metrically dense (pre-)substructure of $M^{\\Omega}$.\n\nLet $\\mathcal{U}$ be a monster model of $T$ such that $M \\prec \\mathcal{U}$. The model $\\mathcal{U}^{\\Omega}$ is almost never saturated, so we will always think of $\\mathcal{U}^{\\Omega}$ as (elementarily) embedded into a monster model $\\mathcal{C}$ of $T^{R}$, i.e. $\\mathcal{U}^{\\Omega} \\prec \\mathcal{C}$. If $a \\in \\mathcal{U}$, we let $f_{a} \\in \\mathcal{U}_{0}^{\\Omega}$ denote the constant random variable taking value $a$, i.e. $f_{a}$ is the equivalence class of the maps which send $\\Omega$ to the point $a$ (equivalence up to measure 0 ). If $A \\subseteq \\mathcal{U}$, we let $A^{c}:=\\left\\{f_{a}: a \\in A\\right\\} \\subseteq \\mathcal{U}_{0}^{\\Omega}$. If $\\varphi\\left(x_{1}, \\ldots, x_{n}\\right)$ is an $\\mathcal{L}$-formula, we let $\\mathbb{E}\\left[\\varphi\\left(x_{1}, \\ldots, x_{n}\\right)\\right]$ denote the corresponding continuous formula in the randomization. This formula is evaluated on tuples of elements $\\bar{h}=\\left(h_{1}, \\ldots, h_{n}\\right)$ from $\\mathcal{U}_{0}^{\\Omega}$ via\n\n$$\n\\mathbb{E}[\\varphi(\\bar{h})]=\\mathbb{P}\\left(\\left\\{\\omega \\in \\Omega: \\mathcal{U} \\models \\varphi\\left(h_{1}(\\omega), \\ldots, h_{n}(\\omega)\\right)\\right\\}\\right)\n$$\n\nand is extended to $\\mathcal{U}^{\\Omega}$ via uniform limits. For $B \\subseteq \\mathcal{C}, S_{x}^{R}(B)$ will denote the space of types in the tuple of variables $x$ over $B$ in $T^{R}$.\n\nRemark 3.15. Note that for any $\\bar{h}=\\left(h_{1}, \\ldots, h_{n}\\right) \\in\\left(\\mathcal{U}_{0}^{\\Omega}\\right)^{n}$, there exists a finite $\\mathcal{B}$-measurable partition $\\mathcal{A}$ of $\\Omega$ with the property that for each $i \\leq n$ the function $h_{i}$ is constant on each element of $\\mathcal{A}$. Given such an $\\bar{h}$ and $\\mathcal{A}$, we write $\\left.\\bar{h}\\right|_{A}$ for the tuple of constant values of the functions in $\\bar{h}$ on the set $A$. Note that for each $A \\in \\mathcal{A},\\left.\\bar{h}\\right|_{A}$ is an element of $\\mathcal{U}^{n}$.\n\nThe following fact can be derived from basic facts about continuous logic:\nFact 3.16. Suppose that $p \\in S_{x}^{R}\\left(\\mathcal{U}^{\\Omega}\\right)$. Then there exists a net of tuples $\\left(h_{i}\\right)_{i \\in I}$ where $h_{i} \\in\\left(\\mathcal{U}_{0}^{\\Omega}\\right)^{x}$ such that $\\lim _{i \\in I} \\operatorname{tp}^{R}\\left(h_{i} / \\mathcal{U}^{\\Omega}\\right)=p$.\n\nThe following observations were made by Ben Yaacov in an unpublished note [BY09]. For a detailed verification, we refer the reader to [CGH23a, Section 3.2].\n\nFact 3.17. Let $\\mathcal{U}$ be a monster model of $T, \\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$, and $\\mathcal{U}^{\\Omega} \\prec \\mathcal{C}$.\n(1) There exists a unique type $p_{\\mu} \\in S_{x}^{R}\\left(\\mathcal{U}^{\\Omega}\\right)$ such that for any $\\mathcal{L}$-formula $\\varphi(x, \\bar{y}), \\bar{h}=\\left(h_{1}, \\ldots, h_{n}\\right) \\in \\mathcal{U}_{0}^{\\Omega}$, and any measurable partition $\\mathcal{A}$ such that each element of $\\bar{h}$ is constant on each element of $\\mathcal{A}$,\n\n$$\n\\left(\\mathbb{E}[\\varphi(x, \\bar{h})]\\right)^{p_{\\mu}}=\\sum_{A \\in \\mathcal{A}} \\mathbb{P}(A) \\mu\\left(\\varphi\\left(x,\\left.\\bar{h}\\right|_{A}\\right)\\right)\n$$\n\n(2) If $\\mu$ is definable, then there exists a unique type $r_{\\mu} \\in S_{x}^{R}(\\mathcal{C})$ such that:\n(a) $\\left.r_{\\mu}\\right|_{\\mathcal{U}^{\\Omega}}=p_{\\mu}$\n(b) $r_{\\mu}$ is definable over $\\mathcal{U}^{\\Omega}$; if $\\mu$ is $M$-definable, then $r_{\\mu}$ is $M^{\\Omega}$ definable.\n\nRemark 3.18. The claims in Fact 3.17 hold in the context where $x$ is an infinite tuple of variables. The infinitary results follow easily from their finite counterparts.\n\nCorollary 3.19. Suppose that $\\mathbf{x}=\\left(x_{i}\\right)_{i<\\alpha}, \\mathbf{y}=\\left(y_{i}\\right)_{i<\\beta}$, and $\\lambda \\in \\mathfrak{M}_{\\mathbf{x y}}(\\mathcal{U})$. Then\n\n$$\n\\left.\\left.\\left(p_{\\lambda}\\right)\\right|_{\\mathbf{x}, M^{\\Omega}}=p_{\\left(\\left.\\lambda\\right|_{\\mathbf{x}}\\right)}\\right|_{M^{\\Omega}} \\text { and }\\left.\\left(p_{\\lambda}\\right)\\right|_{\\mathbf{y}}=p_{\\left(\\left.\\lambda\\right|_{\\mathbf{y}}\\right)}\n$$\n\nProof. Fix $\\bar{x}=\\left(x_{i_{1}}, \\ldots, x_{i_{n}}\\right)$ and $\\bar{h}:=\\left(h_{1}, \\ldots, h_{m}\\right) \\in\\left(M^{\\Omega}\\right)^{m}$. Fix a finite measurable partition $\\mathcal{A}$ of $\\Omega$ such that each element of $\\bar{h}$ is constant on each element of $\\mathcal{A}$. From the definitions we have:\n\n$$\n\\begin{aligned}\n\\left(\\mathbb{E}[\\varphi(\\bar{x}, \\bar{h})]\\right)^{p_{\\lambda}} & =\\sum_{A \\in \\mathcal{A}} \\mathbb{P}(A) \\lambda\\left(\\varphi\\left(\\left.\\bar{x}, \\bar{h}\\right|_{A}\\right)\\right) \\\\\n& =\\sum_{A \\in \\mathcal{A}} \\mathbb{P}(A)\\left(\\left.\\lambda\\right|_{\\mathbf{x}}\\right)\\left(\\varphi\\left(\\left.\\bar{x}, \\bar{h}\\right|_{A}\\right)\\right) \\\\\n& =(\\mathbb{E}[\\varphi(\\bar{x}, \\bar{h})])^{p_{\\left(\\lambda \\mid \\mathbf{x}\\right)}}\n\\end{aligned}\n$$\n\nBy quantifier elimination in $T^{R}$, we conclude that $\\left.p_{\\lambda}\\right|_{\\mathbf{x}, M^{\\Omega}}=\\left.p_{\\left(\\lambda_{\\mathbf{x}}\\right)}\\right|_{M^{\\Omega}}$.\nWe recall some results from [CGH23a] connecting the randomized measures, the Morley product and generic stability in $T$ and $T^{R}$. These are [CGH23a, Proposition 3.15], [CGH23a, Corollary 3.16] and [CGH23a, Corollary 3.19], respectively.\n\nFact 3.20. Suppose $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ and $\\nu \\in \\mathfrak{M}_{y}(\\mathcal{U})$.\n(1) If $\\mu$ and $\\nu$ are definable, then\n\n$$\nr_{\\mu \\otimes \\nu}(x, y)=r_{\\mu}(x) \\otimes r_{\\nu}(y)\n$$\n\n(2) If $\\mu$ is definable, then for every $n \\geq 1$,\n\n$$\nr_{\\mu^{(n)}}(\\bar{x})=\\left(r_{\\mu}\\right)^{(n)}(\\bar{x})\n$$\n\n(3) If $\\mu$ is fim, then $r_{\\mu}$ is generically stable over $M^{\\Omega}$ (for generically stable types in continuous logic we refer to [Kha22; CGH23a; And23]).\n\nCorollary 3.21. If $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ is a definable measure then $r_{\\mu^{(\\omega)}}=\\left(r_{\\mu}\\right)^{(\\omega)}$.\nProof. First note\n\n$$\n\\left(r_{\\mu}\\right)^{(\\omega)}=\\bigcup_{1 \\leq n<\\omega} r_{\\mu}^{(n)}=\\bigcup_{1 \\leq n<\\omega} r_{\\mu^{(n)}}\n$$\n\nWe want to show that $\\bigcup_{n<\\omega} r_{\\mu^{(n)}}=r_{\\mu^{(\\omega)}}$. By quantifier elimination in $T^{R}$, it suffices to show that for every $\\mathcal{L}_{\\bar{x}, y}$-formula $\\varphi\\left(x_{1}, \\ldots, x_{k}, y\\right)$ and $b \\in \\mathcal{C}^{y}$, we\n\nhave that $\\mathbb{E}[\\varphi(\\bar{x}, b)]^{r}{ }_{\\mu}(\\omega)=\\mathbb{E}[\\varphi(\\bar{x}, b)]^{r}{ }_{\\mu(k)}$. By Fact 3.16, fix a net $\\left(h_{i}\\right)_{i \\in I}$ of elements each in $\\left(\\mathcal{U}_{0}^{\\Omega}\\right)^{y}$ such that $\\lim _{i \\in I} \\operatorname{tp}^{R}\\left(h_{i} / \\mathcal{U}^{\\Omega}\\right)=\\operatorname{tp}^{R}\\left(b / \\mathcal{U}^{\\Omega}\\right)$. For each $i \\in I$, choose a finite measurable partition $\\mathcal{A}_{i}$ of $\\Omega$ such that each element of $h_{i}$ is constant on each element of $\\mathcal{A}_{i}$. We have the following computation (using Fact 3.17 ):\n\n$$\n\\begin{aligned}\n& \\mathbb{E}[\\varphi(\\bar{x}, b)]^{r}{ }_{\\mu}(\\omega)=\\lim _{i \\in I} F_{r_{\\mu}(\\omega)}^{\\mathbb{E}[\\varphi(\\bar{x}, y)]} \\quad\\left(\\left(\\operatorname{tp}^{R}\\left(h_{i} / \\mathcal{U}^{\\Omega}\\right)\\right)\\right. \\\\\n= & \\lim _{i \\in I} \\mathbb{E}\\left[\\varphi\\left(\\bar{x}, h_{i}\\right)\\right]^{p_{\\mu}(\\omega)}=\\lim _{i \\in I} \\sum_{A \\in \\mathcal{A}_{i}} \\mathbb{P}(A) \\mu^{(\\omega)}\\left(\\varphi\\left(\\bar{x}, h_{i} \\mid A\\right)\\right) \\\\\n= & \\lim _{i \\in I} \\sum_{A \\in \\mathcal{A}_{i}} \\mathbb{P}(A) \\mu^{(k)}\\left(\\varphi\\left(\\bar{x}, h_{i} \\mid A\\right)\\right)=\\lim _{i \\in I}\\left(\\mathbb{E}\\left[\\varphi\\left(\\bar{x}, h_{i}\\right)\\right]\\right)^{p_{\\mu}(k)} \\\\\n& =\\lim _{i \\in I} F_{r_{\\mu}(k)}^{\\mathbb{E}[\\varphi(\\bar{x}, y)]} \\quad\\left(\\left(\\operatorname{tp}^{R}\\left(h_{i} / \\mathcal{U}^{\\Omega}\\right)\\right)=\\mathbb{E}[\\varphi(\\bar{x}, b)]^{r}{ }_{\\mu(k)}\n\\end{aligned}\n$$\n\nwhere the first and last equality follow from the fact that $F_{r_{\\mu}(\\omega)}^{\\mathbb{E}[\\varphi(\\bar{x}, y)]}$ and $F_{r_{\\mu}(k)}^{\\mathbb{E}[\\varphi(\\bar{x}, y)]}$ are continuous maps, by definability of $\\mu$, hence of $\\mu^{(\\omega)}$ and $\\mu^{(k)}$, and Fact $3.17(2)(\\mathrm{b})$.\n\nThe following fact is [CGH23a, Lemma 3.13].\nFact 3.22. Suppose that $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ and $\\left(h_{i}\\right)_{i \\in I}$ is a net of elements such that $h_{i} \\in\\left(\\mathcal{U}_{0}^{\\Omega}\\right)^{x}$ and $\\lim _{i \\in I} \\operatorname{tp}^{R}\\left(h_{i} / \\mathcal{U}^{\\Omega}\\right)=p_{\\mu}$. For each $i \\in I$, let $\\mathcal{A}_{i}$ be a finite measurable partition of $\\Omega$ such that each element of $h_{i}$ is constant on each $A \\in A_{i}$. Then\n\n$$\n\\lim _{i \\in I}\\left(\\sum_{A \\in \\mathcal{A}_{i}} \\mathbb{P}(A) \\delta_{\\left(h_{i} \\mid A\\right)}\\right)=\\mu\n$$\n\nwhere the limit is calculated in the space $\\mathfrak{M}_{x}(\\mathcal{U})$.\nProposition 3.23. Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ be fim over a small model $M \\prec \\mathcal{U}$, $\\nu \\in \\mathfrak{M}_{y}(\\mathcal{U})$ and $\\mathbf{x}=\\left(x_{i}\\right)_{i \\in \\omega}$ with $x_{i}$ of the same sort as $x$ for all $i$. Suppose that $\\lambda \\in \\mathfrak{M}_{\\mathbf{x} y}(\\mathcal{U})$ such that $\\left.\\lambda\\right|_{\\mathbf{x}, M}=\\left.\\mu^{(\\omega)}\\right|_{M}$ and $\\left.\\lambda\\right|_{y}=\\nu$. Then for any $\\varphi(x, y) \\in \\mathcal{L}$ we have\n\n$$\n\\lim _{i \\rightarrow \\infty} \\lambda\\left(\\varphi\\left(x_{i}, y\\right)\\right)=\\mu \\otimes \\nu(\\varphi(x, y))\n$$\n\nProof. The measures $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U}), \\lambda \\in \\mathfrak{M}_{\\mathbf{x} y}(\\mathcal{U}), \\mu^{(\\omega)} \\in \\mathfrak{M}_{\\mathbf{x}}(\\mathcal{U})$ and $\\nu \\in$ $\\mathfrak{M}_{y}(\\mathcal{U})$ can be associated to complete types $p_{\\mu} \\in S_{x}^{R}\\left(\\mathcal{U}^{\\Omega}\\right), p_{\\lambda} \\in S_{\\mathbf{x} y}^{R}\\left(\\mathcal{U}^{\\Omega}\\right)$, $p_{\\mu^{(\\omega)}} \\in S_{\\mathbf{x} y}^{R}\\left(\\mathcal{U}^{\\Omega}\\right)$ and $p_{\\nu} \\in S_{y}^{R}\\left(\\mathcal{U}^{\\Omega}\\right)$, respectively, by Fact 3.17(1). As $\\mu$ is $M$-definable, $\\mu^{(\\omega)}$ is also $M$-definable, and so the types $r_{\\mu} \\in S_{x}(\\mathcal{C})$ and $r_{\\mu(\\omega)} \\in S_{\\mathbf{x}}(\\mathcal{C})$ are well-defined and definable over $M^{\\Omega}$ by Fact 3.17(2). We then have:\n(1) $r_{\\mu}$ is generically stable over $M^{\\Omega}$ (by Fact 3.20(3));\n(2) $\\left.r_{\\mu^{(\\omega)}}\\right|_{M^{\\Omega}}=\\left.\\left(r_{\\mu}\\right)^{(\\omega)}\\right|_{M^{\\Omega}}$ (by Corollary 3.21);\n(3) $\\left.p_{\\lambda}\\right|_{\\mathbf{x}, M^{\\Omega}}=\\left.p_{\\mu^{(\\omega)}}\\right|_{M^{\\Omega}}=\\left.r_{\\mu^{(\\omega)}}\\right|_{M^{\\Omega}}$ and $\\left.p_{\\lambda}\\right|_{y}=p_{\\nu}$ (by Corollary 3.19).\n\nLet $\\mathbf{a}=\\left(a_{i}\\right)_{i \\in \\omega}$ and $b$ in $\\mathcal{C}$ be so that $(\\mathbf{a}, b) \\models p_{\\lambda}$. Then $\\mathbf{a}$ is a Morley sequence in $r_{\\mu}$ over $M^{\\Omega}$ by (2) and (3) from above. By Fact 3.16, choose a net $\\left(h_{j}\\right)_{j \\in J}$ of tuples in $\\left(\\mathcal{U}_{0}\\right)^{y}$ such that $\\lim _{j \\in J} \\operatorname{tp}^{R}\\left(h_{j} / \\mathcal{U}^{\\Omega}\\right)=\\operatorname{tp}^{R}\\left(b / \\mathcal{U}^{\\Omega}\\right)=p_{\\nu}$. For each $h_{j}$, choose a finite measurable partition $\\mathcal{A}_{j}$ of $\\Omega$ such that each function in $h_{j}$ is constant on each element of $\\mathcal{A}_{j}$. Now, given any $\\varphi(x, y) \\in \\mathcal{L}$, we then have the following computation:\n\n$$\n\\begin{aligned}\n& \\lim _{i \\rightarrow \\infty} \\lambda\\left(\\varphi\\left(x_{i}, y\\right)\\right)=\\lim _{i \\rightarrow \\infty} \\mathbb{E}\\left[\\varphi\\left(x_{i}, y\\right)\\right]^{p_{\\lambda}}=\\lim _{i \\rightarrow \\infty} \\mathbb{E}\\left[\\varphi\\left(a_{i}, b\\right)\\right] \\stackrel{(a)}{=} \\mathbb{E}[\\varphi(x, b)]^{r_{\\mu}} \\\\\n& \\quad=F_{r_{\\mu}}^{\\varphi}\\left(\\operatorname{tp}^{R}\\left(b / \\mathcal{U}^{\\Omega}\\right)\\right) \\stackrel{(b)}{=} \\lim _{j \\in J} F_{r_{\\mu}}^{\\varphi}\\left(\\operatorname{tp}^{R}\\left(h_{j} / \\mathcal{U}^{\\Omega}\\right)\\right)=\\lim _{j \\in J} \\mathbb{E}\\left[\\varphi\\left(x, h_{j}\\right)\\right]^{p_{\\mu}} \\\\\n& \\stackrel{(c)}{=} \\lim _{j \\in J} \\sum_{A \\in \\mathcal{A}_{j}} \\mathbb{P}(A) \\mu\\left(\\varphi\\left(x, h_{j} \\mid{ }_{A}\\right)\\right) \\stackrel{(d)}{=} \\lim _{j \\in J} \\int_{S_{y}(\\mathcal{U})} F_{\\mu}^{\\varphi} \\mathrm{d}\\left(\\sum_{A \\in \\mathcal{A}_{j}} \\mathbb{P}(A) \\delta_{\\left(h_{j} \\mid A\\right)}\\right) \\\\\n& \\stackrel{(e)}{=} \\int_{S_{y}(\\mathcal{U})} F_{\\mu}^{\\varphi} \\mathrm{d}\\left(\\lim _{j \\in J} \\sum_{A \\in \\mathcal{A}_{j}} \\mathbb{P}(A) \\delta_{\\left(h_{j} \\mid A\\right)}\\right) \\stackrel{(f)}{=} \\int_{S_{y}(\\mathcal{U})} F_{\\mu}^{\\varphi} d \\nu=\\mu \\otimes \\nu(\\varphi(x, y))\n\\end{aligned}\n$$\n\nwhere the corresponding equalities hold for the following reasons:\n(a) since the type $r_{\\mu} \\in S_{x}^{R}(\\mathcal{C})$ is generically stable over $M^{\\Omega}$ by (1) and $\\left(\\mathbf{a}_{i}\\right)_{i \\in \\omega}$ is a Morley sequence in $r_{\\mu}$ over $M^{\\Omega}$;\n(b) by the choice of $\\left(h_{j}\\right)_{j \\in I}$ and, as $r_{\\mu}$ is definable over $\\mathcal{U}^{\\Omega}$ by (1), the map $F_{r_{\\mu}}^{\\varphi}: S_{y}^{R}\\left(\\mathcal{U}^{\\Omega}\\right) \\rightarrow[0,1]$ is continuous;\n(c) by the definition of $p_{\\mu}$ (Fact 3.17);\n(d) for a fixed $j \\in J$, the computations of the left hand side and the right hand side are the same;\n(e) since $\\mu$ is definable, the map $F_{\\mu}^{\\varphi}: S_{y}(\\mathcal{U}) \\rightarrow[0,1]$ is continuous, hence the map $\\gamma \\in \\mathfrak{M}_{y}(\\mathcal{U}) \\mapsto \\int F_{\\mu}^{\\varphi} \\mathrm{d} \\gamma \\in[0,1]$ is continuous;\n$(f)$ by Fact 3.22 .\nWe will use the following general topological fact [CGH23a, Lemma 2.3]:\nFact 3.24. Let $f: X \\rightarrow K$ be an arbitrary function from a compact Hausdorff space to a compact interval $K \\subseteq \\mathbb{R}$. Suppose there is a closed subset $C \\subseteq K^{\\omega} \\times X$ satisfying the following properties:\n(1) the projection of $C$ onto $X$ is all of $X$;\n(2) if $(\\alpha, x) \\in C$ and $g: \\omega \\rightarrow \\omega$ is strictly increasing, then $(\\alpha \\circ g, x) \\in C$;\n(3) for any $(\\alpha, x) \\in C, \\lim _{i \\rightarrow \\infty} \\alpha(i)=f(x)$.\n\nThen $f$ is continuous and, for any $\\varepsilon>0$, there is an $n_{\\varepsilon} \\in \\mathbb{N}$ such that: for any $(\\alpha, x) \\in C,\\left\\{i \\in \\omega: \\alpha(i) \\notin_{\\varepsilon} f(x)\\right\\} \\leq n_{\\varepsilon}$.\n\nFinally, we can derive the main theorem of the section:\nProof of Theorem 3.13. The \"moreover\" clause of Theorem 3.13 for formulas without parameters follows from Proposition 3.23 by compactness (using Fact 3.24 ).\n\nNamely, first let $\\varphi(x ; y, z) \\in \\mathcal{L}(\\emptyset)$ be arbitrary. We let\n\n$$\n\\begin{aligned}\n\\mathfrak{M}_{L}(\\mathcal{U}): & =\\left\\{\\eta \\in \\mathfrak{M}_{\\mathbf{x} y z}(\\mathcal{U}):\\left.\\eta\\right|_{\\mathbf{x}, M}=\\left.\\mu^{(\\omega)}\\right|_{M}\\right\\}, X:=\\mathfrak{M}_{y z}(\\mathcal{U}), K=[0,1] \\\\\nf: & X \\rightarrow K \\text { defined by } \\nu \\in \\mathfrak{M}_{y z}(\\mathcal{U}) \\mapsto \\mu \\otimes \\nu(\\varphi(x, y, z)), \\text { and } \\\\\nC:= & \\left\\{\\left(\\left(\\eta\\left(\\varphi\\left(x_{i}, y, z\\right)\\right): i \\in \\omega\\right),\\left.\\eta\\right|_{y z}\\right): \\eta \\in \\mathfrak{M}_{L}(\\mathcal{U})\\right\\} \\subseteq[0,1]^{\\omega} \\times X\n\\end{aligned}\n$$\n\nThe assumptions of Fact 3.24 are satisfied. Indeed, (1) holds since for every $\\nu \\in \\mathfrak{M}_{g z}(\\mathcal{U}), \\eta:=\\mu^{(\\omega)} \\otimes \\nu$ gives an element in $C$ projecting onto it. (2) For every strictly increasing $g: \\omega \\rightarrow \\omega$ we have a continuous map $g^{\\prime}: S_{\\mathbf{x}}(\\mathcal{U}) \\rightarrow$ $S_{\\mathbf{x}}(\\mathcal{U})$ defined by $\\varphi\\left(x_{1}, \\ldots, x_{n}\\right) \\in g^{\\prime}(p) \\Longleftrightarrow \\varphi\\left(x_{g(1)}, \\ldots, x_{g(n)}\\right) \\in p$. Now if $\\left.\\eta\\right|_{\\mathbf{x}, M}=\\left.\\mu^{(\\omega)}\\right|_{M}$ then still $\\left.g_{*}(\\eta)\\right|_{\\mathbf{x}, M}=\\left.\\mu^{(\\omega)}\\right|_{M}$, where $g_{*}(\\eta)$ is the pushforward of the measure $\\eta$ by $g$ (see Definition 3.25). And (3) holds by Proposition 3.23. Then we obtain the required $n=n(\\mu, \\varphi, \\varepsilon)$ applying Fact 3.24 .\n\nNow assume we are given $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U}), \\varepsilon>0$, and $\\psi(x, y) \\in \\mathcal{L}(\\mathcal{U})$ is an arbitrary formula with parameters, say of the form $\\varphi(x, y, b)$ for some $b \\in \\mathcal{U}^{z}$ and $\\varphi(x, y, z) \\in \\mathcal{L}(\\emptyset)$. Let $n=n(\\mu, \\varphi, \\varepsilon) \\in \\omega$ be as given by the above for the formula $\\varphi(x, y, z)$ without parameters. Given any $\\lambda \\in \\mathfrak{M}_{\\mathbf{x} y}(\\mathcal{U})$ with $\\left.\\lambda\\right|_{\\mathbf{x}, M}=\\left.\\mu^{(\\omega)}\\right.$ and $\\left.\\lambda\\right|_{y}=\\nu$, consider the measures $\\lambda_{b} \\in \\mathfrak{M}_{\\mathbf{x} y z}(\\mathcal{U})$ defined by $\\lambda_{b}(\\mathbf{x}, y, z):=\\lambda(\\mathbf{x}, y) \\otimes \\delta_{b}(z)$, and $\\nu_{b} \\in \\mathfrak{M}_{y z}(\\mathcal{U})$ defined by $\\nu_{b}(y, z)=$ $\\nu(y) \\otimes \\delta_{b}(z)$. Note that $\\left.\\lambda_{b}\\right|_{y z}=\\nu_{b}$. By the choice of $n$ and the previous paragraph (with $\\lambda_{b}$ and $\\nu_{b}$ in place of $\\lambda$ and $\\nu$ ) we have\n$\\lim _{i \\rightarrow \\infty} \\lambda\\left(\\varphi\\left(x_{i}, y, b\\right)\\right)=\\lim _{i \\rightarrow \\infty} \\lambda_{b}\\left(\\varphi\\left(x_{i}, y, z\\right)\\right)=\\mu \\otimes \\nu_{b}(\\varphi(x, y, z))=\\mu \\otimes \\nu(\\varphi(x, y, b))$.\n3.5. Definable pushforwards of Keisler measures. We record some basic facts about definable pushforwards of Keisler measures.\nDefinition 3.25. Let $f: \\mathcal{U}^{x} \\rightarrow \\mathcal{U}^{y}$ be a definable map. For $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$, we define the push-forward measure $f_{*}(\\mu)$ in $\\mathfrak{M}_{y}(\\mathcal{U})$, where for any formula $\\varphi(y) \\in \\mathcal{L}_{y}(\\mathcal{U}), f_{*}(\\mu)(\\varphi(y))=\\mu(\\varphi(f(x)))$.\nProposition 3.26. Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$. Let $A \\subseteq \\mathcal{U}$ be a small set and let $f: \\mathcal{U}^{x} \\rightarrow \\mathcal{U}^{y}$ be an $A$-definable map. Then we have the following:\n(1) if $\\mu$ is $A$-invariant, then $f_{*}(\\mu)$ is $A$-invariant;\n(2) if $\\mu$ is $A$-definable, then $f_{*}(\\mu)$ is $A$-definable;\n(3) if $\\mu$ is fim over $A$, then $f_{*}(\\mu)$ is fim over $A$;\n(4) $\\left\\{f_{*}(p): p \\in S(\\mu)\\right\\}=S\\left(f_{*}(\\mu)\\right)$.\n\nProof. (1) Straightforward.\n(2) Note that for any formula $\\varphi(y, z) \\in \\mathcal{L}_{y z}$, we have $F_{f_{*}(\\mu), A}^{\\varphi}=F_{\\mu, A}^{\\varphi_{f}}$ where $\\varphi_{f}(x, z):=\\varphi(f(x), z)$.\n(3) Let $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ be fim over $A$.\n\nClaim. For any $\\theta\\left(y_{1}, \\ldots, y_{n}\\right) \\in \\mathcal{L}(\\mathcal{U})$,\n\n$$\n\\left(f_{*}(\\mu)\\right)^{(n)}\\left(\\theta\\left(y_{1}, \\ldots, y_{n}\\right)\\right)=\\mu^{(n)}\\left(\\theta\\left(f\\left(x_{1}\\right), \\ldots, f\\left(x_{n}\\right)\\right)\\right)\n$$\n\nProof. We prove the claim by induction on $n$. The base case $n=1$ is trivial. Assume the claim holds for $n$. For $1 \\leq k<\\omega$, let $G_{k}:\\left(\\mathcal{U}^{x}\\right)^{k} \\rightarrow\\left(\\mathcal{U}^{y}\\right)^{k}$ be the $A$-definable map given by $G_{k}\\left(x_{1}, \\ldots, x_{k}\\right)=\\left(f\\left(x_{1}\\right), \\ldots, f\\left(x_{k}\\right)\\right)$. Note that $G_{k}$ induces a pushforward from $\\mathfrak{M}_{x_{1}, \\ldots, x_{k}}(\\mathcal{U})$ to $\\mathfrak{M}_{y_{1}, \\ldots, y_{k}}(\\mathcal{U})$. Then our induction hypothesis says $\\left(f_{*}(\\mu)\\right)^{(n)}=\\left(G_{n}\\right)_{*}\\left(\\mu^{(n)}\\right)$. Fix $\\theta\\left(y_{1}, \\ldots, y_{n+1}\\right) \\in$ $\\mathcal{L}(\\mathcal{U})$ and let\n\n$$\n\\begin{gathered}\n\\psi\\left(y_{n+1} ; y_{1}, \\ldots, y_{n}\\right):=\\theta\\left(y_{1}, \\ldots, y_{n+1}\\right) \\\\\n\\psi_{G}\\left(x_{n+1} ; x_{1}, \\ldots, x_{n}\\right):=\\theta\\left(f\\left(x_{1}\\right), \\ldots, f\\left(x_{n+1}\\right)\\right)\n\\end{gathered}\n$$\n\nLet $N \\prec \\mathcal{U}$ be a small model containing $A$ and all relevant parameters. Then\n\n$$\n\\begin{gathered}\n\\left(f_{*}(\\mu)\\right)^{(n+1)}\\left(\\theta\\left(y_{1}, \\ldots, y_{n+1}\\right)\\right)=\\left(f_{*}(\\mu)_{y_{n+1}} \\otimes\\left(f_{*}(\\mu)\\right)_{y_{1}, \\ldots, y_{n}}^{(n)}\\right)\\left(\\theta\\left(y_{1}, \\ldots, y_{n+1}\\right)\\right) \\\\\n=\\int_{S_{y_{1}, \\ldots, y_{n}}(N)} F_{f_{*}(\\mu)}^{\\psi} \\mathrm{d}\\left(\\left(f_{*}(\\mu)\\right)^{(n)}\\right)=\\int_{S_{y_{1}, \\ldots, y_{n}}(N)} F_{f_{*}(\\mu)}^{\\psi} \\mathrm{d}\\left(\\left(G_{n}\\right)_{*}\\left(\\mu^{(n)}\\right)\\right) \\\\\n=\\int_{S_{x_{1}, \\ldots, x_{n}}(N)}\\left(F_{f_{*}(\\mu)}^{\\psi} \\circ G_{n}\\right) \\mathrm{d} \\mu^{(n)}=\\int_{S_{x_{1}, \\ldots, x_{n}}(N)} F_{\\mu}^{\\psi_{\\mathbb{G}}} \\mathrm{d} \\mu^{(n)} \\\\\n=\\mu^{(n+1)}\\left(\\theta\\left(f\\left(x_{1}\\right), \\ldots, f\\left(x_{n+1}\\right)\\right)\\right)\n\\end{gathered}\n$$\n\nWe now show that $f_{*}(\\mu)$ is fim over $A$. Fix a formula $\\varphi(y, z)$ in $\\mathcal{L}_{y z}$. Since $\\mu$ is fim, let $\\left(\\theta_{n}\\left(x_{1}, \\ldots, x_{n}\\right)\\right)_{1 \\leq n<\\omega}$ be a sequence of $\\mathcal{L}(A)$-formulas witnessing this for the formula $\\varphi(f(x), z)$ as in Definition 3.5. To avoid \"scope-of-quantifiers\" confusion, we let $w_{1}, \\ldots, w_{n}$ be new variables with $w_{i}$ of the same sort as $x_{i}$ for each $i$. For each $1 \\leq n<\\omega$, we consider the $\\mathcal{L}(A)$-formula\n\n$$\n\\gamma_{n}\\left(y_{1}, \\ldots, y_{n}\\right):=\\exists w_{1} \\ldots \\exists w_{n}\\left(\\theta\\left(w_{1}, \\ldots, w_{n}\\right) \\wedge \\bigwedge_{1 \\leq i \\leq n} f\\left(w_{i}\\right)=y_{i}\\right)\n$$\n\nNote that\n\n$$\n\\theta\\left(x_{1}, \\ldots, x_{n}\\right) \\vdash \\gamma_{n}\\left(f\\left(x_{1}\\right), \\ldots, f\\left(x_{n}\\right)\\right) \\text { for every } n \\in \\omega\n$$\n\nWe will show that the formulas $\\left(\\gamma_{n}\\left(y_{1}, \\ldots, y_{n}\\right)\\right)_{1 \\leq n<\\omega}$ witness that $f_{*}(\\mu)$ is fim over $A$ with respect to the formula $\\varphi(y, z)$.\n\nFix $\\varepsilon>0$. Then there exists some $n_{\\varepsilon} \\in \\omega$ so that: for any $n_{\\varepsilon} \\leq k<\\omega$ and any $\\bar{d}$ with $\\models \\theta_{k}(\\bar{d})$ we have\n\n$$\n\\sup _{b \\in \\mathcal{U}^{x}}|\\operatorname{Av}(\\bar{d})(\\varphi(f(x), b))-\\mu(\\varphi(f(x), b))|<\\varepsilon\n$$\n\nNow, suppose that $\\bar{c}$ is such that $\\mathcal{U}=\\gamma_{k}(\\bar{c})$. Then, by definition of $\\gamma_{k}$, there exists some $\\bar{e} \\in\\left(\\mathcal{U}^{x}\\right)^{k}$ such that $\\models \\theta_{k}(\\bar{e})$ and $\\left(f\\left(e_{1}\\right), \\ldots, f\\left(e_{k}\\right)\\right)=$ $\\left(c_{1}, \\ldots, c_{k}\\right)$. Therefore,\n\n$$\n\\begin{gathered}\n\\sup _{b \\in \\mathcal{U}^{x}}|\\operatorname{Av}(\\bar{e})(\\varphi(y, b))-f_{*}(\\mu)(\\varphi(y, b))| \\\\\n=\\sup _{b \\in \\mathcal{U}^{x}}\\left|\\operatorname{Av}\\left(c_{1}, \\ldots, c_{n}\\right)(\\varphi(y, b))-\\mu(\\varphi(f(x), b))\\right|\n\\end{gathered}\n$$\n\n$$\n\\begin{aligned}\n& =\\sup _{b \\in \\mathcal{U}^{x}}\\left|\\operatorname{Av}\\left(f\\left(e_{1}\\right), \\ldots, f\\left(e_{n}\\right)\\right)(\\varphi(y, b))-\\mu(\\varphi(f(x), b))\\right| \\\\\n& =\\sup _{b \\in \\mathcal{U}^{x}}\\left|\\operatorname{Av}\\left(e_{1}, \\ldots, e_{n}\\right)(\\varphi(f(x), b))-\\mu(\\varphi(f(x), b))\\right| \\stackrel{(* *)}{<} \\varepsilon\n\\end{aligned}\n$$\n\nFinally, by the Claim and $(*)$ we have\n\n$$\n\\begin{gathered}\n\\lim _{n \\rightarrow \\infty}\\left(\\left(f_{*}(\\mu)\\right)^{(n)}\\left(\\gamma_{n}\\left(y_{1}, \\ldots, y_{n}\\right)\\right)\\right)=\\lim _{n \\rightarrow \\infty} \\mu^{(n)}\\left(\\gamma_{n}\\left(f\\left(x_{1}\\right), \\ldots, f\\left(x_{n}\\right)\\right)\\right) \\\\\n\\geq \\lim _{n \\rightarrow \\infty} \\mu^{(n)}\\left(\\theta_{n}\\left(x_{1}, \\ldots, x_{n}\\right)\\right)=1\n\\end{gathered}\n$$\n\nWe conclude $f_{*}(\\mu)$ is fim.\n(4) $(\\subseteq)$ is trivial. For the opposite inclusion, consider $q \\in S\\left(f_{*}(\\mu)\\right)$. Let $\\pi(x)$ be the closure of $\\{\\varphi(f(x)): \\varphi(y) \\in q\\}$ under logical consequence. Then, every formula in $\\pi(x)$ has positive $\\mu$-measure and $\\pi(x)$ is closed under conjunction. So $\\pi(x)$ can be extended to a type $p \\in S(\\mu)$. It is clear that $f_{*}(p)=q$.\n3.6. Fim and fsg groups. Throughout this section, $G(x)$ will be a $\\emptyset$-typedefinable group. Let $\\varphi_{0}(x) \\in \\mathcal{L}(\\emptyset)$ be chosen for $G(x)$ as in Section 2.2.\n\nDefinition 3.27. [HP11, Definition 6.1] A ( $\\emptyset$-)type-definable group $G$ is $f s g$ (finitely satisfiable generics) if there is some $p \\in S_{G}(\\mathcal{U})$ and small $M \\prec \\mathcal{U}$ such that for every $g \\in G(\\mathcal{U}), g \\cdot p$ is finitely satisfiable in $G(M)$. (We note that for definable $G$, we could equivalently just require finite satisfiability in $M$, but in the type-definable case finite satisfiability in $G(M)$ is a stronger condition.)\n\nWe consider a natural generalization of generically stable groups (Section 2.3) to fim groups.\n\nDefinition 3.28. (1) We let $\\mathfrak{M}_{G}(\\mathcal{U})$ denote the (closed) set of all measures $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ supported on $G$, i.e. with $S(\\mu) \\subseteq S_{G}(\\mathcal{U})$.\n(2) For $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ and $g \\in G(\\mathcal{U})$, we let $g \\cdot \\mu:=\\left(g \\cdot-\\right)_{*}(\\mu)$ and $\\mu^{-1}:=\\left({ }^{-1}\\right)_{*}(\\mu)$ (where, as in Section 2.2, we view $\\cdot,^{-1}$ as globally defined functions whose restrictions to $G$ give the group operations). As $g \\cdot-$ and ${ }^{-1}$ are definable bijections on $\\varphi_{0}(\\mathcal{U})$, we get $S(g \\cdot \\mu)=$ $g \\cdot S(\\mu)$ and $S\\left(\\mu^{-1}\\right)=\\left\\{p^{-1}: p \\in S(\\mu)\\right\\}$ (by Proposition 3.26(4)). In particular, $g \\cdot \\mu, \\mu^{-1} \\in \\mathfrak{M}_{G}(\\mathcal{U})$. We define the right action of $G$ on $\\mathfrak{M}_{G}(\\mathcal{U})$ analogously.\n\nDefinition 3.29. We will say that a ( $\\emptyset$-)type-definable group $G(x)$ is fim if there exists a right $G$-invariant fim measure $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$, i.e. $\\mu \\cdot g=\\mu$ for all $g \\in G(\\mathcal{U})$.\n\nRemark 3.30. (1) In any theory, if $G$ is fim then it is both definably amenable and fsg.\n(2) If $T$ is NIP and $G$ is fsg, then it is fim.\n\nProof. (1) Assume $G$ is type-definable over a small model $M \\prec \\mathcal{U}$ by a partial type $G(x)=\\left\\{\\psi_{\\alpha}(x) \\in \\mathcal{L}(M): \\alpha<\\kappa\\right\\}$ and $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is left-$G(\\mathcal{U})$-invariant and fim over $M$. Let $M^{\\prime}$ with $M \\prec M^{\\prime} \\prec \\mathcal{U}$ be a small $|M|^{+}$-saturated model. We claim that $\\mu$ is finitely satisfiable in $G\\left(M^{\\prime}\\right)$ (then for any $p \\in S(\\mu)$ we have $g \\cdot p$ is finitely satisfiable in $G\\left(M^{\\prime}\\right)$ for all $g \\in G(\\mathcal{U})$ ).\n\nIndeed, assume $\\varphi(x, y) \\in \\mathcal{L}$ and $b \\in \\mathcal{U}^{g}$ with $r:=\\mu(\\varphi(x, b))>0$. As $\\mu$ is fim, there exists $n \\in \\omega$ and a formula $\\theta_{n}\\left(x_{1}, \\ldots, x_{n}\\right) \\in \\mathcal{L}(M)$ such that $\\mu^{(n)}\\left(\\theta_{n}(\\bar{x})\\right)>0$ and for any $\\bar{a}$ in $\\mathcal{U}$ with $\\models \\theta_{n}(\\bar{a})$ we have\n\n$$\n\\sup _{b \\in \\mathcal{U}^{g}}|\\operatorname{Av}(\\bar{a})(\\varphi(x, b))-\\mu(\\varphi(x, b))|<\\frac{r}{2}\n$$\n\nAs $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$, we have $\\mu\\left(\\bigwedge_{\\alpha \\in s} \\psi_{\\alpha}(x)\\right)=1$ for every finite $s \\subseteq \\kappa$. Hence $\\mu^{(n)}\\left(\\bigwedge_{1 \\leq i \\leq n} \\bigwedge_{\\alpha \\in s} \\psi_{\\alpha}\\left(x_{i}\\right)\\right)=1$. It follows that\n\n$$\n\\mu^{(n)}\\left(\\theta_{n}\\left(x_{1}, \\ldots, x_{n}\\right) \\wedge \\bigwedge_{1 \\leq i \\leq n} \\bigwedge_{\\alpha \\in s} \\psi_{\\alpha}\\left(x_{i}\\right)\\right)>0\n$$\n\nfor every finite $s \\subseteq \\kappa$. Then, by $|M|^{+}$-saturation of $M^{\\prime}$, we can find some $\\bar{a}^{\\prime}=\\left(a_{1}^{\\prime}, \\ldots, a_{n}^{\\prime}\\right)$ with $a_{i}^{\\prime} \\in G\\left(M^{\\prime}\\right)$ so that $\\models \\theta_{n}\\left(a_{1}^{\\prime}, \\ldots, a_{n}^{\\prime}\\right)$. By the choice of $\\theta_{n}$ we must have $\\models \\varphi\\left(a_{i}^{\\prime}, b\\right)$ for at least one $i$.\n(2) The standard construction of a left-invariant generically stable measure in an fsg group goes through in the type-definable case (see [HPP08, Proposition 6.2], [HPS13, Remark 4.4], and Remark 3.6).\n\nProblem 3.31. Does fsg imply definable amenability without assuming NIP? Do there exist fsg (and definably amenable) groups that are not fim?\n\nDefinition 3.32. Suppose that $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is Borel-definable. Then for any measure $\\nu \\in \\mathfrak{M}_{G}(\\mathcal{U})$, the (definable) convolution of $\\mu$ and $\\nu$, denoted $\\mu * \\nu$, is the unique measure in $\\mathfrak{M}_{G}(\\mathcal{U})$ such that for any formula $\\varphi(x) \\in \\mathcal{L}(\\mathcal{U})$,\n\n$$\n(\\mu * \\nu)(\\varphi(x))=(\\mu \\otimes \\nu)(\\varphi(x \\cdot y))\n$$\n\nWe say that $\\mu$ is idempotent if $\\mu * \\mu=\\mu$.\nWhen $T$ is NIP, it suffices to assume that $\\mu$ is invariant (under $\\operatorname{Aut}(\\mathbb{M} / M)$ for some small model $M$ ), as then $\\mu$ is automatically Borel-definable ([Sim15]). We refer to [CG22, Section 3] for a detailed discussion of when convolution is well-defined.\n\nThe following is a simultaneous generalization of Fact 2.5 from types to measures in arbitrary theories, and of the previously known case for measures under the NIP assumption [HPS13, Theorem 4.3].\n\nProposition 3.33. Suppose that $G(x)$ is a $\\emptyset$-type-definable fim group, witnessed by a right-G-invariant fim measure $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$. Then we have:\n(1) $\\mu=\\mu^{-1}$;\n(2) $\\mu$ is left $G$-invariant;\n\n(3) $\\mu$ is the unique left $G$-invariant measure in $\\mathfrak{M}_{G}(\\mathcal{U})$;\n(4) $\\mu$ is the unique right $G$-invariant measure in $\\mathfrak{M}_{G}(\\mathcal{U})$.\n\nProof. (1) Fix a formula $\\varphi(x) \\in \\mathcal{L}_{x}(\\mathcal{U})$. Let $M \\prec \\mathcal{U}$ be a small model such that $\\mu$ is $M$-invariant and $M$ contains the parameters of $\\varphi$. As $\\mu$ is fim over $M, \\mu^{-1}$ is also fim over $M$ by Proposition 3.26(3).\n\nSuppose $q(x) \\in S\\left(\\left.\\mu_{x}\\right|_{M}\\right)$ (so $q(x) \\vdash G(x)$ ). Then, for $\\left(\\varphi^{\\prime}\\right)^{*}(y, x)=\\varphi(x \\cdot y)$ (in the notation of Section 3.2) we have (for any $b \\models q(x)$ ):\n\n$$\n\\begin{gathered}\nF_{\\mu_{y}^{\\prime}}^{\\left(\\varphi^{\\prime}\\right)^{*}}(q)=\\mu_{y}^{-1}\\left(\\varphi(b \\cdot y)\\right)=\\mu_{y}\\left(\\varphi\\left(b \\cdot y^{-1}\\right)\\right)=\\mu_{y}\\left(\\varphi\\left(\\left(y \\cdot b^{-1}\\right)^{-1}\\right)\\right) \\\\\n\\stackrel{(*)}{=} \\mu_{y}\\left(\\varphi\\left(y^{-1}\\right)\\right)=\\mu_{y}^{-1}(\\varphi(y))\n\\end{gathered}\n$$\n\nwhere $(*)$ follows by right $G$-invariance of $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ applied to the formula $\\psi(y):=\\varphi\\left(y^{-1}\\right)$.\n\nUsing this and that fim measures commute with all Borel definable measures (Fact 3.7) we have:\n\n$$\n\\begin{aligned}\n\\mu * \\mu^{-1}(\\varphi(x)) & =\\mu_{x} \\otimes \\mu_{y}^{-1}(\\varphi(x \\cdot y))=\\mu_{y}^{-1} \\otimes \\mu_{x}(\\varphi(x \\cdot y)) \\\\\n=\\int_{S_{x}(M)} F_{\\mu_{y}^{-1}}^{\\left(\\varphi^{\\prime}\\right)^{*}} \\mathrm{~d} \\mu_{x} & =\\int_{S\\left(\\left.\\mu_{x}\\right|_{M}\\right)} F_{\\mu_{y}^{-1}}^{\\left(\\varphi^{\\prime}\\right)^{*}} \\mathrm{~d} \\mu_{x}=\\int_{S_{x}(M)} \\mu_{y}^{-1}(\\varphi(y)) \\mathrm{d} \\mu_{x} \\\\\n& =\\mu_{y}^{-1}(\\varphi(y))=\\mu_{x}^{-1}(\\varphi(x))\n\\end{aligned}\n$$\n\nSimilarly, for $\\varphi^{\\prime}(x, y)=\\varphi(x-y)$ and any $q(y) \\in S\\left(\\left.\\mu_{y}^{-1}\\right|_{M}\\right)($ so $q(y) \\vdash G(y))$, by right $G$-invariance of $\\mu$ we have $F_{\\mu_{x}}^{\\varphi^{\\prime}}(q)=\\mu(\\varphi(x))$. Then\n\n$$\n\\begin{aligned}\n\\mu * \\mu^{-1}(\\varphi(x)) & =\\mu_{x} \\otimes \\mu_{y}^{-1}(\\varphi(x \\cdot y))=\\int_{S_{y}(M)} F_{\\mu_{x}}^{\\varphi^{\\prime}} \\mathrm{d}\\left(\\mu_{y}^{-1}\\right) \\\\\n& =\\int_{S_{y}(M)} \\mu(\\varphi(x)) \\mathrm{d}\\left(\\mu_{y}^{-1}\\right)=\\mu(\\varphi(x))\n\\end{aligned}\n$$\n\nWe conclude that $\\mu(\\varphi(x))=\\mu^{-1}(\\varphi(x))$.\n(2) For any $a \\in G(\\mathcal{U})$ and $\\varphi(x) \\in \\mathcal{L}(\\mathcal{U})$, using (1) and right $G$-invariance of $\\mu$ for the formula $\\psi(x):=\\varphi\\left(x^{-1}\\right)$ we have:\n\n$$\n\\begin{aligned}\n\\mu(\\varphi(a \\cdot x))= & \\mu^{-1}\\left(\\varphi(a \\cdot x)\\right)=\\mu\\left(\\varphi\\left(a \\cdot x^{-1}\\right)\\right)=\\mu\\left(\\varphi\\left(\\left(x \\cdot a^{-1}\\right)^{-1}\\right)\\right) \\\\\n& =\\mu\\left(\\varphi\\left(x^{-1}\\right)\\right)=\\mu^{-1}(\\varphi(x))=\\mu(\\varphi(x))\n\\end{aligned}\n$$\n\n(3) Suppose that $\\nu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is left $G$-invariant, and let $\\varphi(x) \\in \\mathcal{L}(\\mathcal{U})$ be arbitrary. Let $M \\prec \\mathcal{U}$ be a small model such that $\\mu$ is invariant over $M$ and $M$ contains the parameters of $\\varphi$.\n\nAs in (1), for any $q(y) \\in S\\left(\\left.\\nu_{y}\\right|_{M}\\right)$ (so $q(y) \\vdash G(y)$ ), by right $G$-invariance of $\\mu$ we have $F_{\\mu_{x}}^{\\varphi^{\\prime}}(q)=\\mu(\\varphi(x))$. Hence\n$\\int_{S_{y}(M)} F_{\\mu_{x}}^{\\varphi^{\\prime}} \\mathrm{d} \\nu_{y}=\\int_{S\\left(\\left.\\nu\\right|_{M}\\right)} F_{\\mu_{x}}^{\\varphi^{\\prime}} \\mathrm{d} \\nu_{y}=\\int_{S\\left(\\left.\\nu\\right|_{M}\\right)} \\mu(\\varphi(x)) \\mathrm{d} \\nu_{y}=\\int_{S_{y}(M)} \\mu(\\varphi(x)) \\mathrm{d} \\nu_{y}$.\n\nSecond, for any $q \\in S\\left(\\left.\\mu_{x}\\right|_{M}\\right)$ (so $q(x) \\vdash G(x)$ ), by left $G$-invariance of $\\nu$ we have (for any $b \\models q$ ):\n\n$$\nF_{\\nu_{y}}^{(\\varphi^{\\prime})^{*}}(q)=\\nu(\\varphi(b \\cdot y))=\\nu(\\varphi(y))\n$$\n\nSo the map $F_{\\nu_{y}}^{(\\varphi^{\\prime})^{*}}: S\\left(\\left.\\mu\\right|_{M}\\right) \\rightarrow[0,1]$ is constant on the support of $\\mu$, hence Borel. As $\\mu$ is fim, the proof of [CGH23b, Proposition 5.15] implies\n\n$$\n\\int_{S\\left(\\left.\\mu\\right|_{M}\\right)} F_{\\nu_{y}}^{(\\varphi^{\\prime})^{*}} \\mathrm{~d} \\mu_{x}=\\int_{S_{y}(M)} F_{\\mu_{x}}^{\\varphi^{\\prime}} \\mathrm{d} \\nu_{y}\n$$\n\nwhere on the left we view $\\mu$ as a regular Borel probability measure restricted to the compact set $S\\left(\\left.\\mu\\right|_{M}\\right)$. Then\n\n$$\n\\begin{gathered}\n\\mu(\\varphi(x))=\\int_{S_{y}(M)} \\mu(\\varphi(x)) \\mathrm{d} \\nu_{y} \\stackrel{(\\star)}{=} \\int_{S_{y}(M)} F_{\\mu_{x}}^{\\varphi^{\\prime}} d \\nu_{y} \\\\\n\\stackrel{( \\ddagger)}{=} \\int_{S\\left(\\left.\\mu\\right|_{M}\\right)} F_{\\nu_{y}}^{(\\varphi^{\\prime})^{*}} \\mathrm{~d} \\mu_{x} \\stackrel{(\\dagger)}{=} \\int_{S\\left(\\left.\\mu\\right|_{M}\\right)} \\nu(\\varphi(y)) \\mathrm{d} \\mu_{x}=\\int_{S_{x}(M)} \\nu(\\varphi(y)) \\mathrm{d} \\mu_{x}=\\nu(\\varphi(y))\n\\end{gathered}\n$$\n\n(4) Let $\\nu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ be right $G$-invariant, $\\varphi(x) \\in \\mathcal{L}(\\mathcal{U})$ and $M \\prec \\mathcal{U}$ containing the parameters of $\\varphi$ and such that $\\mu$ is $M$-invariant.\n\nAs in (3), the map $F_{\\nu_{x}}^{\\varphi^{\\prime}}: S_{y}(M) \\rightarrow[0,1]$ is $\\left(\\left.\\mu_{y}\\right|_{M}\\right)$-measurable since it is constant on the support by right $G$-invariance of $\\nu$. As $\\mu$ is fim we can apply [CGH23b, Proposition 5.15] again to get\n\n$$\n\\int_{S_{y}(M)} F_{\\nu_{x}}^{\\varphi^{\\prime}} \\mathrm{d} \\mu_{y}=\\int_{S_{x}(M)} F_{\\mu_{y}}^{\\left(\\varphi^{\\prime}\\right)^{*}} \\mathrm{~d} \\nu_{x}\n$$\n\nAs $\\mu$ is left $G$-invariant by (2), for any $q \\in S\\left(\\left.\\nu_{x}\\right|_{M}\\right)$, we have (for $b \\models q$ ):\n\n$$\nF_{\\mu_{y}}^{\\left(\\varphi^{\\prime}\\right)^{*}}(q)=\\mu_{y}(\\varphi(b \\cdot y))=\\mu(\\varphi(y))\n$$\n\nCombining we get\n\n$$\n\\begin{gathered}\n\\nu(\\varphi(x))=\\int_{S_{y}(M)} \\nu(\\varphi(x)) \\mathrm{d} \\mu_{y}=\\int_{S_{y}(M)} F_{\\nu_{x}}^{\\varphi^{\\prime}} \\mathrm{d} \\mu_{y} \\\\\n=\\int_{S_{x}(M)} F_{\\mu_{y}}^{\\left(\\varphi^{\\prime}\\right)^{*}} \\mathrm{~d} \\nu_{x}=\\int_{S_{x}(M)} \\mu(\\varphi(y)) \\mathrm{d} \\nu_{x}=\\mu(\\varphi(y))\n\\end{gathered}\n$$\n\nProposition 3.33 and its symmetric version with \"left\" swapped with \"right\" (obtained by a \"symmetric\" proof) yield:\nCorollary 3.34. An ( $\\emptyset$ )-type-definable group $G(x)$ is fim if and only if there exists a left $G$-invariant fim measure $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$.\n3.7. Idempotent fim measures and generic transitivity. Let $G(x)$ be a $\\emptyset$-type-definable group, and we are in the same setting and notation as in Section 2.2. For a measure $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$, we let\n\n$$\n\\operatorname{Stab}(\\mu):=\\{g \\in G(\\mathcal{U}): \\mu \\cdot g=g\\}\n$$\n\ndenote the right-stabilizer of $\\mu$.\n\nFact 3.35. When $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is a measure definable over $M \\prec \\mathcal{U}$, then $\\operatorname{Stab}(\\mu)$ is an $M$-type-definable subgroup of $G(\\mathcal{U})$ (see e.g. [CG22, Proposition 5.3]).\n\nWe now consider the main question investigated in [CG22; CG23] in the case of measures (generalizing from types in Section 2.4).\n\nAgain, we let $H:=\\operatorname{Stab}(\\mu)$.\nDefinition 3.36. For the rest of the section, we let $f:\\left(\\mathcal{U}^{x}\\right)^{2} \\rightarrow\\left(\\mathcal{U}^{x}\\right)^{2}$ be the ( $\\emptyset$-definable) map $f\\left(x_{1}, x_{0}\\right)=\\left(x_{1} \\cdot x_{0}, x_{0}\\right)$ (where $\\cdot$ is viewed as a globally defined function whose restriction to $G$ defines the group operation, see Section 2.2).\n\nProposition 3.37. Let $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ be an idempotent fim measure. Then the following are equivalent:\n(1) $\\mu \\in \\mathfrak{M}_{H}(\\mathcal{U})$;\n(2) $\\mu^{(2)}=f_{*}\\left(\\mu^{(2)}\\right)$;\n(3) $\\mu \\otimes p=f_{*}(\\mu \\otimes p)$ for every $p \\in S(\\mu)$.\n\nProof. (2) $\\Leftrightarrow$ (3) This equivalence only uses that $\\mu$ is a definable measure.\nBy the definition of $f$ we have $f_{*}\\left(\\mu^{(2)}\\right)\\left(\\varphi\\left(x_{1}, x_{0}\\right)\\right)=\\mu^{(2)}\\left(\\tilde{\\varphi}\\left(x_{1}, x_{0}\\right)\\right)$ for all $\\varphi\\left(x_{1}, x_{0}\\right) \\in \\mathcal{L}_{x_{1}, x_{0}}(\\mathcal{U})$, where $\\tilde{\\varphi}\\left(x_{1}, x_{0}\\right):=\\varphi\\left(x_{1} \\cdot x_{0}, x_{0}\\right)$. By definition of $\\mu^{(2)}$ we have: $\\mu^{(2)} \\neq f_{*}\\left(\\mu^{(2)}\\right)$ if and only if there exists a formula $\\varphi\\left(x_{1}, x_{0}\\right) \\in$ $\\mathcal{L}_{x_{1}, x_{0}}(\\mathcal{U})$ and a small model $M \\prec \\mathcal{U}$ so that $M$ contains the parameters of $\\varphi$ and $\\mu$ is $M$-definable, such that\n\n$$\n\\int_{S\\left(\\left.\\mu\\right|_{M}\\right)}\\left|F_{\\mu, M}^{\\tilde{\\varphi}}(p)-F_{\\mu, M}^{\\varphi}(p)\\right| \\mathrm{d} \\mu_{M}>0\n$$\n\nwhere $\\left.\\mu\\right|_{M} \\in \\mathfrak{M}_{x_{0}}(M)$ is the restriction of $\\mu$ to $M, \\mu_{M}$ is the restriction $\\left.\\mu\\right|_{M}$ viewed as a regular Borel measure on $S_{x_{0}}(M)$. By definability of $\\mu$, the function $p \\in S\\left(\\left.\\mu\\right|_{M}\\right) \\mapsto\\left|F_{\\mu, M}^{\\tilde{\\varphi}}(p)-F_{\\mu, M}^{\\varphi}(p)\\right| \\in[0,1]$ is continuous (and nonnegative), hence the integral is $>0$ if and only if $\\left|F_{\\mu, M}^{\\tilde{\\varphi}}(p)-F_{\\mu, M}^{\\varphi}(p)\\right|>0$ for some $p \\in S\\left(\\left.\\mu\\right|_{M}\\right)$, that is $\\mu\\left(\\varphi\\left(x_{1}, b\\right)\\right) \\neq \\mu\\left(\\varphi\\left(x_{1} \\cdot b, b\\right)\\right)$ for some $p \\in S(\\mu)$ and $\\left.b \\models p\\right|_{M}$, that is $\\left(\\mu \\otimes p\\right)\\left(\\varphi\\left(x_{1}, x_{0}\\right)\\right) \\neq f_{*}\\left(\\mu \\otimes p\\right)\\left(\\varphi\\left(x_{1}, x_{0}\\right)\\right)$ for some $p \\in S(\\mu)$.\n(3) $\\Rightarrow$ (1) Fix $p \\in S(\\mu)$, let $M \\prec \\mathcal{U}$ be such that $\\mu$ is $M$-invariant, and let $\\left.a \\models p\\right|_{M}$.\n\nClaim 1. We have $\\left.\\left.\\mu\\right|_{M a}=(\\mu \\cdot a)\\right|_{M a}$.\nProof. Any $\\psi(x) \\in \\mathcal{L}_{x}(M a)$ is of the form $\\varphi(x, a)$ for some $\\varphi(x, y) \\in \\mathcal{L}_{x y}(M)$. By (3) we have:\n\n$$\n\\begin{gathered}\n\\mu(\\varphi(x, a))=(\\mu \\otimes p)(\\varphi(x, y))=f_{*}(\\mu \\otimes p)(\\varphi(x, y)) \\\\\n=(\\mu \\otimes p)(\\varphi(x \\cdot y, y))=\\mu(\\varphi(x \\cdot a, a))\n\\end{gathered}\n$$\n\nTherefore,\n\n$$\n(\\mu \\cdot a)(\\psi(x))=\\mu(\\psi(x \\cdot a))=\\mu(\\varphi(x \\cdot a, a))=\\mu(\\varphi(x, a))=\\mu(\\psi(x))\n$$\n\nClaim 2. The measure $\\mu \\cdot a$ is $(M a)$-definable.\nProof. Since $\\mu$ is $M$-definable, it is also $M a$-definable. Consider the $M a$ definable map $g: x \\mapsto x \\cdot a$. Note that $g_{*}(\\mu)=\\mu \\cdot a$ and so by Proposition 3.26, $\\mu \\cdot a$ is also $M a$-definable.\n\nHence, by Proposition 3.11 over $M a$, we get $\\mu=\\mu \\cdot a$. That is, $a \\in$ $\\operatorname{Stab}(\\mu)$, so $\\left.p\\right|_{M}(x) \\vdash H(x)$.\n(1) $\\Rightarrow$ (3) Let $\\varphi(x, y) \\in \\mathcal{L}(\\mathcal{U})$ be arbitrary, and $M \\prec \\mathcal{U}$ contain its parameters such that $\\mu$ is $M$-invariant. The measure $\\mu$ is right $H$-invariant, and given any $p \\in S(\\mu)$ we have $p \\in S_{H}(\\mathcal{U})$ by (1). So for $\\left.a\\right|=\\left.p\\right|_{M}$ we have $a \\in$ $H$, hence $\\mu \\otimes p(\\varphi(x, y))=\\mu(\\varphi(x, a))=\\mu(\\varphi(x \\cdot a, a))=f_{*}(\\mu \\otimes p)(\\varphi(x, y))$.\n\nDefinition 3.38. We say that an idempotent fim measure $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is generically transitive if it satisfies any of the equivalent conditions in Proposition 3.37.\n\nIn particular, a type is generically transitive in the sense of Definition 2.13 if and only if, viewed as a Keisler measure, it is generically transitive.\n\nThe following is a generalization of Remark 2.11:\nRemark 3.39. Assume $\\mu$ is fim and $\\mu \\in \\mathfrak{M}_{H}(\\mathcal{U})$. Then:\n(1) $H$ is a fim group (Definition 3.29), hence $\\mu$ is both the unique leftinvariant and the unique right-invariant measure supported on $H$ (by Proposition 3.33);\n(2) $H$ is the smallest among all type-definable subgroups $H^{\\prime}$ of $G$ with $\\mu \\in \\mathfrak{M}_{H^{\\prime}}(\\mathcal{U})$;\n(3) $H$ is both the left and the right stabilizer of $\\mu$ in $G$.\n\nProof. (1) $H$ is a fim group, witnessed by the right $H$-invariant fim measure $\\mu \\in \\mathfrak{M}_{H}(\\mathcal{U})$.\n(2) $H$ is type-definable by Fact 3.35 .\n\nFor any type-definable $H^{\\prime} \\leq G(\\mathcal{U})$ with $S(\\mu) \\subseteq S_{H^{\\prime}}(\\mathcal{U})$, the group $H^{\\prime \\prime}:=H \\cap H^{\\prime}$ is type-definable with $S(\\mu) \\subseteq S_{H^{\\prime \\prime}}(\\mathcal{U})$ and $H^{\\prime \\prime} \\leq H$. If the index is $\\geq 2$, we have some $g \\in H$ with $H^{\\prime \\prime} \\cap\\left(H^{\\prime \\prime} \\cdot g\\right)=\\emptyset$, and $S(\\mu) \\subseteq S_{H^{\\prime \\prime}}(\\mathcal{U}), S(\\mu \\cdot g) \\subseteq S_{H^{\\prime \\prime} \\cdot g}(\\mathcal{U})$, so $S(\\mu) \\cap S(\\mu \\cdot g)=\\emptyset$, so $\\mu \\neq \\mu \\cdot g-$ a contradiction. So $H^{\\prime \\prime}=H$, and $H \\subseteq H^{\\prime}$.\n(3) Let $H_{\\ell}$ be the left stabilizer of $\\mu$. Then $H_{\\ell}$ is type-definable by a symmetric version of Fact 3.35. By (1), $\\mu$ is left $H$-invariant, so we have $H \\subseteq$ $H_{\\ell}$, and so $S(\\mu) \\subseteq S_{H_{\\ell}}(\\mathcal{U})$ is left $H_{\\ell}$-invariant. By a symmetric argument as in (2), we conclude $H=H_{\\ell}$.\n\nExample 3.40. If $G^{\\prime}$ is a fim type-definable subgroup of $G$, witnessed by a $G^{\\prime}$-invariant fim measure $\\mu \\in \\mathfrak{M}_{G^{\\prime}}(\\mathcal{U})$, then $\\mu$ is obviously idempotent and generically transitive.\n\nAnalogously to the case of types (Section 2.4), the following is our main question in the case of measures:\n\nProblem 3.41. Assume that $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is fim and idempotent. Is it true that then $\\mu$ is generically transitive? Assuming $T$ is NIP?\n\nA positive answer for stable $T$ is given in [CG22], see Section 3.10 for a discussion.\n\nBy symmetric versions of the above considerations, one easily gets:\nRemark 3.42. Section 3.7 remains valid if one swaps \"left\" with \"right\" (including left and right stabilizers) and replaces $f$ by $f\\left(x_{1}, x_{0}\\right)=\\left(x_{0} \\cdot x_{1}, x_{0}\\right)$.\n3.8. Idempotent fim measures in abelian groups. Finally, we have all of the ingredients to adapt the proof in Section 2.5 from types to measures and give a positive answer to Problem 3.41 for abelian groups in arbitrary theories. Let $G(x)$ and $f$ be as in the previous section.\n\nFirst note the idempotency of a fim measure $\\mu$ can be iterated along a Morley sequence in $\\mu$ :\n\nLemma 3.43. Let $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ and suppose that $\\mu$ is fim and idempotent. Then for any formula $\\psi(x) \\in \\mathcal{L}(\\mathcal{U})$ and $k \\in \\omega$ we have\n\n$$\n\\mu(\\psi(x))=\\mu^{(k)}\\left(\\psi\\left(x_{1} \\cdot \\ldots \\cdot x_{k}\\right)\\right)\n$$\n\nProof. By induction on $k$, the base case $k=2$ is the assumption on $\\mu$. So assume that for any $\\gamma(x) \\in \\mathcal{L}(\\mathcal{U})$ and $\\ell \\leq k-1$ we have\n\n$$\n\\mu_{x_{1}, \\ldots, x_{\\ell}}^{(\\ell)}\\left(\\gamma\\left(x_{1} \\cdot \\ldots \\cdot x_{\\ell}\\right)\\right)=\\mu(\\gamma(x))\n$$\n\nFix $\\psi(x) \\in \\mathcal{L}(\\mathcal{U})$, and choose a small $M \\prec \\mathcal{U}$ such that $\\mu$ is $M$-invariant and $M$ contains the parameters of $\\psi$. Let $\\theta\\left(x_{1}, \\ldots, x_{k-1} ; x_{k}\\right):=\\psi\\left(x_{1} \\cdot \\ldots \\cdot x_{k}\\right)$ and $\\varphi\\left(x_{1} ; x_{k}\\right):=\\psi\\left(x_{1} \\cdot x_{k}\\right)$. For any $q \\in S_{x_{k}}(M)$ (and any $\\left.b \\models q\\right)$ we have\n(b) $F_{\\mu_{x_{1}, \\ldots, x_{k-1}}}^{\\theta}(q)=\\mu^{(k-1)}\\left(\\psi\\left(x_{1} \\cdot \\ldots \\cdot x_{k-1} \\cdot b\\right)\\right) \\stackrel{(\\mathrm{a})}{=} \\mu\\left(\\psi\\left(x_{1} \\cdot b\\right)\\right)=F_{\\mu_{x_{1}}}^{\\varphi}(q)$.\n\nThen, using that $\\mu$ is fim and fim measures commute with Borel definable measures,\n\n$$\n\\begin{gathered}\n\\mu^{(k)}\\left(\\psi\\left(x_{1} \\cdot \\ldots \\cdot x_{k}\\right)\\right)=\\mu_{x_{k}} \\otimes \\mu_{x_{1}, \\ldots, x_{k-1}}^{(k-1)}\\left(\\psi\\left(x_{1} \\cdot \\ldots \\cdot x_{k}\\right)\\right) \\\\\n=\\mu_{x_{1}, \\ldots, x_{k-1}}^{(k-1)} \\otimes \\mu_{x_{k}}\\left(\\psi\\left(x_{1} \\cdot \\ldots \\cdot x_{k}\\right)\\right)=\\int_{S_{x_{k}}(M)} F_{\\mu_{x_{1}, \\ldots, x_{k-1}}}^{\\theta} \\mathrm{d} \\mu_{x_{k}} \\\\\n\\stackrel{(\\mathrm{bb})}{=} \\int_{S_{x_{k}}(M)} F_{\\mu_{x_{1}}}^{\\varphi} \\mathrm{d} \\mu_{x_{k}}=\\mu_{x_{1}} \\otimes \\mu_{x_{k}}\\left(\\varphi\\left(x_{1}, x_{k}\\right)\\right)=\\mu_{x_{1}} \\otimes \\mu_{x_{k}}\\left(\\psi\\left(x_{1} \\cdot x_{k}\\right)\\right) \\stackrel{(\\mathrm{a})}{=} \\mu(\\psi(x))\n\\end{gathered}\n$$\n\nLemma 3.44. Assume that $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is fim and idempotent. Let $k \\geq 2$ be arbitrary and let $g:\\left(\\mathcal{U}^{x}\\right)^{k} \\rightarrow\\left(\\mathcal{U}^{x}\\right)^{k+1}$ be the definable map\n\n$$\ng\\left(x_{1}, \\ldots, x_{k}\\right)=\\left(x_{1} \\cdot \\ldots \\cdot x_{k}, x_{1}, \\ldots, x_{k}\\right)\n$$\n\nwhere \".\" is viewed as a globally defined function whose restriction to $G$ defines the group operation (see Section 2.2). Let $\\lambda_{k}\\left(y, x_{1}, \\ldots, x_{k}\\right):=g_{*}\\left(\\mu^{(k)}\\right)$. Then:\n(1) $\\left.\\lambda_{k}\\right|_{x_{1}, \\ldots, x_{k}}=\\mu^{(k)}$;\n(2) if $G$ is abelian, then $\\left.\\lambda_{k}\\right|_{y, x_{i}}=f_{*}\\left(\\mu^{(2)}\\left(y, x_{i}\\right)\\right)$ for every $1 \\leq i \\leq k$.\n\nProof. (1) By definition of $g$.\n(2) Let $\\varphi(y, x) \\in \\mathcal{L}(\\mathcal{U})$ be arbitrary, and let $M \\prec \\mathcal{U}$ be a small model containing its parameters, and so that $\\mu$ is $M$-invariant. We let\n\n$$\n\\begin{gathered}\n\\theta\\left(x_{1}, \\ldots, x_{i-1}, x_{i+1}, \\ldots, x_{k} ; x_{i}\\right):=\\varphi\\left(x_{1} \\cdot \\ldots \\cdot x_{k}, x_{i}\\right), \\psi(x ; y):=\\varphi(x \\cdot y, y) \\\\\n\\mu_{\\hat{x}_{i}}^{(k-1)}:=\\mu_{x_{k-1}} \\otimes \\ldots \\otimes \\mu_{x_{i+1}} \\otimes \\mu_{x_{i-1}} \\otimes \\ldots \\otimes \\mu_{x_{1}}\n\\end{gathered}\n$$\n\nUsing that $G$ is abelian and Lemma 3.43, for any $q \\in S_{x_{i}}(M)$ and $b \\models q$ we have (renaming the variables when necessary):\n\n$$\n\\begin{gathered}\nF_{\\mu_{\\hat{x}_{i}}^{(k-1)}}^{\\theta}(q)=\\mu_{\\hat{x}_{i}}^{(k-1)}\\left(\\varphi\\left(x_{1} \\cdot \\ldots \\cdot x_{i-1} \\cdot b \\cdot x_{i+1} \\cdot \\ldots \\cdot x_{k}, b\\right)\\right) \\\\\n=\\mu_{\\hat{x}_{i}}^{(k-1)}\\left(\\varphi\\left(x_{1} \\cdot \\ldots \\cdot x_{i-1} \\cdot x_{i+1} \\cdot \\ldots \\cdot x_{k} \\cdot b, b\\right)\\right) \\\\\n=\\mu_{x}(\\varphi(x \\cdot b, b))=F_{\\mu_{x}}^{\\psi}(q)\n\\end{gathered}\n$$\n\nHence, since $G$ is abelian, $\\mu$ is fim, and fim measures commute with Borel definable measures, we get\n\n$$\n\\begin{gathered}\n\\lambda_{k}\\left(\\varphi\\left(y, x_{i}\\right)\\right)=\\mu_{x_{1}, \\ldots, x_{k}}^{(k)}\\left(\\varphi\\left(x_{1} \\cdot \\ldots \\cdot x_{k}, x_{i}\\right)\\right) \\\\\n=\\mu_{\\hat{x}_{i}}^{(k-1)} \\otimes \\mu_{x_{i}}\\left(\\varphi\\left(x_{1} \\cdot \\ldots \\cdot x_{i-1} \\cdot x_{i+1} \\ldots \\cdot x_{k} \\cdot x_{i}, x_{i}\\right)\\right) \\\\\n=\\int_{S_{x_{i}}(M)} F_{\\mu_{\\hat{x}_{i}}^{(k-1)}} \\mathrm{d} \\mu_{x_{i}}=\\int_{S_{x_{i}}(M)} F_{\\mu_{x}}^{\\psi} \\mathrm{d} \\mu_{x_{i}} \\\\\n=\\mu_{x} \\otimes \\mu_{x_{i}}\\left(\\varphi\\left(x \\cdot x_{i}, x_{i}\\right)\\right)=\\mu_{x} \\otimes \\mu_{y}(\\varphi(x \\cdot y, y))=f_{*}\\left(\\mu^{(2)}\\right)(\\varphi(x, y))\n\\end{gathered}\n$$\n\nFinally, using results about the randomization (Theorem 3.13) and Lemma 3.44, we can show generic transitivity in the abelian case:\n\nTheorem 3.45. Assume that $G(x)$ is an abelian type-definable group and $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is fim and idempotent. Then $\\mu$ is generically transitive.\n\nProof. By Proposition 3.37, it suffices to show that $\\mu^{(2)}=f_{*}\\left(\\mu^{(2)}\\right)$. Assume not, say\n\n$$\n\\left|\\mu^{(2)}\\left(\\varphi\\left(x_{1}, x_{2}\\right)\\right)-f_{*}\\left(\\mu^{(2)}\\right)\\left(\\varphi\\left(x_{1}, x_{2}\\right)\\right)\\right|=\\varepsilon_{0}\n$$\n\nfor some $\\varphi\\left(x_{1}, x_{2}\\right) \\in \\mathcal{L}(\\mathcal{U})$ and some $\\varepsilon_{0}>0$. Let $M \\prec \\mathcal{U}$ be a small model containing the parameters of $\\varphi$, and so that $\\mu$ is invariant over $M$. Let $n$ be as given by the moreover part of Theorem 3.13 for $\\mu, \\varphi, \\varepsilon_{0}$. Fix any $k>n$,\n\nand consider the definable map $g:\\left(\\mathcal{U}^{x}\\right)^{k} \\rightarrow\\left(\\mathcal{U}^{x}\\right)^{k+1}$ given by $g\\left(x_{1}, \\ldots, x_{k}\\right)=$ $\\left(x_{1} \\cdot \\ldots \\cdot x_{k}, x_{1}, \\ldots, x_{k}\\right)$. Then $g$ induces a continuous map from $S_{\\mathbf{x}}(\\mathcal{U})$ to $S_{\\mathbf{x} y}(\\mathcal{U})$, where $\\mathbf{x}=\\left(x_{i}: i \\in \\omega\\right)$ and we let $\\lambda \\in \\mathfrak{M}_{\\mathbf{x} y}(\\mathcal{U})$ be defined by $\\lambda:=g_{*}\\left(\\mu^{(\\omega)}\\right)$. That is, for every $m \\in \\omega$ and every $\\varphi\\left(x_{1}, \\ldots, x_{m}, y\\right) \\in \\mathcal{L}(\\mathcal{U})$ we have\n\n$$\n\\lambda\\left(\\varphi\\left(x_{1}, \\ldots, x_{m}, y\\right)\\right)=\\mu^{(\\omega)}\\left(\\varphi\\left(x_{1}, \\ldots, x_{m}, x_{1} \\cdot \\ldots \\cdot x_{k}\\right)\\right)\n$$\n\nThen $\\left.\\lambda\\right|_{\\mathbf{x}}=\\mu^{(\\omega)}$ and $\\left.\\lambda\\right|_{\\left(x_{1}, \\ldots, x_{k}\\right) y}=\\lambda_{k}$ from Lemma 3.44, so by Lemma 3.44 we then have $\\left|\\lambda\\left(\\varphi\\left(y, x_{i}\\right)\\right)-\\mu^{(2)}(\\varphi(y, x))\\right|>\\varepsilon_{0}$ for all $i=1, \\ldots, k-$ contradicting the choice of $n$.\n3.9. Support transitivity of idempotent measures. A tempting strategy for generalizing the arguments in Sections 2.7-2.10 with ranks from idempotent types to idempotent measures in $T$ is to apply (a continuous logic version of) the proof for types in the randomization $T^{R}$ of $T$, assuming that the randomization preserves the corresponding property. E.g, stability is preserved [BYK09], and (real) rosiness is known to be preserved in some special cases [AGK19] (e.g. when $T$ is $o$-minimal). We note that simplicity of $T$ is not preserved, still one gets that $T^{R}$ is $\\mathrm{NSOP}_{1}$ assuming that $T$ is simple [BYCR24]. When attempting to implement this strategy, one arrives at the following natural condition connecting the behavior of measures and types in their support:\n\nDefinition 3.46. Assume that $G$ is a type-definable group and $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$. We say that $\\mu$ is support transitive if $\\mu * p=\\mu$ for every $p \\in S(\\mu)$.\nRemark 3.47. (1) If $p \\in S_{G}(\\mathcal{U})$ is a generically stable idempotent type, then it is obviously support transitive (viewed as a Keisler measure).\n(2) If $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is generically transitive, then it is support transitive.\n\nIndeed, note that if $p \\in S(\\mu), \\theta(x, b) \\in \\mathcal{L}_{x}(\\mathcal{U}), \\mu$ is $M$-invariant for a small model $M \\prec \\mathcal{U}$, and $c|=p|_{M b}$, then\n$(\\mu * p)(\\theta(x, b))=\\left(\\mu_{x} \\otimes p_{y}\\right)(\\theta(x \\cdot y, b))=\\mu(\\theta(x \\cdot c, b))=\\mu(\\theta(x, b))$, where the last equality follows as $p \\vdash \\operatorname{Stab}(\\mu)$ by assumption, and $\\operatorname{Stab}(\\mu)$ is $M$-type-definable by Fact 3.35 .\n\nThus, we view the following as an intermediate (and trivial in the case of types) version of our main Problem 3.41:\n\nProblem 3.48. Assume that $G$ is a type-definable group and $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is fim and idempotent. Is $\\mu$ support transitive?\n\nThe following example (based on [CG23, Example 4.5]) illustrates that the fim assumption in Problem 3.48 cannot be relaxed to either definable or Borel-definable and finitely satisfiable, even in abelian NIP groups:\n\nExample 3.49. Consider $M:=(\\mathbb{R},<,+), M \\prec \\mathcal{U}, G(\\mathcal{U})=\\mathcal{U}$ and $\\mu:=$ $\\frac{1}{2} \\delta_{p_{-\\infty}}+\\frac{1}{2} \\delta_{p_{\\infty}}$ and $\\nu:=\\frac{1}{2} \\delta_{p_{0^{-}}}+\\frac{1}{2} \\delta_{p_{0^{+}}}$, where $p_{\\infty}, p_{-\\infty}, p_{0^{+}}, p_{0^{-}}$are the unique complete 1-types satisfying:\n\n- $p_{\\infty} \\supseteq\\{x>a: a \\in \\mathbb{R}\\} \\cup\\{x<b: b \\in \\mathcal{U}, b>\\mathbb{R}\\}$,\n- $p_{-\\infty} \\supseteq\\{x<a: a \\in \\mathbb{R}\\} \\cup\\{x>b: b \\in \\mathcal{U}, b<\\mathbb{R}\\}$,\n- $p_{0^{+}} \\supseteq\\{x<a: a \\in \\mathcal{U}, a>0\\} \\cup\\{x>0\\}$\n- $p_{0^{-}} \\supseteq\\{x<0\\} \\cup\\{x>b: b \\in \\mathcal{U}, b<0\\}$.\n\nThen $\\mu$ is finitely satisfiable in $M$ (hence also Borel-invariant over $M$ by NIP) and $\\nu$ is definable over $M$, but neither is fim. The following are easy to verify directly:\n(1) $\\mu * p_{\\infty}=p_{\\infty}, \\mu * p_{-\\infty}=p_{-\\infty}$ and $\\mu * \\mu=\\mu-$ hence $\\mu$ is idempotent, finitely satisfiable in $M$, but not support-transitive;\n(2) likewise, $\\nu * p_{0^{+}}=p_{0^{+}}, \\nu * p_{0^{-}}=p_{0^{-}}$, and $\\nu * \\nu=\\nu-$ hence $\\nu$ is idempotent, definable over $M$, but not support transitive.\n\nSupport transitivity is closely related to the algebraic properties of the semigroup induced by $*$ on the support of an idempotent measure, studied in [CG22, Section 4].\n\nFact 3.50. [CG22, Corollary 4.4] Assume that $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is fim and idempotent. Then $(S(\\mu), *)$ is a compact Hausdorff semigroup which is leftcontinuous, i.e. the map $p \\in S(\\mu) \\mapsto p * q \\in S(\\mu)$ is continuous for each fixed $q \\in S(\\mu)$.\n\nProposition 3.51. Assume that $\\mu \\in \\mathfrak{M}_{G}(\\mathcal{U})$ is fim and idempotent. Then the following are equivalent:\n(1) $\\mu$ is support transitive, i.e. $\\mu * p=\\mu$ for all $p \\in S(\\mu)$;\n(2) for any $p, q \\in S(\\mu)$ there exists $r \\in S(\\mu)$ such that $r * q=p$;\n(3) $I_{\\mu}=S(\\mu)$, where $I_{\\mu}$ is a minimal (closed) left ideal of $(S(\\mu), *)$.\n\nProof. (2) $\\Leftrightarrow$ (3). By [CG22, Remark 4.17].\n(3) $\\Rightarrow$ (1). By [CG22, Corollary 4.16].\n$(1) \\Rightarrow(2)$. Let $p, q \\in S(\\mu)$ be given. By Fact 3.50 , the map $f_{p}: S(\\mu) \\rightarrow S(\\mu)$ defined via $f_{p}(s):=s * p$ is continuous. We will show that it has a dense image. Then by compactness of $S(\\mu)$ and continuity of $f_{p}$, the image of $f_{p}$ is also closed, hence $f_{p}$ is surjective - proving the claim.\n\nIndeed, fix some formula $\\theta(x, c) \\in \\mathcal{L}_{x}(\\mathcal{U})$ such that $\\mu(\\theta(x, c))>0$ and choose a small $M \\prec \\mathcal{U}$ such that $\\mu$ is $M$-invariant. By (1), $(\\mu * p)(\\theta(x, c))=$ $\\mu(\\theta(x, c))>0$. Let $b\\models p \\mid M c$, then $\\mu(\\theta(x \\cdot b, c))>0$. Hence there exists some $r \\in S(\\mu)$ such that $\\theta(x \\cdot b, c) \\in r$. But then by definition $\\theta(x, c) \\in r * p$, hence $f_{p}(r) \\in[\\theta(x, c)]$. As $\\theta(x, c)$ was arbitrary, this shows that the image of $f_{p}$ is dense.\n\nWe know that this property holds in specific examples like the circle group (e.g., see [CG22, Example 4.2]).\n3.10. Idempotent measures in stable theories, revisited. It is shown in [CG22, Theorem 5.8] that every idempotent measure on a type-definable group in a stable theory is generically transitive. The proof consists of two ingredients: an analysis of the convolution semigroup on the support of an\n\nidempotent Keisler measure, and an application of a variant of Hrushovski's group chunk theorem for partial types due to Newelski [New91].\n\nIn this section we provide an alternative argument, implementing the strategy outlined at the beginning of Section 3.9 of working in the randomization. This replaces the use of Newelski's theorem by a direct generalization of the proof for types in stable theories from Section 2.7, and the only fact about the supports of idempotent measures that we will need is that they are support transitive.\n\nTo simplify the notation, in this section we will assume that $T$ is an $\\mathcal{L}$ theory expanding a group. We first recall the basic results about local ranks in continuous logic, from [BY10; BYU10]. The following facts are proved under more general hypothesis in Sections 7 and 8 of [BYU10].\n\nFact 3.52. Suppose that $T$ is a continuous stable theory. Let $M \\prec \\mathcal{U}=T$.\n(1) For any $p \\in S_{x}(M)$ there exists a unique $M$-definable extension $p^{\\prime} \\in S_{x}(\\mathcal{U})$.\n(2) For every $\\varepsilon>0$ and every partitioned $\\mathcal{L}$-formula $\\varphi(x, y)$, there exists a rank function $\\mathrm{CB}_{\\varphi, \\varepsilon}$, which we call the $\\varepsilon$-Cantor-Bendixson rank. More specifically, for any subset $A \\subseteq \\mathcal{U}$ and $p \\in S_{\\varphi}(A), C B_{\\varphi, \\varepsilon}(p)$ is an ordinal.\n(3) For any $r \\in S_{\\varphi}(M)$ and $s \\in S_{\\varphi}(\\mathcal{U})$ such that $s \\supseteq r, s$ is the unique definable extension of $r$ if and only if for every $\\varepsilon>0, \\mathrm{CB}_{\\varphi, \\varepsilon}(r)=$ $\\mathrm{CB}_{\\varphi, \\varepsilon}(s)$.\n\nThe following proposition is a standard exercise from the previous fact.\nProposition 3.53. Let $T$ be a continuous stable theory expanding a group. Let $\\mathcal{U}$ be a monster model of $T$ and $M \\prec \\mathcal{U}$ a small submodel. For any partitioned $\\mathcal{L}$-formula $\\varphi(x, y)$ we let $\\Delta_{\\varphi}:=\\varphi(x ; y, z)=\\varphi(x \\cdot z, y)$. Then:\n(1) for any $r \\in S_{x}(\\mathcal{U})$ and $g \\in \\mathcal{U}, \\mathrm{CB}_{\\Delta_{\\varphi}, \\varepsilon}\\left(\\left.r\\right|_{\\Delta_{\\varphi}}\\right)=\\mathrm{CB}_{\\Delta_{\\varphi}, \\varepsilon}\\left(\\left.r \\cdot g\\right|_{\\Delta_{\\varphi}}\\right)$;\n(2) for any $p \\in S_{x}(M)$ and $q \\in S_{x}(\\mathcal{U})$ such that $q \\supset p$, we have that $q$ is the unique definable extension of $p$ if and only if for every partitioned $\\mathcal{L}$-formula $\\varphi(x, y)$ and for all $\\varepsilon>0$, we have $\\mathrm{CB}_{\\Delta_{\\varphi}, \\varepsilon}\\left(\\left.q\\right|_{\\Delta_{\\varphi}}\\right)=$ $\\mathrm{CB}_{\\Delta_{\\varphi}, \\varepsilon}\\left(\\left.p\\right|_{\\Delta_{\\varphi}}\\right)$.\nProof. (1) Given $g \\in \\mathcal{U}$, the map $m_{g}: S_{\\Delta_{\\varphi}}(\\mathcal{U}) \\rightarrow S_{\\Delta_{\\varphi}}(\\mathcal{U})$ defined via $\\varphi(x \\cdot a, b)^{m_{g}(r)}=\\varphi(x \\cdot g \\cdot a, b)^{r}$ is a bijective isometry. In other words, it is an automorphism of $S_{\\Delta_{\\varphi}}(\\mathcal{U})$ as a topometric space, and computing the rank is unaffected.\n(2) Follows directly from (3) of Fact 3.52 .\n\nWe refer to Section 3.4 for notation regarding Keisler randomizations.\nFact 3.54. [BYK09, Theorem 5.14] If $T$ is stable, then its Keisler randomization $T^{R}$ is stable.\n\nProposition 3.55. Suppose that $T$ is stable, $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ is idempotent and support transitive. Then $\\mu$ is generically transitive.\n\nProof. Let $\\mathcal{V} \\succ \\mathcal{U}$ be a bigger monster model of $T$. Fix an atomless probability algebra $(\\Omega, \\mathcal{B}, \\mathbb{P})$ and consider the randomizations $\\mathcal{U}^{\\Omega} \\prec \\mathcal{V}^{\\Omega} \\prec \\mathcal{C}$, where $\\mathcal{C}$ is a monster model of $T^{R}$. Given $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ (note that $\\mu$ is definably by stability), we let $r_{\\mu}^{\\mathcal{U}} \\in S_{x}^{R}(\\mathcal{C})$ be as defined in Fact 3.17. Similarly, given $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{V})$, we let $r_{\\mu}^{\\mathcal{V}} \\in S_{x}^{R}(\\mathcal{C})$ be as defined in Fact 3.17 , but with respect to $\\mathcal{V}$ in place of $\\mathcal{U}$.\n\nLet now $\\mu \\in \\mathfrak{M}_{x}(\\mathcal{U})$ be idempotent and support transitive. Since $T$ is stable, there is some small model $M \\prec \\mathcal{U}$ such that $\\mu$ is $M$-definable. Let $\\mu^{\\prime} \\in \\mathfrak{M}_{x}(\\mathcal{V})$ be the unique $M$-definable extension of $\\mu$. To show that $\\mu$ is generically transitive, it suffices to prove that for every $p \\in S(\\mu)$ and $a \\in \\mathcal{V}$ such that $a \\models p$, we have that $\\mu^{\\prime}=\\mu^{\\prime} \\cdot a$. We let $\\mathbf{p}:=r_{\\mu \\mathcal{U} \\mathcal{U}^{\\Omega}}^{\\mathcal{U}}$. By construction, $r_{\\mu^{\\prime}}^{\\mathcal{V}} \\supseteq \\mathbf{p}$ and $r_{\\mu^{\\prime}}^{\\mathcal{V}}$ is $M^{\\Omega}$-definable. Since $T^{R}$ is stable (Fact 3.54), $r_{\\mu^{\\prime}}^{\\mathcal{V}}$ is the unique global definable extension of $\\mathbf{p}$.\n\nWe claim that then $r_{\\mu^{\\prime} \\cdot a}^{\\mathcal{V}} \\supseteq \\mathbf{p}$. Indeed, let $\\varphi(x, y)$ be an $\\mathcal{L}$-formula and $h \\in \\mathcal{U}_{0}^{\\Omega}$. If $\\mathcal{A}$ is a partition of $\\Omega$ for $h$, using that $\\mu$ is support transitive we have:\n\n$$\n\\begin{aligned}\n& (\\mathbb{E}[\\varphi(x, h)])^{r_{\\mu^{\\prime} \\cdot a}^{\\mathcal{V}}}=\\sum_{A \\in \\mathcal{A}} \\mathbb{P}(A)\\left(\\left.\\mu^{\\prime} \\cdot a\\right)\\left(\\varphi\\left(x,\\left.h\\right|_{A}\\right)\\right)=\\sum_{A \\in \\mathcal{A}} \\mathbb{P}(A)(\\mu * p)\\left(\\varphi\\left(x,\\left.h\\right|_{A}\\right)\\right)\\right. \\\\\n& \\quad=\\sum_{A \\in \\mathcal{A}} \\mathbb{P}(A) \\mu\\left(\\left.\\varphi\\left(x,\\left.h\\right|_{A}\\right)\\right)=\\sum_{A \\in \\mathcal{A}} \\mathbb{P}(A) \\mu^{\\prime}\\left(\\varphi\\left(x,\\left.h\\right|_{A}\\right)\\right)=(\\mathbb{E}[\\varphi(x, h)])^{r_{\\mu^{\\prime}}^{\\mathcal{V}}}\n\\end{aligned}\n$$\n\nLikewise, it is straightforward to check that $r_{\\mu^{\\prime} \\cdot a}^{\\mathcal{V}}=r_{\\mu^{\\prime}}^{\\mathcal{V}} \\cdot f_{a}$, where $f_{a} \\in \\mathcal{U}_{0}^{\\Omega}$ is the constant random variable (i.e., $f_{a}: \\Omega \\rightarrow \\mathcal{U}$ via $f_{a}(t)=a$ for all $t \\in \\Omega$ ) and $\\cdot$ is the randomization of the multiplication of the group in $T$.\n\nSince local rank in the stable theory $T^{R}$ is translation invariant (Proposition 3.53), we conclude that $r_{\\mu^{\\prime} \\cdot a}^{\\mathcal{V}}$ is the unique definable extension of $\\mathbf{p}$. This implies that $r_{\\mu^{\\prime}}^{\\mathcal{V}}=r_{\\mu^{\\prime} \\cdot a}^{\\mathcal{V}}$ and in turn, $\\mu^{\\prime}=\\mu^{\\prime} \\cdot a$. This completes the proof.\n\nRemark 3.56. We expect that this approach could be adapted for groups definable in $o$-minimal structures (as their randomizations are known to be real rosy [AGK19]), by developing a stratified local thorn rank in continuous logic and generalizing the proof for types in rosy (discrete) first order theories from Section 2.10. When $T$ is a simple theory, the randomization $T^{R}$ is $\\mathrm{NSOP}_{1}$ (but not necessarily simple) by [BYCR24]. A local rank for $\\mathrm{NSOP}_{1}$ theories is proposed in [CKR23, Section 5], but a workable stratified rank is lacking at the moment. We do not pursue these directions here.",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 7,
      "text": "# 4. Topological dynamics of $\\mathfrak{M}_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ and $S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ in NIP GROUPs \n\nIn this section, we will use slightly different notation from the rest of the paper, in order to preserve continuity with the earlier work and setup in [CG22; CG23]. We let $G$ be an expansion of a group, and $\\mathcal{G} \\succ G$ a monster model. Throughout this section, we assume that $T:=\\operatorname{Th}(G)$ has NIP.\n\nIt was demonstrated in [CG22, Proposition 6.4] that then the spaces of global $\\operatorname{Aut}(\\mathcal{G} / G)$-invariant Keisler measures, and Keisler measures which are finitely satisfiable in $G$ (denoted $\\mathfrak{M}_{x}^{\\text {inv }}(\\mathcal{G}, G)$ and $\\mathfrak{M}_{x}^{\\text {fs }}(\\mathcal{G}, G)$, respectively) form left-continuous compact Hausdorff semigroups with respect to definable convolution (Definition 3.32). Note that $\\left(\\mathfrak{M}_{x}^{\\mathrm{fs}}(\\mathcal{G}, G), *\\right)$ is a submonoid of $\\left(\\mathfrak{M}_{x}^{\\text {inv }}(\\mathcal{G}, G), *\\right)$. By $S_{x}^{\\text {fs }}(\\mathcal{G}, G)$ we denote the submonoid of $\\left(\\mathfrak{M}_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$ consisting of all global types finitely satisfiable in $G$ (viewed as $\\{0,1\\}$ measures).\n\nIn [CG23, Theorem 6.11], the first two authors described a minimal left ideal of $\\left(\\mathfrak{M}_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$ [and $\\left.\\left(\\mathfrak{M}_{x}^{\\text {inv }}(\\mathcal{G}, G), *)\\right]$ in terms of the Haar measure on an ideal (or Ellis) group of $\\left(S_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$ [resp. $\\left.\\left(S_{x}^{\\text {inv }}(\\mathcal{G}, G), *)\\right]$. However, this required a rather specific assumption that this ideal group is a compact topological group with the topology induced from $\\left(S_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$ [resp. $\\left.\\left(S_{x}^{\\text {inv }}(\\mathcal{G}, G), *)\\right]$. In this section, we obtain the same description in the case of $\\left(\\mathfrak{M}_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$, but under a more natural (from the point of view of topological dynamics) assumption that the so-called $\\tau$-topology on some (equivalently, every) ideal group is Hausdorff (equivalently, the ideal group with the $\\tau$-topology is a compact topological group). In fact, the revised Newelski's conjecture formulated by Anand Pillay and the third author in [KP23, Conjecture 5.3] predicts that the $\\tau$-topology is always Hausdorff under NIP. In Section 5, we confirm this conjecture in the case when $G$ is countable, which is an important result by its own rights. In particular, in the case when $G$ is countable, our description of a minimal left ideal of $\\left(\\mathfrak{M}_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$ does not require any assumption on the ideal group.\n\nAs discussed in the introduction, the $\\tau$-topology plays an essential role in many important structural results in abstract topological dynamics, including the recent theorem of Glasner on the structure of tame, metrizable, minimal flows [Gla18]. In fact, our proof of the revised Newelski's conjecture for countable $G$ will be deduced using this theorem of Glasner.\n\nThe reason why our proof of the revised Newelski's conjecture requires the countability of $G$ assumption is to guarantee that certain flows of types are metrizable in order to be able to apply the aforementioned theorem of Glasner. The reason why we focus only on $\\left(\\mathfrak{M}_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$ and $\\left(S_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$ (and not on $\\left.\\left(\\mathfrak{M}_{x}^{\\text {inv }}(\\mathcal{G}, G), *\\right)\\right.$ and $\\left.\\left(S_{x}^{\\text {inv }}(\\mathcal{G}, G), *)\\right)$ is that $\\left(S_{x}^{\\text {fs }}(\\mathcal{G}, G), *\\right)$ is isomorphic to the Ellis semigroup of the $G$-flow $S_{x}^{\\text {fs }}(\\mathcal{G}, G)$ and so we have the $\\tau$-topology on the ideal group of $S_{x}^{\\text {fs }}(\\mathcal{G}, G)$ at our disposal. For the revised Newelski's conjecture we will also use a well-known general principle that NIP implies tameness for various flows of types [CS18; Iba16; KR20].",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 8,
      "text": "# 4.1. Preliminaries from topological dynamics. \n\nDefinition 4.1. A $G$-flow is a pair $(G, X)$, where $G$ is an abstract group acting (on the left) by homeomorphisms on a compact Hausdorff space $X$.\n\nDefinition 4.2. If $(G, X)$ is a flow, then its Ellis semigroup, denoted by $E(G, X)$ or just $E(X)$, is the (pointwise) closure in $X^{X}$ of the set of functions $\\pi_{g}: x \\mapsto g \\cdot x$ for $g \\in G$.\n\nFact 4.3. (see e.g. [Aus88]) If $(G, X)$ is a flow, then $E(X)$ is a compact left topological semigroup (i.e. it is a semigroup with the composition as its semigroup operation, and the composition is continuous on the left, i.e. for any $f \\in E(X)$ the map $-\\circ f$ is continuous). It is also a $G$-flow with $g \\cdot f:=\\pi_{g} \\circ f$.\n\nThe next fact is folklore. Thanks to this fact $E(E(X))$ is always identified with $E(X)$.\n\nFact 4.4. The function $\\Phi: E(X) \\rightarrow E(E(X))$ given by $\\Phi(\\eta):=l_{\\eta}$, where $l_{\\eta}: E(X) \\rightarrow E(X)$ is defined by $l_{\\eta}(\\tau):=\\eta \\circ \\tau$, is an isomorphism of semigroups and $G$-flows.\n\nThe following is a fundamental theorem of Ellis on the basic structure of Ellis semigroups (see e.g. [Ell69, Corollary 2.10 and Propositions 3.5 and 3.6] or Proposition 2.3 of [Gla76, Section I.2]). We will use it freely without an explicit reference.\n\nFact 4.5 (Ellis' Theorem). Suppose $S$ is a compact Hausdorff left topological semigroup (e.g. the enveloping semigroup of a flow). Then $S$ has a minimal left ideal $\\mathcal{M}$. Furthermore, for any such ideal $\\mathcal{M}$ :\n(1) $\\mathcal{M}$ is closed;\n(2) for any element $a \\in \\mathcal{M}$ and idempotent $u \\in \\mathcal{M}$ we have $a u=a$, and $\\mathcal{M}=S a=\\mathcal{M} a$\n(3) $\\mathcal{M}=\\bigsqcup_{u} u \\mathcal{M}$, where $u$ ranges over all idempotents in $\\mathcal{M}$; in particular, $\\mathcal{M}$ contains an idempotent;\n(4) for any idempotent $u \\in \\mathcal{M}$, the set $u \\mathcal{M}$ is a subgroup of $S$ with the neutral element $u$.\nMoreover, all the groups $u \\mathcal{M}$ (where $\\mathcal{M}$ ranges over all minimal left ideals and $u$ over all idempotents in $\\mathcal{M}$ ) are isomorphic. In the model theory literature, the isomorphism type of all these groups (or any of these groups) is called the ideal (or Ellis) group of $S$; if $S=E(G, X)$, we call this group the ideal (or Ellis) group of the flow $(G, X)$.\n\nWe will use the following fact, which gives us an explicit isomorphism from Fact 4.5 between any two ideal groups in a given minimal left ideal. The context is as in Fact 4.5.\n\nFact 4.6. If $u$ and $v$ are idempotents in $\\mathcal{M}$, then $p \\mapsto u p$ defines an isomorphism $l_{u}: v \\mathcal{M} \\rightarrow u \\mathcal{M}$.\n\nProof. The map $l_{u}$ is a homomorphism, because $l_{u}(p q)=u(p q)=u(p u) q=$ $(u p)(u q)=l_{u}(p) l_{u}(q)$. In the same way, $l_{v}: u \\mathcal{M} \\rightarrow v \\mathcal{M}$ given by $l_{v}(p):=v p$ is a homomorphism. And it is clear that $l_{v}$ is the inverse of $l_{u}$.\n\nWe will also need the following observation which was Lemma 3.5 in the first arXiv version of [KLM22] (the section with this results was removed in the published version).\n\nLemma 4.7. Let $S$ be a compact left topological semigroup, $\\mathcal{M}$ a minimal left ideal of $S$, and $u \\in \\mathcal{M}$ an idempotent. Then the closure $\\overline{u \\mathcal{M}}$ of $u \\mathcal{M}$ is a (disjoint) union of ideal groups. In particular, $\\overline{u \\mathcal{M}}$ is a subsemigroup of $S$.\n\nProof. Note that for every $\\eta \\in \\mathcal{M}, \\eta \\mathcal{M}$ is an ideal group. Namely, $\\eta \\in v \\mathcal{M}$ for some idempotent $v \\in \\mathcal{M}$. Thus, $\\eta \\mathcal{M} \\subseteq v \\mathcal{M}$, but also $v \\mathcal{M} \\subseteq \\eta \\mathcal{M}$, because $v=\\eta \\eta^{-1}$, where $\\eta^{-1}$ is the inverse of $\\eta$ in the ideal group $v \\mathcal{M}$.\n\nLet now $\\eta_{0} \\in \\overline{u \\mathcal{M}} \\subseteq \\mathcal{M}$ (as $\\mathcal{M}$ is closed). By the first paragraph, it suffices to prove that $\\eta_{0} \\mathcal{M} \\subseteq \\overline{u \\mathcal{M}}$. Since $\\eta_{0} u=\\eta_{0}$, we have $\\eta_{0} u \\mathcal{M}=\\eta_{0} \\mathcal{M}$. Take any $\\eta \\in \\eta_{0} \\mathcal{M}$. Then $\\eta=\\eta_{0} \\eta^{\\prime}$ for some $\\eta^{\\prime} \\in u \\mathcal{M}$. Since $\\eta_{0} \\in \\overline{u \\mathcal{M}}$, we have that $\\eta_{0}$ is the limit point of a net $\\left(\\eta_{0}^{i}\\right)_{i} \\subseteq u \\mathcal{M}$. By left continuity, $\\eta=\\eta_{0} \\eta^{\\prime}=\\lim _{i}\\left(\\eta_{0}^{i} \\eta^{\\prime}\\right)$, so $\\eta \\in \\overline{u \\mathcal{M}}$ as $\\eta_{0}^{i} \\eta^{\\prime} \\in u \\mathcal{M}$ for all $i$ 's.\n\nMost of the statements in the next fact are contained in [Gla76, Section IX.1]. There, the author considers the special case of $X=\\beta G$ and defines $\\circ$ in a slightly different (but equivalent) way. However, as pointed out in [KP17, Section 2] and [KPR18, Section 1.1], many of the proofs from [Gla76, Section IX.1] go through in the general context. A very nice exposition of this material (with all the proofs) in the general context can be found in Appendix A of [Rze18].\n\nFact 4.8 (The $\\tau$-topology on the ideal group in an Ellis semigroup). Consider the Ellis semigroup $E(X)$ of a flow $(G, X)$, let $\\mathcal{M}$ be a minimal left ideal of $E(X)$ and $u \\in \\mathcal{M}$ an idempotent.\n(1) For each $a \\in E(X), B \\subseteq E(X)$, we write $a \\circ B$ for the set of all limits of nets $\\left(g_{i} b_{i}\\right)_{i}$, where $g_{i} \\in G$ are such that $\\lim _{i} g_{i}=a$ and $b_{i} \\in B$.\n(2) The formula $\\operatorname{cl}_{\\tau}(A):=(u \\mathcal{M}) \\cap(u \\circ A)$ defines a closure operator on $u \\mathcal{M}$. It can also be (equivalently) defined as $\\operatorname{cl}_{\\tau}(A)=u(u \\circ A)$. We call the topology on $u \\mathcal{M}$ induced by this operator the $\\tau$-topology.\n(3) If $\\left(f_{i}\\right)_{i}$ (a net in $u \\mathcal{M}$ ) converges to $f \\in \\overline{u \\mathcal{M}}$ (the closure of $u \\mathcal{M}$ in $E(X)$ ), then $\\left(f_{i}\\right)_{i}$ converges to uf in the $\\tau$-topology.\n(4) The $\\tau$-topology on $u \\mathcal{M}$ coarsens the subspace topology inherited from $E(X)$.\n(5) $u \\mathcal{M}$ with the $\\tau$-topology is a quasi-compact, $T_{1}$ semitopological group (that is, the group operation is separately continuous) in which the inversion is continuous.\n(6) All the groups $u \\mathcal{M}$ (where $\\mathcal{M}$ ranges over all minimal left ideals of $E(X)$ and $u$ over all idempotents in $\\mathcal{M}$ ) equipped with the $\\tau$ topology are isomorphic as semitopological groups. In particular, the map from Fact 4.6 is a topological isomorphism.\n\nBy the Ellis joint continuity theorem [Ell57] and Fact 4.8(5), we get the following\n\nCorollary 4.9. If the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff, then $u \\mathcal{M}$ is a compact topological group.\n\nThe following result is Lemma 3.1 in [KPR18].\nFact 4.10. Let $(G, X)$ be a flow. Let $\\mathcal{M}$ be a minimal left ideal of $E(X)$ and $u \\in \\mathcal{M}$ an idempotent. Then the function $f: \\overline{u \\mathcal{M}} \\rightarrow u \\mathcal{M}$ (where $\\overline{u \\mathcal{M}}$ is the closure of $u \\mathcal{M}$ in the topology of $E(X)$ ) defined by the formula $f(\\eta):=u \\eta$ has the property that for any continuous function $h: u \\mathcal{M} \\rightarrow X$, where $X$ is a regular topological space and $u \\mathcal{M}$ is equipped with the $\\tau$-topology, the composition $h \\circ f: \\overline{u \\mathcal{M}} \\rightarrow X$ is continuous, where $\\overline{u \\mathcal{M}}$ is equipped with subspace topology from $E(X)$. In particular, if $u \\mathcal{M}$ is Hausdorff with the $\\tau$-topology, then $f$ is continuous.\n\nIn the model-theoretic context of the $G$-flow $S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ (with the action of $G$ by left translations), the following fact is folklore (see e.g. [New12; Pil13]).\n\nFact 4.11. The function $\\Phi: S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G) \\rightarrow E\\left(S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)\\right)$ given by $\\Phi(p):=l_{p}$, where $l_{p}: S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G) \\rightarrow S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ is defined by $l_{p}(q):=p * q$, is an isomorphism of semigroups and $G$-flows.\n\nThanks to this fact, Fact 4.8 can be applied directly to $S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ in place of $E\\left(S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)\\right)$, which we do without further explanations.\n\nNote, however, that Fact 4.11 does not hold for $S_{x}^{\\text {inv }}(\\mathcal{G}, G)$ in place of $S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$, because the $G$-orbit of $\\operatorname{tp}(e / \\mathcal{G})$ need not be dense in $S_{x}^{\\text {inv }}(\\mathcal{G}, G)$.\n4.2. Minimal left ideal of $\\mathfrak{M}_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$. Recall that $G$ is an expansion of a group. Fix $\\mathcal{G} \\succ G$ which is $|G|^{+}$-saturated. Recall that in this section we assume that $T=\\operatorname{Th}(G)$ is NIP.\n\nDefinition 4.12. For a formula $\\varphi(x) \\in \\mathcal{L}(\\mathcal{G})$ and $n>0$, define a new formula\n\n$$\n\\operatorname{Alt}_{n}\\left(x_{0}, \\ldots, x_{n-1} ; y\\right):=\\bigwedge_{i<n-1} \\neg\\left(\\varphi\\left(x_{i} y\\right) \\leftrightarrow \\varphi\\left(x_{i+1} y\\right)\\right)\n$$\n\nIn the next fact, $\\bar{x}$ stands for $\\left(x_{0}, \\ldots, x_{n-1}\\right)$. By the proof of [HP11, Proposition 2.6] (where, if $\\varphi(x) \\in \\mathcal{L}(\\mathcal{G})$ is of the form $\\psi(x ; c)$ for some $\\psi(x, y) \\in \\mathcal{L}(\\emptyset)$ and $c \\in \\mathcal{G}^{y}, N$ is chosen depending on $\\psi(x, y))$, we have:\n\nFact 4.13. Let $p \\in S_{x}^{\\text {inv }}(\\mathcal{G}, G)$ and $\\varphi(x) \\in \\mathcal{L}(\\mathcal{G})$ be any formula. Let $S:=$ $\\{b \\in \\mathcal{G}: \\varphi(x b) \\in p\\}$. Then, there exists a positive $N<\\omega$ such that $S=$ $\\bigcup_{n<N} A_{n} \\cap B_{n+1}^{c}$, where $-{ }^{c}$ denotes the complement of a set and\n\n$$\n\\begin{aligned}\n& A_{n}:=\\left\\{b \\in \\mathcal{G}:\\left.(\\exists \\bar{x})\\left(p^{(n)}\\right|_{G}(\\bar{x}) \\wedge \\operatorname{Alt}_{n}(\\bar{x} ; b) \\wedge \\varphi\\left(x_{n-1} b\\right)\\right)\\right\\} \\\\\n& B_{n}:=\\left\\{b \\in \\mathcal{G}:\\left.(\\exists \\bar{x})\\left(p^{(n)}\\right|_{G}(\\bar{x}) \\wedge \\operatorname{Alt}_{n}(\\bar{x} ; b) \\wedge \\neg \\varphi\\left(x_{n-1} b\\right)\\right)\\right\\}\n\\end{aligned}\n$$\n\nThe following lemma is the key new step needed to adapt the arguments from [CG23, Section 6.2] to our general setting here. From now on, let $\\mathcal{M}$ be a minimal left ideal in $\\left(S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G), *\\right)$ and $u \\in \\mathcal{M}$ an idempotent. For $p, q \\in S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$, we will typically write $p q$ instead of $p * q$.\n\nLemma 4.14. Let $\\varphi(x) \\in \\mathcal{L}(\\mathcal{G})$ be any formula. Assume that the $\\tau$-topology on the ideal group $u \\mathcal{M}$ is Hausdorff. Then the subset $[\\varphi(x)] \\cap u \\mathcal{M}$ of $u \\mathcal{M}$ is constructible, and so Borel (in the $\\tau$-topology).\n\nProof. By Fact 4.10 and the assumption that $u \\mathcal{M}$ is Hausdorff, the function $f: \\overline{u \\mathcal{M}} \\rightarrow u \\mathcal{M}$ (where $\\overline{u \\mathcal{M}}$ is the closure of $u \\mathcal{M}$ in the topology of $E(X)$ ) given by $f(\\eta):=u \\eta$ is continuous. Note that $\\operatorname{ker}(f):=\\{p \\in \\overline{u \\mathcal{M}}: f(p)=u\\}$ is a subsemigroup of $\\overline{u \\mathcal{M}}$ which coincides with the set $\\mathcal{J}$ of all idempotents in $\\overline{u \\mathcal{M}}$. This follows from Lemma 4.7 and the fact that for every $v \\in \\mathcal{J}$ the restriction $\\left.f\\right|_{v \\mathcal{M}}: v \\mathcal{M} \\rightarrow u \\mathcal{M}$ is a group isomorphism by Fact 4.6.\n\nPut\n\n$$\n\\widetilde{S}:=f^{-1}[[\\varphi(x)]]=\\{p \\in \\overline{u \\mathcal{M}}: u p \\in[\\varphi(x)]\\}\n$$\n\nLet $\\mathfrak{G} \\succ \\mathcal{G}$ be a monster model in which $\\mathcal{G}$ is small. Let $\\bar{u} \\in S_{x}^{\\mathrm{fs}}(\\mathfrak{G}, G)$ be the unique extension of $u$ to a type in $S_{x}(\\mathfrak{G})$ which is finitely satisfiable in G. Pick $a \\models \\bar{u}$ (in a yet bigger monster model). Put\n\n$$\nS:=\\{b \\in \\mathfrak{G}: \\models \\varphi(a b)\\}=\\{b \\in \\mathfrak{G}: \\varphi(x b) \\in \\bar{u}\\}\n$$\n\nThen $\\widetilde{S}=\\{p \\in \\overline{u \\mathcal{M}}: \\models \\varphi(a b)$ for all/some $b \\in p(\\mathfrak{G})\\}=\\{\\operatorname{tp}(b / \\mathcal{G}) \\in \\overline{u \\mathcal{M}}:$ $b \\in S\\}$.\n\nTake $N, A_{n}$, and $B_{n}$ from Fact 4.13 applied for $\\mathfrak{G}$ in place of $\\mathcal{G}$ and for $p=\\bar{u}$. Then $S=\\bigcup_{n<N} A_{n} \\cap B_{n+1}^{c}$. Define:\n\n$$\n\\begin{aligned}\n& \\widetilde{A}_{n}:=\\left\\{\\operatorname{tp}(b / \\mathcal{G}): b \\in A_{n} \\text { and } \\operatorname{tp}(b / \\mathcal{G}) \\in \\overline{u \\mathcal{M}}\\right\\} \\\\\n& \\widetilde{B}_{n}:=\\left\\{\\operatorname{tp}(b / \\mathcal{G}): b \\in B_{n} \\text { and } \\operatorname{tp}(b / \\mathcal{G}) \\in \\overline{u \\mathcal{M}}\\right\\} \\\\\n& \\widetilde{A}_{n}^{\\prime}:=\\operatorname{ker}(f) * \\widetilde{A}_{n}:=\\left\\{r s: r \\in \\operatorname{ker}(f), s \\in \\widetilde{A}_{n}\\right\\}, \\widetilde{B}_{n}^{\\prime}:=\\operatorname{ker}(f) * \\widetilde{B}_{n}, \\text { and } \\\\\n& \\widetilde{S}^{\\prime}:=\\bigcup_{n<N} \\widetilde{A}_{n}^{\\prime} \\cap \\widetilde{B}_{n+1}^{c}\n\\end{aligned}\n$$\n\nNote that all the sets $\\widetilde{A}_{n}, \\widetilde{B}_{n}, \\widetilde{A}_{n}^{\\prime}, \\widetilde{B}_{n}^{\\prime}, \\widetilde{S}^{\\prime}$ are contained in $\\overline{u \\mathcal{M}}$, as $\\overline{u \\mathcal{M}}$ is a semigroup by Lemma 4.7.\n\nClaim. (1) $\\widetilde{S}=\\bigcup_{n<N} \\widetilde{A}_{n} \\cap \\widetilde{B}_{n+1}^{c}$.\n(2) $\\operatorname{ker}(f) * \\widetilde{S}=\\widetilde{S}$.\n(3) $\\operatorname{ker}(f) * \\widetilde{A}_{n}^{\\prime}=\\widetilde{A}_{n}^{\\prime}, \\operatorname{ker}(f) * \\widetilde{B}_{n}^{\\prime}=\\widetilde{B}_{n}^{\\prime}$, and $\\operatorname{ker}(f) * \\widetilde{S}^{\\prime}=\\widetilde{S}^{\\prime}$.\n(4) $\\widetilde{A}_{n} \\subseteq \\widetilde{A}_{n}^{\\prime}$ and $\\widetilde{B}_{n} \\subseteq \\widetilde{B}_{n}^{\\prime}$.\n(5) $\\widetilde{S}=\\widetilde{S}^{\\prime}$.\n(6) $f\\left[\\widetilde{A}_{n}\\right]$ and $f\\left[\\widetilde{B}_{n}\\right]$ are closed.\n(7) $f\\left[\\widetilde{S}^{\\prime}\\right]=\\bigcup_{n<N} f\\left[\\widetilde{A}_{n}^{\\prime}\\right] \\cap f\\left[\\widetilde{B}_{n+1}^{\\prime}\\right]^{c}=\\bigcup_{n<N} f\\left[\\widetilde{A}_{n}\\right] \\cap f\\left[\\widetilde{B}_{n+1}\\right]^{c}$ is constructible.\n\nProof. (1) Let $\\rho: \\mathfrak{G} \\rightarrow S_{x}(\\mathcal{G})$ be given by $\\rho(b):=\\operatorname{tp}(b / \\mathcal{G})$. Note that all of the sets $A_{n}, B_{n}$ are $\\operatorname{Aut}(\\mathfrak{G} / \\mathcal{G})$-invariant (more precisely, invariant over $G$\n\nand the parameters of $\\varphi(x)$ in $\\mathcal{G})$, hence they are unions of sets of realizations in $\\mathfrak{G}$ of complete types over $\\mathcal{G}$. Then we have\n\n$$\n\\rho[S]=\\rho\\left[\\bigcup_{n<N} A_{n} \\cap B_{n+1}^{c}\\right]=\\bigcup_{n<N} \\rho\\left[A_{n}\\right] \\cap \\rho\\left[B_{n+1}\\right]^{c}\n$$\n\nSo $\\widetilde{S}=\\overline{u \\mathcal{M}} \\cap \\rho[S]=\\bigcup_{n<N}\\left(\\overline{u \\mathcal{M}} \\cap \\rho\\left[A_{n}\\right]\\right) \\cap\\left(\\overline{u \\mathcal{M}} \\cap \\rho\\left[B_{n+1}\\right]\\right)^{c}=\\bigcup_{n<N} \\widetilde{A}_{n} \\cap$ $\\widetilde{B}_{n+1}^{c}$.\n(2) ( $\\subseteq$ ) Take $p \\in \\operatorname{ker}(f)$ and $s \\in \\widetilde{S}$. Then $f(p s)=u(p s)=(u p) s=u s=$ $f(s) \\in[\\varphi(x)]$, which by definition implies $p s \\in \\widetilde{S}$.\n( $\\supseteq$ ) Take $p \\in \\widetilde{S}$. Then, by Lemma 4.7, $p \\in v \\mathcal{M}$ for some $v \\in \\mathcal{J}$ (where $\\mathcal{J}$ is the set of all idempotents in $\\overline{u \\mathcal{M}}$ ). Then $p=v p$ and $v \\in \\operatorname{ker}(f)$, so $p \\in \\operatorname{ker}(f) * \\widetilde{S}$.\n(3) The first two equalities follow from the definition of $A_{n}^{\\prime}$ and $B_{n}^{\\prime}$ and the fact that $\\operatorname{ker}(f)=\\mathcal{J}$ satisfies $\\mathcal{J} * \\mathcal{J}=\\mathcal{J}$ (as $u v=u$ for $u, v \\in \\mathcal{J}$ ). To show $(\\subseteq)$ in the third equality, take any $p \\in \\widetilde{A}_{n}^{\\prime} \\cap \\widetilde{B}_{n+1}^{t c}$ and $v \\in \\operatorname{ker}(f)=\\mathcal{J}$. Then $v p \\in \\widetilde{A}_{n}^{\\prime}$ by the first equality. Moreover, $v p \\in \\widetilde{B}_{n+1}^{t c}$, as otherwise $v p \\in \\widetilde{B}_{n+1}^{\\prime}$, so $p=v_{p} v p \\in \\widetilde{B}_{n+1}^{\\prime}$ by the second equality, where $v_{p} \\in \\mathcal{J}$ is such that $p \\in v_{p} \\mathcal{M}$, a contradiction. To see $(\\supseteq)$, take any $p \\in \\widetilde{S}^{\\prime}$. We have that $p \\in v \\mathcal{M}$ for some $v \\in \\mathcal{J}=\\operatorname{ker}(f)$. So $p=v p \\in \\operatorname{ker}(f) * \\widetilde{S}^{\\prime}$.\n(4) follows as on the last line of (3).\n(5) ( $\\supseteq$ ) Take $g \\in \\widetilde{S}^{\\prime}$. Then $g \\in \\widetilde{A}_{n}^{\\prime} \\cap \\widetilde{B}_{n+1}^{t c}$ for some $n<N$. Hence, $g \\in \\operatorname{ker}(f) * h$ for some $h \\in \\widetilde{A}_{n}$. Since $g \\in \\widetilde{B}_{n+1}^{t c}$, by (3), we get that $h \\in \\widetilde{B}_{n+1}^{t c}$, so, by (4), $h \\in \\widetilde{B}_{n+1}^{c}$. Thus, $h \\in \\widetilde{A}_{n} \\cap \\widetilde{B}_{n+1}^{c}$ which is contained in $\\widetilde{S}$ by (1). Hence, by (2), we conclude that $g \\in \\widetilde{S}$.\n$(\\subseteq)$ Suppose for a contradiction that there is some $g \\in \\widetilde{S} \\backslash \\widetilde{S}^{\\prime}$. Using (1) and (2), let $n<N$ be maximal for which there is $h \\in \\widetilde{A}_{n} \\cap \\widetilde{B}_{n+1}^{c}$ such that $g \\in \\operatorname{ker}(f) * h$. Then $h \\in \\widetilde{S} \\backslash \\widetilde{S}^{\\prime}$ by (1) and (3). So $h \\notin \\widetilde{A}_{n}^{\\prime} \\cap \\widetilde{B}_{n+1}^{t c}$. This together with $h \\in \\widetilde{A}_{n}$ and (4) implies that $h \\in \\widetilde{B}_{n+1}^{\\prime}$, so $h \\in \\operatorname{ker}(f) * h^{\\prime}$ for some $h^{\\prime} \\in \\widetilde{B}_{n+1}$. Then $g \\in \\operatorname{ker}(f) * \\operatorname{ker}(f) * h^{\\prime}=\\operatorname{ker}(f) * h^{\\prime}$, so $g=v h^{\\prime}$ for some $v \\in \\operatorname{ker}(f)=\\mathcal{J}$. Choose $v^{\\prime} \\in \\mathcal{J}$ with $h^{\\prime} \\in v^{\\prime} \\mathcal{M}$. Then $v^{\\prime} g=v^{\\prime} v h^{\\prime}=$ $v^{\\prime} h^{\\prime}=h^{\\prime}$, and so $h^{\\prime} \\in \\operatorname{ker}(f) * g$ which is contained in $\\widetilde{S}$ by (2) (as $g \\in \\widetilde{S}$ ). Therefore, by (1), $h^{\\prime} \\in \\widetilde{A}_{m} \\cap \\widetilde{B}_{m+1}^{c}$ for some $m<N$. Since $h^{\\prime} \\in \\widetilde{B}_{n+1}$, we get $m+1>n+1$. As $g \\in \\operatorname{ker}(f) * h^{\\prime}$, we get a contradiction with the maximality of $n$.\n(6) follows as $f$ is continuous by Fact 4.10 (this is the only place in the proof where we use the assumption that $u \\mathcal{M}$ is Hausdorff) and $\\widetilde{A}_{n}, \\widetilde{B}_{n}$ are closed.\n(7) To show the first equality, it is enough to prove that $\\widetilde{A}_{n}^{\\prime}$ and $\\widetilde{B}_{n}^{\\prime}$ are unions of fibers of $f$. Let us prove it for $\\widetilde{A}_{n}^{\\prime}$; the case of $\\widetilde{B}_{n}^{\\prime}$ is the same. So consider any $p \\in \\widetilde{A}_{n}^{\\prime}$ and $q \\in \\overline{u \\mathcal{M}}$ with $f(p)=f(q)$. We have $p \\in v_{p} \\mathcal{M}$ and $q \\in v_{q} \\mathcal{M}$ for some $v_{p}, v_{q} \\in \\mathcal{J}$. Then $f\\left(v_{q} p\\right)=u v_{q} p=u p=f(p)=f(q)$ and\n\n$v_{q} p, q \\in v_{q} \\mathcal{M}$. So, since $\\left.f\\right|_{v_{q} \\mathcal{M}}$ is an isomorphism, we get that $q=v_{q} p \\in$ $\\operatorname{ker}(f) * p \\subseteq \\operatorname{ker}(f) * \\tilde{A}_{n}^{\\prime}=\\tilde{A}_{n}^{\\prime}$ by (3).\n\nThe second equality follows since:\n\n$$\n\\begin{aligned}\n& f\\left[\\tilde{A}_{n}^{\\prime}\\right]=f\\left[\\operatorname{ker}(f) * \\tilde{A}_{n}\\right]=u * \\operatorname{ker}(f) * \\tilde{A}_{n}=u * \\tilde{A}_{n}=f\\left[\\tilde{A}_{n}\\right] \\\\\n& f\\left[\\widetilde{B}_{n}^{\\prime}\\right]=f\\left[\\operatorname{ker}(f) * \\widetilde{B}_{n}\\right]=u * \\operatorname{ker}(f) * \\widetilde{B}_{n}=u * \\widetilde{B}_{n}=f\\left[\\widetilde{B}_{n}\\right]\n\\end{aligned}\n$$\n\nHence, $f\\left[\\widetilde{S}^{\\prime}\\right]$ is constructible by (6).\nBy item (5) of the claim, we get $[\\varphi(x)] \\cap u \\mathcal{M}=f\\left[f^{-1}[[\\varphi(x)]]\\right]=f[\\widetilde{S}]=$ $f\\left[\\widetilde{S}^{\\prime}\\right]$, which is a constructible set by item (7) of the claim.\n\nProposition 4.15. Assume that the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff. By Corollary 4.9, $u \\mathcal{M}$ is a compact topological group, so we have the unique normalized Haar measure $h_{u \\mathcal{M}}$ on Borel subsets of $u \\mathcal{M}$. By Lemma 4.14, the formula\n\n$$\n\\mu_{u \\mathcal{M}}(\\varphi(x)):=h_{u \\mathcal{M}}([\\varphi(x)] \\cap u \\mathcal{M})\n$$\n\nyields a well-defined Keisler measure in $\\mathfrak{M}_{x}(\\mathcal{G})$ which is concentrated on $\\overline{u \\mathcal{M}} \\subseteq \\mathcal{M}$ (i.e. with the support contained in $\\overline{u \\mathcal{M}}$ ).\n\nUsing this, the material from Lemma 6.9 to Corollary 6.12 of [CG23] goes through word for word. In particular, we get the following lemma and the main theorem describing a minimal left ideal of the semigroup $\\left(\\mathfrak{M}_{x}^{\\mathrm{ls}}(\\mathcal{G}, G), *\\right)$, under a more natural assumption than the property CIG1 (requiring that $u \\mathcal{M}$ is compact with respect to the induced topology instead of the $\\tau$-topology) assumed in [CG23].\n\nLemma 4.16. Assume that the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff. Then $\\mu_{u \\mathcal{M}} *$ $\\delta_{p}=\\mu_{u \\mathcal{M}}$ for all $p \\in \\mathcal{M}$, where $\\delta_{p}$ is the Dirac measure at $p$.\n\nLet $\\mathfrak{M}(\\mathcal{M}):=\\left\\{\\mu \\in \\mathfrak{M}_{x}(\\mathcal{G}): S(\\mu) \\subseteq \\mathcal{M}\\right\\}$.\nTheorem 4.17. Assume that the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff. Then $\\mathfrak{M}(\\mathcal{M}) * \\mu_{u \\mathcal{M}}$ is a minimal left ideal of $\\mathfrak{M}_{x}^{\\mathrm{ls}}(\\mathcal{G}, G)$, and $\\mu_{u \\mathcal{M}}$ is an idempotent which belongs to $\\mathfrak{M}(\\mathcal{M}) * \\mu_{u \\mathcal{M}}$.\n\nIn the next section we will see that the assumption that the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff is always satisfied when $G$ is a countable NIP group.",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 9,
      "text": "# 5. Revised NeWelski's Conjecture for countable NIP groups \n\nThe goal of this section is to prove the revised Newelski's conjecture (see [KP23, Conjecture 5.3]) working over a countable model. We consider here a standard context for this conjecture (originally from [New09, Section 4], but see also [CPS14]) which is slightly more general than in the previous Section 4. Let $M$ be a model of a NIP theory, $G$ a 0 -definable group in $M$, and $N \\succ M$ an $|M|^{+}$-saturated elementary extension. By $S_{G, \\text { ext }}(M)$ we denote the space of all complete external types over $M$ concentrated on $G$, i.e. the space of ultrafilters of externally definable subsets of $G$. It is a $G$-flow\n\nwith the action given by left translation, which is naturally isomorphic as a $G$-flow to the $G$-flow $S_{G}^{\\mathrm{fs}}(N, M)$ of all complete types over $N$ concentrated on $G$ and finitely satisfiable in $M$. Note that the previous context $S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ of Section 4 is a special case when $M=G$ and $N=\\mathcal{G}$. On $S_{G}^{\\mathrm{fs}}(N, M)$ we have the left continuous semigroup operation defined in the same way as for $S_{x}^{\\mathrm{fs}}(\\mathcal{G}, G)$ (i.e. $p * q:=\\operatorname{tp}(a b / N)$ for any $a \\models p, b \\models q$ such that $\\operatorname{tp}(a / N, b)$ is finitely satisfiable in $M$ ), and Fact 4.11 still holds for it.\n\nThe following revised Newelski's conjecture was stated in [KP23, Conjecture 5.3].\nConjecture 5.1. Assume that $T$ is NIP. Let $\\mathcal{M}$ be a minimal left ideal of $S_{G}^{\\mathrm{fs}}(N, M)$ and $u \\in \\mathcal{M}$ an idempotent. Then the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff.\n\nA background around this conjecture, including an explanation that it is a weakening of Newelski's conjecture, is given in the introduction, and in more details in the long paragraph preceding Conjecture 5.3 in [KP23] and short paragraph following it.\n\nIn order to prove Conjecture 5.1 for countable $M$, first we will deduce from the main theorem of [Gla18] on the structure of tame, metrizable, minimal flows that each such flow has Hausdorff ideal group. Then Conjecture 5.1 for countable $M$ will follow using this fact and a presentation of $S_{G}^{\\mathrm{fs}}(N, M)$ as an inverse limit of certain metrizable flows. The topological dynamical material below is rather standard, but it requires recalling quite a few notions and basic facts about them, and making some observations.\n\nFrom now on, until we say otherwise, we are in the general abstract context of $G$-flows and homomorphisms between them, where $G$ is an arbitrary abstract (not necessarily definable in a NIP theory) group. We let $(G, X)$, $(G, Y)$, etc. be $G$-flows, which we will sometimes denote simply as $X, Y$, etc.\n\nFor a proof of the following fact see [Rze18, Proposition 5.41].\nFact 5.2. Let $\\pi: X \\rightarrow Y$ be an epimorphism of $G$-flows. Then $\\tilde{\\pi}: E(X) \\rightarrow$ $E(Y)$ given by $\\tilde{\\pi}(\\eta)(\\pi(x))=\\pi(\\eta(x))$ is a well-defined semigroup and $G$-flow epimorphism. If $\\mathcal{M}$ is a minimal left ideal of $E(X)$ and $u \\in \\mathcal{M}$ an idempotent, then $\\tilde{\\pi}[\\mathcal{M}]$ is a minimal left ideal of $E(Y)$ and $\\tilde{\\pi}(u)$ is an idempotent in $\\tilde{\\pi}[\\mathcal{M}]$. Moreover, $\\left.\\tilde{\\pi}\\right|_{u \\mathcal{M}}: u \\mathcal{M} \\rightarrow \\tilde{\\pi}(u) \\tilde{\\pi}[\\mathcal{M}]$ is a group epimorphism and topological quotient map with respect to the $\\tau$-topologies.\nRemark 5.3. If $(G, X)$ and $(G, Y)$ are flows for which there exists a semigroup and flow epimorphism $\\Phi: E(X) \\rightarrow E(Y)$, then it is unique. In particular, the epimorphism $\\tilde{\\pi}$ in Fact 5.2 does not depend on the choice of the epimorphism $\\pi$.\nProof. Since $\\Phi$ is a semigroup epimorphism, it satisfies $\\Phi\\left(\\mathrm{id}_{X}\\right)=\\mathrm{id}_{Y}$. Let $g_{X} \\in E(X)$ be the left translation by $g$, and similarly $g_{Y} \\in E(Y)$. Then $\\Phi\\left(g_{X}\\right)=\\Phi\\left(g \\mathrm{id}_{X}\\right)=g \\Phi\\left(\\mathrm{id}_{X}\\right)=g \\mathrm{id}_{Y}=g_{Y}$. By definition, $E(X)$ is the closure of $\\left\\{g_{X}: g \\in G\\right\\}$, so $\\Phi$ is unique (as it is continuous).\n\nLet $\\beta G$ be the Stone-\u010cech compactification of $G$ and $\\mathcal{U}_{e}$ the principal ultrafilter at $e$. As e.g. explained on page 9 of [Gla76], the $G$-ambit $\\left(\\beta G, \\mathcal{U}_{e}\\right)$ (where by a $G$-ambit we mean a $G$-flow with a distinguished point with dense orbit) is universal, and so there is a unique left continuous semigroup operation on $\\beta G$ extending the action of $G$ by left translation. (In fact, it is precisely the $*$ operation on $S_{G, \\text { ext }}(M)$ for $M:=G$ expanded by predicates for all subsets of $G$ ). For any flow $(G, X)$, universality of $\\beta G$ also yields a unique action of the semigroup $(\\beta G, *)$ on $X$ which is left-continuous and extends the action of $G$, and which we will denote by $\\cdot$. Fix a minimal left ideal $\\mathcal{M}$ of $\\beta G$ and an idempotent $u \\in \\mathcal{M}$. Using this action, for any $G$-flow $(G, X)$ with a distinguished point $x_{0} \\in X$ such that $u \\cdot x_{0}=x_{0}$ (note that such an $x_{0}$ always exists), the Galois group of $\\left(X, x_{0}\\right)$ is defined as:\n\n$$\n\\operatorname{Gal}\\left(X, x_{0}\\right):=\\left\\{p \\in u \\mathcal{M}: p \\cdot x_{0}=x_{0}\\right\\} \\leq u \\mathcal{M}\n$$\n\nit is a $\\tau$-closed subgroup of $u \\mathcal{M}$ (see [Gla76, Page 13]). In the topological dynamics literature, this group is sometimes called the Ellis group of $\\left(X, x_{0}\\right)$, e.g. see [Gla76, Page 13], where it is denoted $\\mathcal{G}\\left(X, x_{0}\\right)$, for its basic properties.\n\nThere is an obvious semigroup and $G$-flow epimorphism $\\Phi: \\beta G \\rightarrow E(X)$ given by $\\Phi(p)(x):=p \\cdot x$. It is unique by Remark 5.3. As in Fact 4.11, $\\beta G$ is naturally isomorphic to $E(\\beta G)$ via $p \\mapsto l_{p}$, where $l_{p}(q)=p * q$. Using this identification, for any $G$-flow epimorphism $f: \\beta G \\rightarrow X$, the induced map $\\tilde{f}: \\beta G \\rightarrow E(X)$ from Fact 5.2 coincides with $\\Phi$.\n\nRemark 5.4. Let $\\mathcal{M}$ and $u \\in \\mathcal{M}$ be as above. Let $(G, X)$ be a flow and $\\Phi: \\beta G \\rightarrow E(X)$ the unique epimorphism defined above. Let $\\mathcal{N}:=\\Phi[\\mathcal{M}]$ and $v:=\\Phi(u)$.\n(1) For every $x \\in X$ with $u \\cdot x=x, \\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right) \\subseteq \\operatorname{Gal}(X, x)$.\n(2) For every $x \\in \\operatorname{Im}(v), u \\cdot x=x$.\n(3) $\\bigcap_{x \\in \\operatorname{Im}(v)} \\operatorname{Gal}(X, x)=\\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right)$.\n(4) $\\left.\\Phi\\right|_{u \\mathcal{M}}: u \\mathcal{M} \\rightarrow v \\mathcal{N}$ is a group epimorphism and topological quotient map with respect to the $\\tau$-topologies.\n\nProof. It is clear that $\\mathcal{N}$ is a minimal left ideal of $E(X), v \\in \\mathcal{N}$ an idempotent, and $\\left.\\Phi\\right|_{u \\mathcal{M}}: u \\mathcal{M} \\rightarrow v \\mathcal{N}$ a group epimorphism.\n(1) Take $p \\in \\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right)$, i.e. $\\Phi(p)=v$. Then $p \\cdot x=\\Phi(p)(x)=v(x)=$ $\\Phi(u)(x)=u \\cdot x=x$. Hence, $p \\in \\operatorname{Gal}(X, x)$.\n(2) Take $x \\in \\operatorname{Im}(v)$, i.e. $x=v(y)$ for some $y \\in X$. Then $u \\cdot x=v(v(y))=$ $(v \\circ v)(y)=v(y)=x$.\n(3) The inclusion $(\\supseteq)$ follows from (1) and (2). For the opposite inclusion, consider any $p \\in \\bigcap_{x \\in \\operatorname{Im}(v)} \\operatorname{Gal}(X, x)$. In order to show that $p \\in \\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right)$, it is enough to check that $\\left.\\Phi(p)\\right|_{\\operatorname{Im}(v)}=\\operatorname{id}_{\\operatorname{Im}(v)}$ (because for any $\\eta \\in \\mathcal{N}$ we have $\\eta=\\eta v$, and so the map $v \\mathcal{N} \\rightarrow \\operatorname{Sym}(\\operatorname{Im}(v))$ given by $\\left.\\eta \\mapsto \\eta\\right|_{\\operatorname{Im}(v)}$ is injective, in fact a group monomorphism, and $\\left.v\\right|_{\\operatorname{Im}(v)}=\\operatorname{id}_{\\operatorname{Im}(v)}$ as $v$ is an idempotent). But this is trivial by the choice of $p: \\Phi(p)(v(y))=p \\cdot(v(y))=v(y)$.\n\n(4) In the situation when $(G, X)$ has a dense orbit (which is for example the case when $(G, X)$ is minimal), this follows from Fact 5.2 , the existence of an epimorphism $f: \\beta G \\rightarrow X$ (as $\\beta G$ is a universal $G$-ambit), and the observation that $\\Phi=\\tilde{f}$ made just before Remark 5.4. In general, it follows from the straightforward generalization of Fact 5.2 stated in [KLM22, Fact 2.3].\n\nDefinition 5.5. A $G$-flow epimorphism $\\pi: X \\rightarrow Y$ is almost 1-1 if the set $X_{0}:=\\left\\{x \\in X: \\pi^{-1}[\\pi(x)]=\\{x\\}\\right\\}$ is dense in $X$.\n\nRemark 5.6. If $(G, Y)$ is minimal and $\\pi: X \\rightarrow Y$ is almost 1-1, then $(G, X)$ is also minimal.\n\nProof. We will show that for every $x \\in X$ we have $X_{0} \\subseteq E(X) x:=\\{\\eta(x)$ : $\\eta \\in E(X)\\}$. This implies that $E(X) x=X$ for every $x \\in X$ (because $X_{0}$ is dense in $X$ and $E(X) x$ is closed in $X$ ), which means that $(G, X)$ is minimal.\n\nSo fix $x \\in X$, and consider any $x_{0} \\in X_{0}$. Since $(G, Y)$ is minimal, we can find $\\tau \\in E(Y)$ such that $\\tau(\\pi(x))=\\pi\\left(x_{0}\\right)$. Pick $\\eta \\in E(X)$ satisfying $\\tilde{\\pi}(\\eta)=\\tau$. Then $\\pi\\left(x_{0}\\right)=\\tau(\\pi(x))=\\tilde{\\pi}(\\eta)(\\pi(x))=\\pi(\\eta(x))$. Since $x_{0} \\in X_{0}$, we conclude that $\\eta(x)=x_{0}$.\n\nLemma 5.7. If $(G, Y)$ is minimal and $\\pi: X \\rightarrow Y$ is almost 1-1, then the group homomorphism $\\left.\\tilde{\\pi}\\right|_{u \\mathcal{M}}: u \\mathcal{M} \\rightarrow \\tilde{\\pi}(u) \\tilde{\\pi}[\\mathcal{M}]$ is a topological isomorphism (in the $\\tau$-topologies), where $\\mathcal{M}$ is a minimal left ideal of $E(X)$ and $u \\in \\mathcal{M}$ an idempotent.\n\nProof. By Remark $5.6,(G, X)$ is minimal, so $X=\\mathcal{M} x$ for every $x \\in X$. Pick $x_{0} \\in X_{0}$; then there is $\\eta_{0} \\in \\mathcal{M}$ such that $x_{0} \\in \\operatorname{Im}\\left(\\eta_{0}\\right)$. Choose an idempotent $v \\in \\mathcal{M}$ so that $\\eta_{0} \\in v \\mathcal{M}$. Then $\\operatorname{Im}\\left(\\eta_{0}\\right)=\\operatorname{Im}(v)$, so $x_{0} \\in \\operatorname{Im}(v)$, and hence $v\\left(x_{0}\\right)=x_{0}$ by idempotence of $v$.\n\nSince the diagram\n![img-0.jpeg](img-0.jpeg)\ncommutes (by definition of $\\tilde{\\pi}$ ) and, by Fact 4.8(6), the horizontal arrows are isomorphisms of semitopological groups, it is enough to show that $\\left.\\tilde{\\pi}\\right|_{v \\mathcal{M}}: v \\mathcal{M} \\rightarrow$ $\\tilde{\\pi}(v) \\tilde{\\pi}[\\mathcal{M}]$ is an isomorphism of semitopological groups. By Fact 5.2 , it is a group epimorphism and topological quotient map, so it remains to show that it is injective.\n\nSuppose for a contradiction that $\\operatorname{ker}\\left(\\left.\\tilde{\\pi}\\right|_{v \\mathcal{M}}\\right)$ is non-trivial, i.e. there is $\\eta \\in v \\mathcal{M} \\backslash\\{v\\}$ such that $\\tilde{\\pi}(\\eta)=\\tilde{\\pi}(v)$. Then $\\eta v=\\eta \\neq v=v v$, so $\\left.\\eta\\right|_{\\operatorname{Im}(v)} \\neq$ $\\left.v\\right|_{\\operatorname{Im}(v)}$. On the other hand, by the first sentence of the proof, $\\operatorname{Im}(v)=$ $v \\mathcal{M}\\left(x_{0}\\right)$. So there is $\\eta^{\\prime} \\in v \\mathcal{M}$ with $\\eta \\eta^{\\prime}\\left(x_{0}\\right) \\neq v \\eta^{\\prime}\\left(x_{0}\\right)=\\eta^{\\prime}\\left(x_{0}\\right)$, and hence $\\left(\\eta^{\\prime}\\right)^{-1} \\eta \\eta^{\\prime}\\left(x_{0}\\right) \\neq x_{0}\\left(\\right.$ where $\\left.\\left(\\eta^{\\prime}\\right)^{-1}\\right.$ is the inverse of $\\eta^{\\prime}$ computed in $v \\mathcal{M}$ ). As $x_{0} \\in X_{0}, \\eta \\in \\operatorname{ker}\\left(\\left.\\tilde{\\pi}\\right|_{v \\mathcal{M}}\\right)$ and $\\left.\\tilde{\\pi}\\right|_{v \\mathcal{M}}$ is a group morphism, we get $\\pi\\left(x_{0}\\right) \\neq$\n\n$\\pi\\left(\\left(\\eta^{\\prime}\\right)^{-1} \\eta \\eta^{\\prime}\\left(x_{0}\\right)\\right)=\\tilde{\\pi}\\left(\\left(\\eta^{\\prime}\\right)^{-1} \\eta \\eta^{\\prime}\\right)\\left(\\pi\\left(x_{0}\\right)\\right)=\\tilde{\\pi}(v)\\left(\\pi\\left(x_{0}\\right)\\right)=\\pi\\left(v\\left(x_{0}\\right)\\right)=\\pi\\left(x_{0}\\right)$ (where the last equality follows from the first paragraph) - a contradiction.\n\nA pair of points $\\left(x_{1}, x_{2}\\right)$ of a flow $(G, X)$ is called proximal if there is $\\eta \\in E(X)$ such that $\\eta\\left(x_{1}\\right)=\\eta\\left(x_{2}\\right)$; it is called distal if $x_{1}=x_{2}$ or $\\left(x_{1}, x_{2}\\right)$ is not proximal. Let $P$ denote the collection of all proximal pairs of points in $X$. The flow $(G, X)$ is said to be proximal when $P=X \\times X$, and distal when $P=\\Delta_{X}:=\\{(x, x): x \\in X\\}$.\n\nFact 5.8. The ideal group of every proximal flow is trivial.\nProof. Let $\\mathcal{M}$ be a minimal left ideal of $E(X)$ and $u \\in \\mathcal{M}$ an idempotent. From [Gla76, Chapter I, Proposition 3.2(3)], it follows that each pair of points in $\\operatorname{Im}(u):=u[X]$ is distal, so, by proximality, $\\operatorname{Im}(u)$ is a singleton, say $\\operatorname{Im}(u)=\\left\\{x_{0}\\right\\}$. Then for any $p$ in $u \\mathcal{M}$, say $p=u h$ with $h \\in \\mathcal{M}$, and any $x \\in X$, we have $p(x)=u(h(x))=x_{0}$. So $p=u$, hence $u \\mathcal{M}=\\{u\\}$.\n\nWhenever $\\pi: X \\rightarrow Y$ is a $G$-flow epimorphism, let\n\n$$\nR_{\\pi}:=\\left\\{\\left(x_{1}, x_{2}\\right) \\in X^{2}: \\pi\\left(x_{1}\\right)=\\pi\\left(x_{2}\\right)\\right\\}\n$$\n\nDefinition 5.9. A $G$-flow epimorphism $\\pi: X \\rightarrow Y$ is said to be:\n(1) equicontinuous (or almost periodic) if for every $\\varepsilon$ which is an open neighborhood of the diagonal $\\Delta_{X}:=\\{(x, x): x \\in X\\} \\subseteq X \\times X$, there exists a neighborhood $\\delta$ of $\\Delta_{X}$ such that $g\\left(\\delta \\cap R_{\\pi}\\right) \\subseteq \\varepsilon$ for every $g \\in G$;\n(2) distal if $P \\cap R_{\\pi}=\\Delta_{X}$.\n\nIt is sometimes assumed that the flows in the definition of equicontinuous extensions are minimal. On page 100 of [Gla76], Glasner defines almost periodic extensions of minimal flows in a different way. A proof that both definitions are equivalent for minimal flows can be found in [Aus88, Chapter 14, Theorem 1].\n\nThe following remark is well-known and follows from an argument on page 4 of $[$ Gla76].\n\nRemark 5.10. An equicontinuous epimorphism of flows is distal.\nProposition 5.11. If $\\pi: X \\rightarrow Y$ is an equicontinuous epimorphism of minimal $G$-flows and $(G, Y)$ has a trivial ideal group, then the ideal group of $(G, X)$ is Hausdorff (with respect to the $\\tau$-topology).\n\nProof. Choose a minimal left ideal $\\mathcal{M}$ in $\\beta G$, an idempotent $u \\in \\mathcal{M}$, and an element $x \\in X$ with $u \\cdot x=x$. Let $\\Phi: \\beta G \\rightarrow E(X)$ be the unique semigroup and $G$-flow epimorphism considered before and in Remark 5.4. Put $\\mathcal{N}_{X}:=\\Phi[\\mathcal{M}]$ and $v_{X}:=\\Phi(u)$. So $v_{X} \\mathcal{N}_{X}$ is the ideal group of $(G, X)$. Put $y:=\\pi(x)$. Then $u \\cdot y=y$ (as $u \\cdot y=\\lim g_{i} \\pi(x)=\\pi\\left(\\lim \\left(g_{i} x\\right)\\right)=$ $\\pi(u \\cdot x)=\\pi(x)=y$, where $\\left(g_{i}\\right)_{i}$ is a net in $G$ converging to $u$ in $\\beta G$ ). Let\n\n$\\mathcal{N}_{Y}:=\\tilde{\\pi}\\left[\\mathcal{N}_{X}\\right]$ and $v_{Y}:=\\tilde{\\pi}\\left(v_{X}\\right)$. So $v_{Y} \\mathcal{N}_{Y}$ is the ideal group of $(G, Y)$ which is trivial by assumption.\n\nClearly $\\Phi^{\\prime}:=\\tilde{\\pi} \\circ \\Phi: \\beta G \\rightarrow E(Y)$ is the unique semigroup and $G$-flow epimorphism from $\\beta G$ to $E(Y)$, and $\\left.\\Phi^{\\prime}\\right|_{u \\mathcal{M}}: u \\mathcal{M} \\rightarrow v_{Y} \\mathcal{N}_{Y}$ is a group epimorphism. Hence, as $v_{Y} \\mathcal{N}_{Y}$ is trivial, $\\operatorname{ker}\\left(\\left.\\Phi^{\\prime}\\right|_{u \\mathcal{M}}\\right)=u \\mathcal{M}$. As by Remark $5.4(1) \\operatorname{ker}\\left(\\left.\\Phi^{\\prime}\\right|_{u \\mathcal{M}}\\right) \\subseteq \\operatorname{Gal}(Y, y)$, we conclude that $\\operatorname{Gal}(Y, y)=u \\mathcal{M}$.\n\nLet $F$ be a $\\tau$-closed subgroup of $u \\mathcal{M}$, and let\n\n$$\nH(F):=\\bigcap\\left\\{\\mathrm{cl}_{\\tau}(V \\cap F): V \\text { is a } \\tau \\text {-neighborhood of } u \\text { in } u \\mathcal{M}\\right\\}\n$$\n\nAs $\\pi$ is almost periodic, [Gla76, Chapter IX, Theorem 2.1(4)] yields $H(\\operatorname{Gal}(Y, y)) \\subseteq$ $\\operatorname{Gal}(X, x)$, and together with the conclusion of the last paragraph this implies $H(u \\mathcal{M}) \\subseteq \\operatorname{Gal}(X, x)$. Note that we proved it for any $x \\in X$ with $u \\cdot x=x$, in particular for any $x \\in \\operatorname{Im}\\left(v_{X}\\right)$ (by Remark 5.4(2)). On the other hand, by Remark $5.4(3), \\bigcap_{x \\in \\operatorname{Im}\\left(v_{X}\\right)} \\operatorname{Gal}(X, x)=\\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right)$. Hence, $H(u \\mathcal{M}) \\subseteq \\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right)$.\n\nBy Remark $5.4(4), \\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right)$ is $\\tau$-closed. So, by [Gla76, Chapter IX, Theorem 1.9(3)] and the conclusion of the last paragraph, we get that $u \\mathcal{M} / \\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right)$ is Hausdorff with the quotient topology of the $\\tau$-topology on $u \\mathcal{M}$. Since by Remark $5.4(4)$ we know that $u \\mathcal{M} / \\operatorname{ker}\\left(\\left.\\Phi\\right|_{u \\mathcal{M}}\\right) \\cong v_{X} \\mathcal{N}_{X}$ as semitopological groups, we conclude that $v_{X} \\mathcal{N}_{X}$ is Hausdorff.\n\nThere are many equivalent definitions of tame flows (see Theorems 2.4, 3.2 and Definition 3.1 in [GM18]). We give the one which immediately points to a strong connection with the NIP property in model theory.\n\nA sequence $\\left(f_{n}\\right)_{n<\\omega}$ of real valued functions on a set $X$ is said to be independent if there exist real numbers $a<b$ such that\n\n$$\n\\bigcap_{n \\in P} f_{n}^{-1}[(-\\infty, a)] \\cap \\bigcap_{n \\in Q} f_{n}^{-1}[(b, \\infty)] \\neq \\emptyset\n$$\n\nfor all finite disjoint subsets $P, Q$ of $\\omega$.\nDefinition 5.12. Let $(G, X)$ be a flow. A function $f \\in C(X)$ (i.e. a continuous real valued function on $X$ ) is tame if the family of translates $\\{g f: g \\in G\\}$ does not contain an infinite independent sequence (where $(g f)(x):=f\\left(g^{-1} x\\right)$ ). The flow $(G, X)$ is tame if all functions in $C(X)$ are tame.\n\nThe following fact is a part of the information contained in the main theorem (Theorem 5.3) of [Gla18] on the structure of tame, metrizable, minimal flows.\n\nFact 5.13. Let $(G, X)$ be a tame, metrizable, minimal flow. Then there exists the following commutative diagram of $G$-flow epimorphisms\n\n![img-1.jpeg](img-1.jpeg)\nwhere:\n(1) $(G, \\tilde{X})$ is minimal;\n(2) $(G, Y)$ is proximal;\n(3) $\\theta, \\theta^{*}, \\iota$ are almost 1-1;\n(4) $\\sigma$ is equicontinuous.\n\nWe discussed all of the notions and facts above in order to deduce the following corollary.\n\nCorollary 5.14. The $\\tau$-topology on the ideal group of any tame, metrizable, minimal flow is Hausdorff.\n\nProof. We will be referring to items (1)-(4) in Fact 5.13. By (1), (3) and Remark $5.6,\\left(G, X^{*}\\right)$ is minimal, and so are $(G, Z),\\left(G, Y^{*}\\right)$, and $(G, Y)$ as homomorphic images of $\\left(G, X^{*}\\right)$. By (2) and Fact 5.8 , the ideal group of $(G, Y)$ is trivial, and so is the ideal group of $\\left(G, Y^{*}\\right)$ by (3) and Lemma 5.7. Hence, using (4) and Proposition 5.11, we get that the ideal group of $(G, Z)$ is Hausdorff, and so is the ideal group of $\\left(G, X^{*}\\right)$ by (3) and Lemma 5.7. Therefore, the ideal groups of $(G, \\tilde{X})$ and $(G, X)$ are both Hausdorff by Fact 5.2 , because they are quotients of a compact topological group (namely, the ideal group of $\\left(G, X^{*}\\right)$ ) by closed subgroups.\n\nTo apply this general corollary to our model-theoretic context, we need one more general observation, namely Lemma 5.16. To prove it, we have to recall a description of the $\\tau$-closure that was stated as Lemma 3.11 in the first arXiv version of [KLM22] (the relevant section of [KLM22] was removed in the published version).\n\nFact 5.15. Let $(G, X)$ be a flow, $\\mathcal{M}$ a minimal left ideal of $E(X)$, and $u \\in \\mathcal{M}$ an idempotent. Then for every $A \\subseteq u \\mathcal{M}$, the $\\tau$-closure $\\mathrm{cl}_{\\tau}(A)$ can be described as the set of all limits contained in $u \\mathcal{M}$ of nets $\\left(\\eta_{i} a_{i}\\right)_{i}$ such that $\\eta_{i} \\in \\mathcal{M}, a_{i} \\in A$, and $\\lim _{i} \\eta_{i}=u$.\n\nProof. Consider $a \\in \\mathrm{cl}_{\\tau}(A)$. Then, by the definition of the $\\tau$-topology, there are nets $\\left(g_{i}\\right)_{i} \\subseteq G$ and $\\left(a_{i}\\right)_{i} \\subseteq A$ such that $\\lim _{i} g_{i}=u$ and $\\lim _{i} g_{i} a_{i}=a$. Note that $u a_{i}=a_{i}$, as $a_{i} \\in A \\subseteq u \\mathcal{M}$. Put $\\eta_{i}:=g_{i} u \\in \\mathcal{M}$ for all $i$. By left continuity, we have that $\\lim _{i} \\eta_{i}=\\lim _{i} g_{i} u=\\left(\\lim _{i} g_{i}\\right) u=u u=u$. Furthermore, $\\lim _{i} \\eta_{i} a_{i}=\\lim _{i} g_{i} u a_{i}=\\lim _{i} g_{i} a_{i}=a$.\n\nConversely, consider any $a \\in u \\mathcal{M}$ for which there are nets $\\left(\\eta_{i}\\right)_{i} \\subseteq \\mathcal{M}$ and $\\left(a_{i}\\right)_{i} \\subseteq A$ such that $\\lim _{i} \\eta_{i}=u$ and $\\lim _{i} \\eta_{i} a_{i}=a$. Since each $\\eta_{i}$ can\n\nbe approximated by elements of $G$ and the semigroup operation is left continuous, one can find a subnet $\\left(a_{j}^{\\prime}\\right)_{j}$ of $\\left(a_{i}\\right)_{i}$ and a net $\\left(g_{j}\\right)_{j} \\subseteq G$ such that $\\lim _{j} g_{j}=u$ and $\\lim _{j} g_{j} a_{j}^{\\prime}=a$, which means that $a \\in \\operatorname{cl}_{\\tau}(A)$.\nLemma 5.16. Let $(G, X)$ be a flow, $\\mathcal{M}$ a minimal left ideal in $E(X)$. Then there exists a minimal left ideal $\\mathcal{N}$ of $E(\\mathcal{M})$ and a semigroup and $G$-flow isomorphism from $\\mathcal{M}$ to $\\mathcal{N}$. In particular, the ideal groups of the $G$-flows $X$ and $\\mathcal{M}$ are isomorphic as semitopological groups (with the $\\tau$-topologies).\n\nProof. Denote the semigroup operation on $E(X)$ by $*$ and on $E(\\mathcal{M})$ by - (although both are compositions of functions, but on different sets). Let $f: \\mathcal{M} \\rightarrow E(\\mathcal{M})$ be given by $f(p):=l_{p}$, where $l_{p}(q):=p * q$. It is easy to check that $f$ is a semigroup and $G$-flow monomorphism. Put $\\mathcal{N}:=f[\\mathcal{M}] \\subseteq E(\\mathcal{M})$. Thus, $f: \\mathcal{M} \\rightarrow \\mathcal{N}$ is a semigroup and $G$-flow isomorphism. We need to check that $\\mathcal{N}$ is a minimal left ideal in $E(\\mathcal{M})$. For that, first note that $\\mathcal{M}$ is a minimal left ideal in itself. Indeed, if $\\mathcal{M}^{\\prime}$ is a left ideal in $\\mathcal{M}$, then for any $p \\in \\mathcal{M}^{\\prime}$ and $q \\in E(X)$, taking an idempotent $u \\in \\mathcal{M}$ such that $p \\in u \\mathcal{M}$, we have $p=u * p$, and so $q * p=q *(u * p)=(q * u) * p \\in \\mathcal{M}^{\\prime}$ as $q * u \\in \\mathcal{M}(\\mathcal{M}$ is a left ideal in $E(X)$ ). Hence, $\\mathcal{M}^{\\prime}$ is a left ideal in $E(X)$ which is contained in $\\mathcal{M}$, so it must be equal to $\\mathcal{M}$ by minimality of $\\mathcal{M}$. Since $\\mathcal{M}$ is a minimal left ideal in itself, we get that\n(1) $\\mathcal{N}$ is a minimal left ideal in itself.\n\nOn the other hand,\n(2) $\\mathcal{N}$ is a left ideal in $E(\\mathcal{M})$.\n\nTo prove (2), consider any $\\eta \\in E(\\mathcal{M})$ and $p \\in \\mathcal{M}$, and we need to show that $\\eta \\circ l_{p} \\in \\mathcal{N}$. Using limits of nets, we easily see that there is $\\tilde{\\eta} \\in E(E(X))$ such that $\\left.\\tilde{\\eta}\\right|_{\\mathcal{M}}=\\eta$. For any $q \\in \\mathcal{M}$ we have: $\\left(\\eta \\circ l_{p}\\right)(q)=\\eta\\left(l_{p}(q)\\right)=\\eta(p * q)=$ $\\tilde{\\eta}(p * q)=\\eta^{\\prime} *(p * q)=\\left(\\eta^{\\prime} * p\\right) * q=l_{\\eta^{\\prime} * p}(q)=f\\left(\\eta^{\\prime} * p\\right)(q)$, where $\\eta^{\\prime} \\in E(X)$ satisfies $\\tilde{\\eta}(\\tau)=\\eta^{\\prime} * \\tau$ for all $\\tau \\in E(X)$ (such $\\eta^{\\prime}$ exists by Fact 4.4). Hence, $\\eta \\circ l_{p}=f\\left(\\eta^{\\prime} * p\\right) \\in \\mathcal{N}$ (and $\\eta^{\\prime} * p \\in \\mathcal{M}$ as $\\mathcal{M}$ is a left ideal).\n\nBy (1) and (2), we get that $\\mathcal{N}$ is a minimal left ideal of $E(\\mathcal{M})$.\nThus, $f(u) \\mathcal{N}$ is the ideal group of $\\mathcal{M}$, and $\\left.f\\right|_{u \\mathcal{M}}: u \\mathcal{M} \\rightarrow f(u) \\mathcal{N}$ is a group isomorphism, where $u \\in \\mathcal{M}$ is an idempotent. This isomorphism is topological (with respect to the $\\tau$-topologies) by Fact 5.15 (which expresses the $\\tau$-closure in terms of the semigroup operation and convergence within the minimal left ideal in question) and the above observation that $f: \\mathcal{M} \\rightarrow \\mathcal{N}$ is an isomorphism of left topological semigroups.\n\nWe can finally prove Conjecture 5.1 for countable $M$.\nTheorem 5.17. Let $M$ be a countable model of a theory with NIP and $N \\succ M$ be $\\aleph_{1}$-saturated. Let $\\mathcal{M}$ be a minimal left ideal of $S_{G}^{\\mathrm{ls}}(N, M)$ and $u \\in \\mathcal{M}$ an idempotent. Then the $\\tau$-topology on $u \\mathcal{M}$ is Hausdorff.\n\nProof. Let $M^{\\text {ext }}$ be the Shelah expansion of $M$ obtained by adding predicates for all externally definable subsets of $M^{n}$ for all $n<\\omega$. By Shelah's theorem [She09] (see also [CS13]), we know that $\\operatorname{Th}\\left(M^{\\text {ext }}\\right)$ has quantifier\n\nelimination, NIP, and all types in $S\\left(M^{\\text {ext }}\\right)$ are definable (i.e. all externally definable subsets of $M^{\\text {ext }}$ are definable). It follows that the Boolean algebra of externally definable subset of $G$ with respect to the original language coincides with the Boolean algebra of definable subsets of $G$ in the sense of the expanded language. Hence, $S_{G, \\text { ext }}(M)=S_{G}\\left(M^{\\text {ext }}\\right)$. Thus, without loss of generality, we may assume that $M$ is a countable model of an NIP theory such that all types in $S(M)$ are definable. Then $S_{G, \\text { ext }}(M)=S_{G}(M)$, and the semigroup operation on $S_{G}(M)$ is given by $p * q=\\operatorname{tp}(a b / M)$, where $a \\models p, b \\models q$, and $\\operatorname{tp}(a / M, b)$ is finitely satisfiable in $M$.\n\nIt is well-known, and observed first time in the introduction of [CS18], that NIP implies that $\\left(G, S_{G}(M)\\right)$ is a tame flow. (A standard way to see it is to note that, by NIP, the characteristic functions of all the clopens in $S_{G}(M)$ are tame (in the sense of Definition 5.12) and separate points, and so, by Stone-Weierstrass theorem, they generate a dense subalgebra of $C\\left(S_{G}(M)\\right)$; then use the fact that tame functions on $S_{G}(M)$ form a closed subalgebra of $C\\left(S_{G}(M)\\right)$ to conclude that all functions in $C\\left(S_{G}(M)\\right)$ are tame.) However, $\\left(G, S_{G}(M)\\right)$ is neither metrizable (even when the original language of $M$ was countable, the expanded language of $M^{\\text {ext }}$ is usually uncountable) nor minimal, so we cannot apply Corollary 5.14 directly to $\\left(G, S_{G}(M)\\right)$.\n\nLet $\\Delta$ range over all finite collections of definable subsets of $G$. For any such $\\Delta$, let $\\mathcal{B}_{G}(\\Delta)$ be the Boolean $G$-algebra (so closed under left translations by the elements of $G$ ) of subsets of $G$ generated by $\\Delta$, and denote by $S_{G, \\Delta}(M)$ the space of all ultrafilters of $\\mathcal{B}_{G}(\\Delta)$. Note that $S_{G, \\Delta}(M)$ is naturally a $G$-flow (the action is by left translations), and $S_{G}(M) \\cong$ $\\underline{\\lim } \\int_{G} S_{G, \\Delta}(M)$ as $G$-flows. Let $\\mathcal{M}$ be any minimal left ideal (and so minimal subflow) of $S_{G}(M)$. Let $\\mathcal{M}_{\\Delta} \\subseteq S_{G, \\Delta}(M)$ be the image of $\\mathcal{M}$ under the restriction map. It is clearly a minimal subflow of $S_{G, \\Delta}(M)$, and the above isomorphism induces a $G$-flow isomorphism $\\mathcal{M} \\cong \\underline{\\lim } \\int_{\\Delta} \\mathcal{M}_{\\Delta}$ (see [Rze18, Lemma 6.42]).\n\nSince $\\left(G, S_{G}(M)\\right)$ is tame, so is $\\left(G, S_{G, \\Delta}(M)\\right)$ as a quotient of $S_{G}(M)$, and so is $\\left(G, \\mathcal{M}_{\\Delta}\\right)$ as a subflow of $S_{G, \\Delta}(M)$ (using Definition 5.12 and Tietze's extension theorem, or see e.g. [KR20, Fact 4.20]). Moreover, $S_{G, \\Delta}(M)$ is metrizable since $\\mathcal{B}_{G}(\\Delta)$ is countable by finiteness of $\\Delta$ and countability of $G \\subseteq M$ (and this is the only place where we the assumption that $M$ is countable). Hence, $\\mathcal{M}_{\\Delta}$ is metrizable.\n\nSummarizing, $\\left(G, \\mathcal{M}_{\\Delta}\\right)$ is a tame, metrizable, minimal flow, and hence its ideal group is Hausdorff by Corollary 5.14.\n\nOn the other hand, since $\\mathcal{M} \\cong \\underline{\\lim } \\int_{\\Delta} \\mathcal{M}_{\\Delta}$, [Rze18, Lemma 6.42] implies that the ideal group of $\\mathcal{M}$ equipped with the $\\tau$-topology is topologically isomorphic to an inverse limit of the ideal groups (with the $\\tau$-topologies) of the flows $\\mathcal{M}_{\\Delta}$.\n\nBy the last two paragraphs, we conclude that the ideal group of $\\mathcal{M}$ is Hausdorff.\n\nFinally, by Fact $4.11, E\\left(S_{G}(M)\\right) \\cong S_{G}(M)$ as semigroups and $G$-flows, so $\\mathcal{M}$ can be identified as a $G$-flow with a minimal left ideal of $E\\left(S_{G}(M)\\right)$. Then, by Lemma 5.16, the ideal groups of $S_{G}(M)$ and $\\mathcal{M}$ are topologically isomorphic. Therefore, by the last paragraph, the ideal group of $S_{G}(M)$ is Hausdorff.\n\nCombining Theorem 4.17 with Theorem 5.17 we thus get (using the notation in Theorem 4.17):\n\nCorollary 5.18. Assume that $G$ is countable and $\\operatorname{Th}(G)$ is NIP, and let $\\mathcal{M}$ be a minimal left ideal in $\\left(S_{x}^{\\mathrm{fe}}(\\mathcal{G}, G), *\\right)$ and $u \\in \\mathcal{M}$ an idempotent. Then $\\mathfrak{M}(\\mathcal{M}) * \\mu_{u \\mathcal{M}}$ is a minimal left ideal of $\\left(\\mathfrak{M}_{x}^{\\mathrm{fe}}(\\mathcal{G}, G), *\\right)$, and $\\mu_{u \\mathcal{M}}$ is an idempotent which belongs to $\\mathfrak{M}(\\mathcal{M}) * \\mu_{u \\mathcal{M}}$.",
      "tables": {},
      "images": {
        "img-0.jpeg": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCACiAXMDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3+iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACik3f5FGaAFoPApu72rH8WapPo/hPVL+1GbuK3f7OMZzKRiMY75YrxQBs7smlrj/AIY+ILjxN8P9M1K8m828O9J2IAJdXI5x7YP41127jvQAu7nGKWvPdE8eDxR8TbnRtJYHStNtHee4A4uJtyqAp/uAFsEdT7YJ9CoAKKKKACiiigAooooAKDwKKKAIZ7qC1haa4ljhhTBaSRgqj8TS/aIwqMXUI5AVi3Bz0x654rlfiLOdN8G6jqsas9za27rbp/CskmIw5Hqu48+hb1rB1uC002+8DeFmn3W2lodQuWJ5WO1iwjEehcg/8B46UAegahq+naTAJ9RvrWziJCh7iZY1J54BYj0/nU1vdwXlvHcW0sc8EgDJLEwZWB6EEcEVyt3fafpXjKXUtbdLa3ls4ksbq6+WOIhnMibjwjH5Cc4yAB/DVjwqIpb7WL6xiMek3Nyr22I9iyNsAkkQED5WbHThiCwyGyQDqaKKKACiiigAooooAKKTdz0paACiik3UALRTd/OMUuaADcOOnNGa82+KvjPUPCVz4cWylMcM94JL0hQf3CMgYEnoDvxXpPNAC0gbn8cVna3rth4e0i51PUZRFbW65PcsT0VR3JPAHrWB8OfEF94s8OSa9eARx3d3K1rCP+WUK/Iq57nKsST3J6cUAdjRRRQAUUUUAFFFFABRRRQAUUUUAFHaiigDN1V7wpBb2WY3uJhG86gN5CYJZ8HjPAUZB5YcEVzXgTVtQ1/Tdcla8d7RNSng065kVSxiUAbjgAMN27BPXoa6zUYZ5tLu4rWTy7l4XWJ+gVypAP54rifBDy6T8PtL0O0sLqDVoYfKeKe3dVhlLEs7MRt2hiW6/MOBk8UAbXgOXWJfCFq2vXAn1FZZkll2gbwsrqpGOMYAxU3iD/TtT0XSF5Etz9rn9o4MOP8AyIYR9Caq+IPEukfDjw1p734uWsleOzRok3sPlPzNyOMLyfWn+Frg67cXPidopIre8RYbBJV2t9nXJ347b2LH/dCUAcr8KG/sfXfGPhNvlFjqRuYFPUxSjjHtgKf+BVua1dz+LNVl8MaTO8djCQNYv4jjaCM/Z42/vsMbj/Cp9SKzPE3grXrn4iWuveHL5LBb20ay1ObGWRBgh1HdiMAem0Gu50fRrLQdLh07T4vLt4RgDOSxPJZj3Ynkk9STQB538MbS3/4T7x3cWsEcNvb3MFhAiDARIlZdo/75WvVK8n+Ed35GueMdPuYblLyTWZp8m3fYVJIzvxtHQ8EjPavWKAKt5qNlp1sbm+u4LW3BAMs8gRATwBuPFZ3/AAmfhb/oZdH/APA6L/4qteWCKZCksaSIequuQfwqD+ytP/58bX/vyv8AhQBn/wDCZ+Fv+hl0f/wOi/8AiqP+Ez8Lf9DLo/8A4HRf/FVof2Vp/wDz42v/AH5X/Cj+ytP/AOfG1/78r/hQBn/8Jn4W/wChl0f/AMDov/iqP+Ez8Lf9DLo//gdF/wDFVof2Vp//AD42v/flf8KP7K0//nxtf+/K/wCFAGf/AMJn4W/6GXR//A6L/wCKpP8AhM/C3/Qy6P8A+B0X/wAVWj/ZWn/8+Nr/AN+V/wAKP7K0/wD58bX/AL8r/hQBk3Hirwhd28lvc6/oc0MqlZI5LyJldT1BBbkYqiNQ+Hq+XjUPDWYmLoTPAdrYAyOfQD8h6V0n9laf/wA+Nr/35X/Cj+ytP/58bX/vyv8AhQBm/wDCY+FsY/4SXR8e99F/8VSf8Jh4WBB/4SXR+P8Ap+i/+KrT/srT/wDnxtf+/K/4Uf2Vp/8Az42v/flf8KAM/wD4TPwt/wBDLo//AIHRf/FUf8Jn4W/6GXR//A6L/wCKrQ/srT/+fG1/78r/AIUf2Vp//Pja/wDflf8ACgDP/wCEz8Lf9DLo/wD4HRf/ABVH/CZ+Fv8AoZdH/wDA6L/4qtD+ytP/AOfG1/78r/hR/ZWn/wDPja/9+V/woAz/APhM/C3/AEMuj/8AgdF/8VSHxn4WAP8AxUuj/wDgdF/8VWj/AGVp/wDz42v/AH5X/Cj+y9P/AOfG1/78r/hQBxniLxnolje6frNl4h065S08yO6s4b6NmkhfbuZV3fM6FVIHUjcB1rsNL1jT9bsIr7TLuG6tZfuyxPkH1HsfbrWHr+hjU7vTtJhs1isJy8t9cRIFPlpjEQYcqzlhyOdqvgg810NlYWmm2kdpY20VtbRjCQwoERR7AcCgCyehrzvxxretaVZxXFjcSwXk+pwWGm2u1ds5LDe0gxkggOOMYABHJ49DPQ1wvi+zmPjrwfqksE82l6fJc/aGjiaTypHjAjdlUE4yCM44PWgC1431u/02/wDDWm6VKI7zVNUjiclA3+jr80vUemPf3rrxyM9/SvNdUuLu6+Juma0+l30mmWOm3AsG8hszXTFQy4xlMqcAtjO0noM1e1P4kWmg6pF4auba5vfEJtY2jSCL93cTMCNoOcqMjJJHAz6UAZvjzR28VaB40mVd32W1S3tu+WhPnyFfqSE+qGuo8IeJLbUvh3peuXVwiRfYg9xK7YCsg2yEn0DKa09E0w6bodvYzOJpApNxJj/WysS0jf8AAmLH8a898J/DTUtPurvStYu1l8K2l891YWSnPn5wV83/AGFx93oWyTx1AF8RPPr3hnV/F+oxvFp1nYzNotpKuCWKFRcyL/eORsB+6DnqeOo+GFmLD4Z+HoQMbrNZse8nzn/0Kq/xZimk+F+vJbozyGFRhRk43ru/TP5VoeAb+G+8D6N5MU8Yis4YWEsLx4ZY1BxuAyBjGRwfWgDpqKKKACiiigAooooAKKKKACiiigAooooAKbtxnHFOooAilt4poWimjWWNhgq4yD9acF2gKvAHpT6x9d1OfSxpvkrG32m/htn3gnCsTkjB68UAa+33paKKAECgUtFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFACBcd/8A69LRRQAHkEU3YO2Pyp1FADQuOh7YqNrWF5VlaNGkQEK5UFlB6gHqKmooAb3o24/P0rJsNSnuvEmr6dIsfk2SwNGQDuO9WJzz6j2rYoATHrQFwetLRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFc34v6aF/wBhi2/rXSVzfi/poX/YYtv60AdJRRWM3izw/Hdz2kmtaelzB/rImuFDLjrwTzj26UAbNFNDBgCuCDyCDxTqACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAOb0f/kefEv/AFzs/wD0B66Sub0j/kefEv8A1ztP/QHrbvb+1060e7vLiK3t4xueWVgqqPcnigCzRWbp/iDSNWKjTtTs7sspcCCZXO0HBOB6EgVpZoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACua8YdNC/wCwxb/1rpa5rxf00L/sMW/9aANrULqW0spZoLV7qYcJChALsTgDJ4A9T2Feez6r4tNwYm0XwqxtL6K2jDTSsUlkCt8p8vggOCTgd8Zr0sjg9/auGTwprX/CP6Usl1bnV4tYTU719zbJMyMXRTjsjbRwB8o6UAdXpJ1Q2CHWY7OO9yd4s3Zo/bBYA/pWhTR+vfFOoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA5rSOPHHib/AK52n/oD0zxZqmpWFnJLp2n2ky2sDXU1xfytHFGq54XapYv8p9Mcc84p+kf8jx4l/wCudp/6A9TeJ9LvdXtLOytpIUtmvInvTIxBaBDvKrjruKqpz2Y0Ac9o914wfW7iIaV4YgceTLfPDLKHO/PH3OXAB4JxyK74cgZxn2rB0zSr6z8Xa3qEk0b2N+luYUyd8bopVgRjGPun6k10GKACiiigAooooAKKKKACiiigAooooAKKKKACiiigCOeYW9vLMUdxGhfZGu5mwM4A7n2rjta1zT9aj0c2M+94dZtlmhdGjliY5IDowDKcc/MBxXY3ERntpYllkiLoVEkZAZMjGRkEZH0NeOfEjRtTtZtHa7MuppJex28N3bqIrmVCTm2k24U7uqyADaQ2QCckA9R0/wARadq19La2EklwIgd9xFExgBBA2iXGwtz0BJHfFam3nNYPh7SNQsQkt/fof3eyOwtIljtbZcjAUY3MRgjcTzzwK6CgAooooAKKKKACiiigAooooAKKTNG7mgBaKY8qxxtI5CooJYscAAdT9Kbb3Md1DHNCweKRQ6sOhB6GgCWiioIbuC4lmiikVpIGCSqDyhIBGfqCD9KAJ6KKKACiiigAooooAKKKKACiiigArM1bXbLQ0jlvzNHA5IacQu0cWMcyMAQg56tge9adZesabe3scb2GqzWE8WSpWJJI5M9pFIyRx/CVPvQBgWutadp3ibxJqN3eRRWbR2WyYtkNuR9u3+8T2AyTXT6ffR6lZx3UUdxEkmdq3ETRP1I+42CPXkdxXj3hnRtSb4ja1a2tjb2F3aiMtKy+Zb2O8NuaBT94yH5lBwEBcc9D7Fp9nJZWUcEt7cXki53T3G3e5znnaAB6cAUAWguO9LRRQAUUUUAFFFFABRRRQAUUUUAFFV5b61huorWS5hS4myY4mkAZ8dcDqfwqUSqzsikFl6gHkfWgB9FU9T1S10jT5r68k2QRAE4BJYk4CgDksTwAOpNS2s0s1rFLPbtbyOoLRMwYoT2JHGR7ZHoTQBPRQelUNV1L+yrF7x7eSaKIgyiIZZU7sB3x1IHOAcZPFAF+mGJWILAHBz0plvcx3VtHcQsrxSoHR1OQykZBB9DTbm+trKNXuriKBGYKGlcICfTmgCYLg9c/WnVGJk3hMgOQSFJ5wOD+RI/OsjxHrtxosenraaf9uub67FrFEZvKGSjvktg9kNAG3RUFpNPLaRSXNv8AZ5mQF4g+/Ye4yBziqWu+ItM8N2cV3qtyIIZZlt0JBO526Dj6H8qANSikzRmgBaKzk1i3un1CDT2S6urH5JIlfAEhXIQt0B6Z9M1T8P69c6vPqVre6cLG6sJkikjFwJQd0auCCAOzCgDdoPSig9KAMbxBq1npunMLp7vdPmOOKyR3nk452BAW4HOR065FcNpPiLQ7C/imstP8bSoVZ4baS3uZYhjCsyhiSfvAHkgE9Aa7TxTd3On+H7u906ykudSWLy7VI4y7b3KqueDhQ21j7LmsvTbK50jxnp2nJbzPpsOhCCO42kqJI5FBBPYldp59KAJvEdx/aOq6DoO1hBqDSXN0rDBMEKhthB6ZdowfbI71qa34gs9Bt3uLpZWWKJ55BEoJSJMbnOSBgZHGcnPANZetr9m+IPhi+cYhkiu7Mv2DsqSKPbIif9Kg+Iunzah4ZFtDbPLHNdW0d95Me6T7KJQZMActgdQM8E0AdBca/p9tdaXavKfN1RmW1VVPz4QuT7AKOvuKx/EbjR/EehaxEMC5uV0y6AH345NxjJ91kAx7O3rWPeT3d38RbDUIdLvGsrPTpI7F2tnRHuJZEVs8ZVVQDlgMgEjIFavjdTdf8I9YoMyz61bOoU8hYiZWP02xn8xQBr6nryafdxWUNld399KhkFtahdyoONzM7KijPTLDPOM4NSaTrdvq6SiOKa3uIH8ue2uFCyRPgHBAJByCCCpIPY1m30Oo6Z4ifWLHT21CG6tY7WeCKREljMbSMrIXKqQfMYEFh0BGcmpdDtL5tT1DV9QgW1lvPLiS2DhzHHHu27yOC5LsTjgDAycZoA6CiiigAoprSKiFmIAAySTgAepqCC/tLm2FzBcRSW56So4ZT+I4oAs0UgbIyOfpWd/bMT66ukwRtLOkfm3DD7sCnO3cf7zEcD0BPpkA0qKKKACis2bWIrXVrawuY2iF0p+zzZykkgyTHns20bh6gH+6a0c8UAII1DE4GT7U6q5vrVbtLQ3MIuXXesJkAdl9QOpHHWpFmRmZVYEqcMAc7TjPPpwQfxoAkornrvxDfR+Kl0Sy0lbrbbRXM85uhH5aO7pwu07sbCetdBnigBaKypfEelw+I7fw+90o1O4hNxHDg8xjIJz07H8jWrQAUVG0yIhd2CoASWJwAB3rEvPEcr6DFq+h2K6pbyKZP9f5P7sA/MMqc9OnvQBv0VS0jUBqujWOorEYxd28c4QnO3cobGe/WigC7TScKTjjFOqte2UN/ZS2tyGaGVdsihiu5e4yOxoA831rxV8Kr+5uo9ReC9mkcK9wlnPK2V6bJUU4xjI2NjqR1NaXhXxn4G86DSNAubhpJ5CPntbhjI3Iy8jrknjGWPb2rRtrmC48cXccCqlpoGnrCVUAIskuGIAHA2xxp9PMNWfAVx9t8B6Ldk5e4tlmcg8b2+Zv/HiaAKOqS/2v8TNJ0Zi32XTbR9VmX+F5S3lxA/T94w9wPSunvLy306DzpywBYKqqpZnY9FAHU1yWmZX4y6+G6vpVo0eT/DucHH41v+I5bfTdKn1ydTIdKt5rmNcnG4Rtzj127hn0Y0AOtvE2mXWjXuqrMy2tiZVuiyMGiaLPmArjORip9J1Wz1zSrXU9Pl821uU8yN8YyOnT26VyvgC1Hh/4YwX2okyTXUT6leNj5pHl+cjHc4IHvXR+F9JXRPDOmaaqhfs9uiOo6bsfN+uaAMTwNMbK/wDEPhkn5NIvgbZc5228yiRF/DLAewAqn4o8T/D2HVGtfEMlvd3UCCNontZLpYd3bAVlVj0PRjxnoKl0Bd/xa8ZFchRa2KyY/vFXI/SrF9FaW+u+H/C9ioVPNfUrlM7mKRchmJ5LNM0bZPJ2nvQBgaH42+GehO66XPdRu2FJe1u5WUdQgLqSq99owOc4rqPFnzal4U+Xg6yuc9v9Hn/z+NHhC8W/vPE8oYFl1iSFhnp5cUSD6cLn8aXxbhdS8KH/AKjI/wDSeegDpwMV5N8bbCbWtDktLZm3aZaPqj7exVkVc/VDP/3zXrG7PHf0rmNKtIPEFtrl/cAtb6qWtY/e2QGMY9mYyOD6OKANXw7qa614a0zU1OftVrHN+LKCf1zWJ4t8Q3MDLomiuP7WuImleUjctlAPvTuPXjCg/ePsDXC/D3xdcaH4Wl8GpbG78T2F7NZW9ochSu4t5rt2jXc2T6AY6ius1PRx4W+HHiW7nuTdatdWM8t5euMNLL5ZAx/dReir0A/EkAz/AIFWrp8OEvpXd5b+9nuXdmyXO7Zknv8AcrpfDo/4q7xf/wBftv8A+ksVVvhZbrZ/DLw9EoA3Wiyfi5Ln9WNWvDv/ACN3jD/r9t//AElioA6ekzkfWlrO1W01O6SIabqcdiysS7PbeduHYY3DFAF8gH/9VG2ud/snxX/0NNr/AOCof/HKP7J8V/8AQ02v/gqH/wAcoA1NX0qLV7H7PI7ROjrLDMgG6KRTlXGcjIPqOelWYEmEMYnZTKFAcoMAn1A7fTJrC/snxV/0NFr/AOCof/HKT+yPFf8A0NNr/wCCof8AxygDotg7/wAqzk0kvrr6rdOHkSPybVFXiFTjefdmIGT6KB6k5/8AZPiv/oabX/wVD/45Sf2R4r/6Gm1/8FQ/+OUAdHtFZutauui28F1NEXge4jhmkBwIlc7Q54+6GK59ASe1Z/8AZPiv/oaLU/8AcKH/AMcrK8QWut2mg3kmqeIra4szH5ckA0hXM+7CBAvmclmIAHqaAO33c4xTj0rk/Ael+INJ0QQ+IdRW6kYgwwhcm2X+4ZCcuenJ5HTJ611Z6GgDnfFuteGtL01I/Ek8a21w+Ft2RpDLjkjYoJYdMgjHPPWuHh8UfCSDU49Qt1MU+/cqxWFykTOBnd5YQIWGOuMjHWu28T3Vp4b0vVPEgiD3624iiLHJZicRxrnoC5HTqTz0GM6BBpXibwjoDS7vI024dmJ5eRBEgY+pIaQ0Abun+JdL1TQZdatJpHsY0dmkeF4zhRk8MAay/h3HLL4Th1i7yb7WHOoXDE55f7gHsIwij2FaHjSN38DeIBH/AKw6ZcheMnJjbFJ4MZD4E8PtHjZ/ZluRg548paAJb/xRpWm3sdtdTMhadLcyCNjGkr/cRmAwCePzGcZGbOpa3YaTLYx304he+uFtbddpYvIeg4Bx0PJ4rhfE1lHe+PPCvhiDd9lFzPrV5ubJYoxZB9DIx46AAelSa9JHqfxh0K0lIW20Swn1O4ZiNoLfIuT2Ixn6UAdN4z0x9S8JajHASt3DEbi1ccFJ4/njP/fQH4GrOg6zHrPhnT9YO1I7q2SdsnhMqCQfoc8+1aEk0T2TytzCYyxPquM/yriPhtpkWofCDQ7HUI/Mhlgy8ZPDr5hYA+qkAAjoRxQBkan4p+FF/NMLxluZpJDKbqOzuWkLA43JMi7uOACrYAwBxW94T8ZeC7mW30Xw9PMXfcyK1rONxwSWaR15OOck5NKdWWTWvE+qw4aDQrL7JERggS7TLLz9PJB9CtbXg8qfBehFG3IdOgKtnOR5a0AU7cf8XQ1Af9QW1/8AR89dOelczb/8lR1D/sC2v/o+etjWNUj0jSbq+lQuIYywRTzI38Kj3JwB7kUAeQ+KJZLP4uaH4tDt9kXVjoxYn5QvlqpP4O8w/wCAV7WW9q818feE7if4OzWaEyanYgagZE/inUl5WHud0hHuadY+Lrn4haRY6f4eka3ae3STVb9FIFlkfNFHnrKeQOwHPPAoAwPi/wCJrzUfC2r22jzeXpVm6W97dD/l6mZgDbofQAkufYL616VBp40rwJHp4B/0XTRD/wB8xbf6VwfxZ02z03wf4Y8PWMKw2k2sW0AjXumGzn1OSCT1Nemau2dFv+ePs8n/AKCaAKXg8f8AFEaBjj/iXW//AKLWineDv+RI0H/sHW//AKLWigDaoPIxRRQBjaJ4btdDi1FYpZp31C7ku7iSchmZn4x0+6AAAPajwx4ctvCvh620aznnlt7bd5bTsGbDMWxkAcDcQK2aKAON1+H+xvHGkeJelrLC+l3zk/6tXYNE59hINpPbzBXU3trBqNlcWN3EJLe4iaKVD0ZWGCPxBNOurSC9tpLa5iSaCVSkkbrlWBGCCPSi1tUs7aK3jZ2SJQimRizYHTJPJ+p5PcmgDH03wvHp9nZ2Umo3d3ZWQQQQTBMAJ9zcVUFtuBjPHAJBIzWzNPHbwPNM6xxRqXd2OAqgZJJ9u/apqp6jpltqtt9mvE8yAsGeIn5XwcgMO4yOnQ980Ac74HtJJI9V8QXETJNrd4bmNXHzC3VQkIP/AABQ3tux1rWtvDltbeKb3xAZppbu6gjtgrkbYY15wvGeTyc961lQL0p1AGLonhq10G/1e7tZp2Op3P2qWJ2BRHxglRjjP+HpVHxaf+Jl4U/7DI/9J566isnXdAt9ft7aKe4uoGtZxcQy20mx1cKy5zg9mNAHO+KfB2u694htbqx8V3em6b5At7uziB/eJuJZgc4DEHbnGRjPtXZW1rDZ2sVtbxrHBEgjSNRwqgYAH4YpLS2Fraw2/myzeUoUSTNudsdye596noAz7XQ9Ns9WvNVt7OKO/vQouLgL80gUYGT9PSm6/o8ev6BqGkyytEl5bvCZFGSuQRn3xWlRQBz/AIR8Ny+FdAt9Lk1WbUFt0CRvLGiBFHRVAGcfUk+9V/Dp/wCKu8YY5/023/D/AEWKukni8+3lh8x4/MQrvjbDLkYyD2NZmh+HrbQjdtFc3lzLdyCWaW7l8x2IUKOceiigDXooooAKKKKACiiigAooooAKp3umWuo/Z/tUYkFvMs8YyQA652nHfGfzq5RQA3b05PH606iigDG13w5a+IG00Xc0yxWN4l4IkICysmdobjlQSDj2pNQ8NWmo+JdH12SaZLrSxMIxGQFkEi7SG4yRxke9bVFADJYknheKRQyOpVge4PBrk/APmafpEvhq6b/StGlNuMnl4Mkwvj0KEDvypHauvqnJplrJqcGolCt1CjRiRTgsjdVb1GcH2I+uQDP1PwzBqGtWmsxXM1rqFrG8KyxhWDxtjKsrAgjIBHTBqg3gKwbVbjUWvb1p7y3FtfF2U/ao85wfl+X+6duBt4wOtdXRQBzPje8nt/DM9jYjdqGpD7DZJn/lpIMbvoi7nJ7Ba2NJ02DSNGsdMt/9TaQJAnqVVQo/lTjpls2qLqTrvuki8lGbpGpOW2jtnjP+6Kt45zn3oAwdJ8I2Ok+H7zRxLPcR3rzPdTTEGSVpSd7EgAZwcdOwq3oGixeHtAstJt55pobOIRo8xyxA6A4x+H4VqUUAcvb/APJUNQ6f8ga1HX/ptPWXp/gbV18X3Go6t4nutQ0j7U15a6c4IWKQtlM8nITqBwMgHAxXQXvhi2vdfj1kXt9b3SRJCy28+xJERmYKy9xlm/OtvHvQAhQFSpAIPGCOMVR0bRNN8P6clhpVpFaWqMWEcQwMk5JPqa0KKAOU8c+Cl8Z2FhANRksJrK7W6imjjDkFQeMEj1HPt0rWvYXt/Dl3FJcy3Mi2sm6WUKGc7TyQoA/ICtWszW9FTXLQW0l7e2seTuNpN5ZYEYwfagCDwf8A8iToP/YOt/8A0WtFaFhYQ6bp1tY24Pk20Swx7uTtUADJ/CigC1RRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAH//2Q==",
        "img-1.jpeg": "data:image/jpeg;base64,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"
      }
    },
    {
      "section_id": 10,
      "text": "# 6. ACKNOWLEDGEMENTS \n\nWe thank Aaron Anderson, Martin Hils, Anand Pillay, Sergei Starchenko, Atticus Stonestrom and Mariana Vicaria for helpful conversations. Chernikov was partially supported by the NSF CAREER grant DMS-1651321 and by the NSF Research Grant DMS-2246598. Krupi\u0144ski was supported by the Narodowe Centrum Nauki grant no. 2016/22/E/ST1/00450.",
      "tables": {},
      "images": {}
    },
    {
      "section_id": 11,
      "text": "## REFERENCES\n\n[ACP14] Hans Adler, Enrique Casanovas, and Anand Pillay. \"Generic stability and stability\". In: The Journal of Symbolic Logic (2014), pp. 179-185.\n[Adl07] Hans Adler. \"Strong theories, burden, and weight\". In: preprint 2008 (2007).\n[AGK19] Uri Andrews, Isaac Goldbring, and H Jerome Keisler. \"Independence in randomizations\". In: Journal of Mathematical Logic 19.01 (2019), p. 1950005.\n[And23] Aaron Anderson. \"Generically Stable Measures and Distal Regularity in Continuous Logic\". In: Preprint, arXiv:2310.06787 (2023).\n[Aus88] Joseph Auslander. Minimal Flows and Their Extensions. Mathematics Studies 153. Amsterdam: North-Holland, July 1, 1988. 280 pp. ISBN: 978-0-08-087264-3.\n[Bay18] Martin Bays. \"Geometric stability theory\". In: Lectures in model theory (2018), pp. 29-58.\n[BMPW16] Thomas Blossier, Amador Martin-Pizarro, and Frank O Wagner. \"A la recherche du tore perdu\". In: The Journal of Symbolic Logic 81.1 (2016), pp. 1-31.\n[BY09] Ita\u00ef Ben Yaacov. Transfer of properties between measures and random types. Unpublished research note, http://math.univ-lyon1.fr/ begnac/articles/MsrPrps.pdf. 2009.\n\n[BY10] Ita\u00ef Ben Yaacov. \"Stability and stable groups in continuous logic\". In: The Journal of Symbolic Logic 75.3 (2010), pp. 11111136 .\n[BYCR24] Ita\u00ef Ben Yaacov, Artem Chernikov, and Nick Ramsey. \"Randomization and Keisler measures in $\\mathrm{NSOP}_{1}$ theories\". In: Preprint (2024).\n[BYK09] Ita\u00ef Ben Yaacov and Jerome H Keisler. \"Randomizations of models as metric structures\". In: Confluentes Mathematici 1.02 (2009), pp. 197-223.\n[BYU10] Ita\u00ef Ben Yaacov and Alexander Usvyatsov. \"Continuous first order logic and local stability\". In: Transactions of the American Mathematical Society 362.10 (2010), pp. 5213-5259.\n[Cas11] Enrique Casanovas. More on NIP and related topics (Lecture notes of the Model Theory Seminar, University of Barcelona). http://www.ub.edu/modeltheory/documentos/nip2.pdf. 2011.\n[CG20] Gabriel Conant and Kyle Gannon. \"Remarks on generic stability in independent theories\". In: Annals of Pure and Applied Logic 171.2 (2020), p. 102736.\n[CG22] Artem Chernikov and Kyle Gannon. \"Definable convolution and idempotent Keisler measures\". In: Israel Journal of Mathematics 248.1 (2022), pp. 271-314.\n[CG23] Artem Chernikov and Kyle Gannon. \"Definable convolution and idempotent Keisler measures, II\". In: Model Theory 2.2 (2023), pp. 185-232.\n[CGH23a] Gabriel Conant, Kyle Gannon, and James Hanson. \"Generic stability, randomizations, and NIP formulas\". In: Preprint, arXiv:2308.01801 (2023).\n[CGH23b] Gabriel Conant, Kyle Gannon, and James Hanson. \"Keisler measures in the wild\". In: Model Theory 2.1 (2023), pp. 1-67.\n[Che14] Artem Chernikov. \"Theories without the tree property of the second kind\". In: Annals of Pure and Applied Logic 165.2 (2014), pp. 695-723.\n[Che18] Artem Chernikov. \"Model theory, Keisler measures, and groups\". In: Bulletin of Symbolic Logic 24.3 (2018), pp. 336-339.\n[CK12] Artem Chernikov and Itay Kaplan. \"Forking and dividing in NTP2 theories\". In: The Journal of Symbolic Logic 77.1 (2012), pp. 1-20.\n[CKR23] Artem Chernikov, Byunghan Kim, and Nicholas Ramsey. \"Transitivity, Lowness, and Ranks in $\\mathrm{NSOP}_{1}$ Theories\". In: The Journal of Symbolic Logic 88.3 (2023), pp. 919-946.\n[Coh60] Paul J Cohen. \"On a conjecture of Littlewood and idempotent measures\". In: American Journal of Mathematics 82.2 (1960), pp. 191-212.\n\n[CP12] Annalisa Conversano and Anand Pillay. \"Connected components of definable groups and o-minimality I\". In: Advances in Mathematics 231.2 (2012), pp. 605-623.\n[CPS14] Artem Chernikov, Anand Pillay, and Pierre Simon. \"External definability and groups in NIP theories\". In: Journal of the London Mathematical Society 90.1 (2014), pp. 213-240.\n[CS13] Artem Chernikov and Pierre Simon. \"Externally definable sets and dependent pairs\". In: Israel Journal of Mathematics 194.1 (2013), pp. 409-425.\n[CS18] Artem Chernikov and Pierre Simon. \"Definably amenable NIP groups\". In: J. Amer. Math. Soc. 31.3 (2018), pp. 609-641.\n[CS21] Artem Chernikov and Sergei Starchenko. \"Definable regularity lemmas for NIP hypergraphs\". In: The Quarterly Journal of Mathematics 72.4 (2021), pp. 1401-1433.\n[DK12] Jan Dobrowolski and Krzysztof Krupi\u0144ski. \"On $\\omega$-categorical, generically stable groups\". In: The Journal of Symbolic Logic 77.3 (2012), pp. 1047-1056.\n[EKP08] Clifton Ealy, Krzysztof Krupi\u0144ski, and Anand Pillay. \"Superrosy dependent groups having finitely satisfiable generics\". In: Ann. Pure Appl. Logic 151.1 (Jan. 2008), pp. 1-21.\n[Ell57] Robert Ellis. \"Locally compact transformation groups\". In: Duke Mathematical Journal 24.2 (1957), pp. 119 -125.\n[Ell69] Robert Ellis. Lectures on topological dynamics. Mathematics lecture note series 28. W.A. Benjamin, Inc., 1969. ISBN: 9780805324204.\n[GK15] Jakub Gismatullin and Krzysztof Krupi\u0144ski. \"On model-theoretic connected components in some group extensions\". In: Journal of Mathematical Logic 15.02 (2015), p. 1550009.\n[Gla07] Eli Glasner. \"The structure of tame minimal dynamical systems\". In: Ergodic Theory and Dynamical Systems 27.6 (2007), pp. 1819-1837.\n[Gla18] Eli Glasner. \"The structure of tame minimal dynamical systems for general groups\". In: Invent. Math. 211 (2018), pp. 213244 .\n[Gla76] Shmuel Glasner. Proximal Flows. Lecture Notes in Mathematics 517. Berlin: Springer-Verlag, 1976. ISBN: 978-3-540-07689-6.\n[Gli59] Irving Glicksberg. \"Convolution semigroups of measures.\" In: Pacific Journal of Mathematics 9.1 (1959), pp. 51-67.\n[GM18] Eli Glasner and Michael Megrelishvili. \"More on tame dynamical systems\". In: Ergodic Theory and Dynamical Systems in their Interactions with Arithmetics and Combinatorics: CIRM Jean-Morlet Chair, Fall 2016 (2018), pp. 351-392.\n[GOU13] Dar\u00edo Garc\u00eda, Alf Onshuus, and Alexander Usvyatsov. \"Generic stability, forking, and p-forking\". In: Transactions of the American Mathematical Society 365.1 (2013), pp. 1-22.\n\n[GPP15] Jakub Gismatullin, Davide Penazzi, and Anand Pillay. \"Some model theory of $S L(2, \\mathbb{R})$ \". In: Fundamenta Mathematicae 229.2 (2015), pp. 117-128.\n[HO10] Assaf Hasson and Alf Onshuus. \"Stable types in rosy theories\". In: The Journal of Symbolic Logic 75.4 (2010), pp. 1211-1230.\n[HP11] Ehud Hrushovski and Anand Pillay. \"On NIP and invariant measures\". In: J. Eur. Math. Soc. 13.4 (2011), pp. 1005-1061.\n[HP18] Mike Haskel and Anand Pillay. \"On maximal stable quotients of definable groups in NIP theories\". In: The Journal of Symbolic Logic 83.1 (2018), pp. 117-122.\n[HPP08] Ehud Hrushovski, Ya'acov Peterzil, and Anand Pillay. \"Groups, measures, and the NIP\". In: Journal of the American Mathematical Society 21.2 (2008), pp. 563-596.\n[HPS13] Ehud Hrushovski, Anand Pillay, and Pierre Simon. \"Generically stable and smooth measures in NIP theories\". In: Transactions of the American Mathematical Society 365.5 (2013), pp. 2341-2366.\n[HRK19] Ehud Hrushovski and Silvain Rideau-Kikuchi. \"Valued fields, metastable groups\". In: Selecta Mathematica 25.3 (2019).\n[Hru12] Ehud Hrushovski. \"Stable group theory and approximate subgroups\". In: Journal of the American Mathematical Society 25.1 (2012), pp. 189-243.\n[Hru19] Ehud Hrushovski. Definability patterns and their symmetries. 2019. arXiv: 1911.01129 [math.LO].\n[Hru20] Ehud Hrushovski. Beyond the Lascar Group. 2020. arXiv: 2011. 12009 [math.LO].\n[Hru90] Ehud Hrushovski. \"Unidimensional theories are superstable\". In: Annals of Pure and Applied Logic 50.2 (1990), pp. 117-137.\n[Iba16] Tom\u00e1s Ibarluc\u00eda. \"The dynamical hierarchy for Roelcke precompact Polish groups\". In: Israel Journal of Mathematics 215.2 (2016), pp. 965-1009.\n[Kha22] Karim Khanaki. \"Generic stability and modes of convergence\". In: Preprint, arXiv:2204.03910 (2022).\n[KI40] Yukiyosi Kawada and Kiyosi It\u00f4. \"On the probability distribution on a compact group. I\". In: Proceedings of the PhysicoMathematical Society of Japan. 3rd Series 22.12 (1940), pp. 977998 .\n[KLM22] Krzysztof Krupi\u0144ski, Junguk Lee, and Slavko Moconja. \"Ramsey theory and topological dynamics for first order theories\". In: Trans. Amer. Math. Soc. 375.4 (2022), 2553-2596.\n[KP17] Krzysztof Krupi\u0144ski and Anand Pillay. \"Generalized Bohr compactification and model-theoretic connected components\". In: Math. Proc. Cambridge 163.2 (2017), 219-249.\n\n[KP23] Krzysztof Krupi\u0144ski and Anand Pillay. Generalized locally compact models for approximate groups. 2023. arXiv: 2310.20683 [math.LO].\n[KPR18] Krzysztof Krupi\u0144ski, Anand Pillay, and Tomasz Rzepecki. \"Topological dynamics and the complexity of strong types\". In: Israel J. Math. 228 (2018), pp. 863-932.\n[KR20] Krzysztof Krupi\u0144ski and Tomasz Rzepecki. \"Galois groups as quotients of Polish groups\". In: J. Math. Log. 20.03 (2020), p. 2050018.\n[New09] Ludomir Newelski. \"Topological dynamics of definable group actions\". In: The Journal of Symbolic Logic 74.1 (2009), pp. 5072 .\n[New12] Ludomir Newelski. \"Model theoretic aspects of the Ellis semigroup\". In: Israel Journal of Mathematics 190.1 (2012), pp. 477507 .\n[New91] Ludomir Newelski. \"On type definable subgroups of a stable group\". In: Notre Dame journal of formal logic 32.2 (1991), pp. 173-187.\n[Pil13] Anand Pillay. \"Topological dynamics and definable groups\". In: The Journal of Symbolic Logic 78.2 (2013), pp. 657-666.\n[Pil96] Anand Pillay. Geometric stability theory. 32. Oxford University Press, 1996.\n[Poi01] Bruno Poizat. Stable groups. Vol. 87. American Mathematical Soc., 2001.\n[PT11] Anand Pillay and Predrag Tanovi\u0107. Generic stability, regularity, and quasiminimality. In: Models, logics, and higherdimensional categories. Ed. by Bradd T Hart et al. CRM proceedings \\& lecture notes. Providence, RI: American Mathematical Society, Sept. 2011.\n[Pym62] John Pym. \"Idempotent measures on semigroups\". In: Pacific Journal of Mathematics 12.2 (1962), pp. 685-698.\n[Rud59] Walter Rudin. \"Idempotent measures on Abelian groups\". In: Pacific Journal of Mathematics 9.1 (1959), pp. 195-209.\n[Rze18] Tomasz Rzepecki. Bounded Invariant Equivalence Relations, Ph.D. thesis, Wroclaw. 2018. arXiv: 1810.05113 [math.LO].\n[She09] Saharon Shelah. \"Dependent first order theories, continued\". In: Isr. J. Math. 173 (2009), pp. 1-60.\n[Sim03] Patrick Simonetta. \"An example of a C-minimal group which is not abelian-by-finite\". In: Proceedings of the American Mathematical Society 131.12 (2003), pp. 3913-3917.\n[Sim15] Pierre Simon. A guide to NIP theories. Cambridge University Press, 2015.\n[Sim20] Pierre Simon. \"On Amalgamation in NTP 2 Theories and Generically Simple Generics\". In: Notre Dame Journal of Formal Logic 61.2 (2020).\n\n[Sto23] Atticus Stonestrom. \"On non-abelian dp-minimal groups\". In: Preprint, arXiv:2308.04209 (2023).\n[Wag00] Frank Wagner. Simple Theories. Kluwer, Dordrecht, 2000.\n[Wag24] Frank O Wagner. \"dp-minimal groups\". In: Preprint, arXiv:2403.12111 (2024).\n[Wan22] Paul Z Wang. \"The group configuration theorem for generically stable types\". In: Preprint, arXiv:2209.03081 (2022).\n[Wen54] J. G. Wendel. \"Haar measure and the semigroup of measures on a compact group\". In: Proceedings of the American Mathematical Society 5.6 (1954), pp. 923-929.\n\nArtem Chernikov @https://orCid.org/0000-0002-9136-8737, University of Maryland, College Park and University of California, Los Angeles, USA\n\nEmail address: artem@umd.edu\nKyle Gannon, Beijing International Center for Mathematical Research (BICMR), Peking University, Beijing, China\n\nEmail address: kgannon@bicmr.pku.edu.cn\nKrzysztof Krupi\u0144ski @https://orCID.org/0000-0002-2243-4411, Instytut Matematyczny Uniwersytet Wroclawski, pl. Grunwaldzki 2, 50-384 Wroclaw, Poland\n\nEmail address: Krzysztof.Krupinski@math.uni.wroc.pl",
      "tables": {},
      "images": {}
    }
  ],
  "id": "2406.00912v2",
  "authors": [
    "Artem Chernikov",
    "Kyle Gannon",
    "Krzysztof Krupi\u0144ski"
  ],
  "categories": [
    "math.LO",
    "math.DS",
    "math.GN",
    "math.GR"
  ],
  "abstract": "We study idempotent measures and the structure of the convolution semigroups\nof measures over definable groups. We isolate the property of generic\ntransitivity and demonstrate that it is sufficient (and necessary) to develop\nstable group theory localizing on a generically stable type, including\ninvariant stratified ranks and connected components. We establish generic\ntransitivity of generically stable idempotent types in important new cases,\nincluding abelian groups in arbitrary theories and arbitrary groups in rosy\ntheories, and characterize them as generics of connected type-definable\nsubgroups. Using tools from Keisler's randomization theory, we generalize some\nof these results from types to generically stable Keisler measures, and\nclassify idempotent generically stable measures in abelian groups as (unique)\ntranslation-invariant measures on type-definable fsg subgroups. This provides a\npartial definable counterpart to the classical work of Rudin, Cohen and Pym for\nlocally compact topological groups. Finally, we provide an explicit\nconstruction of a minimal left ideal in the convolution semigroup of measures\nfor an arbitrary countable NIP group, from a minimal left ideal in the\ncorresponding semigroup on types and a canonical measure constructed on its\nideal subgroup. In order to achieve it, we in particular prove the revised\nEllis group conjecture of Newelski for countable NIP groups.",
  "updated": "2025-04-04T21:54:40Z",
  "published": "2024-06-03T00:43:16Z"
}