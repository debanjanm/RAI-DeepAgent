{"title": "Hyperplanes Avoiding Problem and Integer Points Counting in Polyhedra", "sections": [{"section_id": 0, "text": "#### Abstract\n\nIn our work, we consider the problem of computing a vector $x \\in \\mathbb{Z}^{n}$ of minimum $\\|\\cdot\\|_{p}$-norm such that $a^{\\top} x \\neq a_{0}$, for any vector $\\left(a, a_{0}\\right)$ from a given finite set $\\mathcal{A} \\subseteq \\mathbb{Z}^{n}$. In other words, we search for a vector of minimum norm that avoids a given finite set of hyperplanes, which is natural to call as the Hyperplanes Avoiding Problem. This problem naturally appears as a subproblem in Barvinok-type algorithms for counting integer points in polyhedra. More precisely, it appears when one needs to evaluate certain rational generating functions in an avoidable critical point.\n\n\nWe show that:\n\n1. With respect to $\\|\\cdot\\|_{1}$, the problem admits a feasible solution $x$ with $\\|x\\|_{1} \\leq(m+n) / 2$, where $m=|\\mathcal{A}|$, and show that such solution can be constructed by a deterministic polynomial-time algorithm with $O(n \\cdot m)$ operations. Moreover, this inequality is the best possible. This is a significant improvement over the previous randomized algorithm, which computes $x$ with a guaranty $\\|x\\|_{1} \\leq n \\cdot m$. The original approach of A. Barvinok can guarantee only $\\|x\\|_{1}=O\\left((n \\cdot m)^{n}\\right)$. To prove this result, we use a newly established algorithmic variant of the Combinatorial Nullstellensatz;\n2. The problem is $\\mathbb{N}^{4}$-hard with respect to any norm $\\|\\cdot\\|_{p}$, for $p \\in$ $\\left(\\mathbb{R}_{\\geq 1} \\cup\\{\\infty\\}\\right)$;\n3. As an application, we show that the problem to count integer points in a polytope $\\mathcal{P}=\\left\\{x \\in \\mathbb{R}^{n}: A x \\leq b\\right\\}$, for given $A \\in \\mathbb{Z}^{m \\times n}$ and $b \\in \\mathbb{Q}^{m}$, can be solved by an algorithm with $O\\left(\\nu^{2} \\cdot n^{3} \\cdot \\Delta^{5}\\right)$ operations, where $\\nu$ is the maximum size of a normal fan triangulation of $\\mathcal{P}$, and $\\Delta$ is the maximum value of rank-order subdeterminants of $A$. It refines the previous state-of-the-art $O\\left(\\nu^{2} \\cdot n^{4} \\cdot \\Delta^{3}\\right)$-time algorithm. As a further application, it provides a refined complexity bound for the counting problem in polyhedra of bounded codimension. More specifically, it improves the computational complexity bound for counting the number of solutions in the Unbounded Subset-Sum problem.\n\nKeywords: Bounded subdeterminants $\\cdot$ Bounded minors $\\cdot$ Counting integer points $\\cdot$ Combinatorial nullstellensatz $\\cdot$ Covering by subspaces . Covering by hyperplanes", "tables": {}, "images": {}}, {"section_id": 1, "text": "# 1 Introduction \n\nLet $\\mathcal{A} \\subseteq \\mathbb{Z}^{n+1}$ be a set of pairs $\\left(a, a_{0}\\right)$ with $a \\in \\mathbb{Z}^{n} \\backslash\\{\\mathbf{0}\\}$ and $a_{0} \\in \\mathbb{Z}$, and denote $m:=|\\mathcal{A}|<\\infty$. Consider the system\n\n$$\n\\left\\{\\begin{array}{l}\na^{\\top} \\cdot x \\neq a_{0}, \\quad \\forall\\left(a, a_{0}\\right) \\in \\mathcal{A} \\\\\nx \\in \\mathbb{Z}^{n}\n\\end{array}\\right.\n$$\n\n(HyperplanesAvoiding)\n\nThe system (HyperplanesAvoiding) has infinitely many solutions, and it is interesting to find solutions having small norm (we are mainly interested in the $\\left\\|\\cdot\\right\\|_{1}$-norm). The latter motivates the following problem, which is natural to call the Hyperplanes Avoiding Problem:\n\n$$\n\\begin{gathered}\n\\|x\\|_{p} \\rightarrow \\min \\\\\n\\left\\{\\begin{array}{l}\na^{\\top} \\cdot x \\neq a_{0}, \\quad \\forall\\left(a, a_{0}\\right) \\in \\mathcal{A} \\\\\nx \\in \\mathbb{Z}^{n}\n\\end{array}\\right.\n\\end{gathered}\n$$\n\nIn other words, we are just trying to find an integer vector of the smallest norm that does not lie in any of the $m$ given hyperplanes. It is also interesting to consider the Homogeneous forms of the system (HyperplanesAvoiding) and problem ( $p$-HyperplanesAvoiding), when $a_{0}=0$ for any $\\left(a, a_{0}\\right) \\in \\mathcal{A}$. In this case, we are trying to find an integer vector of the smallest norm that does not lie in any of the $m$ given $(n-1)$-dimensional subspaces.", "tables": {}, "images": {}}, {"section_id": 2, "text": "### 1.1 Motivation: The integer Points Counting in Polyhedra\n\nThe problem ( $p$-HyperplanesAvoiding) naturally appears as a subproblem in algorithms for integer points counting in polyhedra. Let us give a brief sketch of how it appears. Consider a rational polytope $\\mathcal{P}$ defined by a system of linear inequalities. The seminal work of A. Barvinok [8] (see also [6,7]) proposes an algorithm to count the number of points inside $\\mathcal{P} \\cap \\mathbb{Z}^{n}$, which is polynomial for a fixed dimension. His approach is based on a representation of $\\mathcal{P} \\cap \\mathbb{Z}^{n}$ via some rational generating function. More precisely, the Barvinok's algorithm computes a set of indices $\\mathcal{I}$, and for each $i \\in \\mathcal{I}$, it computes a number $\\epsilon^{(i)} \\in \\mathbb{Z}$ and vectors $v^{(i)}, u_{1}^{(i)}, \\ldots, u_{n}^{(i)} \\in \\mathbb{Z}^{n}$ such that\n\n$$\n\\sum_{x \\in \\mathcal{P} \\cap \\mathbb{Z}^{n}} z^{x}=f_{\\mathcal{P}}(z):=\\sum_{i \\in \\mathcal{I}} \\epsilon^{(i)} \\cdot \\frac{z^{v^{(i)}}}{\\left(1-z^{u_{1}^{(i)}}\\right) \\cdot \\ldots \\cdot\\left(1-z^{u_{n}^{(i)}}\\right)}\n$$\n\nHere, the notation $z^{x}$ means $z^{x}=z_{1}^{x_{1}} \\cdot \\ldots \\cdot z_{n}^{x_{n}}$. The right-hand-side of (1), i.e. the function $f_{\\mathcal{P}}(z)$, is called the short rational generating function of $\\mathcal{P} \\cap \\mathbb{Z}^{n}$.\n\nSince the left part of (1) is a finite sum, the point $z=\\mathbf{1}$ is an avoidable critical point of $f_{\\mathcal{P}}(z)$. Therefore,\n\n$$\n\\left|\\mathcal{P} \\cap \\mathbb{Z}^{n}\\right|=\\lim _{z \\rightarrow \\mathbf{1}} f_{\\mathcal{P}}(z)\n$$\n\nOne possible approach to find this limit, is to compute a vector $c \\in \\mathbb{Z}^{n}$ such that $c^{\\top} u_{j}^{(i)} \\neq 0$, for any $i \\in \\mathcal{I}$ and $j \\in\\{1, \\ldots, n\\}$. Note that $c$ is a solution of the system (HyperplanesAvoiding) with $\\mathcal{A}=\\left\\{u_{j}^{(i)}\\right\\}$, and $m=|\\mathcal{A}|=(n+1) \\cdot|\\mathcal{I}|$. Using the substitution $z_{i} \\rightarrow e^{\\tau \\cdot c_{i}}$, the function $\\hat{f}_{\\mathcal{P}}(z)$ transforms to the function $\\hat{f}_{\\mathcal{P}}(\\tau)$, depending on the single complex variable $\\tau$, defined by\n\n$$\n\\hat{f}_{\\mathcal{P}}(\\tau)=\\sum_{i \\in \\mathcal{I}} \\epsilon^{(i)} \\cdot \\frac{e^{\\left\\langle c, v^{(i)}\\right\\rangle \\cdot \\tau}}{\\left(1-e^{\\left\\langle c, u_{1}^{(i)}\\right\\rangle \\cdot \\tau}\\right) \\cdot \\ldots \\cdot\\left(1-e^{\\left\\langle c, u_{n}^{(i)}\\right\\rangle \\cdot \\tau}\\right)}\n$$\n\nNow, since $\\hat{f}_{\\mathcal{P}}$ is analytical, the limit (2) just equals to the $\\left[\\tau^{0}\\right]$-term of the Tailor's series for $\\hat{f}_{\\mathcal{P}}(\\tau)$ :\n\n$$\n\\left|\\mathcal{P} \\cap \\mathbb{Z}^{n}\\right|=\\lim _{\\tau \\rightarrow 0} \\hat{f}_{\\mathcal{P}}(\\tau)=\\left[\\tau^{0}\\right] \\hat{f}_{\\mathcal{P}}\n$$\n\nWe note that it is preferable to calculate the vector $c$ satisfying $c^{\\top} u_{j}^{(i)} \\neq 0$ with the smallest possible norm, because it will reduce the size of the numbers $\\left\\langle c, v^{(i)}\\right\\rangle$ and $\\left\\langle c, u_{j}^{(i)}\\right\\rangle$, which in turn will refine the computational complexity and speed up practical computations. However, the norm of $c$ does not affect the computational complexity in terms of the number of operations. It only reduces the variable sizes.\n\nAssume that the polyhedron $\\mathcal{P}$ is defined by a system $A x \\leq b$, for given $A \\in$ $\\mathbb{Z}^{m \\times n}$ and $b \\in \\mathbb{Q}^{m}$, the computational complexity of the Barvinok's algorithm in terms of operations number can be bounded by\n\n$$\n\\nu \\cdot O(\\log \\Delta)^{n \\ln n}\n$$\n\nwhere $\\nu$ is the maximum size of a normal fan triangulation of $\\mathcal{P}$, and $\\Delta$ is the maximum value of the rank-order subdeterminants of $A$.\n\nThus, finding a good solution to (HyperplanesAvoiding) has only effect on the variable sizes of the Barvinok's algorithm. However, there is an alternative algorithmic approach to integer point counting, which allows obtaining complexity bounds of the type poly $(\\nu, n, \\Delta)$. It was developed in a series of works 113|14|11121013 In this alternative approach, the norm of the solution to (HyperplanesAvoiding) is a multiplicative factor in the bound on its computational complexity. More precisely, the following result was obtained in 12.\n\n[^0]\n[^0]:    ${ }^{3}$ For the latest perspective see [12], for the parametric case see [10], the paper [11] is a correction of 14 .\n\nProposition 1 (D. Gribanov, I. Shumilov, D. Malyshev \\& N. Zolotykh [12]). Assume that, for any collection $\\mathcal{A}$ of vectors of size $m$, there exists a solution $x$ of the system (HyperplanesAvoiding) with $\\|x\\|_{1} \\leq L(m, n)$. Assume additionally that such $x$ can be calculated for free. Then the number $\\left|\\mathcal{P} \\cap \\mathbb{Z}^{n}\\right|$ can be calculated with\n\n$$\nO\\left(\\nu \\cdot L(\\nu \\cdot n, n) \\cdot n^{2} \\cdot \\Delta^{3}\\right) \\quad \\text { operations }\n$$\n\nIt was shown in [12] that $L(m, n) \\leq n \\cdot m$, and such $x$ can be constructed by a randomized polynomial-time algorithm with $O(n \\cdot m)$ operations. It means that the counting complexity can be roughly estimated by $O\\left(\\nu^{2} \\cdot n^{4} \\cdot \\Delta^{3}\\right)$. In the current paper, we show that\n\n$$\nL(m, n) \\leq(m+n) / 2\n$$\n\nand such $x$ can be constructed by a deterministic $O(n \\cdot m)$-time algorithm. The latter yields the counting complexity\n\n$$\nO\\left(\\nu^{2} \\cdot n^{3} \\cdot \\Delta^{3}\\right) \\quad \\text { operations }\n$$\n\nwhich is the main application of our results. The parameter $\\nu$ can be estimated in different ways, leading to various applications of the new approach. We present some of these applications and highlight cases where the results of this paper yield improvements.\n\n1. Sparse ILP. Assume that the $\\ell_{1}$-norm of the rows or columns ${ }^{4}$ of $A$ is bounded by $\\gamma$. According to [12], $\\nu=\\gamma^{O(n)}$, which implies that the counting problem can be solved in $\\gamma^{O(n)}$ operations. For instance, when the matrix $A$ has bounded entries and a bounded number of nonzeros per row or column, counting can be performed in $2^{O(n)}$ operations. In the case where only the elements of the matrix are bounded, the complexity of the counting problem becomes $n^{O(n)}$. See [12] for further details.\n2. Counting solutions of ILP problems of bounded codimension. Assume that the polyhedron is defined by the system $A x=b, x \\in \\mathbb{R}_{\\geq 0}^{n}$, where $A \\in \\mathbb{Z}^{k \\times n}, b \\in \\mathbb{Q}^{k}$, and $\\operatorname{rank} A=k$. It is natural to refer to the parameter $k$ as the codimension of $\\mathcal{P}$. Similarly, for polyhedra defined by the systems $A x \\leq b$ with $A \\in \\mathbb{Z}^{m \\times n}$, we can assume that $k=m-n$. Clearly, $\\nu \\leq\\binom{ n}{k}$, which yields a counting algorithm with a computational complexity bound of\n\n$$\nO\\left(\\frac{n}{k}\\right)^{2 k} \\cdot n^{3} \\cdot \\Delta^{3} \\quad \\text { operations }\n$$\n\nwhich improves the previously known bound from [12] by a factor of $n$.\n\n[^0]\n[^0]:    ${ }^{4}$ It is sufficient to bound the $\\ell_{1}$-norm for the columns of $n \\times n$ nondegenerate submatrices of $A$.\n\n3. Counting solutions of the unbounded Subset-Sum problem. From the previous result, it follows that counting the solutions of the unbounded Subset-Sum problem\n\n$$\n\\left\\{\\begin{array}{l}\nw_{1} x_{1}+\\cdots+w_{n} x_{n}=w_{0} \\\\\nx \\in \\mathbb{Z}_{\\geq 0}^{n}\n\\end{array}\\right.\n$$\n\ncan be performed in $O\\left(n^{5} \\cdot w_{\\max }^{3}\\right)$ operations. Here, $w_{i}$ are integers, and $w_{\\max }=\\max _{i \\in\\{1, \\ldots, n\\}} w_{i}$. Note that the complexity bound does not depend on $w_{0}$. Once again, this improves the previously known computational complexity bound by a factor of $n$.\n4. ILP parameterized by the lattice determinant. Denote $\\Delta_{\\text {Lat }}=\\sqrt{\\operatorname{det} A^{+} A}$. In the case where the polyhedron is defined by the system $A x=b, x \\geq 0$, we set $\\Delta_{\\text {Lat }}=\\sqrt{\\operatorname{det} A A^{+}}$.\nThis parameter has received considerable attention in recent works. For instance, Aliev, Celaya et al. [2] showed that the integrality gap is bounded by $\\Delta_{\\text {Lat }}$. In Aliev \\& Henk [3], it was demonstrated that the Frobenius diagonal number can also be estimated using $\\Delta_{\\text {Lat }}$. In Aliev, De Loera et al. [1], the logarithm of $\\Delta_{\\text {Lat }}$ is used to bound the sparsity of an optimal ILP solution. In turn, formula (5) directly yields a counting algorithm with the computational complexity bound\n\n$$\nn^{3} \\cdot \\Delta_{\\mathrm{Lat}}^{O(1)} \\text { operations }\n$$\n\nwhich follows from the trivial inequalities $\\Delta \\leq \\Delta_{\\text {Lat }}$ and $\\nu \\leq \\Delta_{\\text {Lat }}^{2}$. Obtaining a more precise polynomial dependence of computational complexity on $\\Delta_{\\text {Lat }}$ requires a separate study.\n\nAdditionally, we hope that our result can significantly accelerate the evaluation part of the Barvinok-type algorithms. Theoretically, it reduces the size of rational numbers during the evaluation phase from $n \\log (\\nu n)$ to $\\log \\nu$ in comparison to Barvinok's original approach. From a practical point of view, we propose some experimental results showing that the new algorithm constructs solutions of significantly lower norm than random sampling in a cross-polytope, see Section Experimental Evaluation.\n\nFinally, we note that this paper is not considering the dual-type algorithms for counting integer points in polyhedra. A great survey of this approach could be found in the book [15] of J. Lasserre.", "tables": {}, "images": {}}, {"section_id": 3, "text": "# 1.2 Main Results and Related Work \n\nLet us summarize our results below.\n\n1. With respect to $\\|\\cdot\\|_{1}$, the problem ( $p$-HyperplanesAvoiding) admits a feasible solution $x$ with $\\|x\\|_{1} \\leq(m+n) / 2$, where $m=|\\mathcal{A}|$, and we show that such solution can be constructed by a deterministic polynomial-time algorithm with\n\n$O(n \\cdot m)$ operations, see Theorem 4 of Section Approximate Solution via Combinatorial Nullstellensatz. The inequality is the best possible, see the discussion afterward.\nThis is a significant improvement over the previous $O(n \\cdot m)$-time randomized algorithm of [12], which computes $x$ with a guaranty $\\|x\\|_{1} \\leq n \\cdot m$. In contrast, the original approach of A. Barvinok searches $x$ in the form $x=\\left(1, t, t^{2}, \\ldots, t^{n-1}\\right)$. Since, for each $a \\in \\mathcal{A}, a^{\\top} x=\\sum_{i=1}^{n} a_{i} \\cdot t^{i-1}$ is a polynomial of degree at most $n-1$, there exists a suitable $t$ with $t \\leq n \\cdot m$. However, this reasoning can guaranty only $\\|x\\|_{1}=O\\left((n \\cdot m)^{n}\\right)$.\n2. For any $p \\in\\left(\\mathbb{R}_{\\geq 1} \\cup\\{\\infty\\}\\right)$, the problem ( $p$-HyperplanesAvoiding) is $\\mathbb{N}$-hard with respect to any norm $\\|\\cdot\\|_{p}$, even in its homogeneous form. See Theorem 5 of Section Computational Complexity of the Exact Solution;\n3. We show that the problem to calculate the value $\\left|\\mathcal{P} \\cap \\mathbb{Z}^{n}\\right|$ for a polyhedron $\\mathcal{P}$ defined by the system $A x \\leq b$, for agiven $A \\in \\mathbb{Z}^{m \\times n}$ and $b \\in$ $\\mathbb{Q}^{m}$, can be solved with $O\\left(\\nu^{2} \\cdot n^{3} \\cdot \\Delta^{3}\\right)$ operations, where $\\nu$ is the maximum size of a normal fan triangulation of $\\mathcal{P}$, and $\\Delta$ is the maximum value of rank-order subdeterminants of $A$. It refines the $O\\left(\\nu^{2} \\cdot n^{4} \\cdot \\Delta^{3}\\right)$ time algorithm of [12]. As an application, it provides a refined complexity bound for the counting problem in polyhedra of bounded codimension. More specifically, it improves the computational complexity bound for counting the number of solutions in the Unbounded Subset-Sum problem. See Subsection Motivation: The integer Points Counting in Polyhedra, more specifically, see the discussion alongside Proposition 11\n\nIt is easy to see that the guaranty $\\|x\\|_{1} \\leq(m+n) / 2$ on an existing solution $x$ of the system (HyperplanesAvoiding) is the best possible.\n\nProposition 2. There exists a family of systems (HyperplanesAvoiding) such that $\\|x\\|_{1} \\geq(m+n) / 2$ for any solution $x$.\n\nProof. Fix some positive integer $k$. The desired system consists of the constraints $x_{i} \\neq j$, for any $i \\in\\{1, \\ldots, n\\}$ and $j \\in\\{-k, \\ldots, k\\}$. So, the total number of constraints is $m=(2 k+1) \\cdot n$. It is easy to see that $\\left|x_{i}\\right| \\geq k+1$, for any $i \\in\\{1, \\ldots, n\\}$ and any solution $x$ of the system. Therefore, $\\|x\\|_{1} \\geq(k+1) \\cdot n=$ $(m+n) / 2$.\n\nHowever, for the homogeneous form of the system (HyperplanesAvoiding), the asymptotics of the solution quality with respect to the parameter $m$ can be slightly improved. This observation is based on the following result of I. B\u00e1r\u00e1ny, G. Harcos, J. Pach, \\& G. Tardos [5]. Let $\\mathbb{B}_{1}$ be the unit ball with respect to $\\|x\\|_{1}$ and $g(r)$ be a minimal number of subspaces needed to cover all points of the set $r \\cdot \\mathbb{B}_{1} \\cap \\mathbb{Z}^{n}$.\n\nTheorem 1 (I. B\u00e1r\u00e1ny, G. Harcos, J. Pach, \\& G. Tardos [5]). There exist absolute constants $C_{1}$ and $C_{2}$ such that\n\n$$\nC_{1} \\cdot \\frac{1}{n^{2}} \\cdot r^{\\frac{n}{n-1}} \\leq g(r) \\leq C_{2} \\cdot 2^{n} \\cdot r^{\\frac{n}{n-1}}\n$$\n\nNote that the original work [5] contains a more general result concerning arbitrary convex bodies in $\\mathbb{R}^{n}$, albeit with a worse dependence on $n$. The Theorem 1 is a straightforward adaptation of the original proof to the case of $\\mathbb{B}_{1}$.\n\nAs a corollary, it follows that the system (HyperplanesAvoiding) always has a solution with an asymptotics that is slightly better in $m$, but worse in $n$.\n\nCorollary 1. The system (HyperplanesAvoiding) has a solution $x$, such that\n\n$$\n\\|x\\|_{1}=O\\left(n^{2} \\cdot m^{\\frac{n-1}{n}}\\right)\n$$\n\nAt the same time, the theorem implies that solutions of significantly smaller norm do not exist in general. In particular, it implies that our constructive bound $\\|x\\|_{1} \\leq(m+n) / 2$ is almost optimal with respect to $m$ even in the homogeneous case.\n\nCorollary 2. There exists a system (HyperplanesAvoiding) such that, for any solution $x$,\n\n$$\n\\|x\\|_{1}=\\Omega\\left(\\frac{1}{2^{n}} \\cdot m^{\\frac{n-1}{n}}\\right)\n$$", "tables": {}, "images": {}}, {"section_id": 4, "text": "# 2 Approximate Solution via Combinatorial Nullstellensatz \n\nThe existence of a solution $x$ of (HyperplanesAvoiding) of a small norm can be guarantied by the Combinatorial Nullstellensatz due to N. Alon [4].\nTheorem 2 (N. Alon [4]). Let $f(x) \\in \\mathbb{F}\\left[x_{1}, \\ldots, x_{n}\\right]$ be a non-zero polynomial with coefficients in the field $\\mathbb{F}$, and let $x_{1}^{d_{1}} \\ldots x_{n}^{d_{n}}$ be a monomial of $f$ of the largest total degree. For $i \\in\\{1,2, \\ldots, n\\}$, let $S_{i} \\subseteq \\mathbb{F}$ be a set with $|S| \\geq d_{i}+1$. Then, there exists $y \\in S_{1} \\times \\ldots \\times S_{n}$ such that $f(y) \\neq 0$.\n\nProposition 3. The system (HyperplanesAvoiding) has a solution $y$ such that $\\|y\\|_{1} \\leq(m+n) / 2$\n\nProof. Consider a polynomial\n\n$$\nf(x)=\\prod_{\\left(a, a_{0}\\right) \\in \\mathcal{A}}\\left(a^{\\top} x-a_{0}\\right)\n$$\n\nand let $x_{1}^{d_{1}} \\cdot \\ldots \\cdot x_{n}^{d_{n}}$ be its monomial of the highest total degree. Clearly, $x$ is a solution (HyperplanesAvoiding) iff $f(x) \\neq 0$. Define the sets\n\n$$\nS_{i}=\\left\\{-\\left\\lceil d_{i} / 2\\right\\rceil, \\ldots,-1,0,1, \\ldots,\\left\\lceil d_{i} / 2\\right\\rceil\\right\\}, \\quad \\text { for } i \\in\\{1, \\ldots, n\\}\n$$\n\nNote that $\\left|S_{i}\\right| \\geq d_{i}+1$, and, for any $y \\in S_{1} \\times \\ldots \\times S_{n}$,\n\n$$\n\\|y\\|_{1} \\leq\\left\\lceil d_{1} / 2\\right\\rceil+\\ldots+\\left\\lceil d_{n} / 2\\right\\rceil \\leq(m+n) / 2\n$$\n\nThus, Theorem 2 implies the proposition.\n\nUnfortunately, Combinatorial Nullstellensatz is an existence proof, and comes with no efficient algorithm to find the desired vector $y$ (see, e.g., Gnang [9]). To this end, we propose a weaker variant of the Combinatorial Nullstellensatz, which, however, implies the same bound on the $\\ell_{1}$-norm of $y$ in our application and, moreover, allows us to efficiently find such a vector $y$.\n\nTheorem 3. Let $f \\in \\mathbb{Z}\\left[x_{1}, \\ldots, x_{n}\\right], m=\\operatorname{deg}(f)$ and assume that for any tuple $\\left(y_{1}, \\ldots, y_{k}\\right)$ of $k$ integers, we can check if $f\\left(y_{1}, \\ldots, y_{k}, x_{k+1}, \\ldots, x_{n}\\right) \\equiv 0$ using an oracle call.\n\nThen, there exists an algorithm, which computes a point $y \\in \\mathbb{Z}^{n}$ with $\\|y\\|_{1} \\leq$ $(m+n) / 2$ and $f(y) \\neq 0$. The algorithm uses at most $m+2 n$ calls to the oracle. Additionally, the solution $y$ generated by the algorithm is 'lexicographically minimal' in the following sense: $\\left|y_{1}\\right|$ is minimized over all feasible points, $\\left|y_{2}\\right|$ is minimized over all feasible points with $\\left|x_{1}\\right|=\\left|y_{1}\\right|$, and so on.\n\nProof. The algorithm consists of $n$ elementary steps, each of which eliminates one of the variables $x_{i}$. The first step eliminates $x_{1}$, the second step eliminates $x_{2}$, and so on. Consider the first step. Denote $S=\\{-\\lceil m / 2\\rceil, \\ldots,\\lceil m / 2\\rceil\\}$. For each $y_{1} \\in S$, ordered in the increasing order of their absolute values, we check if $f\\left(y_{1}, x_{2}, \\ldots, x_{n}\\right) \\equiv 0$. Take the first value of $y_{1}$ such that this is not satisfied. Note that each new value of $y_{1}$ for which this polynomial is identically 0 , gives a new linear multiple $\\left(x_{1}-y_{1}\\right)$ of $f$. Since $|S|>m$ and the degree of $f$ is $m$, such $y_{1}$ exists. When such $y_{1}$ is found, we make a substitution $\\hat{f}\\left(x_{2}, \\ldots, x_{n}\\right)=$ $f\\left(y_{1}, x_{2}, \\ldots, x_{n}\\right)$. We claim that $\\operatorname{deg}(\\hat{f}) \\leq m-\\left(2\\left|y_{1}\\right|-1\\right)$. Indeed, the inequality is trivial when $y_{1}=0$. If $\\left|y_{1}\\right| \\geq 1$, then $f$ is divisible by\n\n$$\n\\prod_{i=-\\left(\\left|y_{1}\\right|-1\\right)}^{\\left|y_{1}\\right|-1}\\left(x_{1}-i\\right)\n$$\n\nwhich proves the claim.\nThe second step eliminates the variable $x_{2}$ in $\\hat{f}$ using the same scheme. Acting in this manner, we find $y=\\left(y_{1}, \\ldots, y_{n}\\right)^{\\top} \\in S^{n}$ with $f\\left(y_{1}, \\ldots, y_{n}\\right) \\neq 0$, and\n\n$$\n\\sum_{i=1}^{n}\\left(2\\left|y_{i}\\right|-1\\right) \\leq m\n$$\n\nRewriting the last inequality, we get $\\|y\\|_{1} \\leq(m+n) / 2$. In turn, the total number of oracle calls is bounded by $\\sum_{i=1}^{n}\\left(2\\left|y_{i}\\right|+1\\right) \\leq m+2 n$.\n\nWe shall apply Theorem 3 to the polynomial (6). In that case, the whole procedure can be made very efficient.\n\nTheorem 4. There exists an algorithm which computes a solution $y$ of the system (HyperplanesAvoiding) such that the following claims are satisfied:\n\n1. The computational complexity of the algorithm is $O(n \\cdot m)$;\n\n2. $\\|y\\|_{1} \\leq(m+n) / 2$;\n3. The solution $y$ is 'lexicographically minimal' in the sense described in Theorem 3 .\n\nProof. Consider the polynomial (6). Again, $x$ is a solution (HyperplanesAvoiding) iff $f(x) \\neq 0$, and $\\operatorname{deg}(f)=m$. By Theorem 3. the only thing that we need to check is that all oracle calls during a single step of the algorithm shall cost us $O(m)$ operations. Indeed, at each step we shall maintain a list of linear monomials, and change each monomial by substituting the values of $x_{1}, x_{2}$, etc. Checking if each monomial is identically 0 after a given substitution requires $O(1)$ operations, and the polynomial $f$ is not identically 0 iff each of the monomials is not identically 0 .\n\nThe detailed description is given as follows. For any $k \\in\\{1, \\ldots, n\\}$, at the beginning of the $k$-th step, we maintain the polynomial $\\hat{f} \\in \\mathbb{Z}\\left[x_{k}, \\ldots, x_{n}\\right]$ represented by a finite set of integer vectors $\\widehat{\\mathcal{A}} \\subseteq \\mathbb{Z}^{n-k+2}$ such that\n\n$$\n\\hat{f}(x)=\\prod_{\\left(a, a_{0}\\right) \\in \\widehat{\\mathcal{A}}}\\left(a^{\\top} x-a_{0}\\right)\n$$\n\nFor each vector $\\left(a, a_{0}\\right) \\in \\widehat{\\mathcal{A}}$, we store a linked list $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ of non-zero elements of $a$. More precisely, $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ consists of the pairs $\\left(i, a_{i}\\right)$ for each nonzero $a_{i}$, $i \\in\\{k, \\ldots, n\\}$. The pairs inside $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ are stored in the increasing order with respect to the first element of a pair. Initially, at the beginning of the first step, we just assign $\\hat{f} \\leftarrow f$ and $\\widehat{\\mathcal{A}} \\leftarrow \\mathcal{A}$. Clearly, for all $\\left(a, a_{0}\\right) \\in \\widehat{\\mathcal{A}}$, the lists $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ can be initialized with $O(n \\cdot m)$ operations.\n\nWe maintain the following invariant. For each $k \\in\\{1, \\ldots, n\\}$, after the $k$-th step has been completed, the following conditions have to be satisfied:\n\n1. For some integer constant $C$,\n\n$$\nf\\left(y_{1}, \\ldots, y_{k}, x_{k+1}, \\ldots, x_{n}\\right)=C \\cdot \\hat{f}\\left(x_{k}, \\ldots, x_{n}\\right) \\not \\equiv 0\n$$\n\n2. For each $\\left(a, a_{0}\\right) \\in \\widehat{\\mathcal{A}}$, the list $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ is nonempty.\n\nNow, let us describe how the $k$-th step can be performed. Denote $S=$ $\\left\\{-\\lceil m / 2\\rceil, \\ldots,\\lceil m / 2\\rceil\\right\\}$. The step is aimed to find $y_{k} \\in S$ such that $\\hat{f}\\left(y_{k}, x_{k+1}, \\ldots, x_{n}\\right) \\not \\equiv$ 0 , and $\\left|y_{k}\\right|$ is minimized. To this end, we construct an indicator vector $v \\in$ $\\{0,1\\}^{S}$, whose elements are indexed by the elements of $S$, such that $v_{i}=1$ iff $\\hat{f}\\left(i, x_{k+1}, \\ldots, x_{n}\\right) \\equiv 0$. Assuming that $v$ is constructed, we can just set $y_{k} \\leftarrow i$ for $i \\in S$ with $v_{i}=0$ and having a minimum absolute value. Due to the reasoning from the first part of the proof, such $i$ is always existing. Note that such $i$ can be computed with $O(m)$ operations. Let us describe, how to construct the vector $v$. To this end, we search for liner multipliers of $\\hat{f}$ of the form $a_{k} \\cdot x_{k}-a_{0}$. If such multiplier has found, and if $a_{0} / a_{k} \\in S$, then we set $v_{i} \\leftarrow 1$, where $i=a_{0} / a_{k}$. To perform such kind of search, we just need to scan over all elements $\\left(a, a_{0}\\right) \\in \\widehat{\\mathcal{A}}$ with $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ consisting of only a single element $\\left(k, a_{k}\\right)$. Clearly, the latter can be done with $O(\\|\\widehat{\\mathcal{A}}\\|)=O(m)$ operations.\n\nBefore finishing the $k$-th step, we need to maintain the invariant. By other words, we need to perform the substitution of $x_{k} \\leftarrow y_{k}$ inside $\\hat{f}$. To this end, for each $\\left(a, a_{0}\\right) \\in \\widetilde{\\mathcal{A}}$, if the first element of $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ is $\\left(k, a_{k}\\right)$, we set $a_{0} \\leftarrow a_{0}-a_{k} \\cdot y_{k}$ and remove $\\left(k, a_{k}\\right)$ from the list $\\mathcal{L}_{\\left(a, a_{0}\\right)}$. If $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ becomes empty, we remove $\\mathcal{L}_{\\left(a, a_{0}\\right)}$ together with the element $\\left(a, a_{0}\\right)$ of $\\widetilde{\\mathcal{A}}$. Clearly, this work can be done with $O(\\widetilde{\\mathcal{A}}])=O(m)$ operations. Therefore, the algorithm consists of $O(n \\cdot m)$ time preprocessing, and $n$ steps consisting of $O(m)$ operations, which gives the desired complexity bound.", "tables": {}, "images": {}}, {"section_id": 5, "text": "# 3 Computational Complexity of the Exact Solution \n\nLemma 1. For $p=\\infty$, the homogeneous form of the problem ( $p$-HyperplanesAvoiding) is $\\mathrm{N}^{p}$-hard.\n\nProof. Let us reduce the classical $\\mathrm{N}^{p}$-hard Vertex Chromatic Number Problem to our problem. Consider an arbitrary simple graph $G=(V, E)$ on $n$ vertices with $m$ edges. It is not hard to see that the Vertex Chromatic Number Problem with respect to $G$ can be formulated by the following way:\n\n$$\n\\begin{gathered}\n\\|x\\|_{\\infty} \\rightarrow \\min \\\\\n\\left\\{\\begin{array}{l}\n\\forall(u, v) \\in E, \\quad\\left|x_{u}\\right| \\neq\\left|x_{v}\\right| \\\\\nx \\in \\mathbb{Z}^{V}\n\\end{array}\\right.\n\\end{gathered}\n$$\n\nHere, for an optimal solution $x^{*}$ of the problem above, the chromatic number of $G$ is exactly $\\left\\|x^{*}\\right\\|_{\\infty}+1$, and the colors are $\\left\\{0,1, \\ldots,\\left\\|x^{*}\\right\\|_{\\infty}\\right\\}$. A proper coloring of the vertices is given by the vector $\\left|x^{*}\\right|$.\n\nThe formulation (7) can be rewritten as\n\n$$\n\\begin{gathered}\n\\|x\\|_{\\infty} \\rightarrow \\min \\\\\n\\left\\{\\begin{array}{l}\n\\forall(u, v) \\in E, \\quad x_{u}-x_{v} \\neq 0 \\\\\n\\forall(u, v) \\in E, \\quad x_{u}+x_{v} \\neq 0 \\\\\nx \\in \\mathbb{Z}^{V}\n\\end{array}\\right.\n\\end{gathered}\n$$\n\nThis system is an instance of ( $p$-HyperplanesAvoiding) for $p=\\infty$. It proves the $\\mathrm{N}^{p}$-hardness of the latter.\n\nLemma 2. For any $p \\in \\mathbb{R}_{\\geq 1}$, the homogeneous form of the problem ( $p$-HyperplanesAvoiding) is $\\mathrm{N}^{p}$-hard.\n\nProof. We reduce the classical $\\mathrm{N}^{p}$-hard Minimum Vertex Cover Problem to our problem. Consider an arbitrary simple graph $G=(V, E)$ on $n$ vertices and with $m$ edges. We claim that the Minimum Vertex Cover Problem with respect to $G$\n\ncan be formulated as follows.\n\n$$\n\\begin{gathered}\n\\|x\\|_{p}^{p} \\rightarrow \\min \\\\\n\\left\\{\\begin{array}{l}\n\\forall(u, v) \\in E, \\quad x_{u}+x_{v} \\neq 0 \\\\\nx \\in \\mathbb{Z}^{V}\n\\end{array}\\right.\n\\end{gathered}\n$$\n\nIndeed, given an optimal solution $x^{*}$ to this system, construct a new vector $y^{*}$ such that $y_{i}^{*}=0$ iff $x_{i}^{*}=0$ and $y_{i}^{*}=1$ otherwise. First, note that $\\left\\|x^{*}\\right\\|_{p}^{p} \\geq\\left\\|y^{*}\\right\\|_{p}^{p}$ and, second, that $y^{*}$ is also a solution to the system above. Indeed, if $x_{u}^{*}+x_{v}^{*} \\neq 0$, then at least one of $x_{u}, x_{v}$ is not 0 , and thus $y_{u}^{*}+y_{v}^{*} \\geq 1$. It implies that there is an optimal solution $x^{*}$ to the system above with $x_{i}^{*} \\in\\{0,1\\}$ for all $i$. Finally, for $\\{0,1\\}$-solutions it is easy to see that any such solution corresponds to a vertex cover of $G$ and that, moreover, minimizing the $\\ell_{p}$-norm is the same as minimizing the size of the cover. Since the displayed problem is an instance of ( $p$-HyperplanesAvoiding), it proves $\\mathrm{N}^{\\mathrm{p}}$-hardness of the latter.\n\nLemmas 1 and 2 yield\nTheorem 5. For any $p \\in\\left(\\mathbb{R}_{\\geq 1} \\cup\\{\\infty\\}\\right)$, the problem ( $p$-HyperplanesAvoiding) is $\\mathrm{N}^{\\mathrm{p}}$-hard.", "tables": {}, "images": {}}, {"section_id": 6, "text": "# 4 Experimental Evaluation \n\nIn this section, we show some experimental comparison of the algorithm proposed by Theorem 4 with the uniform sampling of integer points inside the cross-polytope $r \\cdot \\mathbb{B}_{1}$, where $r=\\lceil(m+n) / 2\\rceil$. For the experiments, we generate homogeneous systems (HyperplanesAvoiding) with entries in $\\{-10, \\ldots, 10\\}$. The sampling is performed by taking 100 uniform samples inside $r \\cdot \\mathbb{B}_{1} \\cap \\mathbb{Z}^{n}$. Note, that the computational complexity of both approaches is $O(n \\cdot m)$. Tables 1 and 2 show the average norm of the solution found by both algorithms. It is assumed that $n=1000$ is fixed for the first table and $m=2000$ is fixed for the second table, respectively.", "tables": {}, "images": {}}, {"section_id": 7, "text": "## References\n\n1. Aliev, I., De Loera, J.A., Eisenbrand, F., Oertel, T., Weismantel, R.: The support of integer optimal solutions. SIAM Journal on Optimization 28(3), 2152-2157 (2018). https://doi.org/10.1137/17M1162792\n2. Aliev, I., Celaya, M., Henk, M.: Sparsity and integrality gap transference bounds for integer programs. In: International Conference on Integer Programming and Combinatorial Optimization. pp. 1-13. Springer (2024)\n3. Aliev, I., Henk, M.: Feasibility of integer knapsacks. SIAM Journal on Optimization 20(6), 2978-2993 (2010)\n4. Alon, N.: Combinatorial nullstellensatz. Combinatorics, Probability and Computing 8(1-2), 7-29 (1999)\n\n![table_0](table_0)\n\nTable 1: The dimension is fixed $(n=1000)$\n\n![table_1](table_1)\n\nTable 2: The number of hyperplanes is fixed $(m=2000)$\n5. B\u00e1r\u00e1ny, I., Harcos, G., Pach, J., Tardos, G.: Covering lattice points by subspaces. Periodica Mathematica Hungarica 43, 93-103 (2002)\n6. Barvinok, A.: Integer Points in Polyhedra. European Mathematical Society, ETHZentrum, Z\u00fcrich, Switzerland (2008)\n7. Barvinok, A., Pommersheim, J.: An algorithmic theory of lattice points in polyhedra. New Perspect. Algebraic Combin. 38 (1999)\n8. Barvinok, A.: A polynomial time algorithm for counting integral points in polyhedra when the dimension is fixed. In: Proceedings of 1993 IEEE 34th Annual Foundations of Computer Science. pp. 566-572 (1993). https://doi.org/10.1109/SFCS.1993.366830\n9. Gnang, E.K.: Computational aspects of the combinatorial Nullstellensatz method via a polynomial approach to matrix and hypermatrix algebra. Rutgers The State University of New Jersey, School of Graduate Studies (2013)\n10. Gribanov, D., Malyshev, D., Pardalos, P., N, Z.: A new and faster representation for counting integer points in parametric polyhedra. arXiv preprint arXiv:2310.13788 (2024)\n\n11. Gribanov, D., Shumilov, I., Malyshev, D.: A faster algorithm for counting the integer points number in $\\delta$-modular polyhedra (corrected version). arXiv:2110.01732 [cs.CC] (2023)\n12. Gribanov, D., Shumilov, I., Malyshev, D., Zolotykh, N.: Faster algorithms for sparse ilp and hypergraph multi-packing/multi-cover problems. Journal of Global Optimization pp. 1-35 (2024)\n13. Gribanov, D.V., Zolotykh, N.Y.: On lattice point counting in $\\delta$ modular polyhedra. Optimization Letters 16(7), 1991-2018 (2022). https://doi.org/10.1007/s11590-021-01744-x\n14. Gribanov, D., V., Malyshev, D., S.: A faster algorithm for counting the integer points number in $\\delta$-modular polyhedra. Siberian Electronic Mathematical Reports (2022). https://doi.org/10.33048/semi.2022.19.051\n15. Lasserre, J.B.: Linear and integer programming vs linear integration and counting: a duality viewpoint. Springer Science \\& Business Media, New York (2009)", "tables": {"table_0": "| $m$ | Sampling | Our algorithm |\n| :--: | :--: | :--: |\n| 2000 | 1496,8 | 30,4 |\n| 2100 | 1544,4 | 32 |\n| 2200 | 1594,6 | 30,2 |\n| 2300 | 1643,4 | 27,8 |\n| 2400 | 1695 | 31 |\n| 2500 | 1744 | 31,8 |\n| 2600 | 1794 | 35 |\n| 2700 | 1843,8 | 33,6 |\n| 2800 | 1893,6 | 37,4 |\n| 2900 | 1945,8 | 40 |\n| 3000 | 1994 | 34 |", "table_1": "| $n$ | Sampling | Our algorithm |\n| :--: | :--: | :--: |\n| 500 | 1238,6 | 29 |\n| 550 | 1264,5 | 29 |\n| 600 | 1292,6 | 28,6 |\n| 650 | 1316,5 | 26,9 |\n| 700 | 1338,8 | 30,4 |\n| 750 | 1365,5 | 25,7 |\n| 800 | 1391,5 | 25,2 |\n| 850 | 1418,2 | 25 |\n| 900 | 1442,8 | 27,5 |\n| 950 | 1469,7 | 28,2 |\n| 1000 | 1492,9 | 29,3 |"}, "images": {}}], "id": "2411.07030v2", "authors": ["Grigorii Dakhno", "Dmitry Gribanov", "Nikita Kasianov", "Anastasiia Kats", "Andrey Kupavskii", "Nikita Kuz'min"], "categories": ["cs.CC", "cs.CG", "cs.DM", "cs.DS", "math.CO"], "abstract": "In our work, we consider the problem of computing a vector $x \\in Z^n$ of\nminimum $\\|\\cdot\\|_p$-norm such that $a^\\top x \\not= a_0$, for any vector\n$(a,a_0)$ from a given subset of $Z^n$ of size $m$. In other words, we search\nfor a vector of minimum norm that avoids a given finite set of hyperplanes,\nwhich is natural to call as the $\\textit{Hyperplanes Avoiding Problem}$. This\nproblem naturally appears as a subproblem in Barvinok-type algorithms for\ncounting integer points in polyhedra. We show that:\n  1) With respect to $\\|\\cdot\\|_1$, the problem admits a feasible solution $x$\nwith $\\|x\\|_1 \\leq (m+n)/2$, and show that such solution can be constructed by\na deterministic polynomial-time algorithm with $O(n \\cdot m)$ operations.\nMoreover, this inequality is the best possible. This is a significant\nimprovement over the previous randomized algorithm, which computes $x$ with a\nguaranty $\\|x\\|_{1} \\leq n \\cdot m$. The original approach of A.~Barvinok can\nguarantee only $\\|x\\|_1 = O\\bigl((n \\cdot m)^n\\bigr)$. To prove this result, we\nuse a newly established algorithmic variant of the Combinatorial\nNullstellensatz;\n  2) The problem is NP-hard with respect to any norm $\\|\\cdot\\|_p$, for $p \\in\n\\bigl(R_{\\geq 1} \\cup \\{\\infty\\}\\bigr)$.\n  3) As an application, we show that the problem to count integer points in a\npolytope $P = \\{x \\in R^n \\colon A x \\leq b\\}$, for given $A \\in Z^{m \\times\nn}$ and $b \\in Q^m$, can be solved by an algorithm with $O\\bigl(\\nu^2 \\cdot n^3\n\\cdot \\Delta^3 \\bigr)$ operations, where $\\nu$ is the maximum size of a normal\nfan triangulation of $P$, and $\\Delta$ is the maximum value of rank-order\nsubdeterminants of $A$. As a further application, it provides a refined\ncomplexity bound for the counting problem in polyhedra of bounded codimension.\nFor example, in the polyhedra of the Unbounded Subset-Sum problem.", "updated": "2025-02-22T11:19:07Z", "published": "2024-11-11T14:36:31Z"}