{"title": "Semiclassical CEV Option Pricing Model: an Analytical Approach", "sections": [{"section_id": 0, "text": "#### Abstract\n\nThis paper is devoted to obtain closed form solutions for the semiclassical (or WKB) approximation of the heat kernel propagator of the diffusion equation defined by the constant elasticity variance (CEV) option pricing model. One of the key points is that our calculations are based on the Van Vleck-Morette determinant instead of the Van Vleck determinant used by other authors. In fact, we compute this determinant in two different ways: by means of the solution of the classical Hamiltonian equations, and by solving the variational equations. Furthermore, the calculation reveals an exponential factor in the prefactor of the kernel not considered in previous works.", "tables": {}, "images": {}}, {"section_id": 1, "text": "## 1 Introduction: the semiclassical approximation formula\n\nLet be a Hamiltonian system of one degree of freedom defined by the standard Hamiltonian function $H=H(x, p)=T(p)+V(x)$ and a particular classical path $\\gamma$ in configuration space, $x=x(t)$, between the fixed points $x_{1}$ and $x_{2}$, where $t$ stands for time, being $t_{1}$ and $t_{2}$ the initial and final times, respectively. The propagator\n\n$$\nK\\left(x_{2}, t_{2} \\mid x_{1}, t_{1}\\right)\n$$\n\nis the solution of the corresponding Schr\u00f6dinger equation with initial condition $K\\left(x_{2}, t_{1} \\mid x_{1}, t_{1}\\right)=$ $\\delta\\left(x_{2}-x_{1}\\right)$.\n\nTo state the semiclassical approximation for the propagator, we consider the general classical solution around the particular path, by allowing variations around the initial and final positions. We define the Van Vleck-Morette determinant as the Jacobian of the final position with respect to the initial momentum, evaluated at the final time $t_{2}$,\n\n$$\nJ=\\frac{\\partial x_{2}}{\\partial p_{1}}\\left(t_{2}\\right)\n$$\n\nIn fact, as the classical Hamiltonian is autonomous, $J$ depends on the elapsed time $t_{2}-t_{1}$. The function $J$ can be obtained in two ways:\ni) By means of the formula (1.1) above.\n\nii) By means of the solution of the variational equations of the Hamiltonian system around the classical integral curve $x=x(t), p=p(t)$, corresponding to the classical path $x=x(t)$ in configuration space, which is given by the linear system\n\n$$\n\\binom{\\dot{\\xi}}{\\dot{\\eta}}=\\left(\\begin{array}{cc}\n\\frac{\\partial^{2} H}{\\partial x \\partial p}(x(t), p(t)) & \\frac{\\partial^{2} H}{\\partial p^{2}}(x(t), p(t)) \\\\\n-\\frac{\\partial^{2} H}{\\partial x^{2}}(x(t), p(t)) & -\\frac{\\partial^{2} H}{\\partial x \\partial p}(x(t), p(t))\n\\end{array}\\right)\\binom{\\xi}{\\eta}\n$$\n\nHere $\\xi=\\delta x$ and $\\eta=\\delta p$ stand for the variations of position and momentum, respectively. Let $\\xi=\\xi\\left(t_{2}-t_{1}, \\xi_{1}, \\eta_{1}\\right)$ be the solution of the variational equaltion (1.2), given the variation of the momentum at time $t_{2}-t_{1}$ with respect to the initial conditions, $\\xi_{1}=\\xi\\left(t_{1}\\right), \\eta_{1}=\\eta\\left(t_{1}\\right)$. Then $J$ will be the coefficient of $\\eta_{1}$ in $\\xi$, in $\\xi$ as a linear combination of $\\xi_{1}$ and $\\eta_{1}$. It is clear that $J$ is the following element of the fundamental matrix $\\Phi\\left(t_{2}\\right)$ of Eq. (1.2):\n\n$$\n\\Phi\\left(t_{2}\\right)=\\left(\\begin{array}{ll}\n* & J \\\\\n* & *\n\\end{array}\\right)\n$$\n\nwith initial condition the identity matrix\n\n$$\n\\Phi\\left(t_{1}\\right)=\\left(\\begin{array}{ll}\n1 & 0 \\\\\n0 & 1\n\\end{array}\\right)\n$$\n\nIn other words, $J$ is given as the the variation of the position with respect to the momentum at the final time. It gives the same result as (1.1) as a simple consequence of the definition of the variational equations: their solutions represent the linear part of the flow of the Hamiltonian system with respect to the initial conditions. For more details about this connection between the Van Vleck-Morette determinant and the variational equations, see [11].\n\nWe denote by $S(\\gamma)$ the action computed along $\\gamma$. Then the Pauli-Morette semiclassical or WKB formula for the propagator of the Schr\u00f6dinger equation\n\n$$\ni \\hbar \\frac{\\partial}{\\partial t} \\psi=\\hat{H} \\psi\n$$\n\nis\n\n$$\nK_{\\mathrm{WKB}}\\left(x_{2}, t_{2} \\mid x_{1}, t_{1}\\right)=A e^{\\frac{i}{\\hbar} S(\\gamma)}, \\quad A:=\\frac{1}{\\sqrt{2 \\pi i \\hbar J}}\n$$\n\n(see $[15,6]$; the formula was already implicit in Morette's early paper [14]).\nThis formula provides semiclassical quantum fluctuations along the particular path $\\gamma$. Moreover, when the Lagrangian, or corresponding Hamiltonian is quadratic, the semiclassical approximation is exact, and the true propagator coincides with the semiclassical one $\\left(K=K_{W K B}\\right)$. This occurs for the free particle and for the harmonic oscillator cases.\n\nRelated to the simplification that implies using the Van Vleck-Morette determinant (1.1) in (1.5) instead of the Van Vleck determinant,\n\n$$\n\\frac{\\partial^{2} S(\\gamma)}{\\partial x_{1} \\partial x_{2}}\n$$\n\n(they are not the same, but one is the opposite inverse of the other), Cecile DeWitt-Morette said\n\"...It seems nevertheless little known by physicists (myself for example until I rediscover it) who often carry on long calculations instead of using it... \" ([6], p. 371)\n\nOur paper will be essentially an illustration of this remark.\nFor more details about this formula and its connection with differential Galois theory, see [11, 1]. In particular, in [11] it was proved that if the initial classical Hamiltonian system is integrable, then it is possible to obtain $K_{\\text {WKB }}$ in closed form in the framework of differential Galois theory: the essential step in the computation is the Van Vleck-Morette determinant, and it can be done by the variational equations, whose integrability also follows from differential Galois theory. The necessary condition for the integrability of the Hamiltonian system is rigorously justified by a theorem of the third author with Ramis, see reference [13] (and also [12]). In this paper we will only consider one degree of freedom\n\nHamiltonian systems, and, as they are integrable, we can obtain the semiclassical propagator $K_{\\text {WKB }}$ in closed form. Hence, although we shall not make an explicit use of differential Galois theory in this paper, it is behind the closed form computations presented here.\n\nInstead of a Schr\u00f6dinger equation (1.4), we are interested here in a diffusion equation\n\n$$\n\\frac{\\partial}{\\partial \\tau} \\psi=\\hat{H} \\psi, \\hat{H}=\\frac{1}{2} q(x) \\hat{p}^{2}+r(x) \\hat{p}+V(x)\n$$\n\nbeing now the momentum operator\n\n$$\n\\hat{p}=-\\frac{\\partial}{\\partial x}\n$$\n\nand $q(x), r(x)$ and $V(x)$ functions of the position $x$, with $q(x) \\geq 0$. We point out that the semiclassical approximation is valid not only for small $\\hbar$, as in the typical semiclassical problem in quantum mechanics, but also for small times $[7,9]$.\n\nAnother difference with respect to the Hamiltonian considered previously in the Pauli-Morette formula is that the classical Hamitonian,\n\n$$\nH(x, p)=\\frac{1}{2} q(x) p^{2}+r(x) p+V(x)\n$$\n\ncontains terms mixing coordinates and momenta. This fact implies a modification in the PauliMorette formula, by introducing an additional exponential factor in the formula. We remark that if the Hamiltonian has the form $H=T(p)+V(x)$, then it is possible to apply the original Pauli-Morette formula but in the so-called euclidean time.\n\nThe extension of the Pauli-Morette formula to this class of diffusion problems is given in $[10,9]$ and the Pauli-Morette formula becomes\n\n$$\nK_{\\mathrm{WKB}}\\left(x, 0 \\mid x_{T}, T\\right)=A e^{-S(\\gamma)}, \\quad A:=\\frac{1}{\\sqrt{2 \\pi J}} e^{\\frac{i}{2} \\int_{0}^{T} \\frac{u^{2}}{2 \\beta d u}} H(x(\\tau), p(\\tau)) d \\tau\n$$\n\nwith initial condition\n\n$$\nK_{\\mathrm{WKB}}\\left(x, T \\mid x_{T}, T\\right)=\\delta\\left(x-x_{T}\\right)\n$$\n\nbeing $(x(\\tau), p(\\tau))$ the classical integral curve of the Hamiltonian system in phase space with \"initial\" condition $x(0)=x_{T}, p(0)=p(T):=p_{T}$, where $x$ stands for the \"final\" position at time $\\tau=T$, i.e., $x=x\\left(\\tau, x_{T}, p_{T}\\right)$. Then the Van Vleck-Morette determinant is now\n\n$$\nJ=\\frac{\\partial x}{\\partial p_{T}}(\\tau=T)\n$$\n\nand it will be a function of $T$ and $x_{T}, p_{T}$, that we can express in terms of the endpoints in configuration space, namely $x_{T}=x(\\tau=0)$ and $x=x(\\tau=T)$. We remark that\n\n$$\n\\frac{\\partial x}{\\partial p_{T}}(\\tau=0)=0\n$$\n\ni.e., $J=0$ for $T=0$, because it is a non diagonal element of the Jacobian matrix of the flow of the Hamiltonian system\n\n$$\n\\left(x_{T}, p_{T}\\right) \\mapsto\\left(x\\left(\\tau, x_{T}, p_{T}\\right), p\\left(\\tau, x_{T}, p_{T}\\right)\\right)\n$$\n\nthat for $\\tau=0$ is the identity map.\nThe above notation of the initial and final points of the classical paths is motivated by the usual terminology in financial pricing problems: $T>t$ is the maturity time, and $x_{T}$ and $x$ are the starting and final points in configuration space, with respect to the remaining time to maturity, $\\tau=T-t$. Then the classical path connects $x_{T}$ and $x$ as $\\tau$ increases, $0 \\leq \\tau=T-t \\leq T$.\n\nIn this contribution, we will obtain a closed-form expression for the semiclassical approximation of the propagator in diffusion problems of this kind (for diffusion problems, the propagator is also called the heat kernel or simply the kernel). The final expression of the propagator will be given in terms of $T$ and of course $x_{T}$ and $x$.", "tables": {}, "images": {}}, {"section_id": 2, "text": "# 2 Black-Scholes model\n### 2.1 Heat kernel for the Black-Scholes model\n\nAs a preliminary exercise, aimed at showing how the calculation proceeds, we compute the well-known propagator for the Black-Scholes model.\n\nThe s Black-Scholes PDE equation is (see [3])\n\n$$\n\\psi_{r}=\\frac{1}{2} \\sigma^{2} S^{2} \\psi_{S S}+r s \\psi_{S}-r \\psi\n$$\n\nwritten in time $\\tau=T-t, 0 \\leq \\tau \\leq T$, for $\\psi$ the price of an option given as function of the stock price $S$.\n\nUnder the well-known change of variable $e^{x}=S$ (where $x$ refers to the logarithm of the stock price $S)$, we obtain\n\n$$\n\\frac{\\partial \\psi}{\\partial \\tau}=\\left(\\frac{1}{2} \\sigma^{2} \\frac{\\partial^{2}}{\\partial x^{2}}+\\mu \\frac{\\partial}{\\partial x}-r\\right) \\psi=\\hat{H} \\psi, \\mu:=r-\\frac{\\sigma^{2}}{2}\n$$\n\nFor this PDE, we identify the classical Hamiltonian as\n\n$$\nH=\\frac{1}{2} \\sigma^{2} p^{2}-\\mu p-r\n$$\n\nObserve that the Hamitonian is a quadratic function, hence the semiclassical approximation is exact in this case, $K_{\\mathrm{WKB}}=K$.\n\nThe Hamiltonian equations are\n\n$$\n\\dot{x}=\\sigma^{2} p-\\mu, \\dot{p}=0\n$$\n\nfrom which we trivially find\n\n$$\np=\\frac{1}{\\sigma^{2}}(\\dot{x}+\\mu)\n$$\n\nas a first integral, being $\\dot{x}$ also constant, i.e., the motion in $x$ is uniform\n\n$$\nx(\\tau)=C_{1}+C_{2} \\tau\n$$\n\nFrom now on the dot means derivative with respect to $\\tau$.\nThe constant $C_{1}$ does not depend on the initial momentum $p(\\tau=0)=p_{T}$. The dependence of $C_{2}$ with respect to $p_{T}$ is\n\n$$\nC_{2}=\\frac{x-x_{T}}{T}=\\dot{x}=\\sigma^{2} p_{T}-\\mu\n$$\n\nHence, the solution of the Hamilton equations with respect to the initial conditions $\\left(x_{T}, p_{T}\\right)$ is\n\n$$\nx(\\tau)=x_{T}+\\left(\\sigma^{2} p_{T}-\\mu\\right) \\tau, \\quad p=p_{T}, \\quad 0 \\leq \\tau \\leq T\n$$\n\nbeing the corresponding classical path $\\gamma$ the projection of the above phase integral curve onto the configuration space,\n\n$$\nx(\\tau)=x_{T}+\\frac{x-x_{T}}{T} \\tau, \\quad 0 \\leq \\tau \\leq T\n$$\n\nAt this point, we have obtained all the elements to compute the action on $\\gamma$ and the Van Vleck-Morette determinant.\n\nFrom (2.7) we find that the Lagrangian restricted to $\\gamma$ is\n\n$$\nL(x(\\tau))=\\dot{x} p-H=\\frac{1}{2} \\sigma^{2} p^{2}+r=\\frac{1}{2 \\sigma^{2}}\\left(\\frac{x-x_{T}}{T}+\\mu\\right)^{2}+r\n$$\n\nwhich is also a first integral, i.e., it does not depend on $\\tau$. The action reduces to\n\n$$\nS(\\gamma)=\\int_{0}^{T} L(x(\\tau)) d \\tau=L(x(\\tau)) T=\\frac{1}{2 T \\sigma^{2}}\\left(x-x_{T}+\\mu T\\right)^{2}+r T\n$$\n\nand the Van Vleck-Morette determinant\n\n$$\nJ=\\frac{\\partial x}{\\partial p_{T}}(T)=\\sigma^{2} T\n$$\n\nThe propagator of the Black-Scholes model follows from (1.8):\n\n$$\nK=\\frac{1}{\\sqrt{2 \\pi J(T)}} e^{-S(\\gamma)}=\\frac{1}{\\sqrt{2 \\pi \\sigma^{2} T}} e^{-\\frac{1}{2 T \\sigma^{2}}\\left(x_{T}-x-\\mu T\\right)^{2}-r T}\n$$\n\nRecall that, as the classical Hamiltonian system is linear, then the semiclassical approximation of the propagator is exact. Note also that the term\n\n$$\ne^{\\frac{1}{2} \\int_{0}^{T} \\frac{\\rho^{2}}{2 \\rho \\sigma_{T}} H(x(\\tau), p(\\tau)) d \\tau}\n$$\n\nin this example is equal to 1 , so it does not introduce any extra term on the expression because the non-dual dependence in the Hamiltonian of the moments and coordinates holds in this case.", "tables": {}, "images": {}}, {"section_id": 3, "text": "# 2.2 Pricing function of an European call option under the Black-Scholes kernel \n\nThe solution of the Back-Scholes equation (2.2) amounts to apply the propagator to the initial condition of the PDE. For an European call option, the price reduces to\n\n$$\n\\psi(x, 0)=\\frac{e^{-r T}}{\\sqrt{2 \\pi \\sigma^{2} T}} \\int_{-\\infty}^{\\infty} e^{\\frac{-1}{2 \\sigma^{2} T}\\left(x_{T}-x-\\mu T\\right)^{2}} \\psi_{T}\\left(x_{T}\\right) d x_{T}\n$$\n\nwhere, at maturity $(\\tau=T)$, the price of the option has to be $\\psi_{T}\\left(x_{T}\\right)=\\max \\left[e^{x_{T}}-E, 0\\right]$, being $E$ the strike price of the call option. Simple manipulations yield\n\n$$\n\\psi(x, 0)=\\frac{e^{-r T}}{\\sqrt{2 \\pi \\sigma^{2} T}} \\int_{\\ln K}^{\\infty} e^{\\frac{-1}{2 \\sigma^{2} T}\\left(x_{T}-x-\\mu T\\right)^{2}}\\left(e^{x_{T}}-E\\right) d x_{T}\n$$\n\nwhich is equal to the convolution between the propagator and the boundary condition for the underlying:\n\n$$\n\\psi(x, 0)=K * \\psi_{T}\\left(x_{T}\\right)\n$$\n\nAfter de-making variable changes $S=e^{x_{t}}$, doing some simplifications and regrouping in a well known manner to obtain the error function, we get the cumulative distribution function $N(\\cdot)$ of the standard normal distribution. It is left to the reader to follow [3] to obtain the contract function:\n\n$$\n\\psi(S, 0)=S_{0} N\\left(d_{1}\\right)-E e^{-r T} N\\left(d_{2}\\right)\n$$\n\nwhere $d_{1}=\\frac{\\ln \\left(\\frac{\\gamma_{T}}{T}\\right)-\\tau\\left(r+\\sigma^{2}\\right)}{\\sqrt{\\sigma^{2} T}}$ and $d_{2}=d_{1}-\\sigma \\sqrt{T}$, which are basically the two probabilities of the final state at maturity $T$ of the underlying price $S$ with respect to the strike price $E$.", "tables": {}, "images": {}}, {"section_id": 4, "text": "## 3 CEV Model\n### 3.1 The Backward Kolmogorov Equation for the CEV Model\n\nIn 1975, Cox [4] introduced the so called constant elasticity variance (CEV) model, which is defined as follows.\n\nGiven a random process in continuous time, $X_{t}$, defined by the stochastic differential equation\n\n$$\nd X_{t}=\\mu\\left(X_{t}\\right) d t+\\sigma\\left(X_{t}\\right) d W_{t}\n$$\n\nwhere $W_{t}$ stands for a Brownian motion, and $\\mu(x)$ and $\\sigma(x)$ are suitable functions of $x$. Then to (3.1) it is associated a diffusion equation, the so-called backward Kolmogorov equation\n\n$$\n\\frac{\\partial}{\\partial t} \\varphi=\\frac{1}{2} \\sigma^{2}(x) \\frac{\\partial^{2}}{\\partial x^{2}} \\varphi+\\mu(x) \\frac{\\partial}{\\partial x} \\varphi\n$$\n\nwhere $\\varphi(x, t)$ stands for the probability that the random process takes the value $x$ at time $t$. Because we work with the backward Kolmogorov equation In this case, we do not include the discount rate $r$ for the option payoff in the drift term of the stochastic process, as we did before while discussing the Black-Scholes equation, cf. Eq. (2.2). Therefore, when we obtain the option pricing formula after the calculation of the propagator, we have to account for the discount rate by multiplying the result by the factor $e^{-r T}$ (see section 3.3). Observe that this factor naturally arose in the calculation for the BS model (see Eq. (2.10) applied to the initial condition $\\max \\left[S_{T}-E, 0\\right]$ ).\n\nThe CEV model is defined by assuming the following stochastic process for the stock price $S$ :\n\n$$\nd S_{t}=\\mu S_{t} d t+\\sigma S_{t}^{\\alpha+1} d W_{t}\n$$\n\nbeing $\\mu, \\sigma$ and $\\alpha$ constants. Following to [4], we assume that $-1 \\leq \\alpha<0$. In [4] it is used $\\beta=2(\\alpha+1)$, instead $\\alpha$. For $\\alpha=0$, the CEV model becomes the Black-Scholes one. It will be relevant later that $\\alpha<0$.\n\nBy means of a change of variable, the CEV model reduces to one studied by Feller in 1951 [8, 5]. Assuming $\\alpha \\neq 0$, let us define the new random process $X_{t}$ from $S_{t}$ from\n\n$$\nS_{t}^{-2 \\alpha}=\\sigma^{2} \\alpha^{2} X_{t}\n$$\n\nThen the following stochastic differential equation is obtained for $X_{t}$ :\n\n$$\nd X_{t}=\\left(2+\\frac{1}{\\alpha}-2 \\alpha \\mu X_{t}\\right) d t-2 \\sqrt{X_{t}} d W_{t}\n$$\n\nThe associated backward Kolmogorov equation reduces to\n\n$$\n\\frac{\\partial}{\\partial \\tau} \\psi=\\left(2 x \\frac{\\partial^{2}}{\\partial x^{2}}+(a-b x) \\frac{\\partial}{\\partial x}\\right) \\psi, a=2+\\frac{1}{\\alpha}, b=2 \\alpha \\mu\n$$\n\nEquation (3.4) is of the type studied by Feller (see [8]),\n\n$$\n\\frac{\\partial \\psi}{\\partial \\tau}=\\frac{\\partial^{2}}{\\partial x^{2}}(\\beta x \\psi)-\\frac{\\partial}{\\partial x}[(\\gamma+\\delta x) \\psi]\n$$\n\n$\\beta>0, \\gamma$ and $\\delta$ being constant parameters. The reduction of the CEV model to the diffusion equation studied by Feller in [8] was pointed out for the first time by Cox [4].\n\nWe begin with the diffusion PDE given by Eq. (3.4). By means of a Laplace transform in time, it is possible to study the Green function of (3.5) as a confluent hypergeometric function, but we will not follow this approach here. Our objective is to obtain a semiclassical closed-form solution for the heat kernel of (3.4). This problem was studied in [2], but here we simplify the calculations.", "tables": {}, "images": {}}, {"section_id": 5, "text": "# 3.2 Heat kernel for the CEV model \n\nAs with the Black-Scholes model, we start solving the classical Hamiltonian system associated to the diffusion equation (3.4). The classical Hamiltonian is\n\n$$\nH=2 x p^{2}+(b x-a) p\n$$\n\nAs the Hamiltonian is cubic, the semiclassical approximation is not exact.\nThe Hamilton equations are\n\n$$\n\\dot{x}=4 x p+(b x-a), \\quad \\dot{p}=-2 p^{2}-b p\n$$\n\nwith initial conditions\n\n$$\nx(\\tau=0)=x_{T}, \\quad p(\\tau=0)=p_{T}\n$$\n\nbeing $x(\\tau=T)=x$. We recall that the dot means derivative with respect to $\\tau$.\nWe solve the system first for the momentum variable:\n\n$$\np(\\tau)=\\frac{b}{C_{1} e^{b \\tau}-2}\n$$\n\nObserve that, in order to match the initial condition for the momentum, it must hold that\n\n$$\nC_{1}=\\frac{b}{p_{T}}+2\n$$\n\nThen\n\n$$\np(\\tau)=\\frac{b p_{T}}{\\left(b+2 p_{T}\\right) e^{b \\tau}-2 p_{T}}\n$$\n\nNow, by substituting (3.8) in the first equation of (3.7), the equation for the position becomes an elementary linear differential equation with solution\n\n$$\nx(\\tau)=d-4 C_{1} C_{2}+C_{1}^{2} C_{2} e^{b \\tau}+\\left(4 C_{2}-\\frac{2 d}{C_{1}}\\right) e^{-b \\tau}, \\quad d:=\\frac{a}{b}\n$$\n\nwhere we have defined the new parameter $d=a / b$, and $C_{2}$ stands for the second integration constant.\n\n$$\nC_{2}=-\\frac{p_{T}^{2}\\left(\\left(a-x_{T}\\right) b-2 p_{T} x_{T}\\right)}{b^{2}\\left(b+2 p_{T}\\right)}\n$$\n\nWe remark that, by construction, the constants $C_{1}$ and $C_{2}$ are positive, because they are given by suitable exponentials.\n\nBy recasting the constants, it is possible to write (3.11) as\n\n$$\nx(\\tau)=D_{1}+D_{2} e^{b \\tau}+\\frac{D_{1}^{2}-d^{2}}{4 D_{2}} e^{-b \\tau}=\\frac{\\left(D_{1}+2 D_{2} e^{b \\tau}\\right)^{2}-d^{2}}{4 D_{2} e^{b \\tau}}\n$$\n\nbeing\n\n$$\nD_{1}=d-4 C_{1} C_{2}, \\quad D_{2}=C_{1}^{2} C_{2}\n$$\n\nEquivalently,\n\n$$\nC_{1}=\\frac{4 D_{2}}{d-D_{1}}, C_{2}=\\frac{\\left(d-D_{1}\\right)^{2}}{16 D_{2}}\n$$\n\nObserve that Eq. (3.13) coincides with the solution obtained in [2] by means of the Lagrange equations. Hence, the solution of the Hamiltonian system is\n\n$$\nx=\\frac{\\left(D_{1}+2 D_{2} e^{b \\tau}\\right)^{2}-d^{2}}{4 D_{2} e^{b \\tau}}, \\quad p=\\frac{b}{C_{1} e^{b \\tau}-2}=\\frac{b\\left(d-D_{1}\\right)}{4 D_{2} e^{b \\tau}+2 D_{1}-2 d}\n$$\n\nNow, the solution above can be written as a function of the initial conditions $x_{T}=x(\\tau=0)$ and $p_{T}=p(\\tau=0)$ by substituting the constants $D_{1}$ and $D_{2}$ by\n\n$$\nD_{1}=-\\frac{8 x_{T}}{b^{2}} p_{T}^{2}-\\frac{4\\left(x_{T}-d\\right)}{b} p_{T}+d, \\quad D_{2}=\\frac{4 x_{T}}{b^{2}} p_{T}^{2}+\\frac{2\\left(2 x_{T}-d\\right)}{b} p_{T}+x_{T}-d\n$$\n\nSo,\n\n$$\n\\begin{gathered}\nx=\\frac{1}{b^{2}}\\left[d b^{2}+4\\left(d-x_{T}\\right) p_{T} b-8 p_{T}^{2} x_{T}+\\left(2 p_{T}+b\\right)\\left(2 x_{T} p_{T}+x_{T} b-d b\\right) e^{b \\tau}+\\right. \\\\\n\\left.\\left(4 p_{T}^{2} x_{T}-2 p_{T} b d\\right) e^{-b \\tau}\\right]\n\\end{gathered}\n$$\n\nFrom (3.7), the momentum can be also written as a function of the position $x$ and its time derivative $\\dot{x}$ as:\n\n$$\np=\\frac{\\dot{x}+b d-b x}{4 x}\n$$\n\nAt this point, we have all the elements for computing the semiclassical approximation of the propagator.\n\nFirst, we compute the integration constants $D_{1}$ and $D_{2}$ with respect to the initial and final points of the path in configuration space, $x(0)=x_{T}$ and $x(T)=x$. From (3.13) it follows the system of equations\n\n$$\nx_{T}=\\frac{\\left(D_{1}+2 D_{2}\\right)^{2}-d^{2}}{4 D_{2}}, \\quad x=\\frac{\\left(D_{1}+2 D_{2} e^{b T}\\right)^{2}-d^{2}}{4 D_{2} e^{b T}}\n$$\n\nthat solved for the integration constants $D_{1}$ and $D_{2}$ leads to the following expressions in terms of $x$ and $x_{T}$,\n\n$$\n\\begin{gathered}\nD_{1}=\\frac{\\left(\\mathrm{e}^{b T}+1\\right) \\sqrt{d^{2}\\left(\\mathrm{e}^{b T}-1\\right)^{2}+4 x x_{T} \\mathrm{e}^{b T}}-2\\left(x+x_{T}\\right) \\mathrm{e}^{b T}}{\\left(\\mathrm{e}^{b T}-1\\right)^{2}} \\\\\nD_{2}=\\frac{x \\mathrm{e}^{b T}+x_{T}-\\sqrt{d^{2}\\left(\\mathrm{e}^{b T}-1\\right)^{2}+4 x x_{T} \\mathrm{e}^{b T}}}{\\left(\\mathrm{e}^{b T}-1\\right)^{2}}\n\\end{gathered}\n$$\n\nwhich coincide with the expressions obtained in [2].\nNow we have to compute: the action $S(\\gamma)$, the integral\n\n$$\n\\int_{0}^{T} \\frac{\\partial^{2} H}{\\partial x \\partial p}(\\tau) d \\tau\n$$\n\nand the Van Vleck-Morette determinant $J$.\nIn order to compute the action, we first obtain the Lagrangian as a function of time $\\tau$, which turns out to be\n\n$$\nL=2 p^{2} x=\\frac{b^{2}\\left(d-D_{1}\\right)^{2}\\left[\\left(d+D_{1}\\right) e^{-b \\tau}+2 D_{2}\\right]}{8 D_{2}\\left(2 D_{2} e^{b \\tau}+D_{1}-d\\right)}\n$$\n\nThus, the action on the classical path is given by\n\n$$\n\\begin{aligned}\nS(\\gamma)=\\int_{0}^{T} \\frac{b^{2}\\left(d-D_{1}\\right)^{2}\\left[\\left(d+D_{1}\\right) e^{-b \\tau}+2 D_{2}\\right]}{8 D_{2}\\left(2 D_{2} e^{b \\tau}+D_{1}-d\\right)} d \\tau & = \\\\\n{\\left[\\frac{d b}{2} \\log \\left(2 D_{2} e^{b \\tau}+D_{1}-d\\right)+\\frac{b}{8 D_{2}}\\left(d^{2}-D_{1}^{2}\\right) e^{-b \\tau}-\\frac{1}{2} d b^{2} \\tau\\right]_{\\tau=0}^{\\tau=T}}\n\\end{aligned}\n$$\n\nwhich results, after simplifications, in\n\n$$\nS(\\gamma)=\\log \\left[\\left(\\frac{2 D_{2} e^{b T}+D_{1}-d}{2 D_{2}+D_{1}-d}\\right)^{b d / 2}\\right]+\\frac{b}{8 D_{2}}\\left(d^{2}-D_{1}^{2}\\right)\\left(e^{-b T}-1\\right)-\\frac{1}{2} d b^{2} T\n$$\n\nSecondly,\n\n$$\n\\frac{\\partial^{2} H}{\\partial x \\partial p}=4 p+b=-b+\\frac{4 D_{2} b e^{b \\tau}}{2 D_{2} e^{b \\tau}+D_{1}-d}\n$$\n\nIntegrating over time, we find\n\n$$\n\\int_{0}^{T} \\frac{\\partial^{2} H}{\\partial x \\partial p} d \\tau=-b T+2 \\log \\left(\\frac{2 D_{2} e^{b T}+D_{1}-d}{2 D_{2}+D_{1}-d}\\right)\n$$\n\nIt remains to compute the Van Vleck-Morette determinant. From equation (3.13), to compute\n\n$$\nJ=\\frac{\\partial x}{\\partial p_{T}}(T)\n$$\n\nwe have to obtain the derivatives of the constants with respect to the momentum. This calculation yields\n\n$$\n\\begin{aligned}\n& \\frac{\\partial D_{1}}{\\partial p_{T}}(T)=-\\frac{16 x_{T}}{b^{2}} p_{T}+\\frac{4\\left(d-x_{T}\\right)}{b}=\\frac{D_{1}^{2}-4 D_{2}^{2}-d^{2}}{b D_{2}} \\\\\n& \\frac{\\partial D_{2}}{\\partial p_{T}}(T)=\\frac{8 x_{T}}{b^{2}} p_{T}+\\frac{2\\left(2 x_{T}-d\\right)}{b}=\\frac{4 D_{2}+2 D_{1}}{b}\n\\end{aligned}\n$$\n\nas follows from (3.20), (3.21) and (3.16). Hence the Van Vleck-Morette determinant becomes\n\n$$\nJ=\\frac{1}{b D_{2}}\\left[D_{1}^{2}-4 D_{2}^{2}-d^{2}+\\left(4 D_{2}^{2}+2 D_{1} D_{2}\\right) e^{b T}+\\left(d^{2}-2 D_{1} D_{2}-D_{1}^{2}\\right) e^{-b T}\\right]\n$$\n\nAs a second verification, in Appendix A we compute the Van Vleck-Morette determinant (3.25) by means of the variational equation. We observe that for $T=0, J=0$ as it should be. Moreover, from the formula (3.18) it is obtained another expression of $J$ as a function of the initial conditions in phase space\n\n$$\nJ=\\frac{4 d b-4 x_{T} b-16 x_{T} p_{T}+\\left(4 x_{T} b+8 x_{T} p_{T}-2 d b\\right) \\mathrm{e}^{b T}+\\left(8 x_{T} p_{T}-2 d b\\right) \\mathrm{e}^{-b T}}{b^{2}}\n$$\n\nThen as\n\n$$\n\\frac{\\partial J}{\\partial T}(T=0)=4 x_{T}>0\n$$\n\nnecessarily $J(T)>0$, for small enough $T>0$, as also it should be.\nAs a result of this calculation, we can write the semiclassical propagator $K$ in terms of the PauliMorette formula (1.8) with action given by Eq. (3.23), and the prefactor being explicitly determined by Eqs. (3.24) and (3.25):\n\n$$\n\\begin{aligned}\nK_{\\mathrm{WKB}}= & \\frac{e^{-\\frac{1}{2} b T+\\log \\left(\\frac{2 D_{1} e^{b T}+D_{1}-d}{2 D_{2}+D_{1}-d}\\right)}}{\\sqrt{\\frac{2 \\pi}{b D_{2}}\\left[D_{1}^{2}-4 D_{2}^{2}-d^{2}+\\left(4 D_{2}^{2}+2 D_{1} D_{2}\\right) e^{b T}+\\left(d^{2}-2 D_{1} D_{2}-D_{1}^{2}\\right) e^{-b T}\\right]}} \\times \\\\\n& e^{-\\frac{b d}{2} \\log \\left(\\frac{2 D_{1} e^{b T}+D_{1}-d}{2 D_{2}+D_{1}-d}\\right)+\\frac{e}{b D_{2}}\\left(D_{1}^{2}-d^{2}\\right)\\left(e^{-b T}-1\\right)+\\frac{1}{2} d b^{2} T}}\n\\end{aligned}\n$$\n\nAfter some simplifications, we obtain\n\n$$\nK_{\\mathrm{WKB}}=\\frac{\\left(\\frac{2 D_{1} e^{b T}+D_{1}-d}{2 D_{2}+D_{1}-d}\\right)^{1-\\frac{b d}{2}} e^{\\frac{1}{2} b T(d b-1)+\\frac{c}{b D_{2}}\\left(D_{1}^{2}-b^{2}\\right)\\left(e^{-b T}-1\\right)}}{\\sqrt{\\frac{2 \\pi}{b D_{2}}\\left[D_{1}^{2}-4 D_{2}^{2}-d^{2}+\\left(4 D_{2}^{2}+2 D_{1} D_{2}\\right) e^{b T}+\\left(d^{2}-2 D_{1} D_{2}-D_{1}^{2}\\right) e^{-b T}\\right]}}\n$$\n\nwith the constants $D_{1}$ and $D_{2}$ are to be expressed as functions of $x_{T}$ and $x$ (see formulas (3.20) and (3.21), respectively).\n\nThe reader can compare our result for the propagator, c.f. Eq. (3.28), with the one obtained by Araneda et al. in reference [2]. Importantly, the exponential factor\n\n$$\ne^{\\frac{1}{2} \\int_{0}^{T} \\frac{d^{2}}{\\partial p \\sigma s} H(x(\\tau), p(\\tau)) d \\tau}\n$$\n\nwas missing in that reference [2].", "tables": {}, "images": {}}, {"section_id": 6, "text": "# 3.3 Pricing function of an European call option under the CEV Kernel \n\nAt maturity, the pay-off of the resulting option is $\\max \\left[S_{T}-E, 0\\right]$, being $E$ the strike price. The payoff at maturity must be discounted by a constant rate $r$. After the change of variables\n\n$$\nS_{T}^{-2 \\alpha}=\\sigma^{2} \\alpha^{2} X_{T}\n$$\n\nthe payoff at maturity becomes\n\n$$\n\\psi_{T}\\left(x_{T}\\right)=e^{-r T} \\max \\left[\\frac{1}{\\left(\\sigma^{2} \\alpha^{2} x_{T}\\right)^{1 /(2 \\alpha)}}-E, 0\\right]\n$$\n\nThis payoff is only non-negative when\n\n$$\n\\frac{1}{\\left(\\sigma^{2} \\alpha^{2} x_{T}\\right)^{1 /(2 \\alpha)}} \\geq E\n$$\n\nwhich after some elementary algebra reduces to\n\n$$\nx_{T} \\geq \\frac{E^{-2 \\alpha}}{\\sigma^{2} \\alpha^{2}}\n$$\n\nbecause $\\alpha<0$. Therefore, applying the semiclassical approximation for the propagator, we obtain the pricing function\n\n$$\n\\psi(x, 0)=K_{\\text {WKB }} * \\psi_{T}\\left(x_{T}\\right)\n$$\n\nwhich reduces to\n\n$$\n\\psi(x, 0)=e^{-r T} \\int_{\\left(\\sigma \\alpha E^{a}\\right)^{-2}}^{\\infty} K_{\\text {WKB }}\\left(x, 0 \\mid x_{T}, T\\right)\\left(\\left(\\sigma^{2} \\alpha^{2} x_{T}\\right)^{-1 /(2 \\alpha)}-E\\right) d x_{T}\n$$\n\nFinally, as $\\alpha=\\frac{1}{a-2}=\\frac{1}{b d-2}$, then\n\n$$\n\\psi(x, 0)=e^{-r T} \\int_{\\left(\\frac{x-b d}{a}\\right)^{2} E^{\\frac{1}{b-b d}}}^{\\infty} K_{\\mathrm{WKB}}\\left(x, 0 \\mid x_{T}, T\\right)\\left[\\left(\\frac{\\sigma}{2-b d} \\sqrt{x_{T}}\\right)^{2-b d}-E\\right] d x_{T}\n$$\n\nThe contract function $\\psi(x, 0)$ has been written in terms of the parameter combinations that arise in the formula for the semiclassical approximation of the propagator, namely $b$ and $d$.", "tables": {}, "images": {}}, {"section_id": 7, "text": "# Acknowledgements. \n\nJAC acknowledges financial support from grant PRIORITY (PID2021-127202NB-C22), funded by Agencia Estatal de Investigaci\u00f3n (MCIN/AEI/10.13039/501100011033) and \"ERDF. A way of making Europe\". JJMR has been supported by Universidad Polit\u00e9cnica de Madrid research group Modelos Matem\u00e1ticos no lineales.", "tables": {}, "images": {}}, {"section_id": 8, "text": "## A The variational equations for the CEV model\n\nIn this appendix we illustrate the method of computation of the Van Vleck.Morette determinant by means of the solution of the variational equation (1.3). We working in time $\\tau$, i.e., the initial conditions are $\\xi_{0}, \\eta_{0}$, and the final time $\\tau=T$.\n\nThe Hamiltonian is (3.6) and the variational equation (1.2) becomes\n\n$$\n\\left(\\begin{array}{c}\n\\xi \\\\\n\\dot{\\eta}\n\\end{array}\\right)=\\left(\\begin{array}{cc}\n4 p+b & 4 x \\\\\n0 & -4 p-b\n\\end{array}\\right)\\left(\\begin{array}{c}\n\\xi \\\\\n\\eta\n\\end{array}\\right)\n$$\n\nbeing $x=x(\\tau)$ and $p=p(\\tau)$ the classical solution of the Hamiltonian system, (3.11) and (3.8). We remark that now this particular solution of the Hamiltonian system is fixed, i.e., the integration constants $D_{1}$ and $D_{2}$ are fixed.\n\nAs the classical Hamiltonian system is integrable, because it is a 1-degree of freedom, we know by a theorem of the third author with Ramis (see [11] and references therein) that the variational equation must be solved also in closed form, in the sense of the differential Galois theory.\n\nWe start to solve the variation of the momentum\n\n$$\n\\eta(\\tau)=\\frac{A_{1} e^{b \\tau}}{\\left(2 D_{2} e^{b \\tau}+D_{1}-d\\right)^{2}}\n$$\n\nbeing $A_{1}$ the integration constant. With the above equation we can solve the variation of the position by means of variation of constants,\n\n$$\n\\xi(\\tau)=\\frac{1}{2 b D_{2}^{2}}\\left[\\left(2 b A_{2}\\left(d-D_{1}\\right)^{2} D_{2}^{2}-A_{1} D_{1}\\right) e^{-b \\tau}+8 b A_{2} D_{2}^{4} e^{b \\tau}-8 b A_{2}\\left(d-D_{1}\\right) D_{2}^{3}-2 A_{1} D_{2}\\right]\n$$\n\nbeing $A_{2}$ the other integration constant. The equations (A.2) and (A.3) are the solutions of the variational equations, but we need to write them as a function of the initial conditions.\n\nThe integration constants depend on the initial conditions in time $\\tau, \\xi_{0}=\\xi(\\tau=0)$ and $\\eta_{0}=\\eta(\\tau=$ 0 ), as the linear combination\n\n$$\nA_{1}=\\left(2 D_{2}+D_{1}-d\\right)^{2} \\eta_{0} \\quad A_{2}=\\frac{2 D_{2}+D_{1}}{2 b D_{2}^{2}} \\eta_{0}+\\alpha \\xi_{0}\n$$\n\nwhere we will not need the coefficient of $\\xi_{0}$ : only the dependence with respect to $\\eta_{0}$ will be relevant here.\n\nBy substituting the above equations in (A.3), for $\\tau=T$, we obtain the Van Vleck-Morette determinant as the coefficient of $\\eta_{0}$, i.e., $\\xi(T)=J \\eta_{0}+\\cdots$, which turns out to be\n\n$$\nJ=\\frac{1}{b D_{2}}\\left[D_{1}^{2}-4 D_{2}^{2}-d^{2}+\\left(4 D_{2}^{2}+2 D_{1} D_{2}\\right) e^{b T}+\\left(d^{2}-2 D_{1} D_{2}-D_{1}^{2}\\right) e^{-b T}\\right]\n$$\n\nthe same result obtained in Eq. (3.25).", "tables": {}, "images": {}}, {"section_id": 9, "text": "# References \n\n[1] Acosta-Hum\u00e1nez, P., L\u00e1zaro, J.T., Morales-Ruiz, J.J. and Pantazi, C., Semiclassical quantification of some two degree of freedom potentials: A differential Galois approach. Journal of Mathematical Physics (2024) 65(1).\n[2] Araneda, Axel A., and Marcelo J. Villena, Computing the CEV option pricing formula using the semiclassical approximation of path integral. Journal of Computational and Applied Mathematics 388 (2021): 113244.\n[3] Black, Fischer, and Myron Scholes, The pricing of options and corporate liabilities. Journal of political economy 81 (1973) 637-654.\n[4] Cox, John C, The Constant Elasticity of Variance Option Pricing Model. The Journal of Portfolio Management, 23(5) (1996), 15-17.\n[5] Cox, John C., and Stephen A. Ross, The valuation of options for alternative stochastic processes. Journal of financial economics 3.1-2 (1976) 145-166.\n[6] C\u00e9cile DeWitt-Morette. The semiclassical expansion. Annals of Physics, 97(2):367-399, 1976.\n[7] Feynman R.P., Hibbs A. R., Quantum Mechanics and Path Integrals. McGraw-Hill, New York, 1965.\n[8] Feller, W., Two singular diffusion problems. Ann. Math. 54 (1961) 173-182.\n[9] Kolokoltsov, Vassili N. Semiclassical analysis for diffusions and stochastic processes. Springer, 2007.\n[10] Langouche F., Rockaerts D., Tirapegui E., Functional Integration and Semiclassical Expansion. Reidel, Dortrech 1982.\n[11] Morales-Ruiz, J.J., A differential Galois approach to path integrals. Journal of Mathematical Physics,(2020) 61(5).\n[12] Morales-Ruiz, J.J., Differential Galois Theory and Non-integrability of Hamiltonian Systems. Modern Birkh\u00e4user Classics, Reprint 2013 of the 1999 Edition by Birkh\u00e4user, Springer, Basel.\n[13] Morales-Ruiz J.J., Ramis J.-P., Galoisian obstructions to integrability of Hamiltonian systems. Methods and Applications of Analysis 8 (2001) 33-96.\n[14] C\u00e9cile Morette. On the definition and approximation of Feynman's path integrals. Physical Review 81(5):848, 1951.\n[15] Pauli W, Selected topics in field quantization, Pauli Lecures in Physics vol. 6. Dover 2000 (based on lectures given by Pauli at Zurich in 1950-51).", "tables": {}, "images": {}}], "id": "2411.18154v3", "authors": ["Jose A. Capit\u00e1n", "Jose Lope-Alba", "Juan J. Morales-Ruiz"], "categories": ["q-fin.MF"], "abstract": "This paper is devoted to obtain closed form solutions for the semiclassical\n(or WKB) approximation of the heat kernel propagator of the diffusion equation\ndefined by the constant elasticity variance (CEV) option pricing model. One of\nthe key points is that our calculations are based on the Van Vleck-Morette\ndeterminant instead of the Van Vleck determinant used by other authors. In\nfact, we compute this determinant in two different ways: by means of the\nsolution of the classical Hamiltonian equations, and by solving the variational\nequations. Furthermore, the calculation reveals an exponential factor in the\nprefactor of the kernel not considered in previous works.", "updated": "2024-12-30T12:32:33Z", "published": "2024-11-27T09:02:25Z"}