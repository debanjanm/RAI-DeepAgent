{"title": "Optimal partial transport for metric pairs", "sections": [{"section_id": 0, "text": "#### Abstract\n\nIn this article we study Figalli and Gigli's formulation of optimal transport between non-negative Radon measures in the setting of metric pairs. We carry over classical characterisations of optimal plans to this setting and prove that the resulting spaces of measures, $\\mathcal{M}_{p}(X, A)$, are complete, separable and geodesic whenever the underlying space, $X$, is so. We also prove that, for $p>1, \\mathcal{M}_{p}(X, A)$ preserves the property of being non-branching, and for $p=2$ it preserves nonnegative curvature in the Alexandrov sense. Finally, we prove isometric embeddings of generalised spaces of persistence diagrams $\\mathcal{D}_{p}(X, A)$ into the corresponding spaces $\\mathcal{M}_{p}(X, A)$, generalising a result by Divol and Lacombe. As an application of this framework, we show that several known geometric properties of spaces of persistence diagrams follow from those of $\\mathcal{M}_{p}(X, A)$, including the fact that $\\mathcal{D}_{2}(X, A)$ is an Alexandrov space of non-negative curvature whenever $X$ is a proper non-negatively curved Alexandrov space.", "tables": {}, "images": {}}, {"section_id": 1, "text": "## 1. InTRODUCTION\n\nOptimal transport provides a geometric perspective on the study of spaces of probability measures. It can be formulated as the problem of minimising the total cost of transferring a given amount of mass between two given distributions, provided we know the cost of delivering mass between any two locations. Remarkably simple though this framework might seem, it has found applications to several different areas and has become a prominent body of research in the intersection of analysis, geometry, and probability (see the encyclopedic presentation in [33] for a detailed account of the history of this subject).\n\nAn important restriction for classic optimal transport is that it only makes sense for measures with the same total mass, and it is therefore interesting to explore ways to define optimal transport between unbalanced measures. Different approaches have been proposed (see for example [9, 13, 18, $19,22,27]$ and references therein), and very recently, Savar\u00e9 and Sodini, in [31], presented a general formulation that includes previous approaches in the case of finite Radon measures.\n\nIn [19], Figalli and Gigli introduced a notion of optimal transport between non-negative Radon measures defined on bounded domains in Euclidean space, motivated by finding solutions to evolution equations with Dirichlet boundary conditions, in the spirit of Jordan-Kinderlehrer-Otto scheme [24]. The idea here is to use the boundary of the domain as an unlimited supply and storage of mass, such that it can be used to compensate the difference in mass between the given measures, as long as one pays the cost of transporting it to the boundary (see Section 3 for rigorous definitions). For the sake of simplicity, refer to this notion as optimal partial transport, although we acknowledge that this terminology has been used in the past to denote the related work by Figalli [18] (see [12, 23] for further work).\n\nMore recently, in [15], Divol and Lacombe revisited and applied this theory to study spaces of persistence diagrams, which arise in topological data analysis (see [14, 16, 34] for foundational results on this area). They extended definitions in [19] to Radon measures on unbounded domains in $\\mathbb{R}^{n}$ and proved several useful properties of the resulting metric spaces (e.g. completeness, separability,\n\n[^0]\n[^0]:    Date: 13th March 2025.\n    Supported by CONACYT (Mexico) Doctoral Scholarship No. 769708.\n\ncharacterisation of convergence, existence of Fr\u00e9chet means). They also proved that the space of persistence diagrams endowed with the Wasserstein distances can be isometrically embedded into these spaces of measures, by regarding persistence diagrams as discrete measures on a half-plane in $\\mathbb{R}^{2}$. Also based on the framework of optimal partial transport, Bate and Garcia Pulido proved the embeddability of finite atomic measures, endowed with the optimal partial transport metrics, into Hilbert spaces [4].\n\nIn this article, we extend the theory of optimal partial transport to the setting of metric pairs. Namely, we consider ordered pairs $(X, A)$, where $X$ is a proper (i.e. closed and bounded subsets are compact), complete and separable metric space, and $A$ is a closed, non-empty subset of $X$ (cf. $[1,10,11])$, and non-negative Radon measures $\\mu$ on $X \\backslash A$ such that the function $\\operatorname{dist}(\\cdot, A)$ is in $L^{p}(\\mu)$. As a result, we obtain one-parameter families of metric spaces $\\left\\{\\left(\\mathcal{M}_{p}(X, A), \\mathrm{Wb}_{p}\\right)\\right\\}_{p \\in[1, \\infty)}$ associated to each metric pair $(X, A)$. This is a natural extension of Figalli and Gigli's definition, which is recovered when $X=\\bar{\\Omega}$ and $A=\\partial \\Omega$, where $\\Omega$ is a bounded open set in $\\mathbb{R}^{n}$. We also recover Divol and Lacombe's setting when $X=\\left\\{(x, y) \\in \\mathbb{R}^{2}: x \\leq y\\right\\}$ and $A=\\left\\{(x, y) \\in \\mathbb{R}^{2}: x=y\\right\\}$.\nThe structure of the paper is as follows. We start by proving the existence of optimal partial transport plans and the fact that $\\mathrm{Wb}_{p}$ defines a metric on $\\mathcal{M}_{p}(X, A)$ (theorems 3.7 and 3.10), generalising results in $[15,19]$. Along the way, we correct an oversight in the proof of [15, Proposition 3.2] (see discussion in the proof of theorem 3.7). We then prove that the spaces $\\mathcal{M}_{p}(X, A)$, endowed with the optimal partial transport distance $\\mathrm{Wb}_{p}$, are complete, separable and geodesic, provided that $X$ has the same properties (propositions 5.1 and 5.2). Moreover, when $p>1$, we prove that $\\mathcal{M}_{p}(X, A)$ is non-branching (proposition 5.8), and for $p=2$, we prove that $\\mathcal{M}_{2}(X, A)$ is nonnegatively curved in the Alexandrov sense, whenever $X$ is so (theorem 5.9). Finally, in section 6 , we prove that the generalised spaces of persistence diagrams $\\mathcal{D}_{p}(X, A)$ introduced in [10] can be isometrically embedded into $\\mathcal{M}_{p}(X, A)$, generalising [15, Proposition 3.5]. It is important to note that, combined with theorem 5.9, this gives an alternative proof of the fact that $\\mathcal{D}_{2}(X, A)$ is a non-negatively curved Alexandrov space whenever $X$ is proper and non-negatively curved [10, Proposition 7.3] (see also [7] for related results), which in the case $X=\\left\\{(x, y) \\in \\mathbb{R}^{2}: x \\leq y\\right\\}$ and $A=\\left\\{(x, y) \\in \\mathbb{R}^{2}: x=y\\right\\}$ yields the known result, due to Turner, Mileyko, Mukherjee and Harer, that the usual space of persistence diagrams endowed with the $L^{2}$-Wasserstein distance is non-negatively curved [32, Theorem 2.5].\n\nBubenik and Elchesen independently developed a theory of optimal transport for metric pairs in [6]. However, they did not address the metric and topological properties that we examine in this paper, such as completeness, separability, the existence of geodesics, the non-branching property, and non-negative curvature in the Alexandrov sense. Therefore, our results complement theirs.\n\nAdditionally, a few weeks after we completed the first version of this paper, Erbar and Meglioli published [17], where they investigate a variational formulation of evolution equations with constant Dirichlet boundary conditions as gradient flows in the spaces $\\mathcal{M}_{p}(X, A)$, with $X$ being a Euclidean domain and $A$ its boundary. Extending these results to more general metric pairs would be an interesting direction for future research, potentially benefiting from the general framework developed in this paper.\n\nAcknowledgements. I would like to express my gratitude to Fernando Galaz-Garc\u00eda for all his support and advise, as this work is part of my doctoral thesis under his supervision. I would also like to thank Jaime Santos-Rodr\u00edguez, Martin Kerin, Kohei Suzuki, Alp\u00e1r M\u00e9sz\u00e1ros, Amit Einav, Mo Dick Wong, Norbert Peyerimhoff and Mohammad Al Attar for all the valuable comments and fruitful discussions during several sessions of our reading seminar in Durham University, where the contents of this article were first discussed. I am also grateful to Javier Casado, Manuel Mellado Cuerno, and Motiejus Valiunas for their feedback on an earlier version of this manuscript. Finally,\n\nI thank Ana Luc\u00eda Garc\u00eda Pulido and Wilhelm Klingenberg for their careful reading of my PhD thesis, which includes this manuscript. I have been financially supported by CONACYT (Mexico), through the Doctoral Scholarship No. 769708.", "tables": {}, "images": {}}, {"section_id": 2, "text": "# 2. Preliminaries \n\n2.1. Metric geometry. We briefly recall well-known definitions and results about metric spaces, geodesics, and lower curvature bounds in the Alexandrov sense (see [8] for a more detailed discussion).\n\nDefinition 2.1. Let $X$ be a metric space. We denote by $\\mathcal{C}([a, b], X)$ the space of continuous curves $\\xi:[a, b] \\rightarrow X$, endowed with the uniform metric. For any $t \\in[a, b], e_{t}: \\mathcal{C}([a, b], X) \\rightarrow X$ is the evaluation map given by $e_{t}(\\xi)=\\xi_{t}=\\xi(t)$.\n\nA constant speed geodesic, or simply a geodesic, is a continuous curve $\\xi \\in \\mathcal{C}([0,1], X)$ such that\n\n$$\nd\\left(\\xi_{s}, \\xi_{t}\\right)=d\\left(\\xi_{0}, \\xi_{1}\\right)|s-t|\n$$\n\nfor any $s, t \\in[0,1]$. We denote by $\\operatorname{Geo}(X)$ the space of geodesics in $X$, endowed with the uniform metric. We say that $X$ is a geodesic space if for any $x, y \\in X$ there exists $\\xi \\in \\operatorname{Geo}(X)$ such that $\\xi_{0}=x$ and $\\xi_{1}=y$.\n\nIt is known that if $X$ is a complete, separable and geodesic space, then $\\operatorname{Geo}(X)$, endowed with the uniform metric, is complete and separable. Moreover, if $X$ is a proper space then $\\operatorname{Geo}(X)$ is proper as well, by the Arzel\u00e0-Ascoli theorem.\n\nDefinition 2.2. We say that a geodesic space $X$ is non-branching if for any $t \\in(0,1)$ the map $\\left(e_{0}, e_{t}\\right): \\operatorname{Geo}(X) \\rightarrow X \\times X$ is injective.\n\nAlexandrov spaces are synthetic generalisations of Riemannian manifolds with sectional curvature bounded from below. This generalisation comes from the classical Toponogov's comparison theorem in Riemannian geometry (see $[21,28]$ ).\n\nMore precisely, the $n$-dimensional model space with constant sectional curvature $\\kappa$ is given by\n\n$$\n\\mathbb{M}_{\\kappa}^{n}= \\begin{cases}\\mathbb{S}_{\\kappa}^{n}, & \\text { if } \\kappa>0 \\\\ \\mathbb{R}^{n}, & \\text { if } \\kappa=0 \\\\ \\mathbb{H}_{\\kappa}^{n}, & \\text { if } \\kappa<0\\end{cases}\n$$\n\nwhere $\\mathbb{S}_{\\kappa}^{n}$ and $\\mathbb{H}_{\\kappa}^{n}$ are the sphere and the hyperbolic space with their canonical metrics re-scaled by $1 / \\sqrt{|\\kappa|}$. A geodesic triangle $\\triangle p q r$ in $X$ consists of three points $p, q, r \\in X$ and three minimising geodesics $[p q],[q r],[r p]$ between those points. A comparison triangle in $\\mathbb{M}_{\\kappa}^{2}$ for $\\triangle p q r$ is a geodesic triangle $\\widetilde{\\triangle}_{\\kappa} p q r=\\triangle \\widetilde{p q r}$ in $\\mathbb{M}_{\\kappa}^{2}$ such that\n\n$$\nd(\\widetilde{p}, \\widetilde{q})=d(p, q), d(\\widetilde{q}, \\widetilde{r})=d(q, r), d(\\widetilde{r}, \\widetilde{p})=d(r, p)\n$$\n\nDefinition 2.3. We say that $X$ is an Alexandrov space with curvature bounded below by $\\kappa$, and denote it by $\\operatorname{curv}(X) \\geq \\kappa$, if $X$ is complete, geodesic and satisfies the following condition:\n$\\left(\\mathrm{T}_{\\kappa}\\right)$ For any geodesic triangle $\\triangle p q r$, any comparison triangle $\\widetilde{\\triangle}_{\\kappa} p q r$ in $\\mathbb{M}_{\\kappa}^{2}$ and any point $x \\in[q r]$, the corresponding point $\\widetilde{x} \\in[\\widetilde{q r}]$ such that $d(\\widetilde{q}, \\widetilde{x})=d(q, x)$ satisfies\n\n$$\nd(p, x) \\geq d(\\widetilde{p}, \\widetilde{x})\n$$\n\nRemark 2.4. Observe that condition $\\left(\\mathrm{T}_{0}\\right)$ can be formulated as follows: for any geodesic triangle $p, q, r \\in X$, any geodesic $\\xi \\in \\operatorname{Geo}(X)$ with $\\xi_{0}=q$ and $\\xi_{1}=r$,\n\n$$\nd\\left(p, \\xi_{t}\\right)^{2} \\geq(1-t) d(p, q)^{2}+t d(p, r)^{2}-(1-t) t d(q, r)^{2}\n$$\n\nholds for any $t \\in[0,1]$. This is due to the right hand side of the inequality above being the square of $\\left|\\widetilde{p}-\\widetilde{\\xi}_{t}\\right|$ in the comparison triangle $\\widetilde{\\Delta}_{0} p q r$.\n\nRemark 2.5. Condition $\\left(\\mathrm{T}_{\\kappa}\\right)$ is equivalent to the following:\n$\\left(\\mathrm{A}_{\\kappa}\\right)$ For any $p \\in X$ and any $\\xi^{1}, \\xi^{2} \\in \\operatorname{Geo}(X)$ such that $\\xi_{0}^{1}=\\xi_{0}^{2}=p$, the function $(s, t) \\mapsto \\widetilde{\\measuredangle}_{\\kappa} \\xi_{s}^{1} p \\xi_{t}^{2}$ is non-increasing in both $s$ and $t$, where $\\widetilde{\\measuredangle}_{\\kappa} \\xi_{s}^{1} p \\xi_{t}^{2}$ denotes the angle at $\\widetilde{p}$ in the comparison triangle $\\widetilde{\\Delta}_{\\kappa} \\xi_{s}^{1} p \\xi_{t}^{2}$.\nCondition $\\left(\\mathrm{A}_{\\kappa}\\right)$ implies that the angle between $\\xi^{1}, \\xi^{2} \\in \\operatorname{Geo}(X)$ with $\\xi_{0}^{1}=\\xi_{0}^{2}$, given by\n\n$$\n\\measuredangle\\left(\\xi^{1}, \\xi^{2}\\right)=\\lim _{s, t \\rightarrow 0} \\widetilde{\\measuredangle}_{\\kappa} \\xi_{s}^{1} p \\xi_{t}^{2}\n$$\n\nis well-defined. Geodesics that make an angle zero determine an equivalence class called geodesic direction. The set of geodesic directions at a point $p \\in X$ is denoted by $\\Sigma_{p}^{\\prime}$. When equipped with the angle metric $\\measuredangle$, the set $\\Sigma_{p}^{\\prime}$ is a metric space. The completion of $\\left(\\Sigma_{p}^{\\prime}, \\measuredangle\\right)$ is called the space of directions of $X$ at $p$, and is denoted by $\\Sigma_{p}$. Note that in a closed Riemannian manifold the space of directions at any point is isometric to the unit sphere in the tangent space to the manifold at the given point.\n2.2. Optimal transport and measure theory. We now recall definitions and classical results from optimal transport (see $[2,30,33]$ for detailed expositions).\n\nLet $X$ be a metric space and $\\mathcal{P}(X)$ be the set of Borel probability measures on $X$. The support of a Borel measure $\\mu$ on $X$, denoted by $\\operatorname{supp}(\\mu)$, is the smallest closed set $E \\subset X$ such that $\\mu(X \\backslash E)=0$. For any Borel map $T: X \\rightarrow Y$ between metric spaces, the push-forward map $T_{\\#}: \\mathcal{P}(X) \\rightarrow \\mathcal{P}(Y)$ is given by\n\n$$\nT_{\\#} \\mu(E)=\\mu\\left(T^{-1}(E)\\right)\n$$\n\nfor any Borel set $E \\subset Y$.\nLet us recall the following Borel measurable selection principle (see, for example, [3, Theorem 1]).\nTheorem 2.6. Let $X$ and $Y$ be complete and separable metric spaces, and $E$ a closed, $\\sigma$-compact (i.e. $E$ can be covered with countably many compact sets) subset of $X \\times Y$. If $\\pi^{1}: X \\times Y \\rightarrow X$ is the projection onto the first factor, then $\\pi^{1}(E)$ is a Borel set in $X$ and there exists a Borel measurable map $\\phi: \\pi^{1}(E) \\rightarrow Y$ whose graph is contained in $E$.\n\nDefinition 2.7. Given $\\mu, \\nu \\in \\mathcal{P}(X)$, we say that $\\gamma \\in \\mathcal{P}(X \\times X)$ is a transport plan between $\\mu$ and $\\nu$ if $\\pi_{\\#}^{1} \\gamma=\\mu$ and $\\pi_{\\#}^{2} \\gamma=\\nu$, where $\\pi^{1}, \\pi^{2}: X \\times X \\rightarrow X$ are the coordinate maps. The set of transport plans between $\\mu$ and $\\nu$ is denoted by $\\operatorname{Adm}(\\mu, \\nu)$. For any $p \\in[1, \\infty)$, the $L^{p}$-Wasserstein metric between $\\mu, \\nu \\in \\mathcal{P}(X)$ is defined as\n\n$$\n\\mathrm{W}_{p}(\\mu, \\nu)=\\inf _{\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)}\\left(\\int d(x, y)^{p} d \\gamma(x, y)\\right)^{1 / p}\n$$\n\nAny minimiser $\\gamma$ for (2.2) is an optimal plan between $\\mu$ and $\\nu$. The set of optimal plans between $\\mu$ and $\\nu$ is denoted by $\\operatorname{Opt}(\\mu, \\nu)$.\n\nTheorem 2.8. Let $X$ be a complete and separable metric space, and $\\mu, \\nu \\in \\mathcal{P}(X)$ such that\n\n$$\n\\int_{X} d\\left(x, x_{0}\\right)^{p} d \\mu(x), \\int_{X} d\\left(y, x_{0}\\right)^{p} d \\nu(y)<\\infty\n$$\n\nfor some (and therefore any) $x_{0} \\in X$. Then $\\operatorname{Opt}(\\mu, \\nu) \\neq \\varnothing$. Moreover, $\\mathrm{W}_{p}$ defines a metric in $\\mathcal{P}_{p}(X)$, the set of measures in $\\mathcal{P}(X)$ satisfying (2.3).\n\nThe following result, commonly known in the optimal transport jargon as the gluing lemma, plays a role in the proof of theorem 2.8 , and will be useful later on.\n\nTheorem 2.9. Let $\\mu^{1}, \\mu^{2}, \\mu^{3} \\in \\mathcal{P}(X), \\gamma^{12} \\in \\operatorname{Adm}\\left(\\mu^{1}, \\mu^{2}\\right)$, and $\\gamma^{23} \\in \\operatorname{Adm}\\left(\\mu^{2}, \\mu^{3}\\right)$. Then there exists $\\gamma^{123} \\in \\mathcal{P}(X \\times X \\times X)$ such that\n\n$$\n\\begin{aligned}\n& \\pi_{\\#}^{12} \\gamma^{123}=\\gamma^{12} \\\\\n& \\pi_{\\#}^{23} \\gamma^{123}=\\gamma^{23}\n\\end{aligned}\n$$\n\nMore generally, if $\\Gamma^{1} \\in \\mathcal{P}\\left(\\mathcal{X}^{1}\\right), \\Gamma^{2} \\in \\mathcal{P}\\left(\\mathcal{X}^{2}\\right)$, and $F^{i}: \\mathcal{X}^{i} \\rightarrow \\mathcal{X}, i=1,2$, are measurable maps such that $F_{\\#}^{1} \\Gamma^{1}=F_{\\#}^{2} \\Gamma^{2}$, then there exists\n\n$$\n\\hat{\\Gamma} \\in \\mathcal{P}\\left(\\left\\{\\left(x_{1}, x_{2}\\right) \\in \\mathcal{X}^{1} \\times \\mathcal{X}^{2}: F^{1}\\left(x_{1}\\right)=F^{2}\\left(x_{2}\\right)\\right\\}\\right)\n$$\n\nsuch that $\\pi_{\\#}^{i} \\hat{\\Gamma}=\\Gamma^{i}, i=1,2$.\nIt is also possible to characterise optimal plans in terms of cyclical monotonicity and the existence of Kantorovich potentials.\n\nDefinition 2.10. We say that a set $\\Gamma \\subset X \\times X$ is $c$-cyclically monotone if, for any $n \\in \\mathbb{N}$, any $\\left\\{\\left(x_{i}, y_{i}\\right)\\right\\}_{i=1}^{n} \\subset \\Gamma$ and any permutation $\\sigma$ of $\\{1, \\ldots, n\\}$,\n\n$$\n\\sum_{i=1}^{n} d\\left(x_{i}, y_{i}\\right)^{p} \\leq \\sum_{i=1}^{n} d\\left(x_{i}, y_{\\sigma(i)}\\right)^{p}\n$$\n\nholds. The $c$-transform of a function $\\phi: X \\rightarrow \\mathbb{R} \\cup\\{-\\infty\\}$ is given by\n\n$$\n\\phi^{c}(y)=\\inf _{x \\in X}\\left\\{d(x, y)^{p}-\\phi(x)\\right\\}\n$$\n\nWe say that a function $\\phi: X \\rightarrow \\mathbb{R} \\cup\\{-\\infty\\}$ is $c$-concave if there exists a function $\\psi: X \\rightarrow \\mathbb{R} \\cup\\{-\\infty\\}$ such that $\\phi(x)=\\psi^{c}(x)$.\n\nThe $c$-superdifferential of a $c$-concave function $\\phi$ is the set\n\n$$\n\\partial_{+}^{c} \\phi=\\left\\{(x, y) \\in X \\times X: c(x, y)=\\phi(x)+\\phi^{c}(y)\\right\\}\n$$\n\nTheorem 2.11. Let $X$ be a complete and separable metric space, $\\mu, \\nu \\in \\mathcal{P}_{p}(X)$, and $\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)$. Then the following conditions are equivalent:\n(1) $\\gamma \\in \\operatorname{Opt}(\\mu, \\nu)$;\n(2) $\\operatorname{supp}(\\gamma)$ is c-cyclically monotone;\n(3) There is a c-concave function $\\phi$ (known as a Kantorovich potential of $\\gamma$ ) with $\\max \\{0, \\phi\\} \\in$ $L^{1}(\\mu)$ and $\\operatorname{supp}(\\gamma) \\subset \\partial_{c}^{+} \\phi$.\n\nWe will consider a couple of different notions of convergence of measures.\n\nDefinition 2.12. A sequence $\\{\\mu\\}_{n \\in \\mathbb{N}}$ of bounded Borel measures on $X$ is weakly convergent to $\\mu$, and we write $\\mu_{n} \\xrightarrow{w} \\mu$, if\n\n$$\n\\int_{X} f d \\mu_{n} \\rightarrow \\int_{X} f d \\mu \\quad \\text { for any } f \\in \\mathcal{C}_{b}(X)\n$$\n\nwhere $\\mathcal{C}_{b}(X)$ is the set of continuous and bounded functions on $X$.\nLemma 2.13 below is a particular case of the classical Prokhorov's theorem (see [26, Theorem 4.2]).\nLemma 2.13. Let $\\mathcal{F}$ be a set of non-negative Borel measures with finite mass (i.e. $\\mu_{n}(X)<\\infty$ for all $n \\in \\mathbb{N}$ ) on a complete and separable metric space $X$. Then $\\mathcal{F}$ is weakly precompact (i.e. every sequence in $\\mathcal{F}$ has a weakly convergent subsequence) if and only if the following conditions hold:\n(1) $\\mathcal{F}$ has uniformly bounded total variation, i.e. $\\sup _{\\mu \\in \\mathcal{F}} \\mu(X)<\\infty$,\n(2) $\\mathcal{F}$ is tight, i.e. for any $\\varepsilon>0$ there exist a compact set $K \\subset X$ such that $\\sup _{\\mu \\in \\mathcal{F}} \\mu(X \\backslash K)<\\varepsilon$.\n\nAn even weaker notion of convergence is that of vague convergence of Radon measures.\nDefinition 2.14. A Radon measure $\\mu$ on $X$ is a Borel measure that is both finite on compact sets (i.e. $\\mu(K)<\\infty$ for any compact set $K \\subset X$ ) and inner regular (i.e. for any Borel measurable set $E \\subset X, \\mu(E)$ can be approximated from below by the measures of compact sets $K \\subset E$ ). We denote by $\\mathcal{M}(X)$ the set of Radon measures on $X$.\n\nRemark 2.15. If $X$ is a separable and locally compact metric space, any Borel measure on $X$ that is finite on compact sets is also inner regular (see, for example, [20, Theorem 7.8]). Since we only consider proper metric spaces (which, in particular, are separable and locally compact), we will only need to verify finiteness on compact sets in order to prove that a Borel measure is Radon.\n\nDefinition 2.16. A sequence $\\left\\{\\mu_{n}\\right\\}_{n \\in \\mathbb{N}}$ of Radon measures on $X$ is vaguely convergent to $\\mu$, and we write $\\mu_{n} \\stackrel{\\mathrm{c}}{\\rightarrow} \\mu$, if\n\n$$\n\\int_{X} f d \\mu_{n} \\rightarrow \\int_{X} f d \\mu \\quad \\text { for any } f \\in \\mathcal{C}_{c}(X)\n$$\n\nwhere $\\mathcal{C}_{c}(X)$ is the set of compactly supported continuous functions on $X$.\n\nLemmas 2.17 and 2.18 below are adaptations of known results about the vague topology in the setting of separable, locally compact metric spaces (see [25, Section 15.7] for details). In particular, these results are applicable to proper metric spaces.\n\nLemma 2.17. Let $X$ be a separable, locally compact metric space, and let $\\mathcal{F} \\subset \\mathcal{M}(X)$. Then $\\mathcal{F}$ is vaguely relatively compact if and only if\n\n$$\n\\sup \\{\\gamma(K): \\gamma \\in \\mathcal{F}\\}<\\infty\n$$\n\nfor any compact $K \\subset X$.\nLemma 2.18. Let $X$ be a separable, locally compact metric space, and let $\\left\\{\\gamma_{n}\\right\\}_{n \\in \\mathbb{N}} \\subset \\mathcal{M}(X)$. Then the following are equivalent:\n(1) $\\gamma_{n} \\xrightarrow{\\mathrm{c}} \\gamma$ for some $\\gamma \\in \\mathcal{M}(X)$.\n\n(2) For any bounded open $U \\subset X$ and any bounded closed $F \\subset X$,\n\n$$\n\\gamma(U) \\leq \\liminf _{n \\rightarrow \\infty} \\gamma_{n}(U)\n$$\n\nand\n\n$$\n\\gamma(F) \\geq \\limsup _{n \\rightarrow \\infty} \\gamma_{n}(F)\n$$", "tables": {}, "images": {}}, {"section_id": 3, "text": "# 3. OPTIMAL PARTIAL TRANSPORT FOR METRIC PAIRS \n\nA metric pair is an ordered pair $(X, A)$ where $X$ is a metric space and $A \\subseteq X$ is closed and non-empty. Moreover, we will assume throughout the article that $X$ is complete, separable and proper.\n\nWe denote by $\\mathcal{M}(X)$ the set of non-negative Radon measures on $X$, i.e. inner regular Borel measures that are finite on compact sets, and endow it with the vague topology. Then, given a metric pair $(X, A)$ and $p \\in[1, \\infty)$, we define\n\n$$\n\\mathcal{M}_{p}(X, A)=\\left\\{\\mu \\in \\mathcal{M}(\\Omega): \\int_{\\Omega} d(x, A)^{p} d \\mu(x)<\\infty\\right\\}\n$$\n\nwhere $\\Omega=X \\backslash A$, and for any $\\mu, \\nu \\in \\mathcal{M}_{p}(X, A)$, we define the $L^{p}$-optimal partial transport metric by\n\n$$\n\\mathrm{Wb}_{p}(\\mu, \\nu)=\\inf _{\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)}\\left(\\int_{E_{\\Omega}} d(x, y)^{p} d \\gamma(x, y)\\right)^{1 / p}\n$$\n\nwhere $\\operatorname{Adm}(\\mu, \\nu)$ is the set of non-negative Borel measures $\\gamma$ on $E_{\\Omega}=X \\times X \\backslash A \\times A$ whose marginals restricted to $\\Omega$ are $\\mu$ and $\\nu$, i.e. the following equations hold\n\n$$\n\\left.\\pi_{\\#}^{1} \\gamma\\right|_{\\Omega}=\\mu, \\quad\\left.\\pi_{\\#}^{2} \\gamma\\right|_{\\Omega}=\\nu\n$$\n\nRemark 3.1. Observe that condition (3.2) implies that $\\gamma \\in \\mathcal{M}\\left(E_{\\Omega}\\right)$. Indeed, for any compact $K \\subset E_{\\Omega}$ there are compact sets $K^{\\prime}, K^{\\prime \\prime} \\subset \\Omega$ such that $K \\subset K^{\\prime} \\times X \\cup X \\times K^{\\prime \\prime}$, therefore\n\n$$\n\\gamma(K) \\leq \\gamma\\left(K^{\\prime} \\times X\\right)+\\gamma\\left(X \\times K^{\\prime \\prime}\\right)=\\mu\\left(K^{\\prime}\\right)+\\nu\\left(K^{\\prime \\prime}\\right)<\\infty\n$$\n\nsince $\\mu, \\nu \\in \\mathcal{M}(\\Omega)$. Moreover, since $E_{\\Omega}$ is an open subset of the separable and locally compact metric space $X \\times X$, it is separable and locally compact itself, and the claim follows from Remark 2.15. Furthermore, it follows that $\\operatorname{Adm}(\\mu, \\nu)$ is a vaguely relatively compact subset of $\\mathcal{M}\\left(E_{\\Omega}\\right)$, by lemma 2.17 .\n\nRemark 3.2. Given $\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)$, we define\n\n$$\nC(\\gamma)=\\int_{E_{\\Omega}} d(x, y)^{p} d \\gamma(x, y)\n$$\n\nand denote $\\gamma_{R}^{S}=\\left.\\gamma\\right|_{R \\times S}$, for any $R, S \\subset X$ such that $R \\times S \\subset E_{\\Omega}$. In particular,\n\n$$\n\\gamma=\\gamma_{\\Omega}^{\\Omega}+\\gamma_{\\Omega}^{A}+\\gamma_{A}^{\\Omega}\n$$\n\nRemark 3.3. Regarding the terminology of partial transport plans, it comes from the fact that, whenever $\\gamma$ satisfies (3.2), the measure $\\gamma_{\\Omega}^{\\Omega}$ can be regarded as a classical transport plan between the measures $\\widetilde{\\mu}=\\pi_{\\#}^{1}\\left(\\gamma_{\\Omega}^{\\Omega}\\right)$ and $\\widetilde{\\nu}=\\pi_{\\#}^{1}\\left(\\gamma_{\\Omega}^{\\Omega}\\right)$, which satisfy that $\\widetilde{\\mu} \\leq \\mu$ and $\\widetilde{\\nu} \\leq \\nu$, therefore partially transporting mass between $\\mu$ and $\\nu$.\n\nAs a consequence of the Borel measurable selection principle (theorem 2.6), we obtain the following lemma, which will be useful in the sequel.\n\nLemma 3.4. Let $(X, A)$ be a metric pair. Then there exists a Borel measurable map $\\operatorname{proj}_{A}: X \\rightarrow A$ such that $d\\left(x, \\operatorname{proj}_{A}(x)\\right)=d(x, A)$ for all $x \\in X$.\n\nProof. Since $A$ is closed and $X$ is complete and separable, it follows that $A$ is complete and separable endowed with the restricted metric. Moreover, since $X$ is proper and $d$ is continuous, the set\n\n$$\nE=\\{(x, y) \\in X \\times A: d(x, y)=d(x, A)\\}\n$$\n\nis $\\sigma$-compact, closed, and $\\pi^{1}(E)=X$. Therefore, by theorem 2.6, the claim follows.\nRemark 3.5. Observe that $\\mathrm{Wb}_{p}(\\mu, \\nu)$ is well-defined, non-negative, and finite. Indeed, let $\\mu, \\nu \\in$ $\\mathcal{M}_{p}(X, A)$. Then a straightforward computation shows that the measure\n\n$$\n\\gamma=\\left(\\mathrm{id}, \\operatorname{proj}_{A}\\right)_{\\#} \\mu+\\left(\\operatorname{proj}_{A}, \\mathrm{id}\\right)_{\\#} \\nu\n$$\n\nis in $\\operatorname{Adm}(\\mu, \\nu)$, and it satisfies\n\n$$\n0 \\leq C(\\gamma)=\\int_{\\Omega} d(x, A)^{p} d \\mu(x)+\\int_{\\Omega} d(y, A)^{p} d \\nu(y)<\\infty\n$$\n\nFurthermore, the zero measure belongs to $\\mathcal{M}_{p}(X, A)$, and due to lemma 3.4, for any $\\mu \\in \\mathcal{M}_{p}(X, A)$ we have\n\n$$\n\\mathrm{Wb}_{p}^{p}(\\mu, 0)=\\int_{X} d(x, A)^{p} d \\mu(x)\n$$\n\nIndeed, the partial transport plan $\\gamma=\\left(\\mathrm{id}, \\operatorname{proj}_{A}\\right)_{\\#} \\mu \\in \\operatorname{Adm}(\\mu, 0)$ satisfies\n\n$$\nC(\\gamma)=\\int_{\\Omega} d\\left(x, \\operatorname{proj}_{A}(x)\\right)^{p} d \\mu(x)=\\int_{\\Omega} d(x, A)^{p} d \\mu(x)\n$$\n\nOn the other hand, for any $\\widetilde{\\gamma} \\in \\operatorname{Adm}(\\mu, 0)$ we have that $\\left.\\pi_{\\#}^{2} \\widetilde{\\gamma}\\right|_{\\Omega}=0$, which implies that $\\widetilde{\\gamma}(X \\times \\Omega)=0$. Therefore we have\n\n$$\n\\begin{aligned}\nC(\\widetilde{\\gamma}) & =\\int_{E_{\\Omega}} d(x, y)^{p} d \\widetilde{\\gamma}(x, y) \\\\\n& =\\int_{\\Omega \\times A} d(x, y)^{p} d \\widetilde{\\gamma}(x, y) \\\\\n& \\geq \\int_{\\Omega \\times A} d(x, A)^{p} d \\widetilde{\\gamma}(x, y) \\\\\n& =\\int_{\\Omega} d(x, A)^{p} d \\mu(x)\n\\end{aligned}\n$$\n\nThis proves equation (3.3).\nThe following lemma is a natural generalisation of the well-known gluing lemma for probability measures.\n\nLemma 3.6. Let $\\mu^{1}, \\mu^{2}, \\mu^{3} \\in \\mathcal{M}_{p}(X, A), \\gamma^{12} \\in \\operatorname{Adm}\\left(\\mu^{1}, \\mu^{2}\\right)$, and $\\gamma^{23} \\in \\operatorname{Adm}\\left(\\mu^{2}, \\mu^{3}\\right)$. Then there exists a Borel measure $\\gamma^{123}$ on $X \\times X \\times X$ such that\n\n$$\n\\begin{aligned}\n& \\pi_{\\#}^{12} \\gamma^{123}=\\gamma^{12}+\\sigma^{12} \\\\\n& \\pi_{\\#}^{23} \\gamma^{123}=\\gamma^{23}+\\sigma^{23}\n\\end{aligned}\n$$\n\nwhere $\\sigma^{12}$ and $\\sigma^{23}$ are Borel measures supported on $\\Delta(A \\times A)$.\n\nProof. From the hypothesis, we can see that\n\n$$\n\\mu^{2}=\\left.\\pi_{\\#}^{2} \\gamma^{12}\\right|_{\\Omega}=\\left.\\pi_{\\#}^{2}\\left(\\left(\\gamma^{12}\\right)_{X}^{\\Omega}+\\left(\\gamma^{12}\\right)_{\\Omega}^{A}\\right)\\right|_{\\Omega}=\\pi_{\\#}^{2}\\left(\\gamma^{12}\\right)_{X}^{\\Omega}\n$$\n\nAnalogously, $\\mu^{2}=\\pi_{\\#}^{1}\\left(\\gamma^{23}\\right)_{\\Omega}^{X}$. Therefore, by applying the classical gluing lemma, since $\\mu^{2}$ is a Radon measure, we can find a measure $\\widetilde{\\gamma}^{123}$ on $X \\times \\Omega \\times X$ such that\n\n$$\n\\begin{aligned}\n& \\pi_{\\#}^{12} \\tilde{\\gamma}^{123}=\\left(\\gamma^{12}\\right)_{X}^{\\Omega} \\\\\n& \\pi_{\\#}^{23} \\tilde{\\gamma}^{123}=\\left(\\gamma^{23}\\right)_{\\Omega}^{X}\n\\end{aligned}\n$$\n\nWe define\n\n$$\n\\begin{aligned}\n\\tilde{\\sigma}^{12} & =\\left(\\pi^{1}, \\pi^{1}, \\pi^{2}\\right)_{\\#}\\left(\\gamma^{23}\\right)_{A}^{\\Omega} \\\\\n\\tilde{\\sigma}^{23} & =\\left(\\pi^{1}, \\pi^{2}, \\pi^{2}\\right)_{\\#}\\left(\\gamma^{12}\\right)_{\\Omega}^{A} \\\\\n\\gamma^{123} & =\\widetilde{\\gamma}^{123}+\\tilde{\\sigma}^{12}+\\tilde{\\sigma}^{23} \\\\\n\\sigma^{12} & =\\left(\\pi^{1}, \\pi^{1}\\right)_{\\#}\\left(\\gamma^{23}\\right)_{A}^{\\Omega} \\\\\n\\sigma^{23} & =\\left(\\pi^{2}, \\pi^{2}\\right)_{\\#}\\left(\\gamma^{12}\\right)_{\\Omega}^{A}\n\\end{aligned}\n$$\n\nWe can check that these measures work. Indeed,\n\n$$\n\\begin{aligned}\n\\pi_{\\#}^{12} \\gamma^{123} & =\\pi_{\\#}^{12} \\tilde{\\gamma}^{123}+\\pi_{\\#}^{12} \\tilde{\\sigma}^{12}+\\pi_{\\#}^{12} \\tilde{\\sigma}^{23} \\\\\n& =\\left(\\gamma^{12}\\right)_{X}^{\\Omega}+\\pi_{\\#}^{12}\\left(\\pi^{1}, \\pi^{1}, \\pi^{2}\\right)_{\\#}\\left(\\gamma^{23}\\right)_{A}^{\\Omega}+\\pi_{\\#}^{12}\\left(\\pi^{1}, \\pi^{2}, \\pi^{2}\\right)_{\\#}\\left(\\gamma^{12}\\right)_{\\Omega}^{A} \\\\\n& =\\left(\\gamma^{12}\\right)_{X}^{\\Omega}+\\left(\\pi^{1}, \\pi^{1}\\right)_{\\#}\\left(\\gamma^{23}\\right)_{A}^{\\Omega}+\\left(\\pi^{1}, \\pi^{2}\\right)_{\\#}\\left(\\gamma^{12}\\right)_{\\Omega}^{A} \\\\\n& =\\left(\\gamma^{12}\\right)_{X}^{\\Omega}+\\sigma^{12}+\\left(\\gamma^{12}\\right)_{\\Omega}^{A} \\\\\n& =\\gamma^{12}+\\sigma^{12}\n\\end{aligned}\n$$\n\nSimilarly with $\\pi_{\\#}^{23} \\gamma^{123}$.\nThe following result guarantees the existence of optimal partial transport plans in the setting of proper metric spaces, generalising [19, p. 4] and [15, Proposition 3.2].\n\nTheorem 3.7. Let $(X, A)$ be a metric pair and $p \\in[1, \\infty)$. Then, for any $\\mu, \\nu \\in \\mathcal{M}_{p}(X, A)$, the set\n\n$$\n\\operatorname{Opt}(\\mu, \\nu)=\\left\\{\\gamma \\in \\operatorname{Adm}(\\mu, \\nu): C(\\gamma)=\\mathrm{Wb}_{p}^{p}(\\mu, \\nu)\\right\\}\n$$\n\nis non-empty. Moreover, the set $\\operatorname{Opt}(\\mu, \\nu)$ is vaguely compact.\nWe will need the following technical lemma for the proof of theorem 3.7, and later on, for the proof of theorem 3.10. The proof of this lemma follows ideas from [2, Footnotes in Sections 2.1 and 2.2].\n\nLemma 3.8. Let $\\mu, \\nu \\in \\mathcal{M}_{p}(X, A), \\varepsilon>0$, and let $\\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)$ be the set of $\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)$ such that\n\n$$\n\\mathrm{Wb}_{p}^{p}(\\mu, \\nu) \\leq C(\\gamma) \\leq \\mathrm{Wb}_{p}^{p}(\\mu, \\nu)+\\varepsilon\n$$\n\nThen, for any compact $C \\subset \\Omega$, the set $\\left\\{\\gamma_{C}^{X}: \\gamma \\in \\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)\\right\\}$ is weakly relatively compact.\nProof. Take $p_{0} \\in X$ and $0<r<R$ such that $C \\subset \\bar{B}_{r}\\left(p_{0}\\right) \\subset \\bar{B}_{R}\\left(p_{0}\\right)$. By H\u00f6lder's inequality, for any $\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)$, we have\n\n$$\n\\begin{aligned}\n&\\left|\\int_{C \\times\\left(X \\backslash \\bar{B}_{R}\\left(p_{0}\\right)\\right)} d\\left(y, p_{0}\\right)-d\\left(x, p_{0}\\right) d \\gamma(x, y)\\right|^{p} \\\\\n& \\leq \\gamma\\left(C \\times\\left(X \\backslash \\bar{B}_{R}\\left(p_{0}\\right)\\right)\\right)^{p-1} \\int_{C \\times\\left(X \\backslash \\bar{B}_{R}\\left(p_{0}\\right)\\right)} d(x, y)^{p} d \\gamma(x, y)\n\\end{aligned}\n$$\n\nwhereas\n\n$$\n\\left|\\int_{C \\times\\left(X \\backslash \\bar{B}_{R}\\left(p_{0}\\right)\\right)} d\\left(y, p_{0}\\right)-d\\left(x, p_{0}\\right) d \\gamma(x, y)\\right|^{p} \\geq(R-r)^{p} \\gamma\\left(C \\times\\left(X \\backslash \\bar{B}_{R}\\left(p_{0}\\right)\\right)\\right)^{p}\n$$\n\nsince $\\operatorname{dist}\\left(\\bar{B}_{r}\\left(p_{0}\\right), X \\backslash \\bar{B}_{R}\\left(p_{0}\\right)\\right) \\geq R-r$. Combining (3.4), (3.5), and (3.6), we get\n\n$$\n\\gamma\\left(C \\times\\left(X \\backslash \\bar{B}_{R}\\left(p_{0}\\right)\\right)\\right) \\leq \\frac{\\mathrm{Wb}_{p}^{p}(\\mu, \\nu)+\\varepsilon}{(R-r)^{p}}\n$$\n\nfor any $\\gamma \\in \\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)$, which can be made arbitrarily small by fixing $r$ and letting $R$ tend to infinity. This proves that $\\left\\{\\gamma_{C}^{X}: \\gamma \\in \\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)\\right\\}$ is tight. Moreover, since $\\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu) \\subset \\operatorname{Adm}(\\mu, \\nu)$, each $\\gamma_{C}^{X}$ has total mass $\\mu(C)<\\infty$, therefore $\\left\\{\\gamma_{C}^{X}: \\gamma \\in \\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)\\right\\}$ has uniformly bounded total variation. By theorem 2.13, the claim follows.\n\nAs a consequence of the previous lemma, we obtain that the sets $\\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)$ are closed with respect to the vague topology. The proof follows along the same lines of those of [15, Proposition 3.2] and arguments in [19, p. 4]. Observe that the chain of equations in (3.7) below is the same as one in the proof of [15, Proposition 3.2], but we need lemma 3.8 to justify it, even in the Euclidean setting. This is because, even when $f \\in \\mathcal{C}_{c}(\\Omega)$, the composition $f \\circ \\pi^{1}: \\Omega \\times X \\rightarrow \\mathbb{R}$ is not of compact support when $X$ is not compact.\n\nCorollary 3.9. Let $\\mu, \\nu \\in \\mathcal{M}_{p}(X, A), \\varepsilon>0$, and let $\\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)$ be defined as in lemma 3.8. Then $\\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)$ is vaguely closed.\n\nProof. Let $\\left\\{\\gamma_{k}\\right\\}_{k \\in \\mathbb{N}} \\subset \\operatorname{Opt}_{\\varepsilon}(\\mu, \\nu)$ be such that $\\gamma_{k} \\xrightarrow{v} \\gamma$ for some $\\gamma \\in \\mathcal{M}\\left(E_{\\Omega}\\right)$. We first observe that $\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)$. Indeed, if $f \\in \\mathcal{C}_{c}(\\Omega)$ then, by applying lemma 3.8 with $C=\\operatorname{supp}(f)$, we can assume that, up to passing to a subsequence, $\\left\\{\\left(\\gamma_{k}\\right)_{\\operatorname{supp}(f)}^{X}\\right\\}_{k \\in \\mathbb{N}}$ is weakly convergent to $\\gamma_{\\operatorname{supp}(f)}^{X}$. Therefore,\n\n$$\n\\int_{\\Omega} f d \\pi_{\\#}^{1} \\gamma=\\int_{\\Omega \\times X} f \\circ \\pi^{1} d \\gamma=\\lim _{k \\rightarrow \\infty} \\int_{\\Omega \\times X} f \\circ \\pi^{1} d \\gamma_{k}=\\int_{\\Omega} f d \\mu\n$$\n\nwhere the second equality follows from the fact that $f \\circ \\pi^{1} \\in \\mathcal{C}_{b}(\\Omega \\times X)$. This implies that $\\left.\\pi_{\\#}^{1} \\gamma\\right|_{\\Omega}=\\mu$, and analogously we obtain $\\left.\\pi_{\\#}^{2} \\gamma\\right|_{\\Omega}=\\nu$.\nNow, we prove that $\\gamma$ satisfies (3.4). Indeed, by lemma 2.18 applied to the sequence $\\left\\{d(\\cdot, \\cdot)^{p} \\gamma_{k}\\right\\}_{k \\in \\mathbb{N}}$, which is vaguely convergent to $d(\\cdot, \\cdot)^{p} \\gamma$, and any bounded open set $U \\subset E_{\\Omega}$, we get\n\n$$\n\\left.C\\left(\\gamma\\right|_{U}\\right) \\leq \\liminf _{k \\rightarrow \\infty} C\\left(\\left(\\gamma_{k}\\right)\\right|_{U}\\right) \\leq \\mathrm{Wb}_{p}^{p}(\\mu, \\nu)+\\varepsilon\n$$\n\nBy the monotone convergence theorem,\n\n$$\nC(\\gamma) \\leq \\mathrm{Wb}_{p}^{p}(\\mu, \\nu)+\\varepsilon\n$$\n\nand the claim follows.\nProof of theorem 3.7. Let $\\mu, \\nu \\in \\mathcal{M}_{p}(X, A)$ and, for every $k \\in \\mathbb{N}$, let $\\gamma_{k} \\in \\operatorname{Opt}_{1 / k}(\\mu, \\nu)$, that is $\\gamma_{k} \\in \\operatorname{Adm}(\\mu, \\nu)$ and\n\n$$\n\\mathrm{Wb}_{p}^{p}(\\mu, \\nu) \\leq C\\left(\\gamma_{k}\\right) \\leq \\mathrm{Wb}_{p}^{p}(\\mu, \\nu)+1 / k\n$$\n\nRemark 3.1 yields that $\\left\\{\\gamma_{k}\\right\\}_{k \\in \\mathbb{N}}$ is a vaguely relatively compact subset of $\\mathcal{M}\\left(E_{\\Omega}\\right)$. Consequently, up to passing to a subsequence, we can assume that there exists $\\gamma \\in \\mathcal{M}\\left(E_{\\Omega}\\right)$ such that $\\gamma_{k} \\xrightarrow{v} \\gamma$. Corollary 3.9 implies that $\\gamma \\in \\operatorname{Opt}_{1 / k}(\\mu, \\nu)$ for any $k \\in \\mathbb{N}$, which means that\n\n$$\n\\mathrm{Wb}_{p}^{p}(\\mu, \\nu) \\leq C(\\gamma) \\leq \\mathrm{Wb}_{p}^{p}(\\mu, \\nu)+\\frac{1}{k}\n$$\n\nfor all $k \\in \\mathbb{N}$. Therefore, $\\gamma \\in \\operatorname{Opt}(\\mu, \\nu)$.\nRegarding the second part of the theorem, observe that if $\\left\\{\\gamma_{k}\\right\\}_{k \\in \\mathbb{N}} \\subset \\operatorname{Opt}(\\mu, \\nu)$ then, by the previous arguments, up to passing to a subsequence, $\\gamma_{k} \\xrightarrow{\\nu} \\gamma$ for some $\\gamma \\in \\mathcal{M}\\left(E_{\\Omega}\\right)$. The fact that $\\gamma \\in$ $\\operatorname{Opt}(\\mu, \\nu)$ also follows from the arguments above.\n\nWe now prove that $\\mathrm{Wb}_{p}$ is a metric and that it is vaguely lower semi-continuous. This statement, and its proof, are adaptations of [19, Theorem 2.2] to the setting of proper metric spaces.\n\nTheorem 3.10. Let $(X, A)$ be a metric pair and $p \\in[1, \\infty)$. Then the function $\\mathrm{Wb}_{p}$ is a metric on $\\mathcal{M}_{p}(X, A)$. Moreover, $\\mathrm{Wb}_{p}$ is lower semi-continuous with respect to the vague topology.\n\nProof. Let $\\mu, \\nu \\in \\mathcal{M}_{p}(X, A)$. Then the measure\n\n$$\n\\gamma=\\left(\\mathrm{id}, \\operatorname{proj}_{A}\\right)_{\\#} \\mu+\\left(\\operatorname{proj}_{A}, \\mathrm{id}\\right)_{\\#} \\nu\n$$\n\nis in $\\operatorname{Adm}(\\mu, \\nu)$, and it satisfies\n\n$$\nC(\\gamma)=\\int_{\\Omega} d(x, A)^{p} d \\mu(x)+\\int_{\\Omega} d(y, A)^{p} d \\nu(y)<\\infty\n$$\n\nIt is also clear that $\\mathrm{Wb}_{p}$ is non-negative and symmetric. Moreover, due to theorem 3.7, $\\mathrm{Wb}_{p}(\\mu, \\nu)=$ 0 if and only if $C(\\gamma)=0$ for some $\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)$, which is equivalent to\n\n$$\n\\int_{E_{\\Omega}} d(x, y)^{p} d \\gamma(x, y)=0\n$$\n\nHowever, this is the same as $\\operatorname{supp}(\\gamma) \\subset \\Delta\\left(E_{\\Omega}\\right)$, which in turn is equivalent to $\\pi_{\\#}^{1} \\gamma=\\pi_{\\#}^{2} \\gamma$. The latter implies that $\\mu=\\nu$. Conversely, if $\\mu=\\nu$ then we can take $\\gamma=(\\mathrm{id}, \\mathrm{id})_{\\#} \\mu \\in \\operatorname{Adm}(\\mu, \\nu)$, which satisfies $C(\\gamma)=0$.\n\nFor the triangle inequality, we need lemma 3.6. Indeed, let $\\mu^{1}, \\mu^{2}, \\mu^{3} \\in \\mathcal{M}_{p}(X, A)$ and choose $\\gamma^{12} \\in \\operatorname{Opt}\\left(\\mu^{1}, \\mu^{2}\\right)$ and $\\gamma^{23} \\in \\operatorname{Opt}\\left(\\mu^{2}, \\mu^{3}\\right)$ (which we can do thanks to proposition 3.7). By lemma 3.6, there is a measure $\\gamma^{123}$ on $X \\times X \\times X$ such that\n\n$$\n\\begin{aligned}\n& \\pi_{\\#}^{12} \\gamma^{123}=\\gamma^{12}+\\sigma^{12} \\\\\n& \\pi_{\\#}^{23} \\gamma^{123}=\\gamma^{23}+\\sigma^{23}\n\\end{aligned}\n$$\n\nwith $\\operatorname{supp}\\left(\\sigma^{12}\\right), \\operatorname{supp}\\left(\\sigma^{23}\\right) \\subset \\Delta(A \\times A)$. In particular, $\\left.\\pi_{\\#}^{1} \\gamma^{123}\\right|_{\\Omega}=\\mu^{1}$ and $\\left.\\pi_{\\#}^{3} \\gamma^{123}\\right|_{\\Omega}=\\mu^{3}$, therefore $\\left.\\pi_{\\#}^{13} \\gamma^{123}\\right|_{E_{\\Omega}} \\in \\operatorname{Adm}\\left(\\mu^{1}, \\mu^{3}\\right)$. This implies\n\n$$\n\\begin{aligned}\n\\mathrm{Wb}_{p}\\left(\\mu^{1}, \\mu^{3}\\right) & \\leq\\left.C\\left(\\pi_{\\#}^{13} \\gamma^{123}\\right|_{E_{\\Omega}}\\right)^{1 / p} \\\\\n& \\leq\\left\\|d \\circ \\pi^{13}\\right\\|_{L^{p}\\left(\\gamma^{123}\\right)} \\\\\n& \\leq\\left\\|d \\circ \\pi^{12}+d \\circ \\pi^{23}\\right\\|_{L^{p}\\left(\\gamma^{123}\\right)} \\\\\n& \\leq\\left\\|d \\circ \\pi^{12}\\right\\|_{L^{p}\\left(\\gamma^{123}\\right)}+\\left\\|d \\circ \\pi^{23}\\right\\|_{L^{p}\\left(\\gamma^{123}\\right)} \\\\\n& =\\|d\\|_{L^{p}\\left(\\gamma^{12}+\\sigma^{12}\\right)}+\\|d\\|_{L^{p}\\left(\\gamma^{23}+\\sigma^{23}\\right)} \\\\\n& =C\\left(\\gamma^{12}\\right)^{1 / p}+C\\left(\\gamma^{23}\\right)^{1 / p} \\\\\n& =\\mathrm{Wb}_{p}\\left(\\mu^{1}, \\mu^{2}\\right)+\\mathrm{Wb}_{p}\\left(\\mu^{2}, \\mu^{3}\\right)\n\\end{aligned}\n$$\n\nTo prove that $\\mathrm{Wb}_{p}$ is lower semi-continuous with respect to the vague topology, let $\\mu_{n} \\xrightarrow{\\nu} \\mu$ and $\\nu_{n} \\xrightarrow{\\nu}$ If $\\liminf _{n \\rightarrow \\infty} \\mathrm{Wb}_{p}\\left(\\mu_{n}, \\nu_{n}\\right)=\\infty$, the result follows trivially. Otherwise, up to passing to a\n\nsubsequence, we can assume that\n\n$$\n\\liminf _{n \\rightarrow \\infty} \\mathrm{Wb}_{p}\\left(\\mu_{n}, \\nu_{n}\\right)=\\lim _{n \\rightarrow \\infty} \\mathrm{Wb}_{p}\\left(\\mu_{n}, \\nu_{n}\\right)\n$$\n\nFor each $n \\in \\mathbb{N}$, take $\\gamma_{n} \\in \\operatorname{Opt}\\left(\\mu_{n}, \\nu_{n}\\right)$. By similar arguments to those in the proof of proposition 3.7, $\\left\\{\\gamma_{n}\\right\\}_{n \\in \\mathbb{N}}$ is vaguely precompact, therefore, up to passing to another subsequence, we can assume that $\\gamma_{n} \\xrightarrow{\\vDash} \\gamma$ for some $\\gamma \\in \\mathcal{M}\\left(E_{\\Omega}\\right)$. Moreover, we can also prove that for any compact $C \\subset \\Omega$, $\\left\\{\\left(\\gamma_{n}\\right)_{C}^{X}\\right\\}_{n \\in \\mathbb{N}}$ is tight and each $\\left(\\gamma_{n}\\right)_{C}^{X}$ has total mass bounded above by $\\mu(C)$ due to lemma 2.18 . Therefore, $\\left\\{\\left(\\gamma_{n}\\right)_{C}^{X}\\right\\}_{n \\in \\mathbb{N}}$ is weakly convergent to $\\gamma_{C}^{X}$. It follows that $\\pi_{\\#}^{1} \\gamma \\mid \\Omega=\\mu$, and analogously $\\pi_{\\#}^{2} \\gamma \\mid \\Omega=\\nu$. Thus $\\gamma \\in \\operatorname{Adm}(\\mu, \\nu)$ and due to lemma 2.18 applied to the measures $\\left\\{d(\\cdot, \\cdot)^{p} \\gamma_{n}\\right\\}_{n \\in \\mathbb{N}}$, which vaguely converge to $d(\\cdot, \\cdot)^{p} \\gamma$, and bounded open sets $U \\subset X \\times X$, we get\n\n$$\nC\\left(\\gamma_{U}^{U}\\right) \\leq \\liminf _{n \\rightarrow \\infty} C\\left(\\left(\\gamma_{n}\\right)_{U}^{U}\\right) \\leq \\lim _{n \\rightarrow \\infty} \\mathrm{Wb}_{p}^{p}\\left(\\mu_{n}, \\nu_{n}\\right)\n$$\n\nand by the monotone convergence theorem, the claim follows.", "tables": {}, "images": {}}, {"section_id": 4, "text": "# 4. Characterisation of optimal partial transport \n\nWe now move on to study a characterisation of optimal partial transport plans analogous to theorem 2.11. Let us define\n\n$$\n\\begin{aligned}\n& c(x, y)=d(x, y)^{p} \\\\\n& \\widetilde{c}(x, y)=\\min \\left\\{d(x, y)^{p}, d(x, A)^{p}+d(y, A)^{p}\\right\\}\n\\end{aligned}\n$$\n\nand\n\n$$\n\\mathcal{S}=\\{(x, y) \\in X \\times X: \\widetilde{c}(x, y)=c(x, y)\\}\n$$\n\nThe following proposition and its proof are adaptations of [19, Proposition 2.3] for proper metric spaces.\n\nProposition 4.1. Let $\\gamma \\in \\mathcal{M}\\left(E_{\\Omega}\\right)$ be a measure satisfying\n\n$$\n\\int d(x, A)^{p}+d(y, A)^{p} d \\gamma(x, y)<\\infty\n$$\n\nThen the following are equivalent:\n(1) $\\gamma \\in \\operatorname{Opt}\\left(\\pi_{\\#}^{1} \\gamma \\mid \\Omega,\\left.\\pi_{\\#}^{2} \\gamma\\right|_{\\Omega}\\right)$.\n(2) $\\gamma$ is concentrated on $\\mathcal{S}$ and the set $\\operatorname{supp}(\\gamma) \\cup A \\times A$ is $\\widetilde{c}$-cyclically monotone.\n(3) there is a c-concave function $\\phi$ such that both $\\phi$ and $\\phi^{c}$ vanish on $A$ and $\\operatorname{supp}(\\gamma) \\subset \\partial_{+}^{c} \\phi$.\n\nMoreover, $d(x, y)=d(x, A)$ for $\\gamma_{\\Omega}^{A}$-a.e. $(x, y)$ and $d(x, y)=d(y, A)$ for $\\gamma_{A}^{\\Omega}$-a.e. $(x, y)$, whenever $\\gamma$ is optimal.\n\nProof. We start proving that (1) implies (2). We denote $\\bar{\\mu}=\\pi_{\\#}^{1} \\gamma, \\bar{\\nu}=\\pi_{\\#}^{2} \\gamma, \\mu=\\bar{\\mu} \\mid \\Omega$ and $\\nu=\\bar{\\nu} \\mid \\Omega$, and define\n\n$$\n\\left.\\widetilde{\\gamma}=\\gamma\\right|_{E_{\\Omega} \\cap \\mathcal{S}}+\\left(\\pi^{1}, \\operatorname{proj}_{A} \\circ \\pi^{1}\\right)_{\\#} \\gamma \\mid_{E_{\\Omega} \\backslash \\mathcal{S}}+\\left(\\operatorname{proj}_{A} \\circ \\pi^{2},\\left.\\pi^{2}\\right)_{\\#} \\gamma\\right|_{E_{\\Omega} \\backslash \\mathcal{S}}\n$$\n\nIt is clear that $\\widetilde{\\gamma} \\in \\operatorname{Adm}(\\mu, \\nu)$ and\n\n$$\nC(\\widetilde{\\gamma})=\\int_{E_{\\Omega} \\cap \\mathcal{S}} d(x, y)^{p} d \\gamma(x, y)+\\int_{E_{\\Omega} \\backslash \\mathcal{S}} d(x, A)^{p}+d(y, A)^{p} d \\gamma(x, y) \\leq C(\\gamma)\n$$\n\nwith strict inequality if and only if $\\gamma(E_{\\Omega} \\backslash \\mathcal{S})>0$. Since $\\gamma \\in \\operatorname{Opt}(\\mu, \\nu)$, we get that $C(\\widetilde{\\gamma})=C(\\gamma)$, which implies that $\\gamma\\left(E_{\\Omega} \\backslash \\mathcal{S}\\right)=0$, i.e. $\\gamma$ is concentrated on $\\mathcal{S}$. In particular,\n\n$$\nC(\\gamma)=\\int_{E_{\\Omega}} \\widetilde{c}(x, y) d \\gamma(x, y)\n$$\n\nwhere $\\widetilde{c}$ is given by (4.2). Now suppose that a measure $\\eta$ on $X \\times X$ satisfies $\\pi_{\\#}^{1} \\eta=\\bar{\\mu}$ and $\\pi_{\\#}^{2} \\eta=\\bar{\\nu}$. Then we can define $\\widetilde{\\eta}$ in analogy to how we defined $\\widetilde{\\gamma}$. Clearly $\\widetilde{\\eta} \\in \\operatorname{Adm}(\\mu, \\nu)$, and\n\n$$\nC(\\widetilde{\\eta})=\\int_{E_{\\Omega}} \\widetilde{c}(x, y) d \\eta(x, y)\n$$\n\nIn particular,\n\n$$\n\\int_{X \\times X} \\widetilde{c}(x, y) d \\gamma(x, y)=C(\\gamma) \\leq C(\\widetilde{\\eta})=\\int_{X \\times X} \\widetilde{c}(x, y) d \\eta(x, y)\n$$\n\nfor any $\\eta$ with the same marginals as $\\gamma$. In other words, $\\gamma$ is an optimal plan between $\\bar{\\mu}$ and $\\bar{\\nu}$ with respect to the cost function $\\widetilde{c}$ in the usual sense. Theorem 2.11 implies that $\\operatorname{supp}(\\gamma)$ is $\\widetilde{c}$-cyclically monotone. Moreover, given $\\left\\{\\left(x_{i}, y_{i}\\right)\\right\\}_{i=1}^{n} \\subset \\operatorname{supp}(\\gamma) \\cup A \\times A$ and $\\sigma \\in \\Sigma_{n}$, we have\n\n$$\n\\begin{aligned}\n& \\sum_{i=1}^{n} \\widetilde{c}\\left(x_{i}, y_{\\sigma(i)}\\right)=\\sum_{\\substack{\\left(x_{i}, y_{i}\\right) \\in \\operatorname{supp}(\\gamma) \\\\\n\\left(x_{\\sigma(i)}, y_{\\sigma(i)}\\right) \\in \\operatorname{supp}(\\gamma)}} \\widetilde{c}\\left(x_{i}, y_{\\sigma(i)}\\right)+\\sum_{\\substack{\\left(x_{i}, y_{i}\\right) \\in \\operatorname{supp}(\\gamma) \\\\\n\\left(x_{\\sigma(i)}, y_{\\sigma(i)}\\right) \\in A \\times A \\backslash \\operatorname{supp}(\\gamma)}} \\widetilde{c}\\left(x_{i}, y_{\\sigma(i)}\\right) \\\\\n& +\\sum_{\\substack{\\left(x_{i}, y_{i}\\right) \\in A \\times A \\backslash \\operatorname{supp}(\\gamma) \\\\\n\\left(x_{\\sigma(i)}, y_{\\sigma(i)}\\right) \\in \\operatorname{supp}(\\gamma)}} \\widetilde{c}\\left(x_{i}, y_{\\sigma(i)}\\right)+\\sum_{\\substack{\\left(x_{i}, y_{i}\\right) \\in A \\times A \\backslash \\operatorname{supp}(\\gamma) \\\\\n\\left(x_{\\sigma(i)}, y_{\\sigma(i)}\\right) \\in A \\times A \\backslash \\operatorname{supp}(\\gamma)} \\widetilde{c}\\left(x_{i}, y_{\\sigma(i)}\\right)\n\\end{aligned}\n$$\n\nwhere it is clear that the number of summands in the second and the third summations are the same, whereas the fourth summation vanishes since $\\widetilde{c}(x, y)=0$ for any $(x, y) \\in A \\times A$. Let $\\left\\{j_{i}\\right\\}_{i=1}^{p}$, $\\left\\{k_{i}\\right\\}_{i=1}^{q}$ and $\\left\\{l_{i}\\right\\}_{i=1}^{q}$ be the sets of indices for the first, second and third sums, respectively, and define a permutation $\\widetilde{\\sigma}$ of the indices $\\left\\{j_{1}, \\ldots, j_{p}, k_{1}, \\ldots, k_{q}\\right\\}=\\left\\{i:\\left(x_{i}, y_{i}\\right) \\in \\operatorname{supp}(\\gamma)\\right\\}$ by $\\widetilde{\\sigma}\\left(j_{r}\\right)=\\sigma\\left(j_{r}\\right)$ for $r=1, \\ldots, p$ and $\\widetilde{\\sigma}\\left(k_{s}\\right)=\\sigma\\left(l_{s}\\right)$ for $s=1, \\ldots, q$. Then\n\n$$\n\\begin{aligned}\n\\sum_{i=1}^{n} \\widetilde{c}\\left(x_{i}, y_{\\sigma(i)}\\right) & =\\sum_{i=1}^{p} \\widetilde{c}\\left(x_{j_{i}}, y_{\\sigma\\left(j_{i}\\right)}\\right)+\\sum_{i=1}^{q} \\widetilde{c}\\left(x_{k_{i}}, y_{\\sigma\\left(k_{i}\\right)}\\right)+\\widetilde{c}\\left(x_{l_{i}}, y_{\\sigma\\left(l_{i}\\right)}\\right) \\\\\n& =\\sum_{i=1}^{p} \\widetilde{c}\\left(x_{j_{i}}, y_{\\sigma\\left(j_{i}\\right)}\\right)+\\sum_{i=1}^{q} \\widetilde{c}\\left(x_{k_{i}}, y_{\\sigma\\left(k_{i}\\right)}\\right)+\\widetilde{c}\\left(y_{\\sigma\\left(k_{i}\\right)}, x_{l_{i}}\\right)+\\widetilde{c}\\left(x_{l_{i}}, y_{\\sigma\\left(l_{i}\\right)}\\right) \\\\\n& \\geq \\sum_{i=1}^{p} \\widetilde{c}\\left(x_{j_{i}}, y_{\\sigma\\left(j_{i}\\right)}\\right)+\\sum_{i=1}^{q} \\widetilde{c}\\left(x_{k_{i}}, y_{\\sigma\\left(l_{i}\\right)}\\right) \\\\\n& =\\sum_{\\left(x_{i}, y_{i}\\right) \\in \\operatorname{supp}(\\gamma)} \\widetilde{c}\\left(x_{i}, y_{\\widetilde{\\sigma}(i)}\\right) \\\\\n& \\geq \\sum_{\\left(x_{i}, y_{i}\\right) \\in \\operatorname{supp}(\\gamma)} \\widetilde{c}\\left(x_{i}, y_{i}\\right) \\\\\n& =\\sum_{i=1}^{n} \\widetilde{c}\\left(x_{i}, y_{i}\\right)\n\\end{aligned}\n$$\n\nwhere in the second and last equalities we have used the fact that $\\widetilde{c}(x, y)=0$ for any $(x, y) \\in$ $A \\times A$, whereas for the first and second inequalities we have used the easily checked inequality $\\widetilde{c}(x, y)+\\widetilde{c}(z, y) \\geq \\widetilde{c}(x, z)$ that holds for any $x, z \\in X$ and $y \\in A$, and the fact that $\\operatorname{supp}(\\gamma)$ is $\\widetilde{c}$-cyclically monotone. This shows (2).\n\nNow, to prove that (2) implies (3), observe that, by theorem 2.11, the $\\widetilde{c}$-cyclical monotonicity of $\\operatorname{supp}(\\gamma) \\cup A \\times A$ implies that there exists a $\\widetilde{c}$-concave function, say $\\phi$, such that $\\operatorname{supp}(\\gamma) \\cup A \\times A \\subset \\partial_{+}^{\\widetilde{c}} \\phi$. In particular,\n\n$$\n\\phi(x)+\\phi^{\\widetilde{c}}(y)=\\widetilde{c}(x, y)=0\n$$\n\nfor any $(x, y) \\in A \\times A$, which implies that both $\\phi$ and $\\phi^{\\widetilde{c}}$ are constant on $A$. Since the $\\widetilde{c}$-concavity is invariant under addition of constants, we can assume that $\\phi=\\phi^{\\widetilde{c}}=0$ on $A$.\n\nOn the other hand, we can see that $\\phi$ is $c$-concave. Indeed, one can prove that, for any $y \\in X$, the map $x \\mapsto \\widetilde{c}(x, y)$ is $c$-concave. Indeed, if we define $\\psi_{y}: X \\rightarrow \\mathbb{R} \\cup\\{-\\infty\\}$ by\n\n$$\n\\psi_{y}(z)= \\begin{cases}-\\infty & \\text { if } z \\in X \\backslash(A \\cup\\{y\\}) \\\\ 0 & \\text { if } z=y \\\\ -d(y, A)^{p} & \\text { if } z \\in A\\end{cases}\n$$\n\nthen it is clear that\n\n$$\n\\inf _{z \\in X} c(x, z)-\\psi_{y}(z)=\\min \\left\\{d(x, y)^{p}, \\inf _{z \\in A} d(x, z)^{p}+d(y, A)^{p}\\right\\}=\\widetilde{c}(x, y)\n$$\n\nand since $\\phi$ is $\\widetilde{c}$-concave, there exists a function $\\psi: X \\rightarrow \\mathbb{R} \\cup\\{-\\infty\\}$ such that $\\phi=\\psi^{\\widetilde{c}}$, that is,\n\n$$\n\\begin{aligned}\n\\phi(x) & =\\inf _{y \\in X} \\widetilde{c}(x, y)-\\psi(y) \\\\\n& =\\inf _{y \\in X} \\inf _{z \\in X} c(x, z)-\\psi_{y}(z)-\\psi(y) \\\\\n& =\\inf _{z \\in X} \\inf _{y \\in X} c(x, z)-\\psi_{y}(z)-\\psi(y) \\\\\n& =\\inf _{z \\in X} c(x, z)-\\sup _{y \\in X} \\psi_{y}(z)+\\psi(y) \\\\\n& =\\inf _{z \\in X} c(x, z)-\\eta(z)\n\\end{aligned}\n$$\n\nwhere $\\eta(z)=\\sup _{y \\in X} \\psi_{y}(z)+\\psi(y)$. Observe this is a well defined function $X \\rightarrow \\mathbb{R} \\cup\\{-\\infty\\}$ since, if $z \\in A$ then\n\n$$\n\\sup _{y \\in X} \\psi_{y}(z)+\\psi(y)=\\sup _{y \\in X}-d(y, A)^{p}+\\psi(y)=-\\inf _{y \\in X} \\widetilde{c}(z, y)-\\psi(y)=-\\phi(z)=0\n$$\n\nand if $z \\notin A$, then\n\n$$\n\\psi_{y}(z)+\\psi(y)= \\begin{cases}-\\infty & \\text { if } y \\neq z \\\\ \\psi(z) & \\text { if } y=z\\end{cases}\n$$\n\nwhich implies that $\\sup _{y \\in X} \\psi_{y}(z)+\\psi(y)=\\psi(z)$.\nMoreover, if $(x, y) \\in \\partial_{+}^{\\widetilde{c}} \\phi \\cap \\mathcal{S}$ then\n\n$$\n\\phi^{\\widetilde{c}}(y)=\\widetilde{c}(x, y)-\\phi(x)=c(x, y)-\\phi(x)\n$$\n\nwhereas\n\n$$\n\\phi^{\\widetilde{c}}(y) \\leq \\widetilde{c}\\left(x^{\\prime}, y\\right)-\\phi\\left(x^{\\prime}\\right) \\leq c\\left(x^{\\prime}, y\\right)-\\phi\\left(x^{\\prime}\\right)\n$$\n\nfor any $x^{\\prime} \\in X$, which means that $\\phi^{\\widetilde{c}}(y)=\\phi^{c}(y)$, therefore $(x, y) \\in \\partial_{+}^{\\widetilde{c}} \\phi$. In particular, since $\\gamma$ is concentrated on $\\partial_{+}^{\\widetilde{c}} \\phi \\cap \\mathcal{S}$, we get that it is also concentrated on $\\partial_{+}^{\\widetilde{c}} \\phi$, which implies that $\\operatorname{supp}(\\gamma) \\subset \\partial_{+}^{\\widetilde{c}} \\phi$.\n\nOn the other hand, if $x \\in A$ then, since $\\phi=\\phi^{\\widetilde{c}}=0$ on $A$, we get\n\n$$\n\\phi(x)+\\phi^{\\widetilde{c}}(x)=\\widetilde{c}(x, x)=c(x, x)=0\n$$\n\nwhich implies that $(x, x) \\in \\partial_{+}^{\\bar{c}} \\phi \\cap \\mathcal{S}$, therefore $(x, x) \\in \\partial_{+}^{\\bar{c}} \\phi$. In particular,\n\n$$\n\\phi^{c}(x)=\\phi(x)+\\phi^{c}(x)=c(x, x)=0\n$$\n\ntherefore $\\phi^{c}=0$ on $A$. This proves (3).\nFinally, to prove that (3) implies (1), consider $\\phi$ a $c$-concave function such that $\\operatorname{supp}(\\gamma) \\subset \\partial_{+}^{\\bar{c}} \\phi$ and $\\phi=\\phi^{c}=0$ on $A$, and choose $\\widetilde{\\gamma} \\in \\operatorname{Adm}(\\mu, \\nu)$. Then, since $\\left.\\pi_{\\#}^{1} \\gamma\\right|_{\\Omega}=\\left.\\pi_{\\#}^{1} \\widetilde{\\gamma}\\right|_{\\Omega}$, we get\n\n$$\n\\int_{X} \\phi d \\pi_{\\#}^{1} \\gamma=\\int_{\\Omega} \\phi d \\pi_{\\#}^{1} \\gamma=\\int_{\\Omega} \\phi d \\pi_{\\#}^{1} \\widetilde{\\gamma}=\\int_{X} \\phi d \\pi_{\\#}^{1} \\widetilde{\\gamma}\n$$\n\nAnalogously with $\\phi^{c}$. Then, we get\n\n$$\n\\begin{aligned}\n\\int_{E_{\\Omega}} d(x, y)^{p} d \\gamma(x, y) & =\\int_{E_{\\Omega}} \\phi(x)+\\phi^{c}(y) d \\gamma(x, y) \\\\\n& =\\int_{X} \\phi(x) d \\pi_{\\#}^{1} \\gamma(x)+\\int_{X} \\phi^{c}(y) d \\pi_{\\#}^{2} \\gamma(y) \\\\\n& =\\int_{X} \\phi(x) d \\pi_{\\#}^{1} \\widetilde{\\gamma}(x)+\\int_{X} \\phi^{c}(y) d \\pi_{\\#}^{2} \\widetilde{\\gamma}(y) \\\\\n& =\\int_{E_{\\Omega}} \\phi(x)+\\phi^{c}(y) d \\widetilde{\\gamma}(x, y) \\\\\n& \\leq \\int_{E_{\\Omega}} d(x, y)^{p} d \\widetilde{\\gamma}(x, y)\n\\end{aligned}\n$$\n\nwhere the last inequality is due to the inequality $\\phi(x)+\\phi^{c}(y) \\leq c(x, y)$ that holds for general $(x, y) \\in X \\times X$. This argument implies that $\\gamma \\in \\operatorname{Opt}(\\mu, \\nu)$.\nTo prove the last part of the statement, we only need to observe that, whenever $\\gamma \\in \\operatorname{Opt}(\\mu, \\nu)$ for some $\\mu, \\nu \\in \\mathcal{M}_{p}(X, A)$, then by (2) we have\n\n$$\n\\operatorname{supp}\\left(\\gamma_{\\Omega}^{A}\\right) \\subset \\operatorname{supp}(\\gamma) \\cap \\Omega \\times A \\subset \\mathcal{S} \\cap \\Omega \\times A\n$$\n\nand for any $(x, y) \\in \\mathcal{S} \\cap \\Omega \\times A$ we have\n\n$$\nd(x, A)^{p} \\leq d(x, y)^{p}=\\min \\left\\{d(x, y)^{p}, d(x, A)^{p}\\right\\} \\leq d(x, A)^{p}\n$$\n\nwhich implies $d(x, y)=d(x, A)$ for any $(x, y) \\in \\operatorname{supp}\\left(\\gamma_{\\Omega}^{A}\\right)$. Analogously with $\\gamma_{A}^{\\Omega}$.", "tables": {}, "images": {}}, {"section_id": 5, "text": "# 5. Properties of $\\mathcal{M}_{p}(X, A)$ \n\nIn this section we prove that $\\mathcal{M}_{p}(X, A)$ inherits different properties from the space $X$. Namely, we prove that $\\mathcal{M}_{p}(X, A)$ is complete, separable, geodesic and non-negatively curved in the Alexandrov sense whenever the underlying space $X$ is so. Proofs are similar to the corresponding results for the classical Wasserstein spaces of probability measures, and we include them for the sake of completeness.\n5.1. Completeness and separability. In this subsection we prove that $\\mathcal{M}_{p}(X, A)$ inherits the properties of completeness and separability from the underlying space $X$. This statement and its proof are adaptations of [19, Proposition 2.7] for proper metric spaces.\n\nProposition 5.1. The space $\\mathcal{M}_{p}(X, A)$ is complete and separable.\nProof. For the separability of $\\mathcal{M}_{p}(X, A)$, if we choose a countable dense set $S \\subset X$ and define,\n\n$$\nF=\\left\\{\\sum_{i \\in I} q_{i} \\delta_{x_{i}}: x_{i} \\in S \\cap \\Omega, q_{i} \\in \\mathbb{Q}_{+}, I \\subset \\mathbb{N} \\text { is finite }\\right\\}\n$$\n\nit is easy to check that $F$ is countable and dense in $\\mathcal{M}_{p}(X, A)$, following the same argument in [33, Theorem 6.18].\n\nTo prove that $\\mathcal{M}_{p}(X, A)$ is complete, we consider a Cauchy sequence $\\left\\{\\mu_{n}\\right\\}_{n \\in \\mathbb{N}} \\subset \\mathcal{M}_{p}(X, A)$. Since $\\left\\{\\mathrm{Wb}_{p}\\left(\\mu_{n}, 0\\right)\\right\\}_{n \\in \\mathbb{N}}$ is a bounded sequence in $\\mathbb{R}$, say by some $C>0$, then for any compact $K \\subset \\Omega$ we have\n\n$$\n\\mu_{n}(K) \\leq \\frac{1}{r^{p}} \\int_{\\Omega} d(x, A)^{p} d \\mu_{n}(x)=\\frac{1}{r^{p}} \\mathrm{Wb}_{p}^{p}\\left(\\mu_{n}, 0\\right) \\leq \\frac{C^{p}}{r^{p}}\n$$\n\nwhere $d(x, A)>r$ for any $x \\in K$. In particular\n\n$$\n\\sup \\left\\{\\mu_{n}(K): n \\in \\mathbb{N}\\right\\}<\\infty\n$$\n\nfor any compact $K \\subset \\Omega$, which due to lemma 2.17 , implies that $\\left\\{\\mu_{n}: n \\in \\mathbb{N}\\right\\}$ is vaguely precompact. Therefore it has a subsequence $\\left\\{\\mu_{n_{k}}\\right\\}_{k \\in \\mathbb{N}}$ vaguely convergent to some $\\mu$. By the lower semi continuity of $\\mathrm{Wb}_{p}$, we get that\n\n$$\n\\mathrm{Wb}_{p}^{p}(\\mu, 0) \\leq \\liminf _{k \\rightarrow \\infty} \\mathrm{Wb}_{p}^{p}\\left(\\mu_{n_{k}}, 0\\right)<\\infty\n$$\n\ntherefore $\\mu \\in \\mathcal{M}_{p}(X, A)$. Moreover, for any $n \\in \\mathbb{N}$,\n\n$$\n\\mathrm{Wb}_{p}\\left(\\mu_{n}, \\mu\\right) \\leq \\liminf _{k \\rightarrow \\infty} \\mathrm{Wb}_{p}^{p}\\left(\\mu_{n}, \\mu_{n_{k}}\\right)\n$$\n\nwhich implies\n\n$$\n\\lim _{n \\rightarrow \\infty} \\mathrm{Wb}_{p}\\left(\\mu_{n}, \\mu\\right) \\leq \\lim _{n \\rightarrow \\infty} \\liminf _{k \\rightarrow \\infty} \\mathrm{Wb}_{p}^{p}\\left(\\mu_{n}, \\mu_{n_{k}}\\right)=0\n$$\n\nwhere the last inequality comes from the fact that $\\left\\{\\mu_{n}\\right\\}_{n \\in \\mathbb{N}}$ is Cauchy. Therefore $\\mu_{n} \\rightarrow \\mu$ in $\\mathcal{M}_{p}(X, A)$, which implies the completeness.\n5.2. Geodesics. We now prove that $\\mathcal{M}_{p}(X, A)$ is a geodesic space whenever $X$ has this property. This is a generalisation of [19, Proposition 2.9] for proper metric spaces.\n\nProposition 5.2. Let $(X, A)$ be a metric pair such that $X$ is geodesic. Then $\\mathcal{M}_{p}(X, A)$ is geodesic as well. Furthermore, if $\\left(\\mu_{t}\\right)_{t \\in[0,1]}$ is a constant speed geodesic in $\\mathcal{M}_{p}(X, A)$, then there exists a measure $\\gamma$ on $\\operatorname{Geo}(X)$ such that $\\left(e_{0}, e_{1}\\right)_{\\#} \\gamma \\mid_{E_{\\Omega}} \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{1}\\right)$ and\n\n$$\n\\mu_{t}=\\left.\\left(e_{t}\\right)_{\\#} \\gamma\\right|_{\\Omega}\n$$\n\nfor any $t \\in[0,1]$.\nFor the proof of proposition 5.2 we follow ideas from the proofs of [2, Theorem 2.10] and [19, Proposition 2.9]. In particular, we need the following technical observation.\n\nLemma 5.3. There is a Borel measurable map GeoSel: $X \\times X \\rightarrow \\operatorname{Geo}(X)$ such that\n\n$$\n\\left(e_{0}, e_{1}\\right) \\circ \\operatorname{GeoSel}=\\operatorname{id}_{X \\times X}\n$$\n\nProof. Since $X$ and $\\operatorname{Geo}(X)$ are complete, separable and proper, the set\n\n$$\nE=\\left\\{(x, y, \\xi) \\in X \\times X \\times \\operatorname{Geo}(X): \\xi_{0}=x, \\xi_{1}=y, d(x, y)=\\mathcal{L}(\\xi)\\right\\}\n$$\n\nis $\\sigma$-compact. Moreover, by the continuity of $d$, the lower semi-continuity of the length functional $\\mathcal{L}$ (see [8, Proposition 2.3.4]), the continuity of the evaluation maps $e_{0}, e_{1}$, and the fact that $X$ is geodesic, it follows that $E$ is closed and $\\pi^{1,2}(E)=X \\times X$, where $\\pi^{1,2}: X \\times X \\times \\operatorname{Geo}(X) \\rightarrow X \\times X$ is the projection onto the first two factors. Therefore, by theorem 2.6, the claim follows.\n\nRemark 5.4. Observe that for any $(x, y) \\in \\mathcal{S}$, where $\\mathcal{S}$ is given by (4.3), and any $t \\in(0,1)$ and $\\xi \\in \\operatorname{Geo}(X)$ such that $\\left(e_{0}, e_{1}\\right)(\\xi)=(x, y)$, we have $\\xi_{t} \\in \\Omega$. Indeed, if this is not the case, then for some choice of $(x, y) \\in \\mathcal{S}, t \\in(0,1)$ and $\\xi \\in$ Geo such that $\\left(e_{0}, e_{1}\\right)(\\xi)=(x, y)$, we have $\\xi_{t} \\in A$. Therefore,\n\n$$\nd(x, A)^{p}+d(y, A)^{p} \\leq d\\left(x, \\xi_{t}\\right)^{p}+d\\left(y, \\xi_{t}\\right)^{p}=\\left((1-t)^{p}+t^{p}\\right) d(x, y)^{p}<d(x, y)^{p}\n$$\n\nwhich contradicts the fact that $(x, y) \\in \\mathcal{S}$.\nWe also need the following lemma to prove the second part of proposition 5.2. Intuitively speaking, this lemma allows us to construct a sequence of measures on $\\operatorname{Geo}(X)$ that interpolate a given geodesic $\\left(\\mu_{t}\\right)_{t \\in[0,1]}$ in $\\mathcal{M}_{p}(X, A)$ at arbitrarily fine dyadic rational parameters in $[0,1]$.\n\nLemma 5.5. Let $\\left(\\mu_{t}\\right)_{t \\in[0,1]}$ be a geodesic in $\\mathcal{M}_{p}(X, A)$. Then, for any $m \\in \\mathbb{N}$, we can find $\\gamma^{m} \\in$ $\\mathcal{B}(\\operatorname{Geo}(X))$ such that\n\n$$\n\\begin{aligned}\n\\left(e_{j / 2^{m}}, e_{k / 2^{m}}\\right)_{\\#} \\gamma^{m} \\mid E_{\\Omega} & \\in \\operatorname{Opt}\\left(\\mu_{j / 2^{m}}, \\mu_{k / 2^{m}}\\right) \\\\\n\\operatorname{supp}\\left(\\left(e_{j / 2^{m}}, e_{k / 2^{m}}\\right)_{\\#} \\gamma^{m} \\mid{ }_{A \\times A}\\right) & \\subset \\Delta(A \\times A)\n\\end{aligned}\n$$\n\nfor any $j, k \\in\\left\\{0, \\ldots, 2^{m}\\right\\}$.\nProof. For each $m \\in \\mathbb{N}$ and each $i \\in\\left\\{0, \\ldots, 2^{m}-1\\right\\}$, choose\n\n$$\n\\gamma^{i, m} \\in \\operatorname{Opt}\\left(\\mu_{i / 2^{m}}, \\mu_{(i+1) / 2^{m}}\\right)\n$$\n\nand apply lemma 3.6 iteratively to get $\\gamma^{m} \\in \\mathcal{B}\\left(X^{2^{m}+1}\\right)$ such that\n\n$$\n\\pi_{\\#}^{i, i+1} \\gamma^{m}=\\gamma^{i, m}+\\sigma^{i, m}\n$$\n\nwhere $\\sigma^{i, m}$ is supported on $\\Delta(A \\times A)$. Then, by letting $G^{m}: X^{2^{m}+1} \\rightarrow \\mathcal{C}([0,1], X)$ be the Borel measurable map given by\n\n$$\n\\left(x_{0}, \\ldots, x_{2^{m}}\\right) \\mapsto \\operatorname{GeoSel}\\left(x_{0}, x_{1}\\right) * \\cdots * \\operatorname{GeoSel}\\left(x_{2^{m}}, x_{2^{m}+1}\\right)\n$$\n\nwhere $*$ denotes concatenation of paths, we can define\n\n$$\n\\gamma^{m}=G_{\\#}^{m} \\gamma^{m}\n$$\n\nNow, for any $j, k \\in\\left\\{0, \\ldots, 2^{m}\\right\\}$, we have\n\n$$\n\\begin{aligned}\n\\left\\|d\\left(e_{j / 2^{m}}, e_{k / 2^{m}}\\right)\\right\\|_{L^{p}\\left(\\gamma^{m}\\right)} & \\leq\\left\\|\\sum_{i=j}^{k-1} d\\left(e_{i / 2^{m}}, e_{(i+1) / 2^{m}}\\right)\\right\\|_{L^{p}\\left(\\gamma^{m}\\right)} \\\\\n& \\leq \\sum_{i=j}^{k-1}\\left\\|d\\left(e_{i / 2^{m}}, e_{(i+1) / 2^{m}}\\right)\\right\\|_{L^{p}\\left(\\gamma^{m}\\right)} \\\\\n& =\\sum_{i=j}^{k-1} \\mathrm{Wb}_{p}\\left(\\mu_{i / 2^{m}}, \\mu_{(i+1) / 2^{m}}\\right) \\\\\n& =\\mathrm{Wb}_{p}\\left(\\mu_{j / 2^{m}}, \\mu_{k / 2^{m}}\\right)\n\\end{aligned}\n$$\n\nwhere the first inequality is given by the monotonicity of the integral; the second one is the triangle inequality in $L^{p}\\left(\\gamma^{m}\\right)$, and the last two lines are consequences of the definition of $\\gamma^{m}$ and the fact that $\\left(\\mu_{t}\\right)_{t \\in[0,1]}$ is a geodesic. As a consequence, we get that\n\n$$\n\\left(e_{j / 2^{m}}, e_{k / 2^{m}}\\right)_{\\#} \\gamma^{m} \\left\\lvert\\, \\begin{aligned}\n& E_{\\Omega} \\in \\operatorname{Opt}\\left(\\mu_{j / 2^{m}}, \\mu_{k / 2^{m}}\\right) \\\\\n& \\text { ( } \\quad \\text { ) }\n\\end{aligned}\\right.\n$$\n\nand\n\n$$\nd\\left(\\xi_{j / 2^{m}}, \\xi_{k / 2^{m}}\\right)=\\sum_{i=j}^{k-1} d\\left(\\xi_{i / 2^{m}}, \\xi_{(i+1) / 2^{m}}\\right)\n$$\n\nfor $\\gamma^{m}$-a.e. $\\xi \\in \\mathcal{C}([0,1], X)$, and the claim follows.\nThe next results are similar in spirit to lemma 3.8 and Corollary 3.9, and they will allow us to construct the limit measure we need for the second part of proposition 5.2. Let us define\n\n$$\n\\operatorname{OptGeo}(\\mu, \\nu)=\\left\\{\\gamma \\in \\mathcal{M}\\left(\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)\\right):\\left(e_{0}, e_{1}\\right)_{\\#} \\gamma \\in \\operatorname{Opt}(\\mu, \\nu)\\right\\}\n$$\n\nLemma 5.6. For any $\\mu, \\nu, \\rho \\in \\mathcal{M}_{p}(X, A)$, any compact $C \\subset \\Omega$, and any $t \\in[0,1]$, the set\n\n$$\n\\left\\{\\left.\\gamma\\right|_{e_{t}^{-1}(C)}: \\gamma \\in \\operatorname{OptGeo}(\\mu, \\nu),\\left.\\left(e_{t}\\right)_{\\#} \\gamma\\right|_{\\Omega}=\\rho\\right\\}\n$$\n\nis weakly relatively compact.\nProof. Let $p_{0} \\in X$ and $R>r>0$ such that $C \\subset \\bar{B}_{r}\\left(p_{0}\\right) \\subset \\bar{B}_{R}\\left(p_{0}\\right)$. Then, an argument analogous to the proof of lemma 3.8 shows that\n\n$$\n\\gamma\\left(e_{t}^{-1}(C) \\backslash\\left(e_{0}, e_{1}\\right)^{-1}\\left(\\bar{B}_{R}\\left(p_{0}\\right) \\times \\bar{B}_{R}\\left(p_{0}\\right)\\right)\\right) \\leq \\frac{\\mathrm{Wb}_{p}^{p}\\left(\\mu_{0}, \\mu_{1}\\right)}{(R-r)^{p}}\n$$\n\nfor any $\\gamma \\in \\operatorname{OptGeo}(\\mu, \\nu)$. Observe that $\\left(e_{0}, e_{1}\\right)^{-1}\\left(\\bar{B}_{R}\\left(p_{0}\\right) \\times \\bar{B}_{R}\\left(p_{0}\\right)\\right)$ is closed and, being the set of geodesics with endpoints in $\\bar{B}_{R}\\left(p_{0}\\right)$, is contained in $\\operatorname{Geo}\\left(\\bar{B}_{2 R}(X)\\right)$, which is compact due to Arzel\u00e0Ascoli theorem and the fact that $X$ is proper. By fixing $r>0$ and letting $R$ tend to infinity, the right hand side of inequality (5.3) can be made arbitrarily small, uniformly over $\\gamma$, which implies tightness.\nOn the other hand, each $\\left.\\gamma\\right|_{e_{t}^{-1}(C)}$ has total mass $\\rho(C)<\\infty$. Therefore we have uniformly bounded total variation, and the claim follows from lemma 2.13 .\n\nCorollary 5.7. For any $\\mu, \\nu, \\rho \\in \\mathcal{M}_{p}(X, A)$ and any $t \\in[0,1]$, the set\n\n$$\n\\left\\{\\gamma: \\gamma \\in \\operatorname{OptGeo}(\\mu, \\nu),\\left.\\left(e_{t}\\right)_{\\#} \\gamma\\right|_{\\Omega}=\\rho\\right\\}\n$$\n\nis vaguely closed in $\\mathcal{M}\\left(\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)\\right)$.\nProof. Let $\\left\\{\\gamma^{m}\\right\\}_{m \\in \\mathbb{N}} \\subset \\operatorname{OptGeo}(\\mu, \\nu)$ be such that $\\left.\\left(e_{t}\\right)_{\\#} \\gamma^{m}\\right|_{\\Omega}=\\rho$ for all $m \\in \\mathbb{N}$, and assume that $\\gamma^{m} \\xrightarrow{v} \\gamma$ for some $\\gamma \\in \\mathcal{M}\\left(\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)\\right)$. Thanks to lemma 5.6, for any compact $C \\subset \\Omega$, $\\left\\{\\left.\\gamma^{m}\\right|_{e_{t}^{-1}(C)}\\right\\}_{m \\in \\mathbb{N}}$ is weakly relatively compact, therefore $\\left.\\left.\\gamma^{m}\\right|_{e_{t}^{-1}(C)} \\xrightarrow{w} \\gamma\\right|_{e_{t}^{-1}(C)}$. In particular, if $f \\in \\mathcal{C}_{c}(\\Omega)$ then\n\n$$\n\\begin{aligned}\n\\int_{\\Omega} f d\\left(e_{t}\\right)_{\\#} \\gamma & =\\int_{e_{t}^{-1}(\\operatorname{supp}(f))} f \\circ e_{t} d \\gamma \\\\\n& =\\lim _{m \\rightarrow \\infty} \\int_{e_{t}^{-1}(\\operatorname{supp}(f))} f \\circ e_{t} d \\gamma^{m} \\\\\n& =\\lim _{m \\rightarrow \\infty} \\int_{\\operatorname{supp}(f)} f d\\left(e_{t}\\right)_{\\#} \\gamma^{m} \\\\\n& =\\int_{\\Omega} f d \\mu_{t}\n\\end{aligned}\n$$\n\nwhich implies $\\left(e_{t}\\right)_{\\#} \\gamma \\mid \\Omega=\\rho$. Analogously, $\\left(e_{0}, e_{1}\\right)_{\\#} \\gamma \\in \\operatorname{Adm}(\\mu, \\nu)$.\n\nNow, we prove that $\\gamma \\in \\operatorname{OptGeo}(\\mu, \\nu)$. Indeed, by lemma 2.18 applied to the sequence $\\left\\{d\\left(e_{0}, e_{1}\\right)^{p} \\gamma^{m}\\right\\}_{m \\in \\mathbb{N}}$, which is vaguely convergent to $d\\left(e_{0}, e_{1}\\right)^{p} \\gamma$, and any bounded open set $U \\subset\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)$, we get\n\n$$\nC\\left(\\left.\\left(e_{0}, e_{1}\\right)_{\\#} \\gamma\\right|_{U}\\right) \\leq \\liminf _{m \\rightarrow \\infty} C\\left(\\left.\\left(e_{0}, e_{1}\\right)_{\\#} \\gamma^{m}\\right|_{U}\\right) \\leq \\mathrm{Wb}_{p}^{p}(\\mu, \\nu)\n$$\n\nBy the monotone convergence theorem, the claim follows.\nProof of proposition 5.2. Let $\\mu^{0}, \\mu^{1} \\in \\mathcal{M}_{p}(X, A)$ and choose $\\gamma \\in \\operatorname{Opt}\\left(\\mu^{0}, \\mu^{1}\\right)$. By lemma 5.3 there is a measurable map GeoSel: $X \\times X \\rightarrow \\operatorname{Geo}(X)$ such that $\\operatorname{GeoSel}(x, y)$ is a constant speed geodesic joining $x$ and $y$. We define a measure $\\gamma$ on $\\operatorname{Geo}(X)$ by\n\n$$\n\\gamma=\\operatorname{GeoSel}_{\\#} \\gamma\n$$\n\nIn particular, since $\\gamma$ is concentrated on $\\mathcal{S}$ by item 2 in proposition 4.1, then $\\gamma$ is concentrated on $\\left(e_{0}, e_{1}\\right)^{-1}(\\mathcal{S})$, which implies that $\\left(e_{t}\\right)_{\\#} \\gamma$ is concentrated on $\\Omega$, for any $t \\in(0,1)$, by remark 5.4. Observe, however, that this is not necessarily the case for $t=0$ and $t=1$. Let $\\mu_{t}$ be given by\n\n$$\n\\mu_{t}=\\left.\\left(e_{t}\\right)_{\\#} \\gamma\\right|_{\\Omega}\n$$\n\nWe claim that the curve $\\left(\\mu_{t}\\right)_{t \\in[0,1]}$ is a constant speed geodesic joining $\\mu^{0}$ and $\\mu^{1}$ in $\\mathcal{M}_{p}(X, A)$. Indeed, since $\\left(e_{0}, e_{t}\\right) \\circ \\operatorname{GeoSel}=\\mathrm{id}$ then\n\n$$\n\\mu^{0}=\\left.\\pi_{\\#}^{1} \\gamma\\right|_{\\Omega}=\\pi_{\\#}^{1}\\left(e_{0}, e_{1}\\right)_{\\#} \\operatorname{GeoSel}_{\\#} \\gamma\\left|_{\\Omega}=\\left(e_{0}\\right)_{\\#} \\gamma\\right|_{\\Omega}=\\mu_{0}\n$$\n\nand, analogously, $\\mu^{1}=\\mu_{1}$. Moreover, for any $s, t \\in[0,1]$,\n\n$$\n\\begin{aligned}\n\\mathrm{Wb}_{p}^{p}\\left(\\mu_{t}, \\mu_{s}\\right) & =\\mathrm{Wb}_{p}^{p}\\left(\\left.\\left(e_{t}\\right)_{\\#} \\gamma\\right|_{\\Omega},\\left(e_{s}\\right)_{\\#} \\gamma\\right|_{\\Omega} \\\\\n& \\leq C\\left(\\left.\\left(e_{t}, e_{s}\\right)_{\\#} \\gamma\\right|_{E_{\\Omega}}\\right) \\\\\n& =\\int_{E_{\\Omega}} d(x, y)^{p} d\\left(e_{t}, e_{s}\\right)_{\\#} \\gamma(x, y) \\\\\n& =\\int_{E_{\\Omega}} d\\left(\\operatorname{GeoSel}(x, y)_{t}, \\operatorname{GeoSel}(x, y)_{s}\\right)^{p} d \\gamma(x, y) \\\\\n& =|t-s|^{p} \\int_{E_{\\Omega}} d(x, y)^{p} d \\gamma(x, y) \\\\\n& =|t-s|^{p} \\mathrm{Wb}_{p}^{p}\\left(\\mu_{0}, \\mu_{1}\\right)\n\\end{aligned}\n$$\n\nThis argument implies both that $\\mu_{t} \\in \\mathcal{M}_{p}(X, A)$ for any $t \\in[0,1]$, by the triangle inequality, and that $\\left(\\mu_{t}\\right)_{t \\in[0,1]} \\in \\operatorname{Geo}\\left(\\mathcal{M}_{p}(X, A)\\right)$.\nNow, for the second part of the theorem, let $\\left(\\mu_{t}\\right)_{t \\in[0,1]}$ be a geodesic in $\\mathcal{M}_{p}(X, A)$. We want to construct $\\gamma \\in \\mathcal{M}\\left(\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)\\right)$ such that $\\left(e_{0}, e_{1}\\right)_{\\#} \\gamma \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{1}\\right)$ and $\\left(e_{t}\\right)_{\\#} \\gamma \\mid \\Omega=\\mu_{t}$ for all $t \\in[0,1]$. We will get such $\\gamma$ as a limit of a sequence of measures given by lemma 5.5.\nIndeed, for each $m \\in \\mathbb{N}$, let $\\gamma^{m} \\in \\mathcal{B}(\\operatorname{Geo}(X))$ be as in lemma 5.5. In particular, $\\left(e_{0}, e_{1}\\right)_{\\#} \\gamma^{m} \\mid E_{\\Omega} \\in$ $\\operatorname{Opt}\\left(\\mu_{0}, \\mu_{1}\\right)$. Due to item 2 in proposition $4.1,\\left.\\gamma^{m}\\right|_{\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)}$ is concentrated on $\\left(e_{0}, e_{1}\\right)^{-1}\\left(\\mathcal{S} \\cap E_{\\Omega}\\right)$. Additionally, lemma 5.5 implies that $\\left.\\gamma^{m}\\right|_{\\left(e_{0}, e_{1}\\right)^{-1}(A \\times A)}$ is supported on constant geodesics. Therefore, without loss of generality, we can assume that $\\gamma^{m}=\\left.\\gamma^{m}\\right|_{\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)}$.\nWe now prove that $\\left\\{\\gamma^{m}\\right\\}_{m \\in \\mathbb{N}}$ is vaguely relatively compact in $\\mathcal{M}\\left(\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)\\right)$. Indeed, if $\\mathcal{K} \\subset$ $\\left(e_{0}, e_{1}\\right)^{-1}\\left(\\mathcal{S} \\cap E_{\\Omega}\\right)$ is a compact set, then $e_{1 / 2}(\\mathcal{K}) \\subset \\Omega$ by remark 5.4, and thanks to lemma 5.5,\n\n$$\n\\gamma^{m}(\\mathcal{K}) \\leq \\gamma^{m}\\left(\\left(e_{1 / 2}\\right)^{-1}\\left(e_{1 / 2}(\\mathcal{K})\\right)\\right)=\\left(e_{1 / 2}\\right)_{\\#} \\gamma^{m}\\left(e_{1 / 2}(\\mathcal{K})\\right)=\\mu_{1 / 2}\\left(e_{1 / 2}(\\mathcal{K})\\right)\n$$\n\nSince $\\mu_{1 / 2}$ is a Radon measure on $\\Omega$, and $e_{1 / 2}(\\mathcal{K})$ is compact, we get that\n\n$$\n\\sup _{m \\in \\mathbb{N}} \\gamma^{m}(\\mathcal{K})<\\infty\n$$\n\nwhich proves the claim, due to remark 2.15 and lemma 2.17 , since $\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)$ is an open subset of a separable, locally compact metric space.\n\nThus, we can assume, up to passing to a subsequence, that $\\left\\{\\boldsymbol{\\gamma}^{m}\\right\\}_{m \\in \\mathbb{N}}$ is vaguely convergent to some $\\gamma \\in \\mathcal{M}\\left(\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)\\right)$. By corollary $5.7,\\left(e_{0}, e_{1}\\right)_{\\#} \\boldsymbol{\\gamma} \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{1}\\right)$ and $\\left.\\left(e_{t}\\right)_{\\#} \\boldsymbol{\\gamma}\\right|_{\\Omega}=\\mu_{t}$ for any dyadic rational $t \\in[0,1]$.\nFinally, for any other $t \\in[0,1]$, let $\\left\\{t_{k}\\right\\}_{k \\in \\mathbb{N}}$ and $\\left\\{t^{l}\\right\\}_{l \\in \\mathbb{N}}$ be two sequences of dyadic rational numbers converging to $t$, with $t_{k} \\leq t \\leq t^{l}$ for any $k, l \\in \\mathbb{N}$, and observe that $\\left.\\left(e_{t_{k}}, e_{t}\\right)_{\\#} \\boldsymbol{\\gamma}\\right|_{E_{\\Omega}} \\in$ $\\operatorname{Adm}\\left(\\mu_{t_{k}},\\left.\\left(e_{t}\\right)_{\\#} \\boldsymbol{\\gamma}\\right|_{\\Omega}\\right)$. Therefore,\n\n$$\n\\begin{aligned}\n\\mathrm{Wb}_{p}^{p}\\left(\\mu_{t_{k}},\\left.\\left(e_{t}\\right)_{\\#} \\boldsymbol{\\gamma}\\right|_{\\Omega}\\right) & \\leq C\\left(\\left.\\left(e_{t_{k}}, e_{t}\\right)_{\\#} \\boldsymbol{\\gamma}\\right|_{E_{\\Omega}}\\right) \\\\\n& \\leq C\\left(\\left.\\left(e_{t_{k}}, e_{t^{l}}\\right)_{\\#} \\boldsymbol{\\gamma}\\right|_{E_{\\Omega}}\\right) \\\\\n& =\\mathrm{Wb}_{p}^{p}\\left(\\mu_{t_{k}}, \\mu_{t^{l}}\\right)\n\\end{aligned}\n$$\n\nBy letting $k, l \\rightarrow \\infty$, we get that $\\left(e_{t}\\right)_{\\#} \\boldsymbol{\\gamma} \\mid \\Omega=\\mu_{t}$ as claimed.\nWe now prove that $\\mathcal{M}_{p}(X, A)$ inherits the property of being non-branching, whenever $p>1$. This is analogous to the second half of [19, Proposition 2.9], and the proof adapts ideas from [2, Proposition 2.16].\n\nProposition 5.8. Let $(X, A)$ be a metric pair such that $X$ is geodesic and non-branching, and $p \\in(1, \\infty)$. Then $\\mathcal{M}_{p}(X, A)$ is non branching. Furthermore, if $\\left(\\mu_{t}\\right)_{t \\in[0,1]} \\in \\operatorname{Geo}\\left(\\mathcal{M}_{p}(X, A)\\right)$, then for any $t \\in(0,1)$ and any $\\gamma \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{t}\\right), \\gamma_{X}^{\\Omega}$ is unique and it is induced by a map.\n\nProof. Let $\\left(\\mu_{t}\\right)_{t \\in[0,1]} \\in \\operatorname{Geo}\\left(\\mathcal{M}_{p}(X, A)\\right), t \\in(0,1)$ and consider $\\gamma^{1} \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{t}\\right)$ and $\\gamma^{2} \\in \\operatorname{Opt}\\left(\\mu_{t}, \\mu_{1}\\right)$. By the proof of proposition 5.2, there is measure $\\gamma$ on $X^{3}$ such that\n\n$$\n\\pi_{\\#}^{12} \\gamma=\\gamma^{1}+\\sigma^{1} \\quad \\text { and } \\quad \\pi_{\\#}^{23} \\gamma=\\gamma^{2}+\\sigma^{2}\n$$\n\nfor some $\\sigma^{1}, \\sigma^{2}$ supported on $\\Delta(A \\times A)$, and such that $\\pi_{\\#}^{13} \\gamma \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{1}\\right)$. Moreover,\n\n$$\nd(x, y)=t d(x, z), d(y, z)=(1-t) d(x, z)\n$$\n\nwhich implies that $x, y, z$ lie in a geodesic, for $\\gamma$-a.e. $(x, y, z)$.\nNow consider $(x, y, z),\\left(x^{\\prime}, y, z^{\\prime}\\right) \\in \\operatorname{supp}(\\gamma)$. By proposition 4.1, we know that $\\operatorname{supp}\\left(\\pi_{\\#}^{13} \\gamma\\right)$ is in the superdifferential of a $c$-concave function (where $c$ is given by (4.1)), which implies it is $c$-cyclically monotone. Therefore,\n\n$$\n\\begin{aligned}\nd(x, z)^{p}+d\\left(x^{\\prime}, z^{\\prime}\\right)^{p} & \\leq d\\left(x, z^{\\prime}\\right)^{p}+d\\left(x^{\\prime}, z\\right)^{p} \\\\\n& \\leq\\left(d(x, y)+d\\left(y, z^{\\prime}\\right)\\right)^{p}+\\left(d\\left(x^{\\prime}, y\\right)+d(y, z)\\right)^{p} \\\\\n& =\\left(t d(x, z)+(1-t) d\\left(x^{\\prime}, z^{\\prime}\\right)\\right)^{p}+\\left(t d\\left(x^{\\prime}, z^{\\prime}\\right)+(1-t) d(x, z)\\right)^{p} \\\\\n& \\leq t d(x, z)^{p}+(1-t) d\\left(x^{\\prime}, z^{\\prime}\\right)^{p}+t d\\left(x^{\\prime}, z^{\\prime}\\right)^{p}+(1-t) d(x, z)^{p} \\\\\n& =d(x, z)^{p}+d\\left(x^{\\prime}, z^{\\prime}\\right)^{p}\n\\end{aligned}\n$$\n\nwhere the last inequality is due to the convexity of $t \\mapsto t^{p}$ for $p>1$. Moreover, the strict convexity of the same function, and the fact the all the inequalities above are equations, imply that $d(x, z)=$ $d\\left(x^{\\prime}, z^{\\prime}\\right)$ and\n\n$$\nd(x, y)+d\\left(y, z^{\\prime}\\right)=d\\left(x, z^{\\prime}\\right)\n$$\n\nIn particular, $x, y, z^{\\prime}$ lie in a geodesic. Since $X$ is non-branching, we get that $z=z^{\\prime}$, and analogously we get that $x=x^{\\prime}$. In other words, the map $\\pi^{2}:(x, y, z) \\mapsto y$ is injective in $\\operatorname{supp}(\\gamma)$. In particular,\n\nif $T$ is the inverse of $\\left.\\pi^{2}\\right|_{\\operatorname{supp}(\\gamma)}$, we get that\n\n$$\n\\left(\\pi^{1} \\circ T, \\mathrm{id}\\right)_{\\#} \\mu_{t}=\\left(\\gamma^{1}\\right)_{X}^{\\Omega} \\quad \\text { and } \\quad\\left(\\mathrm{id}, \\pi^{3} \\circ T\\right)_{\\#} \\mu_{t}=\\left(\\gamma^{2}\\right)_{U}^{X}\n$$\n\nTherefore, $\\left(\\gamma^{1}\\right)_{X}^{\\Omega}$ and $\\left(\\gamma^{2}\\right)_{U}^{X}$ are induced by maps. Moreover, this also implies that $\\left(\\gamma^{1}\\right)_{X}^{\\Omega}$ is unique, because otherwise we could construct $\\gamma \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{t}\\right)$ such that\n\n$$\n\\gamma_{X}^{\\Omega}=\\frac{1}{2}\\left(\\left(\\pi^{1} \\circ T, \\mathrm{id}\\right)_{\\#} \\mu_{t}+\\left(\\pi^{1} \\circ T^{\\prime}, \\mathrm{id}\\right)_{\\#} \\mu_{t}\\right)\n$$\n\nwhich would not be induced by a map.\nFinally, to prove that $\\mathcal{M}_{p}(X, A)$ is non-branching, consider geodesics $\\left(\\mu_{t}\\right)_{t \\in[0,1]},\\left(\\mu_{t}^{\\prime}\\right)_{t \\in[0,1]}$ and $t_{0} \\in$ $(0,1)$ such that $\\mu_{0}=\\mu_{0}^{\\prime}$ and $\\mu_{t_{0}}=\\mu_{t_{0}}^{\\prime}$. Let $\\gamma, \\gamma^{\\prime} \\in \\mathcal{M}\\left(\\left(e_{0}, e_{1}\\right)^{-1}\\left(E_{\\Omega}\\right)\\right)$ be such that $\\mu_{t}=\\left(e_{t}\\right)_{\\#} \\gamma \\mid \\Omega$ and $\\mu_{t}^{\\prime}=\\left(e_{t}\\right)_{\\#} \\gamma^{\\prime} \\mid \\Omega$ for all $t \\in[0,1]$. Then we have\n\n$$\n\\left(e_{0}, e_{t_{0}}\\right)_{\\#} \\gamma,\\left(e_{0}, e_{t_{0}}\\right)_{\\#} \\gamma^{\\prime} \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{t_{0}}\\right)\n$$\n\nand due to our previous arguments, it follows that\n\n$$\n\\left(e_{0}, e_{t_{0}}\\right)_{\\#} \\gamma=\\left(e_{0}, e_{t_{0}}\\right)_{\\#} \\gamma \\mid X \\times \\Omega=\\left(e_{0}, e_{t_{0}}\\right)_{\\#} \\gamma^{\\prime} \\mid X \\times \\Omega=\\left(e_{0}, e_{t_{0}}\\right)_{\\#} \\gamma^{\\prime}\n$$\n\nwhere we have used that $\\operatorname{supp}\\left(\\left(e_{t_{0}}\\right)_{\\#} \\gamma\\right) \\subset \\Omega$ for $t_{0} \\in(0,1)$, thanks to remark 5.4. Since $X$ is non-branching, the map $\\left(e_{0}, e_{t_{0}}\\right): \\operatorname{Geo}(X) \\rightarrow X \\times X$ is injective, which implies\n\n$$\n\\gamma=\\gamma^{\\prime}\n$$\n\ntherefore\n\n$$\n\\mu_{1}=\\left(e_{1}\\right)_{\\#} \\gamma \\mid \\Omega=\\left(e_{1}\\right)_{\\#} \\gamma^{\\prime} \\mid \\Omega=\\mu_{1}^{\\prime}\n$$\n\nand the proposition follows.\n5.3. Non-negative curvature. In this subsection we prove that $\\mathcal{M}_{2}(X, A)$ inherits the property of having non-negative curvature in the sense of Alexandrov. This provides a new way to construct Alexandrov spaces. The proof is an adaptation of that of [2, Theorem 2.20].\n\nTheorem 5.9. Let $(X, A)$ be a metric pair such that $X$ is a non-negatively curved Alexandrov space. Then $\\mathcal{M}_{2}(X, A)$ is a non-negatively curved Alexandrov space too.\n\nProof. Since $X$ is complete, separable, proper and geodesic, it follows that $\\mathcal{M}_{2}(X, A)$ is complete and geodesic, due to theorems 5.1 and 5.2. Now, let $\\left(\\mu_{t}\\right)_{t \\in[0,1]}$ be a constant speed geodesic in $\\mathcal{M}_{2}(X, A)$. Let also $\\nu \\in \\mathcal{M}_{2}(X, A)$ be some measure. By theorem 5.2, we know there exists a measure $\\gamma$ on $\\operatorname{Geo}(X)$ such that $\\left(e_{0}, e_{1}\\right)_{\\#} \\gamma \\in \\operatorname{Opt}\\left(\\mu_{0}, \\mu_{1}\\right)$ and $\\left(e_{t}\\right)_{\\#} \\gamma \\mid \\Omega=\\mu_{t}$ for all $t \\in[0,1]$. Fix $t \\in(0,1)$ and consider $\\gamma \\in \\operatorname{Opt}\\left(\\mu_{t}, \\nu\\right)$. By observing that $\\left(e_{t}\\right)_{\\#} \\gamma=\\mu_{t}=\\left.\\pi_{\\#}^{1} \\gamma\\right|_{\\Omega}$ and applying the gluing lemma (theorem 2.9), we get a measure $\\boldsymbol{\\alpha} \\in \\mathcal{M}(\\operatorname{Geo}(X) \\times X)$ such that\n\n$$\n\\begin{gathered}\n\\pi_{\\#}^{\\operatorname{Geo}(X)} \\boldsymbol{\\alpha}=\\gamma \\\\\n\\left(e_{t} \\circ \\pi^{\\operatorname{Geo}(X)}, \\pi^{X}\\right)_{\\#} \\boldsymbol{\\alpha}=\\gamma_{\\Omega}^{X}\n\\end{gathered}\n$$\n\nIn it therefore easy to check that\n\n$$\n\\begin{aligned}\n& \\left(e_{0} \\circ \\pi^{\\operatorname{Geo}(X)}, \\pi^{X}\\right)_{\\#} \\boldsymbol{\\alpha} \\mid E_{\\Omega}+\\gamma_{A}^{\\Omega} \\in \\operatorname{Adm}\\left(\\mu_{0}, \\nu\\right) \\\\\n& \\left(e_{1} \\circ \\pi^{\\operatorname{Geo}(X)}, \\pi^{X}\\right)_{\\#} \\boldsymbol{\\alpha} \\mid E_{\\Omega}+\\gamma_{A}^{\\Omega} \\in \\operatorname{Adm}\\left(\\mu_{1}, \\nu\\right)\n\\end{aligned}\n$$\n\nIn particular,\n\n$$\n\\begin{aligned}\n\\mathrm{Wb}_{2}^{2}\\left(\\mu_{t}, \\nu\\right)= & \\int_{E_{\\Omega}} d(x, z)^{2} d \\gamma(x, z) \\\\\n= & \\int_{\\Omega \\times X} d(x, z)^{2} d \\gamma(x, z)+\\int_{A \\times \\Omega} d(x, z)^{2} d \\gamma(x, z) \\\\\n= & \\int_{\\operatorname{Geo}(X) \\times X} d\\left(\\xi_{t}, z\\right)^{2} d \\boldsymbol{\\alpha}(\\xi, z)+\\int_{A \\times \\Omega} d(x, z)^{2} d \\gamma(x, z) \\\\\n\\geq & \\int_{\\operatorname{Geo}(X) \\times X}(1-t) d\\left(\\xi_{0}, z\\right)^{2}+t d\\left(\\xi_{1}, z\\right)^{2}-(1-t) t d\\left(\\xi_{0}, \\xi_{1}\\right)^{2} d \\boldsymbol{\\alpha}(\\xi, z) \\\\\n& +\\int_{A \\times \\Omega} d(x, z)^{2} d \\gamma(x, z) \\\\\n\\geq & (1-t)\\left(\\int_{E_{\\Omega}} d(x, z)^{2} d\\left(e_{0} \\circ \\pi^{\\operatorname{Geo}(X)}, \\pi^{X}\\right)_{\\#} \\boldsymbol{\\alpha}(x, z)+\\int_{A \\times \\Omega} d(x, z)^{2} d \\gamma(x, z)\\right) \\\\\n& +t\\left(\\int_{E_{\\Omega}} d(x, z)^{2} d\\left(e_{1} \\circ \\pi^{\\operatorname{Geo}(X)}, \\pi^{X}\\right)_{\\#} \\boldsymbol{\\alpha}(x, z)+\\int_{A \\times \\Omega} d(x, z)^{2} d \\gamma(x, z)\\right) \\\\\n& -(1-t) t \\int_{E_{\\Omega}} d(x, z)^{2} d\\left(\\left(e_{0}, e_{1}\\right) \\circ \\pi^{\\operatorname{Geo}(X)}\\right)_{\\#} \\boldsymbol{\\alpha}(x, z) \\\\\n\\geq & (1-t) \\mathrm{Wb}_{2}^{2}\\left(\\mu_{0}, \\nu\\right)+t \\mathrm{Wb}_{2}^{2}\\left(\\mu_{1}, \\nu\\right)-(1-t) t \\mathrm{Wb}_{2}^{2}\\left(\\mu_{0}, \\mu_{1}\\right)\n\\end{aligned}\n$$\n\nwhich proves the claim.\nAn interesting fact about the geometric structure of $\\mathcal{M}_{2}(X, A)$ when $X$ is a non-negatively curved Alexandrov space is that the zero measure is always an extremal point, i.e. a point at which the space of directions has diameter bounded above by $\\pi / 2$ (see [29] for a more general exposition about extremal points and extremal sets in Alexandrov spaces).\n\nProposition 5.10. The space of directions at the zero measure, $\\Sigma_{0}\\left(\\mathcal{M}_{2}(X, A)\\right)$, has diameter no greater than $\\pi / 2$.\n\nProof. Let $\\mu, \\nu \\in \\mathcal{M}_{2}(X, A)$. Then, we know that\n\n$$\n\\mathrm{Wb}_{2}(\\mu, 0)^{2}+\\mathrm{Wb}_{2}(\\nu, 0)^{2} \\geq \\mathrm{Wb}_{2}(\\mu, \\nu)^{2}\n$$\n\nsince the transport plan $\\left(\\mathrm{id}, \\operatorname{proj}_{A}\\right)_{\\#} \\mu+\\left(\\operatorname{proj}_{A}, \\mathrm{id}\\right)_{\\#} \\nu \\in \\operatorname{Adm}(\\mu, \\nu)$ is suboptimal. Therefore, if $\\xi_{1}, \\xi_{2} \\in \\operatorname{Geo}\\left(\\mathcal{M}_{2}(X, A)\\right)$ are geodesics with $\\xi_{1}(0)=\\xi_{2}(0)=0$, then\n\n$$\n\\cos \\measuredangle\\left(\\xi_{1}, \\xi_{2}\\right)=\\lim _{s, t \\rightarrow 0} \\frac{\\mathrm{Wb}_{2}\\left(\\xi_{1}(s), 0\\right)^{2}+\\mathrm{Wb}_{2}\\left(\\xi_{2}(t), 0\\right)^{2}-\\mathrm{Wb}_{2}\\left(\\xi_{1}(s), \\xi_{2}(t)\\right)^{2}}{2 \\mathrm{Wb}_{2}\\left(\\xi_{1}(s), 0\\right) \\mathrm{Wb}_{2}\\left(\\xi_{2}(t), 0\\right)} \\geq 0\n$$\n\nwhich implies that $\\measuredangle\\left(\\xi_{1}, \\xi_{2}\\right) \\leq \\pi / 2$.", "tables": {}, "images": {}}, {"section_id": 6, "text": "# 6. Embedding of $\\mathcal{D}_{p}(X, A)$ into $\\mathcal{M}_{p}(X, A)$ \n\nOne of the motivations for studying $\\mathcal{M}_{p}(X, A)$ is that it admits a natural embedding of the space of generalised persistence diagrams $\\mathcal{D}_{p}(X, A)$, as defined in [10]. Indeed, we have the natural inclusion\n\n$$\n\\begin{aligned}\n\\mathcal{D}_{p}(X, A) & \\longrightarrow \\mathcal{M}_{p}(X, A) \\\\\n\\sigma & \\longmapsto \\sum_{x \\in \\sigma \\mid \\Omega} \\delta_{x}\n\\end{aligned}\n$$\n\nThe proofs of the following results are adaptations of those of [15, Lemma 3.4 and Proposition 3.5].\n\nProposition 6.1. Let $\\mu \\in \\mathcal{M}_{p}(X, A), r>0$ and $A_{r}=\\left\\{x \\in X: d(x, A) \\leq r\\right\\}$. Let $\\mu^{r}=\\left.\\mu\\right|_{X \\backslash A_{r}}$. Then $\\mathrm{Wb}_{p}\\left(\\mu^{r}, \\mu\\right) \\rightarrow 0$ when $r \\rightarrow 0$. Similarly, if $\\sigma \\in \\mathcal{D}_{p}(X, A)$, we have $d_{p}\\left(\\sigma^{r}, \\sigma\\right) \\rightarrow 0$ as $r \\rightarrow 0$.\n\nProof. Let $\\gamma \\in \\operatorname{Adm}\\left(\\mu, \\mu^{r}\\right)$ be the transport plan given by\n\n$$\n\\gamma=(\\mathrm{id}, \\mathrm{id})_{\\#} \\mu_{\\mid X \\backslash A_{r}}+\\left.\\left(\\mathrm{id}, \\operatorname{proj}_{A}\\right)_{\\#} \\mu\\right|_{A_{r}}\n$$\n\nTherefore,\n\n$$\n\\mathrm{Wb}_{p}^{p}\\left(\\mu, \\mu^{r}\\right) \\leq \\int_{A_{r}} d(x, A)^{p} d \\mu(x)\n$$\n\nBy the monotone convergence theorem applied to $\\mu$ with the functions $f_{r}(x)=d(x, A)^{p} \\cdot 1_{X \\backslash A_{r}}(x)$, we conclude that $\\mathrm{Wb}_{p}\\left(\\mu, \\mu^{r}\\right) \\rightarrow 0$ as $r \\rightarrow 0$. Similar arguments show that $d_{p}\\left(\\sigma, \\sigma^{r}\\right) \\rightarrow 0$ as $r \\rightarrow 0$.\n\nTheorem 6.2. For $\\sigma, \\tau \\in \\mathcal{D}_{p}(X, A), \\mathrm{Wb}_{p}(\\sigma, \\tau)=d_{p}(\\sigma, \\tau)$.\n\nProof. First we consider the case when both $\\sigma \\backslash A$ and $\\tau \\backslash A$ have finite cardinality (counting multiplicity), that is, $\\sigma \\backslash A=\\left\\{\\left\\{x_{1}, \\ldots, x_{m}\\right\\}\\right\\}$ and $\\tau \\backslash A=\\left\\{\\left\\{y_{1}, \\ldots, y_{n}\\right\\}\\right\\}$ for some $x_{i}, y_{j} \\in \\Omega$, $i=1, \\ldots, m, j=1, \\ldots, n$. Let us define\n\n$$\n\\begin{aligned}\n\\widetilde{\\sigma} & =\\left\\{\\left\\{x_{1}, \\ldots, x_{m}, \\operatorname{proj}_{A}\\left(y_{1}\\right), \\ldots, \\operatorname{proj}_{A}\\left(y_{n}\\right)\\right\\}\\right\\} \\\\\n\\widetilde{\\tau} & =\\left\\{\\left\\{y_{1}, \\ldots, y_{n}, \\operatorname{proj}_{A}\\left(x_{1}\\right), \\ldots, \\operatorname{proj}_{A}\\left(x_{m}\\right)\\right\\}\\right\\}\n\\end{aligned}\n$$\n\nThen, it is clear that\n\n$$\nd_{p}^{p}(\\sigma, \\tau)=d_{p}^{p}(\\widetilde{\\sigma}, \\widetilde{\\tau})=\\min _{P}\\langle P, C\\rangle_{\\mathrm{HS}}\n$$\n\nwhere $P$ runs over all permutation matrices of size $(m+n) \\times(m+n),\\langle\\cdot, \\cdot\\rangle_{\\mathrm{HS}}$ denotes the HilbertSchmidt inner product of square matrices, and\n\n$$\nC_{i j}= \\begin{cases}d\\left(x_{i}, y_{j}\\right)^{p} & \\text { if } 1 \\leq i \\leq m, 1 \\leq j \\leq n \\\\ d\\left(x_{i}, p_{A}\\left(x_{j-n}\\right)^{p} & \\text { if } 1 \\leq i \\leq m, n<j \\leq m+n \\\\ d\\left(y_{j}, p_{A}\\left(y_{i-m}\\right)\\right)^{p} & \\text { if } m<i \\leq m+n, 1 \\leq j \\leq n \\\\ 0 & \\text { if } m<i \\leq m+n, n<j \\leq m+n\\end{cases}\n$$\n\nSimilarly, it is clear that\n\n$$\n\\mathrm{Wb}_{p}^{p}(\\sigma, \\tau)=\\min _{M}\\langle M, C\\rangle_{\\mathrm{HS}}\n$$\n\nwhere $M$ runs over all matrices of size $(m+n) \\times(m+n)$ such that $M_{i j} \\geq 0$ and $\\sum_{i=1}^{m+n} M_{i j}=$ $\\sum_{j=1}^{m+n} M_{i j}=1$.\n\nHowever, it is known that minimisers in equation (6.1) are permutation matrices (see [5, 30]). This proves the finite case.\n\nFor arbitrary $\\sigma, \\tau \\in \\mathcal{D}_{p}(X, A)$, consider $r>0$ and observe that both $\\sigma^{r}$ and $\\tau^{r}$ contain finitely many points in $\\Omega$. Then, due to proposition 6.1, we get that\n\n$$\n\\mathrm{Wb}_{p}(\\sigma, \\tau)=\\lim _{r \\rightarrow 0} \\mathrm{Wb}_{p}\\left(\\sigma^{r}, \\tau^{r}\\right)=\\lim _{r \\rightarrow 0} d_{p}\\left(\\sigma^{r}, \\tau^{r}\\right)=d_{p}(\\sigma, \\tau)\n$$", "tables": {}, "images": {}}, {"section_id": 7, "text": "# REFERENCES \n\n1. Andr\u00e9s Ahumada G\u00f3mez and Mauricio Che, Gromov-Hausdorff convergence of metric pairs and metric tuples, Differential Geom. Appl. 94 (2024), Paper No. 102135, 29. MR 4727066\n2. Luigi Ambrosio and Nicola Gigli, A user's guide to optimal transport, Modelling and Optimisation of Flows on Networks, Lecture Notes in Mathematics, vol. 2062, Springer, Berlin, Heidelberg, 2013.\n3. Edward A. Azoff, Borel measurability in linear algebra, Proc. Amer. Math. Soc. 42 (1974), 346-350. MR 327799\n4. David Bate and Ana Luc\u00eda Garcia Pulido, Bi-Lipschitz embeddings of the space of unordered m-tuples with a partial transportation metric, Math. Ann. 390 (2024), no. 2, 3109-3131. MR 4801849\n5. Garrett Birkhoff, Three observations on linear algebra, Univ. Nac. Tucum\u00e1n. Revista A. 5 (1946), 147-151. MR 20547\n6. Peter Bubenik and Alex Elchesen, Relative optimal transport, 2025.\n7. Peter Bubenik and Iryna Hartsock, Topological and metric properties of spaces of generalized persistence diagrams, J. Appl. Comput. Topol. 8 (2024), no. 2, 347-399. MR 4768640\n8. Dmitri Burago, Yuri Burago, and Sergei Ivanov, A course in metric geometry, Graduate Studies in Mathematics, vol. 33, American Mathematical Society, Providence, RI, 2001. MR 1835418\n9. Luis A. Caffarelli and Robert J. McCann, Free boundaries in optimal transport and Monge-Amp\u00e8re obstacle problems, Ann. of Math. (2) 171 (2010), no. 2, 673-730. MR 2630054\n10. Mauricio Che, Fernando Galaz-Garc\u00eda, Luis Guijarro, and Ingrid Membrillo Solis, Metric geometry of space of persistence diagrams, arXiv:2109.14697, 2022.\n11. Mauricio Che, Fernando Galaz-Garc\u00eda, Luis Guijarro, Ingrid Membrillo Solis, and Motiejus Valiunas, Basic metric geometry of the bottleneck distance, Proc. Amer. Math. Soc. 152 (2024), no. 8, 3575-3591. MR 4767285\n12. S. Chen and E. Indrei, On the regularity of the free boundary in the optimal partial transport problem for general cost functions, J. Differential Equations 258 (2015), no. 7, 2618-2632. MR 3306350\n13. L\u00e9na\u00efc Chizat, Gabriel Peyr\u00e9, Bernhard Schmitzer, and Fran\u00e7ois-Xavier Vialard, Unbalanced optimal transport: dynamic and Kantorovich formulations, J. Funct. Anal. 274 (2018), no. 11, 3090-3123. MR 3782988\n14. David Cohen-Steiner, Herbert Edelsbrunner, and John Harer, Stability of persistence diagrams, Discrete Comput. Geom. 37 (2007), no. 1, 103-120. MR 2279866\n15. Vincent Divol and Th\u00e9o Lacombe, Understanding the topology and the geometry of the space of persistence diagrams via optimal partial transport, Journal of Applied and Computational Topology 5 (2021), no. 1, 1-53. MR 4224153\n16. Herbert Edelsbrunner, David Letscher, and Afra Zomorodian, Topological persistence and simplification, 41st Annual Symposium on Foundations of Computer Science (Redondo Beach, CA, 2000), IEEE Comput. Soc. Press, Los Alamitos, CA, 2000, pp. 454-463. MR 1931842\n17. Matthias Erbar and Giulia Meglioli, Gradient flow for a class of diffusion equations with dirichlet boundary data, 2025.\n18. Alessio Figalli, The optimal partial transport problem, Arch. Ration. Mech. Anal. 195 (2010), no. 2, 533-560. MR 2592287\n19. Alessio Figalli and Nicola Gigli, A new transportation distance between non-negative measures, with applications to gradients flows with Dirichlet boundary conditions, Journal de Math\u00e9matiques Pures et Appliqu\u00e9es. Neuvi\u00e8me S\u00e9rie 94 (2010), no. 2, 107-130. MR 2665414\n20. Gerald B. Folland, Real analysis, second ed., Pure and Applied Mathematics (New York), John Wiley \\& Sons, Inc., New York, 1999, Modern techniques and their applications, A Wiley-Interscience Publication. MR 1681462\n21. Detlef Gromoll, Wilhelm Klingenberg, and Wolfgang Meyer, Riemannsche Geometrie im Grossen, Lecture Notes in Mathematics, vol. No. 55, Springer-Verlag, Berlin-New York, 1968. MR 229177\n22. Leonid G. Hanin, Kantorovich-Rubinstein norm and its application in the theory of Lipschitz spaces, Proc. Amer. Math. Soc. 115 (1992), no. 2, 345-352. MR 1097344\n23. Emanuel Indrei, Free boundary regularity in the optimal partial transport problem, J. Funct. Anal. 264 (2013), no. 11, 2497-2528. MR 3041707\n24. Richard Jordan, David Kinderlehrer, and Felix Otto, The variational formulation of the Fokker-Planck equation, SIAM Journal on Mathematical Analysis 29 (1998), no. 1, 1-17 (English).\n25. Olav Kallenberg, Random measures, fourth ed., Akademie-Verlag, Berlin; Academic Press, Inc., London, 1986. MR 854102\n26. , Random measures, theory and applications, Probability Theory and Stochastic Modelling, vol. 77, Springer, Cham, 2017. MR 3642325\n27. Matthias Liero, Alexander Mielke, and Giuseppe Savar\u00e9, Optimal entropy-transport problems and a new HellingerKantorovich distance between positive measures, Invent. Math. 211 (2018), no. 3, 969-1117. MR 3763404\n28. Wolfgang Meyer, Toponogov's Theorem and Applications, Lecture Notes, College on Differential Geometry, Trieste, 1989 .\n\n29. Anton Petrunin, Semiconcave functions in Alexandrov's geometry, Surveys in differential geometry. Vol. XI, Surv. Differ. Geom., vol. 11, Int. Press, Somerville, MA, 2007, pp. 137-201. MR 2408266\n30. Filippo Santambrogio, Optimal transport for applied mathematicians, Progress in Nonlinear Differential Equations and their Applications, vol. 87, Birkh\u00e4user/Springer, Cham, 2015, Calculus of variations, PDEs, and modeling. MR 3409718\n31. Giuseppe Savar\u00e9 and Giacomo Enrico Sodini, A relaxation viewpoint to Unbalanced Optimal Transport: Duality, optimality and Monge formulation, J. Math. Pures Appl. (9) 188 (2024), 114-178. MR 4756504\n32. Katharine Turner, Yuriy Mileyko, Sayan Mukherjee, and John Harer, Fr\u00e9chet means for distributions of persistence diagrams, Discrete Comput. Geom. 52 (2014), no. 1, 44-70. MR 3231030\n33. C\u00e9dric Villani, Optimal transport, Grundlehren der mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences], vol. 338, Springer-Verlag, Berlin, 2009, Old and new. MR 2459454\n34. Afra Zomorodian and Gunnar Carlsson, Computing persistent homology, Discrete Comput. Geom. 33 (2005), no. 2, 249-274. MR 2121296\n(Che) Department of Mathematical Sciences, Durham University, United Kingdom.\nCurrent address: Faculty of Mathematics, University of Vienna, Austria.\nEmail address: mauricio.adrian.che.moguel@univie.ac.at", "tables": {}, "images": {}}], "id": "2406.17674v2", "authors": ["Mauricio Che"], "categories": ["math.MG", "math.AT"], "abstract": "In this article we study Figalli and Gigli's formulation of optimal transport\nbetween non-negative Radon measures in the setting of metric pairs. We carry\nover classical characterisations of optimal plans to this setting and prove\nthat the resulting spaces of measures, $\\mathcal{M}_p(X,A)$, are complete,\nseparable and geodesic whenever the underlying space, $X$, is so. We also prove\nthat, for $p>1$, $\\mathcal{M}_p(X,A)$ preserves the property of being\nnon-branching, and for $p=2$ it preserves non-negative curvature in the\nAlexandrov sense. Finally, we prove isometric embeddings of generalised spaces\nof persistence diagrams $\\mathcal{D}_p(X,A)$ into the corresponding spaces\n$\\mathcal{M}_p(X,A)$, generalising a result by Divol and Lacombe. As an\napplication of this framework, we show that several known geometric properties\nof spaces of persistence diagrams follow from those of $\\mathcal{M}_p(X,A)$,\nincluding the fact that $\\mathcal{D}_2(X,A)$ is an Alexandrov space of\nnon-negative curvature whenever $X$ is a proper non-negatively curved\nAlexandrov space.", "updated": "2025-03-11T18:23:37Z", "published": "2024-06-25T16:05:22Z"}